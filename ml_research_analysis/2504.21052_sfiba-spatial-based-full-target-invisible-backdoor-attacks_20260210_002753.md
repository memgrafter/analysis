---
ver: rpa2
title: 'SFIBA: Spatial-based Full-target Invisible Backdoor Attacks'
arxiv_id: '2504.21052'
source_url: https://arxiv.org/abs/2504.21052
tags:
- trigger
- backdoor
- poisoned
- attack
- sfiba
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces SFIBA, a novel spatial-based full-target
  invisible backdoor attack designed to address limitations in existing multi-target
  backdoor attacks, particularly in black-box settings. The key innovation lies in
  leveraging the sensitivity of backdoor models to trigger spatial location and morphology
  to ensure trigger specificity, while employing frequency-domain-based trigger injection
  methods to guarantee stealthiness.
---

# SFIBA: Spatial-based Full-target Invisible Backdoor Attacks

## Quick Facts
- **arXiv ID:** 2504.21052
- **Source URL:** https://arxiv.org/abs/2504.21052
- **Reference count:** 37
- **Primary result:** Achieves high attack success rates for any predefined target class while maintaining model performance on benign samples and bypassing existing backdoor defenses

## Executive Summary
SFIBA introduces a novel spatial-based full-target invisible backdoor attack that addresses limitations in existing multi-target backdoor attacks, particularly in black-box settings. The key innovation lies in leveraging the sensitivity of backdoor models to trigger spatial location and morphology to ensure trigger specificity, while employing frequency-domain-based trigger injection methods to guarantee stealthiness. SFIBA achieves full-target attacks by dividing images into disjoint blocks, injecting invisible, morphologically constrained triggers into specific blocks for different target classes, and dynamically optimizing injection coefficients.

## Method Summary
SFIBA executes a full-target invisible backdoor attack by first partitioning images into non-overlapping spatial blocks, each assigned to a specific target class. It then employs frequency-domain injection using FFT, DWT, and SVD to embed triggers into the diagonal features of the amplitude spectrum while maintaining visual imperceptibility. The method applies morphological constraints to ensure trigger specificity and uses dynamic tuning to achieve high PSNR values (40-42). During training, the model learns to map each spatial block-trigger combination to its designated target class, enabling multi-target attacks that are robust to common data augmentations.

## Key Results
- Achieves attack success rates exceeding 99% across all target classes on CIFAR-10, GTSRB, and ImageNet100
- Maintains benign accuracy with minimal degradation (typically <1%) on clean samples
- Successfully bypasses existing backdoor defenses including fine-pruning and spectral signature detection
- Demonstrates superior stealth with PSNR values consistently above 40, indicating near-invisible trigger injection

## Why This Works (Mechanism)

### Mechanism 1: Spatial Disjointness for Trigger Specificity
- **Claim:** Restricting triggers for different target classes to non-overlapping spatial regions minimizes mutual interference during training, enabling simultaneous multi-target attacks.
- **Mechanism:** The method partitions images into disjoint "Blocks" with specific spatial intervals. It relies on the theoretical assumption that a backdoor is sensitive to trigger location; if a trigger is shifted spatially, the backdoor effect for the original target is lost. By allocating a unique Block and channel to each target class, the model learns independent mappings for each trigger location.
- **Core assumption:** The Neural Tangent Kernel (NTK) behavior implies that features extracted from a trigger in one spatial region have low correlation with backdoor neurons established in a different region.
- **Evidence anchors:** Abstract statement on restricting triggers to local spatial regions, Section IV.A Lemma 1 on spatial sensitivity, and related work on multi-target strategies.

### Mechanism 2: Frequency-Domain Fusion for Stealth and Effectiveness
- **Claim:** Transforming trigger injection into the frequency domain using DWT and SVD allows for high attack success rates while maintaining visual imperceptibility (high PSNR).
- **Mechanism:** The method avoids pixel-space injection. Instead, it uses FFT to access the amplitude spectrum, then DWT to extract diagonal features (which contain less energy and are visually less significant). SVD is then used to fuse the trigger information into the singular values of the clean image. This allows the trigger to be "hidden" in the structural stability of the image data rather than its visual appearance.
- **Core assumption:** DNNs rely sufficiently on the amplitude spectrum's structural features (singular values) for classification, such that modifying them alters classification without human-perceptible visual artifacts.
- **Evidence anchors:** Abstract statement on frequency-domain injection, Section IV.B on injecting triggers into high-frequency HH1 and low-frequency HH2 components, and related work on feature-based attacks.

### Mechanism 3: Morphological Constraints for Robustness
- **Claim:** Applying differentiated morphological constraints (horizontal vs. vertical) to triggers enhances their specificity and robustness against data augmentation.
- **Mechanism:** After frequency injection, the method applies a filter in pixel space, retaining trigger information only in specific directional features (e.g., horizontal). Triggers in adjacent blocks use orthogonal orientations (e.g., vertical). This creates a "signature" for the trigger that helps the model distinguish targets even if spatial localization is slightly jittery.
- **Core assumption:** Data augmentation (rotation/translation) does not completely destroy the directional integrity of the trigger features.
- **Evidence anchors:** Abstract statement on selectively filtering parts of the trigger, Section IV.B Step 3 on applying distinct morphological constraints, and validation experiments showing ASR for two targets at 90.8% and 89.2%.

## Foundational Learning

- **Concept: Fast Fourier Transform (FFT) in Image Processing**
  - **Why needed here:** SFIBA relies on the "amplitude spectrum" for injection. You must understand that FFT decomposes an image into frequency components where "amplitude" holds low-level semantic info (contrast/brightness) while "phase" holds high-level structure.
  - **Quick check question:** If you modify the phase spectrum instead of the amplitude spectrum, would the visual quality likely remain as high?

- **Concept: Discrete Wavelet Transform (DWT)**
  - **Why needed here:** The method injects triggers into sub-bands (LL, LH, HL, HH). You need to distinguish that HH (Diagonal) features are low-energy and thus better for hiding triggers than LL (Approximation) features.
  - **Quick check question:** Why does the paper choose the diagonal features (HH) over the approximation sub-band (LL) for trigger injection?

- **Concept: Singular Value Decomposition (SVD)**
  - **Why needed here:** The paper claims SVD "reduces sensitivity to injection coefficient." You need to know that singular values represent the "energy" or "stability" of a matrix to understand why fusing triggers here is more robust than direct addition.
  - **Quick check question:** How does fusing data into singular values help stabilize the trade-off between visual quality (PSNR) and attack effectiveness?

## Architecture Onboarding

- **Component map:** Input (Clean Image & Trigger Image) -> Block Selector (Divides image into disjoint $2l_0$ regions) -> Frequency Injector (FFT -> DWT -> SVD Fusion -> IDWT -> IFFT) -> Morphological Filter (DWT on Poisoned Block -> Filter Horizontal/Vertical -> IDWT) -> Dynamic Tuner (Binary search for coefficient $K$ to target PSNR $\in (40, 42)$)

- **Critical path:** The **Dynamic Tuning (Algorithm 2)** is the most volatile component. If the initial $K$ range $(K_{min}, K_{max})$ is misconfigured for a specific dataset, the search may fail to find a coefficient that satisfies the PSNR threshold, resulting in either visible noise (too high $K$) or a failed attack (too low $K$).

- **Design tradeoffs:**
  - **Block Size vs. Target Count:** Smaller blocks allow for more target classes (e.g., 300 on ImageNet) but make frequency injection harder due to "irregular energy distributions" in small patches.
  - **Stealth vs. Robustness:** Using only diagonal features (HH) via DWT improves stealth but might make the trigger more fragile to heavy compression than using LL features.

- **Failure signatures:**
  - **Low ASR on specific classes:** Likely indicates Block overlap due to aggressive data augmentation or an error in the `Distance(Block_i, Block_around)` calculation.
  - **Low Benign Accuracy (BA):** Suggests the injection coefficient $K$ is too high, corrupting the semantic features of the clean image (check PSNR logs).
  - **High Variance in ASR:** Indicates that the Dynamic Tuning is inconsistent across samples (Algorithm 2 is exiting early or failing).

- **First 3 experiments:**
  1. **Spatial Sensitivity Validation:** Run a single-target attack, then shift the trigger by 1-2 pixels during inference to verify the drop in ASR (confirming Lemma 1).
  2. **Ablation on Frequency Components:** Remove the SVD step (Step 3 in paper) and compare the resulting PSNR and ASR to understand the stability contribution of SVD.
  3. **Defense Robustness:** Apply "Fine-Pruning" to the infected model and plot the decay rate of Benign Accuracy vs. Attack Success Rate to confirm the backdoor's persistence.

## Open Questions the Paper Calls Out
None

## Limitations
- **Spatial augmentation vulnerability:** The method's effectiveness assumes trigger location sensitivity remains robust across diverse model architectures and training regimes, but common data augmentation pipelines may disrupt the spatial relationships between triggers and target classes.
- **Stealth guarantees based on PSNR only:** The method's stealth guarantees are based on PSNR metrics alone, without formal perceptual quality assessments or human evaluation studies to validate visual imperceptibility.
- **Assumption-dependent effectiveness:** The frequency-domain injection approach assumes that singular value manipulation preserves classification-relevant features while maintaining visual imperceptibility, which may not hold for all model architectures or training scenarios.

## Confidence
- **High Confidence:** Spatial disjointness for trigger specificity (Section IV.A) - supported by direct experimental evidence and theoretical framework
- **Medium Confidence:** Frequency-domain stealth mechanism (Section IV.B) - validated through PSNR metrics but lacks perceptual studies
- **Low Confidence:** Morphological constraint robustness against aggressive augmentations - supported by limited ablation experiments

## Next Checks
1. **Augmentation Robustness Test:** Apply strong spatial augmentations (rotation up to 30Â°, translation up to 20% image size) during inference and measure ASR degradation across all target classes.

2. **Cross-Architecture Generalization:** Evaluate SFIBA on VGG and MobileNet architectures beyond the reported ResNet models to verify spatial sensitivity assumptions hold across different feature extraction patterns.

3. **Defense Circumvention Study:** Test SFIBA against fine-pruning and spectral signature detection methods, measuring both ASR persistence and the ability to evade detection metrics.