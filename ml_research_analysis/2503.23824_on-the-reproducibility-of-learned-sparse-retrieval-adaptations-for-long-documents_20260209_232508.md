---
ver: rpa2
title: On the Reproducibility of Learned Sparse Retrieval Adaptations for Long Documents
arxiv_id: '2503.23824'
source_url: https://arxiv.org/abs/2503.23824
tags:
- document
- terms
- retrieval
- segment
- segments
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study examines Learned Sparse Retrieval (LSR) for long document
  retrieval by reproducing ExactSDM and SoftSDM methods. The experiments confirm that
  the first segment dominates retrieval performance and that Score-Max remains robust
  across varying document lengths.
---

# On the Reproducibility of Learned Sparse Retrieval Adaptations for Long Documents
## Quick Facts
- arXiv ID: 2503.23824
- Source URL: https://arxiv.org/abs/2503.23824
- Reference count: 23
- Learned Sparse Retrieval (LSR) methods improve long document retrieval performance

## Executive Summary
This study examines Learned Sparse Retrieval (LSR) adaptations for long document retrieval by reproducing ExactSDM and SoftSDM methods. The experiments validate that Score-Max remains robust across varying document lengths and that the first segment consistently dominates retrieval performance. Both ExactSDM and SoftSDM demonstrate improved performance over baseline LSR through proximity-based matching, with ExactSDM emerging as the most effective approach for long documents. The analysis highlights the critical importance of hyperparameter tuning for optimal performance and reveals that unique and global terms significantly impact scoring more than intersection terms.

## Method Summary
The study reproduces ExactSDM and SoftSDM methods for learned sparse retrieval of long documents. Documents are partitioned into three segments, with each segment processed through LSR models. ExactSDM uses exact proximity matching between query and document segments, while SoftSDM employs soft proximity scoring. Score-Max pooling aggregates segment scores to produce final retrieval rankings. The methods are evaluated on standard datasets with varying document lengths to assess performance consistency and robustness.

## Key Results
- The first segment consistently dominates retrieval performance across all tested methods
- Score-Max pooling remains robust when document length varies
- ExactSDM achieves superior performance compared to SoftSDM for long document retrieval

## Why This Works (Mechanism)
The first-segment dominance likely stems from query terms concentrating in early document sections where key information is typically presented. Score-Max pooling preserves the strongest relevance signal by selecting the highest-scoring segment, avoiding dilution that occurs with averaging or summation. ExactSDM's superior performance can be attributed to its precise proximity matching, which more accurately captures local relevance patterns compared to SoftSDM's smoothed scoring approach.

## Foundational Learning
- Learned Sparse Retrieval (LSR): Combines neural term weighting with sparse vector representations; needed for efficient long document processing; quick check: compare against dense retrieval baselines
- Segment pooling strategies: Methods for combining scores from document partitions; needed to handle documents exceeding typical length limits; quick check: evaluate different pooling functions (max, sum, average)
- Proximity matching: Scoring based on term co-occurrence patterns; needed to capture local relevance signals; quick check: measure impact of proximity window size
- Hyperparameter tuning: Systematic parameter optimization; needed for method-specific performance; quick check: conduct grid search across key parameters

## Architecture Onboarding
**Component map:** Document -> Segmenter -> LSR Model -> Segment Scores -> Pooling Function -> Final Ranking
**Critical path:** Query -> LSR Model Processing -> Proximity Scoring -> Segment Pooling -> Ranked Results
**Design tradeoffs:** ExactSDM provides precise proximity matching but may be computationally expensive; SoftSDM offers smoother scoring but potentially less discriminative power
**Failure signatures:** Performance degradation when first segment lacks query terms; sensitivity to incorrect segment boundaries; overfitting to specific document structures
**First experiments:**
1. Compare Score-Max pooling against alternative aggregation methods (sum, average, weighted)
2. Test segment partitioning with different segment counts (2, 4, 5) to validate first-segment dominance
3. Evaluate method performance on documents with varying structural complexity (headers, lists, paragraphs)

## Open Questions the Paper Calls Out
- How do ExactSDM and SoftSDM methods generalize to document types beyond news articles?
- What is the optimal number of segments for different document structures and domains?
- How does computational efficiency scale with document length and segment count?
- Can the first-segment dominance phenomenon be explained by specific document characteristics or query patterns?

## Limitations
- Focus on only ExactSDM and SoftSDM methods without exploring alternative segment pooling strategies
- Fixed three-segment partitioning scheme may not generalize to documents with different structures
- Limited to specific datasets without broader domain validation
- No investigation of computational efficiency or scalability trade-offs
- Unknown: Impact of segment boundary placement on retrieval performance
- Unknown: Sensitivity to different proximity window sizes in ExactSDM
- Unknown: Effect of query length variations on segment dominance patterns

## Confidence
- High confidence: First segment dominance; Score-Max robustness; ExactSDM and SoftSDM improvements
- Medium confidence: Hyperparameter tuning recommendations; ExactSDM versus SoftSDM comparison; term impact analysis
- Low confidence: Generalization to non-newswire domains; optimal segment count for diverse documents; computational efficiency comparisons

## Next Checks
1. Replicate experiments using documents with more than three segments to test first-segment dominance with finer granularity
2. Test methods on non-newswire datasets (scientific papers, legal documents) to assess domain generalizability
3. Measure runtime and memory usage for ExactSDM and SoftSDM at scale to evaluate deployment feasibility
4. Investigate alternative segment boundary placement strategies beyond fixed-length partitioning
5. Compare performance with different proximity window sizes in ExactSDM to understand sensitivity