---
ver: rpa2
title: 'MarS-FM: Generative Modeling of Molecular Dynamics via Markov State Models'
arxiv_id: '2509.24779'
source_url: https://arxiv.org/abs/2509.24779
tags:
- page
- mars-fm
- cited
- training
- dynamics
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper introduces MSM-Emulators, a new class of generative models
  that learn to sample transitions across discrete states defined by a Markov State
  Model (MSM) rather than fixed-lag time transitions. This approach addresses data
  imbalance in MD data by focusing on state-to-state transitions rather than frame-to-frame
  transitions, enabling better learning of rare conformational changes.
---

# MarS-FM: Generative Modeling of Molecular Dynamics via Markov State Models

## Quick Facts
- arXiv ID: 2509.24779
- Source URL: https://arxiv.org/abs/2509.24779
- Authors: Kacper KapuÅ›niak; Cristian Gabellini; Michael Bronstein; Prudencio Tossou; Francesco Di Giovanni
- Reference count: 40
- Key outcome: MARS-FM generates protein conformations over 600x faster than MD simulations while outperforming existing MD-emulators on structural observables

## Executive Summary
MARS-FM introduces a novel approach to generative modeling of molecular dynamics by learning transitions between discrete states defined by Markov State Models (MSMs) rather than fixed-lag time transitions. This addresses data imbalance in MD data by focusing on state-to-state transitions, enabling better learning of rare conformational changes. The framework leverages Flow Matching optimization and demonstrates superior performance in generating realistic protein conformations across diverse protein domains, particularly excelling at capturing large conformational changes like unfolding events.

## Method Summary
MARS-FM represents a new class of generative models called MSM-Emulators that learn to sample transitions across discrete states defined by a Markov State Model rather than fixed-lag time transitions. By focusing on state-to-state transitions rather than frame-to-frame transitions, the method addresses data imbalance issues inherent in MD data. The framework uses Flow Matching optimization to learn the transition dynamics between MSM states, generating conformations that preserve structural observables while achieving computational speedups of over 600x compared to traditional MD simulations. The approach demonstrates improved sampling of rare conformational changes and better generalization across different protein systems.

## Key Results
- Generates protein conformations over 600x faster than traditional MD simulations
- Outperforms existing MD-emulators on structural observables including RMSD, radius of gyration, and secondary structure content
- Demonstrates superior performance in capturing large conformational changes like unfolding events across diverse protein domains

## Why This Works (Mechanism)
The method works by restructuring the generative modeling problem from learning fixed-lag time transitions to learning transitions between discrete states in an MSM. This approach naturally addresses the data imbalance problem in MD data where most transitions occur between similar states while rare but important transitions (like unfolding) are underrepresented. By focusing learning capacity on state-to-state transitions, the model can better capture the statistical properties of these transitions without being overwhelmed by the majority of similar-state transitions. The Flow Matching optimization further enhances learning by providing a stable training objective that works well with the discrete state structure.

## Foundational Learning

**Markov State Models (MSMs)**: Discretize conformational space into discrete states and estimate transition probabilities between them - needed to define the state-to-state transition problem that MARS-FM learns; quick check: verify transition matrix satisfies detailed balance.

**Flow Matching**: A generative modeling technique that learns to transform simple distributions into complex ones through deterministic paths - needed to provide stable optimization for learning state transitions; quick check: confirm training loss decreases monotonically.

**Molecular Dynamics (MD) Simulation**: Numerical integration of Newton's equations of motion to sample protein conformational space - needed as the source of training data and ground truth for evaluation; quick check: validate energy conservation in reference trajectories.

## Architecture Onboarding

**Component Map**: Raw MD Trajectories -> MSM Discretization -> State Transition Pairs -> Flow Matching Network -> Generated Conformations

**Critical Path**: The core pipeline processes MD trajectories through MSM clustering to extract state transition pairs, which are then used to train the Flow Matching network that generates new conformations by sampling state-to-state transitions.

**Design Tradeoffs**: The method trades fine-grained temporal resolution for improved sampling of rare transitions by working at the MSM state level rather than individual time steps. This sacrifices some dynamical detail but gains efficiency and better coverage of conformational space.

**Failure Signatures**: Poor MSM discretization can lead to over- or under-clustering, resulting in either too many similar states or states that are too broad to capture meaningful transitions. Insufficient training data for certain state transitions can cause the model to generate unrealistic conformations for those specific transitions.

**First Experiments**: 1) Generate trajectories for a simple protein and compare equilibrium distributions with reference MD; 2) Test sensitivity to number of MSM states by varying clustering granularity; 3) Evaluate performance on a protein with known rare transitions like unfolding.

## Open Questions the Paper Calls Out

None

## Limitations

- Reliance on MSM discretization introduces sensitivity to clustering method and number of states, affecting generative performance
- Limited assessment of dynamical properties such as transition rates and timescales critical for understanding biomolecular function
- Performance on extremely rare transitions (occurring less than once per microsecond) remains untested
- Comparison assumes access to the same simulation data for training, not addressing performance under limited data constraints

## Confidence

- High confidence: Computational efficiency gains (600x speedup) and basic structural accuracy (RMSD, radius of gyration, secondary structure content)
- Medium confidence: Handling of rare conformational changes and unfolding events, generalization across protein domains
- Low confidence: Dynamical accuracy and preservation of transition timescales

## Next Checks

1. Compare transition rates and timescales between MARS-FM-generated trajectories and long-timescale reference simulations using implied timescales analysis

2. Systematically evaluate MARS-FM performance across different numbers of MSM states (10, 50, 100, 200) and clustering algorithms

3. Train MARS-FM on progressively smaller fractions of available simulation data (10%, 25%, 50%) to assess performance under realistic data constraints