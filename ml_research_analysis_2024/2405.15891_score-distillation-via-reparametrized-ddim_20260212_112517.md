---
ver: rpa2
title: Score Distillation via Reparametrized DDIM
arxiv_id: '2405.15891'
source_url: https://arxiv.org/abs/2405.15891
tags:
- ddim
- noise
- inversion
- diffusion
- score
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper addresses the problem of over-smoothing and lack of detail
  in 3D shape generation using Score Distillation Sampling (SDS) when compared to
  2D image generation quality from diffusion models. The core idea is to reinterpret
  SDS as a high-variance version of DDIM (Denoising Diffusion Implicit Models) with
  i.i.d.
---

# Score Distillation via Reparametrized DDIM

## Quick Facts
- arXiv ID: 2405.15891
- Source URL: https://arxiv.org/abs/2405.15891
- Reference count: 40
- One-line primary result: Improves 3D shape generation quality by reinterpreting SDS as a high-variance DDIM variant and using prompt-conditioned DDIM inversion to reduce variance and enhance detail preservation

## Executive Summary
The paper addresses the problem of over-smoothing and lack of detail in 3D shape generation using Score Distillation Sampling (SDS) compared to 2D image generation quality from diffusion models. The authors show that SDS can be reinterpreted as a high-variance version of DDIM with i.i.d. noise sampling at each step. By replacing random noise sampling with prompt-conditioned DDIM inversion (SDI), the method achieves consistent denoising trajectories that significantly improve 3D generation quality, producing higher-frequency details and reducing over-saturation without requiring additional neural networks or multi-view supervision.

## Method Summary
The method replaces the random noise sampling in SDS with prompt-conditioned DDIM inversion to achieve consistent denoising trajectories. This involves running DDIM inversion conditioned on the text prompt with negative guidance (γinv = -γfwd) to infer the conditional noise term, which is then used in the score distillation loss computation. The approach effectively reduces the variance introduced by random noise sampling in SDS, leading to improved detail preservation and reduced over-saturation in 3D generation. The method uses standard 3D representations like InstantNGP with differentiable rendering and pre-trained 2D diffusion models like Stable Diffusion 2.1.

## Key Results
- SDI significantly improves 3D generation quality compared to SDS, producing higher-frequency details and reducing over-saturation
- The method achieves CLIP scores and ImageReward metrics comparable to or better than state-of-the-art methods like ISM and ProlificDreamer
- Experiments show that prompt-conditioned DDIM inversion with negative guidance (γinv = -γfwd) provides the best approximation quality for the conditional noise term

## Why This Works (Mechanism)

### Mechanism 1
SDS can be reinterpreted as a high-variance version of DDIM due to its use of i.i.d. noise sampling at each step instead of conditionally inferred noise. By replacing random noise sampling in SDS with prompt-conditioned DDIM inversion, the noise trajectories become consistent, reducing variance and improving detail preservation in 3D generation.

### Mechanism 2
DDIM inversion with negative guidance (γinv = -γfwd) provides a better approximation of the conditional noise term needed for consistent denoising trajectories. Running DDIM inversion conditionally on the text prompt with negative guidance aligns the inferred noise with the forward denoising process, reducing over-saturation and improving 3D generation quality.

### Mechanism 3
The variance-boosting effect of noisy guidance in SDS is mitigated by using prompt-conditioned DDIM inversion, leading to reduced over-saturation and improved detail preservation. By using prompt-conditioned DDIM inversion instead of random noise sampling, the variance in the denoising process is reduced, allowing for the use of lower guidance values and avoiding over-saturation while preserving details.

## Foundational Learning

- Concept: Diffusion models and their denoising processes (DDIM, SDS)
  - Why needed here: Understanding the relationship between DDIM and SDS is crucial for grasping the core insight of the paper and the proposed improvement.
  - Quick check question: What is the key difference between DDIM and SDS in terms of noise sampling, and how does this difference impact the quality of generated 3D shapes?

- Concept: Classifier-free guidance (CFG) and its effects on generation quality
  - Why needed here: CFG plays a significant role in controlling the variance and detail preservation in both 2D and 3D generation using diffusion models.
  - Quick check question: How does increasing the CFG value affect the generated images in terms of detail preservation and over-saturation?

- Concept: 3D representation and rendering techniques (e.g., NeRF, InstantNGP)
  - Why needed here: Understanding the 3D representation and rendering pipeline is essential for implementing and evaluating the proposed method in the context of 3D shape generation.
  - Quick check question: What are the key components of a 3D representation and rendering pipeline, and how do they contribute to the overall generation process?

## Architecture Onboarding

- Component map: 3D shape representation (e.g., InstantNGP) -> Differentiable renderer -> Pre-trained 2D diffusion model (e.g., Stable Diffusion 2.1) -> DDIM inversion module -> Score distillation loss computation

- Critical path: 1) Render a random view of the current 3D shape, 2) Run DDIM inversion to infer the conditional noise term, 3) Compute the score distillation loss using the inferred noise and the pre-trained diffusion model, 4) Backpropagate the loss to update the 3D shape representation

- Design tradeoffs: Number of DDIM inversion steps (more steps improve noise approximation but increase computational cost), CFG value for inversion (γinv) and forward pass (γfwd) (affects inversion quality and generation results), resolution of rendered views (higher resolution improves detail but increases computational cost)

- Failure signatures: Over-saturation (indicates excessive variance in denoising process), lack of detail (suggests insufficient variance reduction or improper noise approximation), inconsistent 3D views (implies issues with 3D representation or rendering pipeline)

- First 3 experiments: 1) Implement proposed method and verify 3D shape generation with simple prompt and representation, 2) Compare generated 3D shapes quality with baseline SDS using quantitative metrics and qualitative evaluation, 3) Ablate key components (DDIM inversion steps, CFG values) to understand their impact and identify optimal settings

## Open Questions the Paper Calls Out

### Open Question 1
How can we further reduce the variance in 3D generation beyond the improvements provided by SDI, particularly to address the Janus problem and hollow face illusion? While the paper suggests using Perp-Neg and normal map penalties as partial solutions, stronger view conditioning, multi-view supervision, or video generation models might resolve these issues, but these remain untested hypotheses.

### Open Question 2
What is the optimal strategy for selecting the noise term κ_t(y) in 3D score distillation, and how does it compare to other root-finding approaches beyond DDIM inversion? While DDIM inversion is shown to be superior to other tested methods, the paper acknowledges that fixed points of the theoretical equation could be found through other means, including trained invertible diffusion models as a future research direction.

### Open Question 3
How does the choice of CFG values for DDIM inversion (γ_inv) and forward pass (γ_fwd) affect the quality of 3D generation, and what is the theoretical explanation for the counterintuitive finding that γ_inv = -γ_fwd works better than γ_inv = γ_fwd? While the paper provides empirical evidence and some intuition, it does not provide a complete theoretical explanation for why negative CFG during inversion improves results, noting this finding is "surprising" with only partial explanations offered.

## Limitations
- The method occasionally produces flat or concave "billboards" due to the Janus problem and hollow face illusion
- Content drift occurs where certain properties of generated 3D shapes drift around different views due to limited communication between frames
- Performance on complex, multi-object scenes and diverse 3D representations beyond InstantNGP remains untested

## Confidence
- High: The mathematical equivalence between SDS and DDIM variants is well-established
- Medium: Experimental improvements over baseline methods are demonstrated but may depend on specific implementation choices
- Medium: Claims about variance reduction and detail preservation are supported but could benefit from more rigorous quantitative analysis

## Next Checks
1. Conduct ablation studies on the number of DDIM inversion steps (2, 4, 8, 16) to determine the optimal balance between noise approximation quality and computational cost
2. Test the method's robustness across different 3D representations (NeRF, Plenoxels) and rendering pipelines to verify generalizability
3. Evaluate the method on multi-object prompts and complex scene descriptions to assess its ability to handle more challenging generation tasks beyond single-object prompts