---
ver: rpa2
title: Towards Marginal Fairness Sliced Wasserstein Barycenter
arxiv_id: '2405.07482'
source_url: https://arxiv.org/abs/2405.07482
tags:
- mfswb
- barycenter
- wasserstein
- page
- sliced
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces the Marginal Fairness Sliced Wasserstein
  Barycenter (MFSWB) to address the limitation of uniform weighted SWB in achieving
  marginal fairness. The authors propose three hyperparameter-free and computationally
  tractable surrogate MFSWB problems to overcome the computational challenges of the
  formal definition.
---

# Towards Marginal Fairness Sliced Wasserstein Barycenter

## Quick Facts
- arXiv ID: 2405.07482
- Source URL: https://arxiv.org/abs/2405.07482
- Authors: Khai Nguyen; Hai Nguyen; Nhat Ho
- Reference count: 40
- Key outcome: Introduces Marginal Fairness Sliced Wasserstein Barycenter (MFSWB) with three computationally tractable surrogate problems to ensure marginal fairness in barycenter estimation

## Executive Summary
This paper addresses the limitation of uniform weighted Sliced Wasserstein Barycenter (USWB) in achieving marginal fairness, where the barycenter may be closer to some marginals than others. The authors propose three hyperparameter-free surrogate MFSWB problems: s-MFSWB minimizes the maximum SW distance to any marginal, us-MFSWB minimizes the expected value of the largest one-dimensional Wasserstein distance, and es-MFSWB introduces an energy-based slicing distribution that focuses computational effort on unfair projecting directions. Experimental results on 3D point-cloud averaging, color harmonization, and sliced Wasserstein autoencoder demonstrate favorable performance compared to existing methods.

## Method Summary
The paper introduces Marginal Fairness Sliced Wasserstein Barycenter (MFSWB) to address fairness limitations in standard USWB. The formal MFSWB is computationally intractable due to the arg max operation, so three surrogate problems are proposed. The s-MFSWB minimizes the maximum Wasserstein distance to any marginal, us-MFSWB minimizes the expected value of the largest one-dimensional Wasserstein distance among marginals, and es-MFSWB uses an energy-based slicing distribution that reweights projecting directions based on their fairness energy. All methods are optimized using stochastic gradient descent with Monte Carlo estimation of the sliced Wasserstein distance.

## Key Results
- USWB does not guarantee marginal fairness due to heterogeneous marginal structures and non-optimal optimization
- s-MFSWB implicitly encourages fairness by minimizing the maximum distance to marginals
- es-MFSWB improves computational efficiency by focusing on projecting directions where unfairness is most pronounced
- Experiments show favorable performance on 3D point-cloud averaging, color harmonization, and SWAE with class-fairness representation

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Uniform SWB does not guarantee marginal fairness because the optimization landscape may converge to a barycenter that is closer to some marginals than others.
- Mechanism: The non-uniform geometry of marginals combined with the stochastic optimization over projecting directions causes bias in the final barycenter location.
- Core assumption: The distance from the barycenter to each marginal is not directly controlled during optimization.
- Evidence anchors:
  - [abstract]: "The uniform weighted SWB is not necessarily the optimal choice to obtain the desired marginal fairness barycenter due to the heterogeneous structure of marginals and the non-optimality of the optimization."
  - [section 3.1]: "Both the Wasserstein barycenter and SWB are defined based on a given set of marginal weights (marginal coefficients), and these weights represent the important levels of marginals toward the barycenter."
- Break condition: If marginals are identical or symmetric, the bias disappears.

### Mechanism 2
- Claim: The proposed surrogate MFSWB problems minimize the maximum Wasserstein distance to any marginal, thereby implicitly enforcing fairness.
- Mechanism: By minimizing the worst-case distance, all distances to marginals are reduced, leading to a more balanced solution.
- Core assumption: Minimizing the maximum distance indirectly reduces the variance of distances across marginals.
- Evidence anchors:
  - [abstract]: "We propose two hyperparameter-free and computationally tractable surrogate MFSWB problems that implicitly minimize the distances to marginals and encourage marginal fairness at the same time."
  - [section 3.2]: "The s-MFSWB problem tries to minimize the maximal distance from the barycenter to the marginals. Therefore, it can minimize indirectly the overall distances between the barycenter to the marginals and implicitly make the distances to marginals approximately the same."
- Break condition: If one marginal is significantly different from others, the maximum distance may still be dominated by that outlier.

### Mechanism 3
- Claim: The energy-based slicing distribution focuses computational effort on projecting directions where the barycenter is furthest from marginals, improving fairness efficiency.
- Mechanism: Reweighting projecting directions based on their fairness energy prioritizes correction of unfair projections.
- Core assumption: Unfairness is more pronounced in certain projecting directions than others.
- Evidence anchors:
  - [section 3.2]: "From the new proposed slicing distribution, we can define a new surrogate MFSWB problem... es-MFSWB utilizes the marginal fairness energy-based slicing distribution to reweight the importance of each projecting direction instead of considering them equally."
  - [section 3.2]: "We see that the marginal fairness energy-based slicing distribution in Definition 4 put more mass to a projecting direction θ that has the larger maximal one-dimensional Wasserstein distance to marginals."
- Break condition: If all projecting directions have similar fairness energy, reweighting provides no benefit.

## Foundational Learning

- Concept: Sliced Wasserstein Distance
  - Why needed here: Forms the core distance metric used throughout the barycenter formulation
  - Quick check question: What is the computational complexity of computing SW distance between two discrete measures with n supports?

- Concept: Wasserstein Barycenter
  - Why needed here: The baseline method that MFSWB extends to incorporate fairness constraints
  - Quick check question: How does the computational complexity of Wasserstein barycenter compare to SWB?

- Concept: Stochastic Gradient Descent with Monte Carlo Estimation
  - Why needed here: Required to optimize the barycenter when SW distance is intractable
  - Quick check question: What is the role of the number of projections L in the gradient estimation?

## Architecture Onboarding

- Component map: Data → Marginal Representation → SWB/Surrogate MFSWB → Barycenter Output
- Critical path: Marginal preparation → Gradient computation via Monte Carlo → Parameter update → Convergence check
- Design tradeoffs: Computational efficiency vs. fairness accuracy; hyperparameter-free design vs. flexibility
- Failure signatures: Slow convergence, high variance in gradients, poor fairness metrics despite optimization
- First 3 experiments:
  1. Compare USWB vs. s-MFSWB on synthetic Gaussian marginals with known ground truth
  2. Test gradient variance as a function of projection count L for different surrogate definitions
  3. Validate the connection to SMW by computing both metrics on simple distributions

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the choice of hyperparameter λ in the formal MFSWB affect the trade-off between marginal fairness and barycenter quality, and is there an optimal strategy for selecting λ?
- Basis in paper: [explicit] The paper discusses the sensitivity of the formal MFSWB to the choice of λ and compares different values (0.1, 1, 10) in experiments.
- Why unresolved: The paper shows that the performance of the formal MFSWB is sensitive to λ, but it does not provide a clear strategy for selecting the optimal λ value.
- What evidence would resolve it: A systematic study of the effect of different λ values on the F-metric and W-metric for various datasets and applications would help identify an optimal strategy for selecting λ.

### Open Question 2
- Question: Can the proposed surrogate MFSWB problems be extended to handle more complex fairness constraints beyond marginal fairness, such as group fairness or individual fairness?
- Basis in paper: [inferred] The paper focuses on marginal fairness, but the surrogate MFSWB problems are defined based on general principles of minimizing distances and encouraging fairness, which could potentially be extended to other fairness notions.
- Why unresolved: The paper does not explore the applicability of the surrogate MFSWB problems to other fairness constraints beyond marginal fairness.
- What evidence would resolve it: Applying the surrogate MFSWB problems to datasets with different fairness requirements and evaluating their performance in terms of relevant fairness metrics would demonstrate their generalizability.

### Open Question 3
- Question: How do the proposed surrogate MFSWB problems compare to other fairness-aware barycenter methods in terms of computational efficiency and effectiveness?
- Basis in paper: [explicit] The paper mentions that the formal MFSWB has computational challenges and proposes surrogate problems to address them, but it does not compare the proposed methods to other existing fairness-aware barycenter approaches.
- Why unresolved: The paper does not provide a comparison of the proposed surrogate MFSWB problems to other fairness-aware barycenter methods in terms of computational efficiency and effectiveness.
- What evidence would resolve it: Conducting a comparative study of the proposed surrogate MFSWB problems against other fairness-aware barycenter methods on benchmark datasets and applications would reveal their relative strengths and weaknesses.

## Limitations

- The computational efficiency claims for es-MFSWB are not empirically validated with runtime comparisons
- The hyperparameter-free claim is somewhat misleading as the number of projections L remains a critical parameter
- The connection to sliced multi-marginal Wasserstein distance with maximal ground metric is established theoretically but not empirically validated

## Confidence

- **High confidence**: The mathematical formulation of the three surrogate problems is rigorous and well-defined.
- **Medium confidence**: The theoretical connections to SMW distance are sound but require more empirical validation.
- **Medium confidence**: The experimental results show favorable performance, but the evaluation metrics for fairness could be more comprehensive.

## Next Checks

1. **Runtime Benchmarking**: Measure and compare wall-clock time for computing s-MFSWB, us-MFSWB, and es-MFSWB on identical marginals with varying numbers of projections L.
2. **Convergence Analysis**: Track the maximum distance to marginals over iterations to verify that s-MFSWB indeed converges to a fairer solution than USWB.
3. **Sensitivity Study**: Evaluate how the number of projections L affects both the fairness metrics and computational cost across all three surrogate definitions.