---
ver: rpa2
title: On the Byzantine-Resilience of Distillation-Based Federated Learning
arxiv_id: '2402.12265'
source_url: https://arxiv.org/abs/2402.12265
tags:
- clients
- byzantine
- feddistill
- predictions
- learning
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper analyzes Byzantine-resilient knowledge distillation
  (KD) in federated learning (FL). It shows that KD-based FL algorithms are inherently
  more resilient to Byzantine attacks than standard parameter-sharing methods because
  the attack space is restricted to the probability simplex.
---

# On the Byzantine-Resilience of Distillation-Based Federated Learning

## Quick Facts
- arXiv ID: 2402.12265
- Source URL: https://arxiv.org/abs/2402.12265
- Reference count: 40
- Key outcome: Knowledge distillation-based federated learning is inherently more resilient to Byzantine attacks due to the bounded probability simplex constraint, with novel attacks (LMA, CPA) and defenses (ExpGuard, HIPS) proposed.

## Executive Summary
This paper analyzes Byzantine-resilient knowledge distillation in federated learning, demonstrating that KD-based approaches are inherently more resilient than parameter-sharing methods because Byzantine clients are confined to the probability simplex. The authors introduce two novel attacks (LMA and CPA) that can break existing defenses, and propose a new defense mechanism (ExpGuard) that leverages historical and current client behavior. Additionally, they present HIPS, a general framework to obfuscate attacks and make them harder to detect. Extensive experiments on CIFAR-10/100, CINIC-10, and Clothing1M datasets validate the effectiveness of both attacks and defenses.

## Method Summary
The method involves FedDistill, a knowledge distillation-based federated learning algorithm where clients train on private data and send predictions on a public dataset to the server. The server aggregates these predictions and trains on the public dataset using them as pseudo-labels. The paper introduces two novel Byzantine attacks (LMA and CPA) that exploit the probability simplex constraint, and proposes ExpGuard, a defense mechanism that computes outlier scores based on client predictions across rounds. HIPS is presented as a general framework to obfuscate attacks. Experiments use ResNet and WideResNet architectures on CIFAR-10/100, CINIC-10, and Clothing1M datasets with 20 clients over 10 communication rounds.

## Key Results
- FedDistill with mean aggregation is more resilient to Byzantine attacks than FedAvg due to the bounded probability simplex constraint
- LMA and CPA attacks can effectively break existing Byzantine defenses in FedDistill
- ExpGuard significantly improves Byzantine resilience by incorporating historical and current client behavior
- HIPS makes attacks more effective against defenses by obfuscating attack patterns

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Knowledge distillation-based FL is more resilient to Byzantine attacks than parameter-sharing FedAvg because the attack space is restricted to the probability simplex.
- **Mechanism:** Byzantine clients in FedDistill can only send probability vectors in the c-dimensional simplex ∆c, while in FedAvg they can send arbitrary updates in the unbounded parameter space. This confinement inherently limits the impact of adversarial perturbations.
- **Core assumption:** The honest clients' predictions remain bounded in the probability simplex and Byzantine clients cannot directly manipulate the model parameters.
- **Evidence anchors:**
  - [abstract] "KD-based FL algorithms are inherently more resilient to Byzantine attacks than standard parameter-sharing methods because the attack space is restricted to the probability simplex."
  - [section] "The threat vector in FedDistill is confined to the bounded probability simplex ∆c, limiting the impact of perturbations, unlike in FedAvg, where the threat vector operates in the higher-dimensional, unbounded parameter space."
  - [corpus] "Byzantine-Robust Federated Learning with Learnable Aggregation Weights" discusses aggregation in bounded spaces but not specifically the simplex constraint in distillation.

### Mechanism 2
- **Claim:** The indirect influence of Byzantine clients through the distillation objective makes FedDistill more resilient than FedAvg where clients directly manipulate model parameters.
- **Mechanism:** In FedDistill, Byzantine clients affect the server model only indirectly through their predictions on the public dataset, which then influences the distillation objective. In FedAvg, they directly manipulate the server parameters through their parameter updates.
- **Core assumption:** The server aggregates predictions using a mean or robust aggregation method, and Byzantine clients cannot directly influence the server's optimization procedure.
- **Evidence anchors:**
  - [abstract] "byzantine clients in FedDistill can only influence the server model indirectly through the distillation objective, whereas in FedAvg they directly manipulate the model parameters."
  - [section] "The influence of byzantine clients on the server parameters in FedDistill is indirect. They can only affect the distillation objective through their predictions..."
  - [corpus] Weak - corpus neighbors focus on secure aggregation but not the indirect influence mechanism.

### Mechanism 3
- **Claim:** ExpGuard defense mechanism enhances Byzantine resilience by incorporating client behavior information from both current and past communication rounds.
- **Mechanism:** ExpGuard computes outlier scores for each client based on their predictions across the entire public dataset and updates client weights using exponential weights algorithm. This allows detection and filtering of Byzantine clients based on historical and current behavior.
- **Core assumption:** Byzantine clients exhibit detectable anomalous behavior patterns that can be identified through outlier detection on their predictions.
- **Evidence anchors:**
  - [abstract] "we propose a novel defence mechanism which enhances the byzantine resilience of KD-based FL algorithms."
  - [section] "ExpGuard, which incorporates additional information available to the server from the predictions on other samples within each communication round as well as information about the predictions in past communication rounds."
  - [corpus] "Practical Framework for Privacy-Preserving and Byzantine-robust Federated Learning" mentions outlier detection but not the specific ExpGuard approach.

## Foundational Learning

- **Concept: Knowledge Distillation**
  - Why needed here: Understanding how knowledge is transferred from teacher models (clients) to student model (server) through predictions is crucial for understanding the threat vectors and defense mechanisms.
  - Quick check question: How does the server use aggregated client predictions to update its model in FedDistill?

- **Concept: Byzantine Fault Tolerance**
  - Why needed here: Understanding Byzantine attacks and defenses is essential for analyzing the resilience of different FL algorithms and designing effective countermeasures.
  - Quick check question: What makes Byzantine attacks particularly challenging in distributed learning systems?

- **Concept: Probability Simplex**
  - Why needed here: The bounded nature of the probability simplex is a key factor in the inherent resilience of FedDistill to Byzantine attacks.
  - Quick check question: What are the properties of the probability simplex that make it inherently bounded?

## Architecture Onboarding

- **Component map:**
  Server -> Clients (20) -> Server (aggregation) -> Public dataset training

- **Critical path:**
  1. Server broadcasts parameters to clients
  2. Clients train on private data and send predictions on public dataset
  3. Server aggregates predictions and trains on public dataset
  4. Server broadcasts updated parameters

- **Design tradeoffs:**
  - FedDistill vs FedAvg: Communication efficiency vs direct parameter manipulation
  - Robust aggregation vs mean aggregation: Resilience vs accuracy
  - ExpGuard vs simpler defenses: Detection capability vs computational overhead

- **Failure signatures:**
  - Accuracy degradation over communication rounds
  - Inconsistent predictions across clients
  - Anomalous behavior patterns in client predictions

- **First 3 experiments:**
  1. Implement FedDistill with mean aggregation and measure accuracy with varying Byzantine client fractions
  2. Implement ExpGuard defense and compare resilience against LMA and CPA attacks
  3. Implement HIPS attack and measure its effectiveness against ExpGuard compared to non-obfuscated attacks

## Open Questions the Paper Calls Out
None

## Limitations
- Analysis is limited to specific attack and defense mechanisms without exploring the full space of Byzantine attack strategies in knowledge distillation settings
- The bounded nature of the probability simplex may not hold under all threat models, particularly if Byzantine clients can manipulate the public dataset or influence other clients' training
- Effectiveness of ExpGuard depends on the assumption that Byzantine behavior is detectable through outlier analysis, which may not hold against sophisticated adaptive attacks

## Confidence
- **High confidence:** The inherent resilience of KD-based FL due to the probability simplex constraint (Mechanism 1)
- **Medium confidence:** The indirect influence mechanism making FedDistill more resilient than FedAvg (Mechanism 2)
- **Medium confidence:** ExpGuard's effectiveness in detecting and filtering Byzantine clients (Mechanism 3)

## Next Checks
1. **Extend threat model analysis:** Evaluate whether Byzantine clients can bypass simplex constraints by manipulating public datasets or influencing honest clients' predictions through poisoning.
2. **Stress-test ExpGuard:** Design adaptive attacks that specifically target ExpGuard's outlier detection by mimicking honest client behavior patterns across multiple rounds.
3. **Evaluate HIPS in practice:** Implement the HIPS framework with real Byzantine clients to verify whether obfuscation techniques effectively bypass existing defenses while maintaining attack efficacy.