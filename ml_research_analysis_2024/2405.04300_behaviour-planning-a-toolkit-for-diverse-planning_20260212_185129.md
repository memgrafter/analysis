---
ver: rpa2
title: 'Behaviour Planning: A Toolkit for Diverse Planning'
arxiv_id: '2405.04300'
source_url: https://arxiv.org/abs/2405.04300
tags:
- planning
- plans
- behaviour
- diverse
- plan
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper addresses the problem of generating diverse plans in
  automated planning, where existing methods use distance functions to measure diversity,
  which limits expressiveness and explainability. It introduces a novel approach called
  Behaviour Planning that uses an n-dimensional grid (behaviour space) to represent
  user-defined features of plan diversity.
---

# Behaviour Planning: A Toolkit for Diverse Planning

## Quick Facts
- arXiv ID: 2405.04300
- Source URL: https://arxiv.org/abs/2405.04300
- Authors: Mustafa F Abdelwahed; Joan Espasa; Alice Toniolo; Ian P. Gent
- Reference count: 6
- One-line primary result: Novel approach for generating diverse plans using n-dimensional behaviour space, achieving 41,055 behaviour count for classical planning with k=1000 and q=1.0

## Executive Summary
This paper introduces Behaviour Planning, a novel approach to diverse planning that uses an n-dimensional behaviour space to represent user-defined features of plan diversity. Unlike traditional methods that use distance functions to measure diversity, this framework allows for more expressive modelling of diversity by mapping plans to behaviours in a customisable grid space. The approach is implemented using planning-as-satisfiability with SMT solvers and supports multiple planning paradigms including classical, over-subscription, and numerical planning.

## Method Summary
The Behaviour Planning framework uses a two-component approach: BSS (Behaviour Sorts Suite) defines the behaviour space with user-specified dimensions, while FBIX (Forbid Behaviour IterativeX) generates diverse plans by iteratively forbidding behaviours rather than individual plans. The system encodes planning problems and diversity constraints into SMT formulas, which are then solved to find plans with new behaviours. The method significantly outperforms existing diverse planning approaches in terms of behaviour count across various planning domains.

## Key Results
- Achieved 41,055 behaviour count for classical planning with k=1000 and q=1.0, significantly outperforming baseline methods
- Demonstrated superior diversity generation across three planning paradigms: classical, over-subscription, and numerical planning
- Showed effectiveness on benchmark domains including rover, satellite, and logistics problems

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Behaviour Planning outperforms distance-function-based diverse planning by incorporating a user-defined n-dimensional grid that captures meaningful features of plan diversity.
- **Mechanism:** The framework replaces the traditional distance threshold with a customisable diversity model. Each dimension in the behaviour space corresponds to a user-defined feature (e.g., cost, resource usage, goal ordering). Plans are generated to maximise the number of distinct behaviours (behaviour count) in the set, which directly measures diversity on interpretable dimensions rather than a single numeric distance.
- **Core assumption:** The user can define a finite, discretised set of dimensions that meaningfully capture the differences between plans relevant to their domain. The behaviour space is not too large to make search intractable.
- **Evidence anchors:**
  - [abstract] "This paper introduces a novel approach to the diverse planning problem, allowing for more expressive modelling of diversity using a n-dimensional grid representation, where each dimension corresponds to a user-defined feature."
  - [section] "Our key contribution is representing the astronaut's diversity requirements as a discretised grid, where each dimension corresponds to one of these important features."
- **Break condition:** If the behaviour space is too large or the user-defined features are not granular enough to distinguish meaningful differences, the approach may not generate truly diverse plans or may become computationally infeasible.

### Mechanism 2
- **Claim:** The Forbid Behaviour IterativeX (FBIX) algorithm ensures diverse plans by forbidding entire behaviours rather than individual plans, which prevents redundant exploration of plan variants that share the same behaviour.
- **Mechanism:** After generating a plan, FBIX infers its behaviour in the behaviour space and then forbids that behaviour. This means all plans that would have the same behaviour (including reorderings and symmetrical variants) are excluded from future search, forcing the planner to explore new regions of the behaviour space.
- **Core assumption:** Forbidding behaviours is a sufficient constraint to guide the planner toward unexplored behaviours without overly restricting the search space or causing premature failure to find new plans.
- **Evidence anchors:**
  - [section] "FBIX finds a plan, then uses behaviour space to infer this plan's behaviour and to acquire another plan, it forbids this behaviour, then uses the updated formulation to obtain a different one."
  - [section] "When FBIX prohibits a particular behaviour, all plans associated with this behaviour, along with their symmetrical and reordered versions that result in the same behaviour, are also forbidden."
- **Break condition:** If the behaviour space is poorly designed (e.g., dimensions are correlated or not sufficiently discriminating), forbidding behaviours may block large portions of the search space, leading to fewer generated plans than requested.

### Mechanism 3
- **Claim:** The planning-as-satisfiability (SMT) implementation enables the integration of arbitrary diversity constraints directly into the planning problem, allowing the diversity model to guide plan generation from the start.
- **Mechanism:** The Encoder function constructs a satisfiability formula that encodes both the planning problem and the behaviour space dimensions. Additional constraints derived from the diversity model (e.g., cost bounds, resource usage, goal ordering) are appended to the formula. The solver then searches for plans that satisfy both the original goals and the diversity constraints simultaneously.
- **Core assumption:** The SMT solver can efficiently handle the augmented problem with additional constraints without a prohibitive performance penalty. The encoding of diversity features into SMT constraints is correct and does not introduce logical errors.
- **Evidence anchors:**
  - [abstract] "We provide an implementation for behaviour planning using planning-as-satisfiability."
  - [section] "In our framework, to identify a plan, we abstract the creation of the formula ϕn by defining the function Encoder(Ξ, n) = ϕn, which takes a planning task Ξ, a number of steps (n) and returns a formula that encodes the existence of a plan with exactly n steps."
- **Break condition:** If the SMT encoding is inefficient or the problem size grows too large, the solver may time out or fail to find solutions, reducing coverage compared to baseline planners.

## Foundational Learning

- **Concept: Planning-as-satisfiability (SAT/SMT) encoding**
  - Why needed here: The entire Behaviour Planning framework relies on encoding the planning problem and diversity constraints into a satisfiability formula that can be solved by an SMT solver. Understanding how to construct these encodings is essential for implementing or extending the framework.
  - Quick check question: What are the key components that must be encoded in the satisfiability formula for a classical planning problem?

- **Concept: Behaviour space and dimensions**
  - Why needed here: The user must be able to define and construct the behaviour space, which involves selecting meaningful features, discretising their values, and implementing the extracting functions that map plans to behaviours. This is the core novelty of the approach.
  - Quick check question: How would you define a dimension for "resource utilisation" in a planning problem with multiple rovers?

- **Concept: Diverse planning metrics (behaviour count vs MaxSum)**
  - Why needed here: Understanding the difference between behaviour count and traditional diversity metrics like MaxSum is important for evaluating the effectiveness of the approach and for knowing when this method is appropriate.
  - Quick check question: What is the key difference between behaviour count and MaxSum in measuring plan diversity?

## Architecture Onboarding

- **Component map:**
  - BSS (Behaviour Sorts Suite) -> Encoder -> FBIX (Forbid Behaviour IterativeX) -> PlanExtractor -> Plan Set
  - BehaviourGenerator -> BehaviourSpace -> ExtractingFunctions -> Dimensions

- **Critical path:**
  1. Define behaviour space (dimensions and extracting functions).
  2. Encode the planning problem and behaviour space into an SMT formula.
  3. Use FBIX to iteratively find plans with new behaviours by forbidding existing ones.
  4. Extract and return the set of diverse plans.

- **Design tradeoffs:**
  - Expressivity vs. efficiency: More dimensions increase the granularity of diversity but also increase the size of the behaviour space and the complexity of the SMT formula.
  - User burden vs. customisation: Requiring users to define dimensions allows for domain-specific diversity but places a burden on the user to identify meaningful features.
  - Coverage vs. diversity: Forbidding behaviours may reduce coverage if the search space becomes too constrained.

- **Failure signatures:**
  - Low coverage: The SMT solver fails to find plans within the time/memory limits, often due to inefficient encodings or a large behaviour space.
  - Poor diversity: The generated plans do not exhibit the expected variety in the defined dimensions, possibly due to poorly chosen features or discretisation.
  - Solver timeouts: The augmented SMT formula is too complex for the solver to handle efficiently.

- **First 3 experiments:**
  1. **Classical planning with two dimensions:** Implement the rover domain example with dimensions for "goal predicate ordering" and "resource utilisation". Generate 5 plans and verify the behaviour count.
  2. **Over-subscription planning:** Convert a classical planning task to over-subscription by adding utility values. Use dimensions for "cost bound" and "utility value". Compare behaviour count with SymK.
  3. **Numerical planning:** Use a numerical planning domain with dimensions for "cost bound", "goal predicate ordering", and "numeric fluent" (e.g., rover energy levels). Compare with the naive version that forbids plans only.

## Open Questions the Paper Calls Out
1. How can behavior planning be extended to support planning paradigms beyond classical, over-subscription, and numerical planning?
2. What techniques can be employed to improve the coverage of behavior planning implementations while maintaining optimality?
3. How can the behavior space be optimized to reduce dimensionality without losing essential diversity information?
4. What guided search strategies could replace the current blind search approach in FBIX to improve efficiency?

## Limitations
- Framework performance heavily depends on user's ability to define meaningful behaviour space dimensions
- May struggle with coverage when behaviour space becomes too large or forbidding behaviours blocks significant portions of search space
- Computational overhead of SMT-based approach compared to traditional planners is not fully characterised
- User burden of defining meaningful dimensions requires domain expertise

## Confidence
- High confidence in the core mechanism of using behaviour space for diversity representation
- Medium confidence in the scalability claims, as experiments focus on behaviour count rather than runtime efficiency
- Medium confidence in the generality across planning categories, as numerical planning results are not fully detailed
- Low confidence in the ease of adoption, given the user burden of defining meaningful dimensions

## Next Checks
1. Benchmark runtime performance against baseline planners across multiple domains to quantify the computational overhead of the SMT-based approach
2. Implement an automated method for discovering behaviour space dimensions from problem structure to reduce user burden
3. Test the framework on a larger set of benchmark domains with varying characteristics to validate the generality claims beyond the presented examples