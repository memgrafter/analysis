---
ver: rpa2
title: 'ACTER: Diverse and Actionable Counterfactual Sequences for Explaining and
  Diagnosing RL Policies'
arxiv_id: '2402.06503'
source_url: https://arxiv.org/abs/2402.06503
tags:
- counterfactual
- failure
- acter
- explanations
- sequences
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'ACTER addresses the lack of actionable recourse in counterfactual
  explanations for RL policies by generating counterfactual sequences of actions that
  can prevent failures. The core method uses NSGA-II to optimize five counterfactual
  properties: validity (avoiding failure), proximity (similarity to original actions),
  sparsity (minimal changes), stochastic uncertainty (robustness), and recency (recent
  changes preferred).'
---

# ACTER: Diverse and Actionable Counterfactual Sequences for Explaining and Diagnosing RL Policies

## Quick Facts
- arXiv ID: 2402.06503
- Source URL: https://arxiv.org/abs/2402.06503
- Authors: Jasmina Gajcin; Ivana Dusparic
- Reference count: 39
- Key outcome: ACTER generates actionable counterfactual sequences for 89% of highway driving failures and 100% of farm failures, with higher stochastic uncertainty than baselines, though user study shows no improvement in failure diagnosis compared to non-actionable explanations.

## Executive Summary
ACTER addresses the lack of actionable recourse in counterfactual explanations for RL policies by generating counterfactual sequences of actions that can prevent failures. The core method uses NSGA-II to optimize five counterfactual properties: validity, proximity, sparsity, stochastic uncertainty, and recency. This generates diverse counterfactual sequences that users can choose based on their preferences. Experiments show ACTER generates valid counterfactuals for 89% of highway driving failures and 100% of farm failures, with higher stochastic uncertainty than baselines. However, a user study reveals that while counterfactual explanations are perceived as more useful and actionable, they don't actually help users better diagnose and correct failures compared to simpler explanations that only identify responsible actions.

## Method Summary
ACTER uses NSGA-II multi-objective evolutionary optimization to generate counterfactual action sequences that prevent RL policy failures. The method optimizes five counterfactual properties simultaneously: validity (avoiding failure), proximity (similarity to original actions), sparsity (minimal changes), stochastic uncertainty (robustness across environmental variations), and recency (recent changes preferred). Rather than producing a single optimal solution, ACTER generates a Pareto front of diverse counterfactual sequences, allowing users to select options that best match their preferences. The stochastic uncertainty property is particularly innovative, ensuring counterfactuals remain valid across different environmental configurations by simulating the counterfactual sequence under multiple stochastic scenarios.

## Key Results
- ACTER generates valid counterfactual sequences for 89% of highway driving failures and 100% of farm failures
- Generated counterfactuals have significantly higher stochastic uncertainty than baseline methods
- User study shows counterfactual explanations are perceived as more useful, detailed, and actionable than non-actionable explanations
- However, both explanation types perform similarly in helping users identify and correct failures
- ACTER produces significantly more diverse counterfactual sequences than baseline methods across all three diversity metrics

## Why This Works (Mechanism)

### Mechanism 1
- Claim: ACTER generates actionable counterfactual sequences by optimizing five specific properties simultaneously.
- Mechanism: Uses NSGA-II multi-objective evolutionary optimization to search for counterfactual action sequences that minimize five properties while maintaining validity as a hard constraint, creating a Pareto front of diverse solutions.
- Core assumption: The five counterfactual properties comprehensively capture what makes a counterfactual sequence useful for users.
- Evidence anchors: Abstract states ACTER "generates counterfactual sequences of actions that prevent it with minimal changes and high certainty"; section describes "five counterfactual properties that describe the desiderata"; corpus shows moderate relevance with FMR=0.531.
- Break condition: If the five properties don't adequately capture user needs or optimization trade-offs produce counterfactuals that are valid but not actionable.

### Mechanism 2
- Claim: Stochastic uncertainty property ensures counterfactuals remain valid across different environmental configurations.
- Mechanism: Estimates stochastic uncertainty by simulating the counterfactual action sequence under multiple possible stochastic configurations and calculating the probability of avoiding failure across all scenarios.
- Core assumption: Simulated stochastic configurations adequately represent the true distribution of possible environmental states.
- Evidence anchors: Abstract mentions "high certainty even in stochastic environments"; section states "stochastic uncertainty ensures that ð´âˆ— avoids failure with high certainty regardless of stochastic processes"; moderate corpus relevance (FMR=0.531).
- Break condition: If simulation environment doesn't accurately capture real-world stochasticity or insufficient simulations to reliably estimate uncertainty.

### Mechanism 3
- Claim: Multi-objective optimization with NSGA-II generates diverse counterfactual sequences catering to different user preferences.
- Mechanism: NSGA-II maintains a population of solutions representing different trade-offs between properties, creating a Pareto front rather than a single optimal solution.
- Core assumption: Users have heterogeneous preferences for counterfactual properties and providing multiple options is better than a single solution.
- Evidence anchors: Abstract states ACTER "generates a set of multiple diverse counterfactual sequences"; section notes "different users might deem different properties as more important" and "users can get a better understanding of the different ways to prevent failure"; related work exists but ACTER specifically applies this to RL action sequences.
- Break condition: If users prefer a single, highly optimized counterfactual rather than multiple options, or diversity doesn't meaningfully capture different preferences.

## Foundational Learning

- Concept: Multi-objective optimization and Pareto fronts
  - Why needed here: ACTER uses NSGA-II to optimize five different counterfactual properties simultaneously, requiring understanding of how to handle conflicting objectives
  - Quick check question: What is the difference between a Pareto optimal solution and a dominated solution in multi-objective optimization?

- Concept: Evolutionary algorithms (specifically NSGA-II)
  - Why needed here: The paper uses NSGA-II for generating counterfactual sequences, requiring understanding of selection, crossover, mutation, and non-dominated sorting
  - Quick check question: How does NSGA-II maintain diversity in the population compared to single-objective genetic algorithms?

- Concept: Counterfactual reasoning in sequential decision-making
  - Why needed here: The core contribution involves reasoning about "what if" scenarios in RL by examining past actions, requiring understanding of counterfactual thinking in temporal contexts
  - Quick check question: How does counterfactual reasoning differ when applied to state features versus action sequences?

## Architecture Onboarding

- Component map:
  - RL environment interface -> Black-box policy -> Failure detection module -> NSGA-II optimization engine -> Diversity evaluation module -> User interface

- Critical path:
  1. Identify failure state and extract failure sequence
  2. Initialize NSGA-II population with sequences similar to failure sequence
  3. Run NSGA-II optimization to generate Pareto front of counterfactual sequences
  4. Evaluate generated sequences on counterfactual properties
  5. Present diverse set of counterfactual sequences to user

- Design tradeoffs:
  - Computational cost vs. diversity: More generations and larger populations yield more diverse counterfactuals but increase computation time
  - Optimality vs. actionability: Highly optimal counterfactuals might require large changes, reducing actionability
  - Stochastic uncertainty estimation vs. runtime: More simulations provide better uncertainty estimates but increase runtime

- Failure signatures:
  - NSGA-II fails to find valid counterfactuals: Check constraint handling and validity function implementation
  - Generated counterfactuals are not diverse: Check diversity metrics and NSGA-II parameters (crowding distance, population size)
  - Stochastic uncertainty estimates are unreliable: Check simulation environment and number of stochastic configurations sampled

- First 3 experiments:
  1. Run ACTER on a simple gridworld environment with discrete actions to verify basic functionality and compare to manual counterfactual generation
  2. Test ACTER on the highway environment with a known failure case to verify that generated counterfactuals actually prevent the specific crash
  3. Evaluate diversity metrics on counterfactual sequences generated for the Farm environment to verify that multiple distinct prevention strategies are identified

## Open Questions the Paper Calls Out

- Question: How to extend ACTER to handle cases where the environment model is not fully accessible?
  - Basis in paper: ACTER uses simulations to estimate stochastic uncertainty and leaves offline scenario for future work
  - Why unresolved: The paper only evaluates ACTER in simulated environments with full environment access, while real-world RL applications often have limited environment access
  - What evidence would resolve it: Comparative experiments showing ACTER's performance in both online (full environment access) vs offline (historical data only) settings

## Limitations

- User study reveals fundamental tension: counterfactual explanations are perceived as more useful but don't actually improve users' ability to diagnose and correct failures
- Computational overhead of ACTER not reported, making practical deployment considerations unclear
- Implementation details for NSGA-II algorithm and RL training not fully specified, hindering exact reproduction
- Limited evaluation scope: only tested on two specific environments (highway driving and farm simulation)

## Confidence

- High confidence: The core algorithmic contribution of generating actionable counterfactual sequences via NSGA-II optimization is well-specified and technically sound
- Medium confidence: The five-property framework comprehensively captures counterfactual desiderata, though relative importance of each property could be better justified
- Medium confidence: The stochastic uncertainty estimation approach is reasonable but depends heavily on the quality of the simulation environment

## Next Checks

1. **Reproduce counterfactual generation**: Implement ACTER on a simple gridworld environment and verify that generated counterfactuals actually prevent the specified failures while satisfying the five properties

2. **Validate stochastic uncertainty**: Test whether counterfactual sequences that score high on stochastic uncertainty actually remain valid across a wider range of environmental conditions than those that don't

3. **Ablation study**: Remove each counterfactual property one at a time from the optimization to quantify its individual contribution to the quality of generated counterfactuals