---
ver: rpa2
title: 'Have Faith in Faithfulness: Going Beyond Circuit Overlap When Finding Model
  Mechanisms'
arxiv_id: '2403.17806'
source_url: https://arxiv.org/abs/2403.17806
tags:
- eap-ig
- circuits
- faithfulness
- circuit
- overlap
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper addresses the challenge of efficiently finding faithful
  circuits in transformer language models, which are subgraphs that explain model
  behavior on specific tasks. While causal interventions are the gold standard for
  identifying important edges in circuits, they scale poorly with model size.
---

# Have Faith in Faithfulness: Going Beyond Circuit Overlap When Finding Model Mechanisms

## Quick Facts
- arXiv ID: 2403.17806
- Source URL: https://arxiv.org/abs/2403.17806
- Authors: Michael Hanna; Sandro Pezzelle; Yonatan Belinkov
- Reference count: 40
- Primary result: EAP with integrated gradients (EAP-IG) finds more faithful circuits than EAP while maintaining similar node overlap with manually found circuits

## Executive Summary
This paper addresses the challenge of finding faithful circuits in transformer language models—subgraphs that explain model behavior on specific tasks. While causal interventions are the gold standard for identifying important edges in circuits, they scale poorly with model size. Edge attribution patching (EAP) offers a scalable gradient-based approximation, but may compromise faithfulness—the property that ablating non-circuit edges doesn't change model performance on the task. The authors introduce EAP-IG, which incorporates integrated gradients to better handle zero gradients and finds more faithful circuits than EAP while maintaining similar node overlap with manually found circuits.

## Method Summary
The authors propose EAP with integrated gradients (EAP-IG) as an improvement over the standard EAP method. EAP-IG computes edge importance by accumulating gradients along a straight-line path from a baseline to the input, capturing activation changes that EAP misses when gradients are zero. The method uses a greedy search algorithm to select circuits from top-scored edges, ensuring structural coherence. Faithfulness is evaluated by intervening on non-circuit edges and measuring task performance retention, while overlap with manually found circuits is measured using intersection-over-union (IoU).

## Key Results
- EAP-IG circuits are more faithful than EAP circuits, particularly on tasks like Greater-Than and Country-Capital where differences exceed 0.2 in normalized faithfulness
- EAP-IG outperforms EAP on SVA and Hypernymy tasks, avoiding complete unfaithfulness issues EAP exhibits at low edge counts
- Circuit overlap with manually found circuits does not reliably predict faithfulness, especially for moderate overlap values (0.2-0.6 IoU)
- Activation patching circuits significantly outperform EAP/EAP-IG circuits on IOI and Gender-Bias tasks despite EAP-IG's improved faithfulness

## Why This Works (Mechanism)

### Mechanism 1
- Claim: EAP-IG improves faithfulness by addressing zero gradient issues in EAP through integrated gradients
- Mechanism: EAP-IG computes edge importance by accumulating gradients along a straight-line path from baseline to input, capturing activation changes that EAP misses when gradients are zero
- Core assumption: The difference between clean and corrupted activations matters for task performance, even when the gradient at the clean activation is zero
- Evidence anchors:
  - [abstract] "we introduce a new method—EAP with integrated gradients (EAP-IG)—that aims to better maintain a core property of circuits: faithfulness"
  - [section 3] "IG resolves this issue by cumulating the gradients along the straight-line path from s′ to s"
  - [corpus] Weak evidence - no direct citation of integrated gradients in related papers
- Break condition: If integrated gradients fails to capture relevant activation differences or if the model is non-differentiable at key points

### Mechanism 2
- Claim: Greedy search for circuit selection produces more faithful circuits than simple top-n edge selection
- Mechanism: The greedy algorithm builds circuits by iteratively adding the highest-scoring edge that connects to the existing circuit, ensuring structural coherence
- Core assumption: Edge scores alone don't guarantee circuit faithfulness; the circuit structure matters
- Evidence anchors:
  - [section 4.2] "we select a circuit of n edges using a greedy search procedure; if no circuit is faithful at n = 1000, we consider up to n = 2000"
  - [section D] "Finding the exact solution to this problem, i.e. finding the maximum-flow subgraph connecting our source node to the target node, is likely NP-hard"
  - [corpus] No direct evidence about greedy vs top-n in related papers
- Break condition: If edge scores are highly predictive of circuit faithfulness, making structure irrelevant

### Mechanism 3
- Claim: Faithfulness, not overlap, should be the primary metric for evaluating circuit-finding methods
- Mechanism: High node/edge overlap between circuits doesn't guarantee that the circuits capture the same computational mechanisms
- Core assumption: Circuit overlap metrics (IoU) don't account for the importance of specific edges or the functional role of components
- Evidence anchors:
  - [abstract] "Our experiments demonstrate that circuits found using EAP are less faithful than those found using EAP-IG, even though both have high node overlap"
  - [section 5] "we caution against concluding that overlap is a good way to predict faithfulness... when overlap is moderate, it does not predict faithfulness"
  - [corpus] Weak evidence - no direct citation about overlap vs faithfulness tradeoffs
- Break condition: If circuit overlap consistently predicts faithfulness across all tasks and models

## Foundational Learning

- Concept: Circuit faithfulness
  - Why needed here: The paper's core contribution is introducing EAP-IG to improve circuit faithfulness, a property distinct from circuit overlap
  - Quick check question: What distinguishes a faithful circuit from an unfaithful one in terms of model behavior?

- Concept: Gradient-based attribution methods
  - Why needed here: EAP and EAP-IG are gradient-based approximations of causal interventions, requiring understanding of how gradients can approximate importance
  - Quick check question: How does EAP use gradients to approximate the effect of edge interventions?

- Concept: Integrated gradients
  - Why needed here: EAP-IG extends EAP by incorporating integrated gradients to address zero gradient issues
  - Quick check question: What problem does integrated gradients solve that basic gradient attribution cannot?

## Architecture Onboarding

- Component map: Input -> attention layers -> MLP layers -> unembedding -> logits
- Critical path: Input → attention layers → MLP layers → unembedding → logits (for language modeling tasks)
- Design tradeoffs: Computational efficiency (EAP vs causal interventions) vs faithfulness; simplicity vs completeness of circuits
- Failure signatures: EAP produces unfaithful circuits with zero performance on some tasks; overlap metrics don't predict faithfulness; certain edges (like input to MLP0) are consistently critical
- First 3 experiments:
  1. Replicate EAP vs EAP-IG faithfulness comparison on IOI task with GPT-2 small
  2. Test EAP-IG with different step counts (m=2,3,5) to find minimum effective value
  3. Implement greedy circuit search algorithm and compare to top-n edge selection on Greater-Than task

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Does EAP-IG's improved faithfulness come from better estimating the importance of specific critical edges, or from more accurate overall edge rankings?
- Basis in paper: [inferred] The paper shows EAP-IG has better Pearson correlation with activation patching scores than EAP, but worse Kendall correlation with edge rankings. However, EAP-IG has better average overlap with top-k edges at small k values
- Why unresolved: The analysis shows conflicting evidence - EAP-IG is better correlated with ground truth scores but worse at overall ranking. The critical factor seems to be performance on top edges rather than overall ranking accuracy
- What evidence would resolve it: A controlled experiment isolating the effect of top-edge accuracy on faithfulness, or ablation studies showing which edges are most critical for faithfulness

### Open Question 2
- Question: Can a modified overlap metric that weights edges by their importance scores better predict cross-task faithfulness than simple IoU?
- Basis in paper: [explicit] The paper notes that moderate overlap (0.2-0.6 IoU) does not reliably predict faithfulness, unlike zero or perfect overlap. They suggest weighted graph edit distance as a potential solution
- Why unresolved: The authors only speculate about weighted metrics but don't test them. The current IoU metric treats all overlapping components equally regardless of their importance
- What evidence would resolve it: Experiments comparing standard IoU with weighted overlap metrics that incorporate edge importance scores, measuring correlation with cross-task faithfulness

### Open Question 3
- Question: Why do activation patching circuits significantly outperform EAP/EAP-IG circuits on IOI and Gender-Bias tasks despite EAP-IG's improved faithfulness?
- Basis in paper: [explicit] The results show activation patching circuits achieve faithfulness above 0.8 on IOI while EAP and EAP-IG plateau at 0.6, with similar underperformance on Gender-Bias at low edge counts
- Why unresolved: The paper doesn't investigate the specific mechanisms causing this gap. The authors note there's "still room for improvement on top of EAP-IG" but don't identify the source of activation patching's advantage
- What evidence would resolve it: Detailed analysis of which edges EAP-IG misses compared to activation patching, and whether these can be incorporated through modified scoring or circuit search algorithms

## Limitations

- Method robustness: The experiments are limited to GPT-2 small and six specific tasks, making it unclear how these methods generalize to larger models or more complex tasks
- Optimization guarantees: The greedy search algorithm for circuit selection is not guaranteed to find optimal circuits, and the quality of results depends heavily on this heuristic approach
- Correlation interpretation: While the paper demonstrates that overlap doesn't predict faithfulness well for moderate overlap values, the practical implications for circuit discovery methodology are not fully explored

## Confidence

- **High confidence**: EAP-IG improves faithfulness over EAP on tested tasks
- **Medium confidence**: Circuit overlap is not a reliable predictor of faithfulness
- **Medium confidence**: Greedy search produces more faithful circuits than top-n selection

## Next Checks

1. **Model scaling test**: Apply EAP-IG to GPT-2 medium or large models to verify faithfulness improvements scale with model size and confirm the method's practical utility for larger models
2. **Task generalization**: Test EAP-IG on a broader range of tasks beyond the six included, particularly tasks requiring multi-step reasoning or longer-range dependencies
3. **Optimization comparison**: Implement and compare alternative circuit selection methods (e.g., beam search or dynamic programming) against the greedy approach to establish whether better optimization yields more faithful circuits