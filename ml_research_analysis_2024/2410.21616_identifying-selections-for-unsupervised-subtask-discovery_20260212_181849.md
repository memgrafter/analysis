---
ver: rpa2
title: Identifying Selections for Unsupervised Subtask Discovery
arxiv_id: '2410.21616'
source_url: https://arxiv.org/abs/2410.21616
tags:
- learning
- subtasks
- data
- selection
- should
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of discovering reusable subtasks
  from expert demonstrations to improve data efficiency and generalization in multi-task
  imitation learning. The authors propose a novel theory that identifies subgoals
  as selection variables in the data generation process, distinguishing them from
  confounders or intermediate nodes.
---

# Identifying Selections for Unsupervised Subtask Discovery

## Quick Facts
- arXiv ID: 2410.21616
- Source URL: https://arxiv.org/abs/2410.21616
- Authors: Yiwen Qiu; Yujia Zheng; Kun Zhang
- Reference count: 40
- Key outcome: Proposes a causal theory identifying subgoals as selection variables and develops seq-NMF method to discover subtasks that improve generalization in multi-task imitation learning, outperforming baselines on synthetic and Kitchen environment datasets.

## Executive Summary
This paper addresses the challenge of discovering reusable subtasks from expert demonstrations to improve data efficiency and generalization in multi-task imitation learning. The authors propose a novel theory that identifies subgoals as selection variables in the data generation process, distinguishing them from confounders or intermediate nodes. Based on this theory, they develop a sequential non-negative matrix factorization (seq-NMF) method to learn subgoals and extract meaningful behavior patterns as subtasks. The proposed method is evaluated on synthetic and real-world datasets, including a challenging Kitchen environment. The results demonstrate that the learned subtasks effectively enhance generalization to new tasks in multi-task imitation learning scenarios, outperforming state-of-the-art baselines in terms of episodic return.

## Method Summary
The authors propose a causal framework where subgoals are identified as "selection variables" that causally influence the choice of actions, rather than being confounders or intermediate nodes. This theoretical foundation leads to a sequential non-negative matrix factorization (seq-NMF) approach that factorizes temporally segmented demonstration data into subgoal representations. The method learns a library of subtask policies that can be composed to solve new tasks. The seq-NMF algorithm alternates between inferring subgoal assignments for demonstration segments and updating subgoal representations, ensuring temporal consistency across the factorization process.

## Key Results
- The seq-NMF method successfully discovers semantically meaningful subtasks from expert demonstrations without supervision
- Learned subtasks significantly improve generalization to unseen tasks in multi-task imitation learning settings
- The approach outperforms state-of-the-art baselines in terms of episodic return on both synthetic and Kitchen environment datasets

## Why This Works (Mechanism)
The paper's approach works by leveraging causal inference principles to correctly identify subgoals as selection variables rather than confounding variables. This distinction is crucial because selection variables actively influence the generation of action sequences, while confounders merely correlate with them. By properly identifying selection variables, the method can extract truly reusable behavior patterns rather than spurious correlations. The sequential NMF factorization then decomposes demonstration trajectories into these subgoal representations while preserving temporal structure, enabling the discovery of meaningful subtasks that capture the essential decision points in expert behavior.

## Foundational Learning
- **Causal inference for variable identification**: Understanding the difference between selection variables, confounders, and mediators is essential for correctly extracting reusable subtasks from demonstrations. Quick check: Verify that subgoals identified by the method indeed precede and influence action choices in the causal graph.
- **Non-negative matrix factorization (NMF)**: NMF is used to decompose demonstration data into additive, interpretable components representing subtasks. Quick check: Ensure the non-negativity constraint produces parts-based, interpretable representations rather than abstract factors.
- **Temporal segmentation in sequential data**: The method must handle variable-length demonstrations and identify consistent temporal patterns across different expert trajectories. Quick check: Validate that discovered subtasks align with meaningful temporal segments in demonstrations.

## Architecture Onboarding
- **Component Map**: Demonstrations -> Temporal Segmentation -> seq-NMF Factorization -> Subgoal Library -> Task Composition
- **Critical Path**: Expert demonstrations are first temporally segmented, then factorized using seq-NMF to discover subgoals, which are compiled into a reusable library that can be composed for new tasks.
- **Design Tradeoffs**: The method trades off computational complexity of seq-NMF against the expressiveness of discovered subtasks. Using selection variable theory improves interpretability but may miss some task-relevant patterns that don't fit this causal structure.
- **Failure Signatures**: Poor performance when expert demonstrations lack clear subgoal structure, when the number of subtasks is mis-specified, or when temporal dependencies are too complex for seq-NMF to capture.
- **First Experiments**: 1) Run seq-NMF on synthetic data with known subgoal structure to verify recovery accuracy. 2) Test sensitivity to hyperparameter choices (number of subtasks, temporal window size). 3) Compare discovered subtasks against human-annotated ground truth in Kitchen environment.

## Open Questions the Paper Calls Out
None

## Limitations
- The theory relies on a specific causal structure assumption that subgoals are selection variables, which may not hold in all real-world scenarios
- The sequential NMF approach requires careful hyperparameter tuning that could impact results
- Performance on highly stochastic or partially observable environments remains unexplored

## Confidence
- **High Confidence**: The core theoretical framework distinguishing selection variables from confounders is sound and well-supported by causal inference principles
- **Medium Confidence**: The scalability of the method to more complex, high-dimensional tasks is plausible but not fully demonstrated
- **Low Confidence**: The method's behavior in scenarios with significant noise, non-stationary dynamics, or when expert demonstrations are sparse or suboptimal has not been thoroughly evaluated

## Next Checks
1. Conduct ablation studies removing the causal selection variable assumption to quantify its impact on subtask discovery quality and downstream performance
2. Test the method on a physical robot manipulation task (e.g., block stacking or tool use) to validate generalization beyond simulated environments
3. Evaluate the approach on a benchmark with significantly higher state/action dimensions (e.g., Atari or continuous control tasks) to assess computational feasibility and performance retention