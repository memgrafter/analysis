---
ver: rpa2
title: One-Index Vector Quantization Based Adversarial Attack on Image Classification
arxiv_id: '2409.01282'
source_url: https://arxiv.org/abs/2409.01282
tags:
- attack
- adversarial
- index
- image
- images
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a novel adversarial attack method targeting
  the vector quantization (VQ) domain, where images are commonly stored and transmitted.
  Unlike existing attacks in the pixel domain, this approach modifies a single VQ
  index to generate adversarial images that mislead classification models, addressing
  the gap in real-world attack scenarios.
---

# One-Index Vector Quantization Based Adversarial Attack on Image Classification

## Quick Facts
- arXiv ID: 2409.01282
- Source URL: https://arxiv.org/abs/2409.01282
- Reference count: 32
- Primary result: Novel single-index VQ adversarial attack achieving 55.9% success rate and 77.4% confidence on CIFAR-10 and Fashion MNIST

## Executive Summary
This paper introduces a novel adversarial attack method that operates in the vector quantization (VQ) domain, targeting compressed image data streams commonly used in real-world storage and transmission. Unlike traditional pixel-domain attacks, this approach modifies only a single VQ index to generate adversarial examples that mislead classification models while maintaining visual similarity to the original image. The method employs a differential evolution algorithm for optimization and a codeword sorting algorithm to enhance convergence efficiency. Experiments demonstrate effective attack performance on CIFAR-10 and Fashion MNIST datasets against multiple model architectures.

## Method Summary
The proposed method targets the VQ domain by modifying a single index in the compressed data stream. The approach uses differential evolution to optimize the perturbation of this index, with the objective of minimizing the true category probability. A codeword sorting algorithm based on PCA is applied to improve convergence efficiency by establishing correlations between adjacent codeword indexes. The attack operates in a semi-black-box setting where only output probabilities are accessible, making it practical for real-world applications where model weights may not be available.

## Key Results
- Achieved 55.9% average attack success rate on CIFAR-10 across ResNet, NIN, and VGG16 models
- Obtained 77.4% average confidence in misclassification for Fashion MNIST dataset
- Demonstrated effectiveness of codeword sorting in improving differential evolution convergence
- Successfully attacked three different model architectures with minimal image perturbation

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Modifying a single VQ index in the compressed data stream can cause misclassification in the neural network model.
- Mechanism: The VQ codebook maps image patches to codewords. Changing one index replaces a codeword with a different one, altering the reconstructed image in a way that shifts its features enough to cross the model's decision boundary.
- Core assumption: The model's classification is sensitive to the specific codeword values, and one codeword change is sufficient to change the model's output probability distribution.
- Evidence anchors:
  - [abstract]: "The one-index attack method modifies a single index in the compressed data stream so that the decompressed image is misclassified."
  - [section]: "Our method modifies only one VQ index to attack, and the VQ index’s range is [1, L]."
  - [corpus]: Weak or missing evidence in corpus for direct VQ index modification leading to misclassification.
- Break condition: If the model's decision boundary is too robust or the codeword change is too small to influence the reconstructed image features significantly.

### Mechanism 2
- Claim: Differential evolution algorithm can optimize the single VQ index perturbation to minimize the true class probability.
- Mechanism: The algorithm iteratively mutates and selects perturbations based on their fitness (true class probability), converging toward the perturbation that most effectively reduces the probability.
- Core assumption: The fitness landscape is smooth enough for differential evolution to navigate and find an effective perturbation within the limited number of iterations.
- Evidence anchors:
  - [abstract]: "The method employs a differential evolution algorithm to optimize the perturbation."
  - [section]: "We consider the true category probability as fitness value. The optimization objective is to minimize fitness value and the constraint number of modified indexes is one."
  - [corpus]: Weak or missing evidence in corpus for differential evolution's effectiveness in this specific attack scenario.
- Break condition: If the fitness landscape is too rugged or the true class probability is not sufficiently sensitive to small perturbations.

### Mechanism 3
- Claim: Codeword sorting algorithm improves the convergence efficiency of the differential evolution algorithm.
- Mechanism: Sorting codewords by principal component analysis (PCA) establishes a correlation between adjacent codeword indexes, making the solution space more navigable for the differential evolution algorithm.
- Core assumption: The differential evolution algorithm benefits from a structured solution space where adjacent solutions are more likely to be similar.
- Evidence anchors:
  - [abstract]: "The method employs a differential evolution algorithm to optimize the perturbation and a codeword sorting algorithm to enhance convergence efficiency."
  - [section]: "To sort codewords in the codebook, we need to perform data dimensionality reduction... PCA is the more basic linear dimensionality reduction method, so we use the PCA algorithm for codeword sorting."
  - [corpus]: Weak or missing evidence in corpus for the specific impact of codeword sorting on differential evolution convergence.
- Break condition: If the sorted codebook does not provide a significant advantage in convergence speed or if the differential evolution algorithm is not sensitive to the structure of the solution space.

## Foundational Learning

- Concept: Vector Quantization (VQ)
  - Why needed here: VQ is the compression technique targeted by the attack, and understanding how it works is crucial for modifying the compressed data stream.
  - Quick check question: What is the primary goal of vector quantization in image compression?

- Concept: Differential Evolution (DE) Algorithm
  - Why needed here: DE is used to optimize the single VQ index perturbation, and understanding its principles is essential for implementing the attack.
  - Quick check question: How does differential evolution differ from genetic algorithms in terms of maintaining population diversity?

- Concept: Principal Component Analysis (PCA)
  - Why needed here: PCA is used to sort codewords, and understanding its role in dimensionality reduction is important for the codeword sorting algorithm.
  - Quick check question: What is the primary purpose of principal component analysis in data processing?

## Architecture Onboarding

- Component map: VQ Encoder -> Attack Module -> VQ Decoder -> Classification Model
- Critical path: Image → VQ Encoder → Attack Module → VQ Decoder → Classification Model
- Design tradeoffs:
  - Attack success rate vs. image quality: A more aggressive attack may achieve a higher success rate but may also cause more noticeable changes to the image.
  - Convergence speed vs. solution quality: A faster convergence may lead to a suboptimal solution, while a slower convergence may find a better perturbation.
- Failure signatures:
  - Low attack success rate: The modified image is still classified correctly by the model.
  - High image distortion: The modified image is noticeably different from the original.
  - Slow convergence: The differential evolution algorithm takes too many iterations to find an effective perturbation.
- First 3 experiments:
  1. Implement the VQ encoder and decoder to ensure the basic compression and decompression functionality.
  2. Implement the codeword sorting algorithm to establish correlations between adjacent codewords.
  3. Implement the differential evolution algorithm to optimize the single VQ index perturbation.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does extending the codebook length by adding irrelevant codewords affect the attack success rate and confidence?
- Basis in paper: [explicit] The paper mentions extending the codebook length by adding irrelevant codewords to expand the solution space.
- Why unresolved: The paper states this as a future direction but does not provide experimental results.
- What evidence would resolve it: Experiments comparing attack performance with and without extended codebook length.

### Open Question 2
- Question: How effective is the diffusion model framework in improving VQ attack performance compared to the current differential evolution approach?
- Basis in paper: [explicit] The paper suggests exploring diffusion models as a future direction for VQ attacks.
- Why unresolved: The paper does not provide any experimental results using diffusion models.
- What evidence would resolve it: Experiments comparing attack performance using diffusion models versus the current method.

### Open Question 3
- Question: How does the proposed one-index attack method perform against other types of compressed image domains beyond vector quantization?
- Basis in paper: [explicit] The paper focuses on vector quantization and mentions the need to explore other compressed domains.
- Why unresolved: The paper only tests the method on vector quantization and does not provide results for other compression methods.
- What evidence would resolve it: Experiments testing the attack method on other compressed image domains like JPEG or DCT.

## Limitations

- The paper does not clearly specify the codebook generation method or size, which may significantly impact attack effectiveness and reproducibility.
- Differential evolution hyperparameters are not detailed, making it difficult to replicate the convergence behavior.
- The claim that modifying a single VQ index suffices for misclassification lacks evidence across different codebook sizes or image resolutions.

## Confidence

- **High Confidence**: The general framework of attacking VQ-compressed images using a single-index modification is sound and addresses a real-world vulnerability.
- **Medium Confidence**: The reported success rates (55.9% and 77.4% confidence) are plausible, but the lack of detailed hyperparameter and codebook information limits precise verification.
- **Low Confidence**: The claim that codeword sorting via PCA consistently improves convergence is weakly supported, as the paper does not provide quantitative ablation results specifically for this component.

## Next Checks

1. **Reproduce VQ compression**: Implement LBG or similar codebook generation and compression on CIFAR-10 and Fashion MNIST, verifying that the codebook size and index range match those assumed in the attack.

2. **Validate differential evolution parameters**: Systematically test and report the effect of varying DE hyperparameters (population size, mutation, crossover) on convergence speed and attack success.

3. **Assess codeword sorting impact**: Conduct an ablation study comparing attack success and convergence speed with and without PCA-based codeword sorting, using quantitative metrics.