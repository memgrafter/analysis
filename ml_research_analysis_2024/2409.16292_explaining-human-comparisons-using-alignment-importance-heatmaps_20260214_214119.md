---
ver: rpa2
title: Explaining Human Comparisons using Alignment-Importance Heatmaps
arxiv_id: '2409.16292'
source_url: https://arxiv.org/abs/2409.16292
tags:
- feature
- maps
- image
- human
- heatmaps
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces an approach for explaining human comparison
  processes using Alignment Importance Scores (AIS) derived from deep neural networks.
  The core idea is that feature maps relevant for aligning DNN representational geometry
  with human similarity judgments can be identified through a perturbation-based analysis,
  where the importance of each feature map is measured by how its removal affects
  the alignment.
---

# Explaining Human Comparisons using Alignment-Importance Heatmaps

## Quick Facts
- arXiv ID: 2409.16292
- Source URL: https://arxiv.org/abs/2409.16292
- Authors: Nhut Truong; Dario Pesenti; Uri Hasson
- Reference count: 12
- Key outcome: This paper introduces an approach for explaining human comparison processes using Alignment Importance Scores (AIS) derived from deep neural networks.

## Executive Summary
This paper introduces a method to explain human comparison processes by identifying which image regions are important for inter-image comparisons. The core innovation is Alignment Importance Scores (AIS), which measure how individual feature maps in deep neural networks contribute to aligning the model's representational geometry with human similarity judgments. The method generates heatmaps highlighting regions relevant for comparison, distinct from traditional saliency maps that focus on visual attention.

The approach is validated through improved prediction of human similarity judgments when using only high-scoring AIS feature maps, and through comparative analysis showing both correspondence and meaningful differences with saliency-based explanations. The method generalizes across multiple architectures (VGG, ResNet, EfficientNet) and training objectives (supervised and self-supervised), demonstrating its robustness and potential for interpreting comparison-driven reasoning.

## Method Summary
The method computes AIS by iteratively masking feature maps in the deepest convolutional layer of pre-trained models and measuring how this affects alignment between DNN and human similarity spaces. For each feature map, its AIS is calculated as the difference in Spearman correlation between the full model and the model with that feature map masked. The approach uses sequential feature selection to identify optimal feature map subsets that maximize prediction accuracy on held-out data. Heatmaps are generated by weighting feature maps according to their AIS values and upsampling to input resolution. The method is validated on 720 images from six categories using human similarity judgments.

## Key Results
- Prediction of out-of-sample human similarity judgments improves when using only higher-scoring AIS feature maps compared to using all features
- AIS heatmaps show both correspondence and meaningful differences with saliency maps from gaze-prediction models
- The method generalizes across architectures (VGG, ResNet, EfficientNet, etc.) and training objectives (supervised and self-supervised)
- AIS-based pruning consistently improves prediction of human judgments across different model families

## Why This Works (Mechanism)

### Mechanism 1
- Claim: AIS identifies feature maps whose removal most disrupts alignment between DNN and human similarity spaces.
- Mechanism: For each feature map, masking it changes the DNN embedding geometry; if the resulting geometry diverges from human similarity judgments, that feature map is deemed important.
- Core assumption: Human similarity judgments can be represented as a distance matrix over image pairs, and DNNs encode similar structure.
- Evidence anchors:
  - [abstract]: "The AIS reflects a feature-map's unique contribution to the alignment between Deep Neural Network's (DNN) representational geometry and that of humans."
  - [section 2.1]: "We define the baseline isomorphism between the two spaces as the correlation between these two vectors... Two possible outcomes: i) if the encoded information from the feature map is cognitively irrelevant... its removal could alter ModelDist in a way that improves the isomorphism... ii) if the encoded information... is cognitively-relevant... its removal will alter ModelDist in a way that decreases the isomorphism."
- Break condition: If human similarity judgments are not well approximated by DNN distances, AIS scores lose interpretability.

### Mechanism 2
- Claim: Heatmaps built from AIS-weighted feature maps highlight image regions that matter for comparison, not just saliency.
- Mechanism: Each feature map is upsampled to input resolution, weighted by its AIS, and combined; warmer colors indicate regions used in inter-image alignment.
- Core assumption: Feature maps capture localized visual information that can be mapped back to pixel space without loss of meaning.
- Evidence anchors:
  - [abstract]: "We then compute image-specific heatmaps that visually indicate the areas that correspond to feature-maps with higher AIS scores."
  - [section 1.2]: "These maps provide an intuitive explanation of which image areas are more important when it is compared to other images in a cohort."
  - [section 2.3]: "Image-level heatmaps are then computed as follows... feature maps for an image are weighted-averaged according to their corresponding AIS to create a heatmap."
- Break condition: If feature map semantics are not spatially coherent, the heatmap will misrepresent important regions.

### Mechanism 3
- Claim: Pruning based on AIS improves out-of-sample prediction of human similarity judgments compared to using all features.
- Mechanism: Feature maps are ranked by AIS; adding them sequentially to a subset maximizes alignment with human judgments on a training set, and this subset generalizes better to held-out data.
- Core assumption: Not all features contribute equally to modeling human similarity; removing irrelevant ones improves generalization.
- Evidence anchors:
  - [abstract]: "We first validate the AIS by showing that prediction of out-of-sample human similarity judgments is improved when constructing representations using only higher-scoring AIS feature maps identified from a training set."
  - [section 2.2]: "The AIS of feature map k is defined... AISk = ρ(Zu, Hu) − ρ(Z (¬k) u , Hu)... we recompute the 2OI... using that subset of feature maps alone... ρ(Z (S*) u , Hu) surpasses ρ(Zu, Hu), indicating superior prediction compared to the baseline using a subset of feature maps."
  - [section 3.1]: "Paired T-tests indicated that in all 12 cases, predictions from Full features were less accurate than those from features learned via pruning (p-values < 0.01)."
- Break condition: If pruning removes features that are indirectly important (via interactions), prediction may degrade.

## Foundational Learning

- Concept: Representational similarity analysis (RSA)
  - Why needed here: The core method compares DNN and human similarity spaces using distance matrices and correlations.
  - Quick check question: What does a high Spearman correlation between human and DNN distance matrices indicate about their representational geometry?

- Concept: Feature map importance via perturbation
  - Why needed here: AIS is defined by measuring the effect of removing each feature map on model-human alignment.
  - Quick check question: How does masking a single feature map affect the DNN's image embeddings and downstream similarity predictions?

- Concept: Heatmap generation from convolutional features
  - Why needed here: AIS scores are mapped back to image space to create interpretable visualizations.
  - Quick check question: Why must negative AIS values be set to zero before generating the heatmap?

## Architecture Onboarding

- Component map: Pre-trained CNN -> AIS computation loop -> Pruned feature set -> AIS-weighted heatmaps -> Comparative analysis with saliency maps
- Critical path:
  1. Compute baseline DNN-human distance correlation
  2. For each feature map: mask it, recompute distances, measure correlation drop
  3. Rank feature maps by AIS, select top subset that maximizes validation correlation
  4. Generate heatmap for each image by weighting feature maps with AIS
- Design tradeoffs:
  - Using fully connected layers (VGG) vs. global pooling (ResNet, EfficientNet) changes how feature importance is aggregated
  - ImageNet vs. Ecoset training affects AIS distributions and heatmap consistency
  - Heatmap thresholding level affects precision-recall trade-off with saliency maps
- Failure signatures:
  - Low correlation between DNN and human distance matrices → AIS scores become meaningless
  - High entropy in model softmax outputs for an image → heatmap instability across training regimes
  - Heatmaps that don't align with salient regions but also don't match comparison logic → possible feature-map spatial misalignment
- First 3 experiments:
  1. Verify AIS ranking reproduces pruning gains on a small held-out set
  2. Compare heatmaps from VGG vs. ResNet on the same image to observe architectural differences
  3. Test whether thresholding saliency maps at high percentiles improves precision for AIS prediction

## Open Questions the Paper Calls Out
The paper does not explicitly call out open questions, but several important questions emerge from the methodology:

- How do different pruning strategies (e.g., iterative vs. one-shot) affect the identification of alignment-important feature maps?
- How does the choice of distance metric (e.g., Euclidean, cosine) for computing representational geometry affect the alignment importance scores and resulting heatmaps?
- How do the alignment importance heatmaps generalize to other comparison tasks beyond similarity judgments, such as categorization or anomaly detection?

## Limitations
- The method's reliance on human similarity judgments as ground truth may limit generalizability across different comparison tasks
- The perturbation-based AIS computation assumes that masking individual feature maps captures their independent contribution, potentially missing feature interactions
- Heatmap visualization assumes that feature map semantics are spatially coherent and can be meaningfully mapped back to pixel space

## Confidence
- AIS-based pruning improves prediction: High
- Heatmaps reveal comparison-relevant regions: Medium
- Architecture generalization: Medium

## Next Checks
1. Conduct ablation studies to quantify the impact of feature map interactions on AIS scores by comparing sequential vs. simultaneous masking approaches
2. Test AIS heatmaps against eye-tracking data to verify their correspondence with actual human visual attention during comparison tasks
3. Evaluate the method's performance on cross-category comparisons where visual similarity is less straightforward to establish