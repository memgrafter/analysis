---
ver: rpa2
title: Free Energy in a Circumplex Model of Emotion
arxiv_id: '2407.02474'
source_url: https://arxiv.org/abs/2407.02474
tags:
- agent
- object
- valence
- emotional
- arousal
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: 'This paper presents a novel framework for modeling emotions in
  artificial agents using the Circumplex Model, which maps emotions along two dimensions:
  valence and arousal. The authors derive these dimensions from an agent''s expected
  free energy in active inference, where arousal is linked to the entropy of posterior
  beliefs and valence is linked to utility minus expected utility.'
---

# Free Energy in a Circumplex Model of Emotion

## Quick Facts
- arXiv ID: 2407.02474
- Source URL: https://arxiv.org/abs/2407.02474
- Reference count: 20
- Models emotions in artificial agents using Circumplex Model derived from expected free energy in active inference

## Executive Summary
This paper presents a novel framework for modeling emotions in artificial agents using the Circumplex Model, which maps emotions along two dimensions: valence and arousal. The authors derive these dimensions from an agent's expected free energy in active inference, where arousal is linked to the entropy of posterior beliefs and valence is linked to utility minus expected utility. Simulation results show that agents exhibit commonsense emotional responses during search tasks, including anger when precise priors are violated, relaxation upon finding objects, and resignation when objects are absent.

## Method Summary
The method employs active inference principles where agents minimize expected free energy through policy selection. Emotional states are computed from the generative model's beliefs: valence emerges as the difference between observed utility and expected utility, while arousal is quantified by the entropy of posterior beliefs. These Cartesian coordinates are transformed to polar coordinates (radius for intensity, angle for emotional type) to create the circumplex representation. The framework is tested through simulations of search tasks in a graph environment with varying prior beliefs about object location and presence.

## Key Results
- Agents exhibit appropriate emotional responses matching commonsense expectations during search tasks
- Emotional regulation success depends critically on accurate world models, with rigid priors potentially preventing optimal emotional states
- The model captures the distinction between factive emotions (based on beliefs about states of affairs) and epistemic emotions (based on uncertain beliefs)

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Valence is derived from the difference between observed utility and expected utility in active inference.
- Mechanism: The model computes valence as U - EU where utility is the log probability of observations given preferences, and expected utility is the expectation over future observations under the agent's beliefs. This creates a prediction error signal that tracks positive and negative experiences.
- Core assumption: Emotional valence emerges from comparing actual outcomes to expected outcomes in terms of utility.
- Evidence anchors:
  - [abstract] "valence is linked to utility minus expected utility"
  - [section 2.2] "V alence (V ) = U tility (U ) − Expected U tility (EU)"
  - [corpus] Weak evidence - no corpus papers directly address this specific formulation
- Break condition: If the agent's preferences (C) are uniform or if the likelihood model is misspecified, the valence signal becomes uninformative.

### Mechanism 2
- Claim: Arousal is quantified by the entropy of posterior beliefs in active inference.
- Mechanism: The model uses H[Q(s|o)] as an arousal measure, where higher entropy indicates greater uncertainty in the agent's beliefs about hidden states given observations.
- Core assumption: Uncertainty in beliefs directly corresponds to emotional arousal, independent of valence.
- Evidence anchors:
  - [abstract] "arousal is linked to the entropy of posterior beliefs"
  - [section 2.3] "arousal (A) becomes: A = EQ(s|o) [ − log Q(s|o) ] = H[Q(s|o)]"
  - [section 2.3] "Empirical evidence links arousal to uncertainty vis-a-vis 'increases in amygdala activity'"
- Break condition: If the agent's model is too precise or if observations are too informative, arousal may remain near zero even during emotionally significant events.

### Mechanism 3
- Claim: The circumplex model is realized through polar transformation of valence-arousal coordinates.
- Mechanism: The Cartesian valence-arousal values are transformed to polar coordinates (r, θ) where r represents emotional intensity and θ maps to specific emotions on the circumplex.
- Core assumption: The circumplex model's emotional states can be parameterized by distance from neutral (r) and angular position (θ).
- Evidence anchors:
  - [abstract] "mapping emotions into a two-dimensional spectrum of valence and arousal"
  - [section 2.4] "r = radius = pV 2 + A2, θ = angle = tan−1( AV )"
  - [section 2.4] "The co-occurrence of valence and arousal results in the varying degrees on the circle with different emotion labels"
- Break condition: If either valence or arousal is zero, the angular position becomes undefined, requiring special handling in implementation.

## Foundational Learning

- Concept: Active Inference and Free Energy Minimization
  - Why needed here: The entire emotional framework is built on active inference principles where agents minimize free energy to maintain coherence between beliefs and observations
  - Quick check question: What are the two main terms that compose free energy in active inference, and how do they relate to prediction and complexity?

- Concept: Bayesian Inference and Posterior Entropy
  - Why needed here: Arousal is directly computed from posterior entropy, requiring understanding of how belief uncertainty is quantified in Bayesian frameworks
  - Quick check question: How does posterior entropy change when new observations strongly confirm existing beliefs versus when they contradict them?

- Concept: Utility Functions and Expected Utility
  - Why needed here: Valence computation requires understanding how utility functions define preferences and how expected utility aggregates these preferences over future outcomes
  - Quick check question: If an agent's preference distribution C assigns equal probability to all outcomes, what happens to the valence signal?

## Architecture Onboarding

- Component map: Generative model (factor graph with state factors for agent location and object location, observation modalities for location sensing and object visibility) -> Policy selection (action policies based on expected free energy minimization balancing information gain and utility) -> Action execution -> Observation -> Belief update -> Free energy computation -> Emotional state derivation -> Behavior modulation

- Critical path: Generative model → policy selection → action execution → observation → belief update → free energy computation → emotional state derivation → behavior modulation

- Design tradeoffs: The model sacrifices computational complexity (no hierarchical structure) for interpretability and direct mapping to psychological constructs. This enables clear emotional state attribution but may miss nuanced emotional dynamics captured by hierarchical models.

- Failure signatures:
  - Valence stuck near zero indicates uniform preferences or uninformative observations
  - Arousal stuck near zero indicates overly precise models or deterministic environments
  - Emotional trajectories that don't match expected patterns suggest incorrect prior specifications or model misspecification

- First 3 experiments:
  1. Run Scenario 2 (present object, correct prior) and verify the agent remains in a calm state throughout
  2. Run Scenario 3 (present object, incorrect prior) and confirm anger upon prior violation followed by relaxation upon finding object
  3. Run Scenario 5 (absent object, "definitely here" prior) and observe cycling between anger and depression without acceptance

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Does the proposed valence-arousal mapping from expected free energy generalize to more complex multi-agent environments and tasks?
- Basis in paper: [explicit] The authors suggest future work will explore emotions among simulated agents in social contexts
- Why unresolved: The paper only tests simple search tasks with a single agent
- What evidence would resolve it: Demonstrating the valence-arousal mapping produces plausible emotional states in multi-agent scenarios with social interactions

### Open Question 2
- Question: How does emotional intensity (distance from origin in the circumplex) relate to cognitive processes like event segmentation and episodic memory encoding?
- Basis in paper: [explicit] The authors mention this as a future research direction, citing that intense emotional experiences are more likely to be encoded and recalled
- Why unresolved: The paper does not investigate the relationship between emotional intensity and memory processes
- What evidence would resolve it: Experimental studies showing correlations between emotional intensity in the model and memory performance

### Open Question 3
- Question: What are the temporal dynamics of emotional states in the model, and how do they relate to the distinction between factive and epistemic emotions?
- Basis in paper: [explicit] The authors identify this as future work, referencing the distinction between beliefs about states of affairs versus uncertain beliefs
- Why unresolved: The paper does not explore temporal aspects of emotional state attribution
- What evidence would resolve it: Demonstrating how the model can distinguish between different types of emotions based on their temporal evolution

## Limitations

- The circumplex model's two-dimensional representation may not capture the full complexity of emotional states observed in biological agents
- The framework requires accurate world models for effective emotional regulation, which may not always be available in real-world scenarios
- The model focuses on individual agents and does not address the complexity of emotional dynamics in multi-agent or social contexts

## Confidence

- Confidence in the core mechanism linking valence to utility prediction error is **High**, as this follows directly from active inference principles and is mathematically well-specified
- Confidence in the arousal-entropy relationship is **Medium**, as while theoretically sound, the direct mapping of posterior uncertainty to emotional arousal requires empirical validation in real-world scenarios
- Confidence in the circumplex transformation mechanism is **High** given its straightforward mathematical implementation

## Next Checks

1. **Empirical Validation**: Test the model's emotional predictions against human subject data in analogous search tasks to verify that the valence-arousal trajectories match observed emotional patterns.

2. **Robustness Testing**: Systematically vary prior precision and preference distributions to identify conditions under which the emotional signals become uninformative or misleading.

3. **Hierarchical Extension**: Implement a hierarchical version of the model to assess whether adding temporal or contextual layers improves emotional state discrimination and predictive accuracy.