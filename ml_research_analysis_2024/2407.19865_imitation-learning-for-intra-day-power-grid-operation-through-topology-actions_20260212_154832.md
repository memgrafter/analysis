---
ver: rpa2
title: Imitation Learning for Intra-Day Power Grid Operation through Topology Actions
arxiv_id: '2407.19865'
source_url: https://arxiv.org/abs/2407.19865
tags:
- agent
- agents
- power
- grid
- learning
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper investigates the use of imitation learning for intra-day
  power grid operation through topology control actions. Two rule-based expert agents,
  a greedy agent and an N-1 agent, are used to generate state-action pairs for training
  a fully-connected neural network (FCNN).
---

# Imitation Learning for Intra-Day Power Grid Operation through Topology Actions

## Quick Facts
- arXiv ID: 2407.19865
- Source URL: https://arxiv.org/abs/2407.19865
- Authors: Matthijs de Jong; Jan Viebahn; Yuliya Shapovalova
- Reference count: 22
- Key outcome: Imitation learning can develop fast, high-performing power grid agents, with hybrid approaches matching expert performance at lower computational cost

## Executive Summary
This paper investigates imitation learning for intra-day power grid operation through topology control actions. The authors train a fully-connected neural network on state-action pairs generated by two rule-based expert agents (greedy and N-1) and evaluate it as both a classifier and power system agent. While classification accuracy is limited by class imbalance and overlap, the learned agents perform well in grid control tasks. Hybrid agents that incorporate minimal simulation-based verification achieve expert-level performance with significantly reduced computational cost, demonstrating the potential of imitation learning for practical power grid applications.

## Method Summary
The authors generate state-action pairs from two rule-based expert agents operating on the IEEE 14-bus system under various network regimes. A fully-connected neural network (FCNN) is trained on this data using binary cross-entropy loss with Adam optimization. The model outputs are converted to valid switch actions through post-processing that ensures feasibility. Hybrid agents are implemented by combining the ML predictions with simulation-based verification, falling back to expert behavior only when risk thresholds are exceeded. The agents are evaluated on their ability to complete operational days without violating grid constraints.

## Key Results
- The FCNN achieves approximately 78.6% classification accuracy on validation data
- As power system agents, ML agents perform slightly worse than expert agents but demonstrate competitive behavior
- Hybrid agents match expert agent performance while requiring significantly fewer simulations
- Action post-processing improves classification accuracy by approximately 2.4 percentage points

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Imitation learning enables rapid deployment of high-performing power grid agents by leveraging expert rule-based behavior without requiring online interaction with the grid.
- Mechanism: The FCNN is trained offline on state-action pairs generated by rule-based expert agents. This allows the learned agent to directly imitate expert decision-making patterns without the need for expensive simulation-based training.
- Core assumption: Expert-generated data is sufficiently diverse and representative to cover the operational state space encountered during deployment.
- Evidence anchors:
  - [abstract] "We train a fully-connected neural network (FCNN) on expert state-action pairs and evaluate it in two ways."
  - [section 5.1] "We create a dataset with the data from the N-1 agent (from the full-network regime) and data from the Greedy agent in the N-1 networks"
- Break condition: If expert agents cannot generate diverse enough state-action pairs, the FCNN will not generalize to unseen grid conditions.

### Mechanism 2
- Claim: Hybrid agents that combine ML predictions with minimal simulation-based verification achieve expert-level performance with significantly lower computational cost.
- Mechanism: The Verify+N-1 agent uses the FCNN prediction as a starting point but falls back to expert agent simulation only when the predicted action exceeds risk thresholds. This selective use of expensive simulation reduces computational overhead while maintaining safety guarantees.
- Core assumption: The ML model can reliably predict safe actions for the majority of grid states, requiring simulation verification only for risky scenarios.
- Evidence anchors:
  - [abstract] "hybrid agents, which incorporate minimal additional simulations, match expert agents' performance with significantly lower computational cost."
  - [section 5.4] "In the full-topology regime, the hybrid agents approach the performance of the N-1 agent"
- Break condition: If the ML model frequently predicts unsafe actions, the computational savings from reduced simulation will be negated by frequent fallback to expert verification.

### Mechanism 3
- Claim: Post-processing of ML predictions to nearest valid actions significantly improves classification accuracy by ensuring feasibility of predicted actions.
- Mechanism: The FCNN outputs continuous values that are converted to binary switch decisions, but not all binary vectors correspond to valid actions. The post-processing step maps these predictions to the nearest valid action in the action space.
- Core assumption: The valid action space is sufficiently connected that every invalid prediction can be mapped to a nearby valid action without significant loss of optimality.
- Evidence anchors:
  - [section 5.2] "We apply a postprocessing step where the model prediction p is replaced by the valid switch-action nearest to p."
  - [section 5.4] "The action postprocessing step had a sizeable effect on accuracy: the validation accuracy without this step decreased from 78.6% ± 0.6 to 76.2% ± 0.7"
- Break condition: If the action space contains isolated valid actions, post-processing may map predictions to suboptimal actions far from the true expert action.

## Foundational Learning

- Concept: Multi-label binary classification for action prediction
  - Why needed here: Each substation can have multiple objects that need switching, requiring simultaneous prediction of multiple binary decisions
  - Quick check question: How does the model handle cases where no objects need switching versus cases where multiple objects need switching simultaneously?

- Concept: Label weighting for imbalanced classification
  - Why needed here: Only a small fraction of objects typically switch in each action, creating extreme class imbalance that would cause predictions to collapse to zeros
  - Quick check question: What happens to the loss function when we assign higher weights to positive labels versus negative labels?

- Concept: Post-processing for action feasibility
  - Why needed here: Not all binary output vectors correspond to valid grid actions due to constraints like preventing isolated generators or loads
  - Quick check question: How do we efficiently find the nearest valid action to an arbitrary binary prediction vector?

## Architecture Onboarding

- Component map:
  Data generation pipeline (Grid2Op environment + expert agents) -> Feature engineering module (normalization, flattening, concatenation) -> FCNN model (input layer → hidden layers → sigmoid output) -> Post-processing module (validity checking and nearest neighbor search) -> Hybrid agent wrapper (ML prediction + simulation verification) -> Evaluation framework (Grid2Op environment + performance metrics)

- Critical path:
  Data generation → Feature engineering → Model training → Post-processing → Hybrid agent deployment → Performance evaluation

- Design tradeoffs:
  - Model complexity vs training speed: Deeper networks may capture more complex patterns but require more training data and computation
  - Post-processing strictness vs optimality: More stringent validity checks ensure feasible actions but may map predictions further from expert actions
  - Simulation frequency vs computational cost: More frequent verification improves safety but increases inference time

- Failure signatures:
  - Accuracy plateaus around 80% despite hyperparameter tuning → likely class imbalance or overlap issues
  - Hybrid agent performance worse than expert agent → ML model may be systematically predicting unsafe actions
  - Inference time close to expert agent → post-processing or verification steps may be too computationally expensive

- First 3 experiments:
  1. Train baseline FCNN with different hidden layer sizes and learning rates to establish performance baseline
  2. Implement and test post-processing step on validation set to measure accuracy improvement
  3. Compare hybrid agent variants (Verify vs Verify+Greedy vs Verify+N-1) on full-network regime to determine optimal verification strategy

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can class imbalance and overlap be effectively mitigated in imitation learning for power grid topology control?
- Basis in paper: [explicit] The paper explicitly identifies class imbalance and overlap as limitations to classification accuracy.
- Why unresolved: The paper introduces label weighting to address imbalance but finds it insufficient, and notes overlap persists despite this.
- What evidence would resolve it: Experiments showing improved accuracy with alternative methods like data augmentation, class-balanced sampling, or advanced neural network architectures designed for imbalanced data.

### Open Question 2
- Question: What is the optimal balance between simulation-based verification and direct model action execution for hybrid agents in power grid control?
- Basis in paper: [explicit] The paper shows hybrid agents outperform both pure ML and rule-based agents, suggesting a trade-off exists.
- Why unresolved: The paper does not explore the full parameter space of hybrid approaches or provide a theoretical framework for optimal hybrid design.
- What evidence would resolve it: Comparative studies varying the frequency and conditions of simulation-based verification across diverse grid scenarios.

### Open Question 3
- Question: How do imitation learning methods compare to reinforcement learning methods for power grid topology control in terms of long-term performance and adaptability?
- Basis in paper: [explicit] The paper focuses on imitation learning and suggests future comparison with RL methods.
- Why unresolved: The paper only evaluates imitation learning agents and does not benchmark against RL approaches.
- What evidence would resolve it: Head-to-head evaluations of IL and RL agents across multiple grid environments with varying complexity and dynamic conditions.

## Limitations
- Experiments conducted on single test system (IEEE 14-bus) limiting generalizability to larger grids
- Expert agents are rule-based rather than optimal, potentially limiting the ceiling for imitation learning performance
- Significant class imbalance and overlap in action space constrain classification accuracy to around 80%

## Confidence

- **High Confidence**: The hybrid agent methodology and computational efficiency improvements are well-supported by experimental results across multiple network regimes.
- **Medium Confidence**: The classification accuracy results are valid but limited by dataset characteristics (class imbalance) that are clearly acknowledged.
- **Medium Confidence**: The performance comparison between ML agents and expert agents is valid for the specific test system but may not generalize to larger grids.

## Next Checks

1. **Cross-system validation**: Test the FCNN and hybrid agents on multiple grid sizes (e.g., 39-bus, 118-bus) to assess scalability and identify potential failure modes in larger systems.

2. **Robustness testing under extreme conditions**: Evaluate agent performance during cascading failures and multiple concurrent contingencies to verify safety guarantees in worst-case scenarios.

3. **Ablation study on post-processing**: Systematically analyze the impact of different post-processing strategies (distance metrics, feasibility constraints) on both accuracy and actual grid performance to optimize the trade-off between feasibility and optimality.