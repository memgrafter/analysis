---
ver: rpa2
title: Equivariant Denoisers for Image Restoration
arxiv_id: '2412.05343'
source_url: https://arxiv.org/abs/2412.05343
tags:
- ered
- equivariant
- image
- denoiser
- denoising
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This paper proposes Equivariant Regularization by Denoising (ERED),\
  \ a unified framework that incorporates invariance properties into Plug-and-Play\
  \ image restoration by extending the Regularization by Denoising (RED) method with\
  \ \u03C0-equivariant denoisers and stochastic optimization. The method generalizes\
  \ existing approaches including equivariant PnP and stochastic versions of PnP."
---

# Equivariant Denoisers for Image Restoration

## Quick Facts
- arXiv ID: 2412.05343
- Source URL: https://arxiv.org/abs/2412.05343
- Authors: Marien Renaud; Arthur Leclaire; Nicolas Papadakis
- Reference count: 40
- Key outcome: Modest quantitative improvements (+0.3 dB) over standard RED with flip and rotation transformations showing the most benefit

## Executive Summary
This paper proposes Equivariant Regularization by Denoising (ERED), a unified framework that incorporates invariance properties into Plug-and-Play image restoration by extending the Regularization by Denoising (RED) method with π-equivariant denoisers and stochastic optimization. The method generalizes existing approaches including equivariant PnP and stochastic versions of PnP. Theoretical convergence analysis is provided, showing that ERED converges to critical points of the equivariant objective function, and when the prior is π-equivariant, these critical points converge to those of the original problem as the denoiser parameter σ approaches zero. Numerical experiments on image deblurring with various blur kernels demonstrate modest quantitative improvements (approximately +0.3 dB) over standard RED, with flip and rotation transformations showing the most benefit. However, the practical advantage of equivariance appears limited compared to standard methods.

## Method Summary
ERED extends RED by incorporating π-equivariant denoisers, defined as $\tilde{D}_\sigma(x) = E_{G \sim \pi}[J_T^G(x)D_\sigma(G(x))]$, where G represents a group of transformations and π is the probability measure on G. The method uses stochastic optimization where transformations are sampled during iterations, leading to the update rule: $x_{k+1} = x_k - \delta\nabla f(x_k) - \delta\lambda J_T^G(x_k)(G(x_k) - D_\sigma(G(x_k)))$. The theoretical analysis shows convergence to critical points of the equivariant objective function, with asymptotic convergence to the original problem's critical points when the prior is π-equivariant and σ → 0. The framework generalizes both equivariant PnP and stochastic PnP approaches, providing a unified treatment of these methods.

## Key Results
- ERED achieves approximately +0.3 dB improvement over standard RED in PSNR for image deblurring tasks
- Flip and rotation transformations show the most significant benefits among tested transformations
- The method converges to critical points of the equivariant objective function under theoretical assumptions
- As σ → 0 and when the prior is π-equivariant, critical points converge to those of the original problem

## Why This Works (Mechanism)
The method leverages group invariance properties by incorporating π-equivariant denoisers that average over transformations from a group G. This averaging operation creates a regularization term that respects the symmetries of the problem, potentially improving robustness to certain types of image transformations. The stochastic optimization approach allows handling of continuous transformation groups by sampling transformations at each iteration, making the method computationally tractable while maintaining theoretical convergence guarantees.

## Foundational Learning
- **Group invariance in image processing**: Why needed - To understand how symmetry properties can be leveraged for image restoration. Quick check - Verify that the chosen transformation group G preserves the structure of the image restoration problem.
- **RED framework**: Why needed - ERED builds directly on RED's regularization approach. Quick check - Confirm understanding of how RED uses denoisers as implicit priors through the divergence term.
- **Jacobian transformations under group actions**: Why needed - Critical for computing the equivariant denoiser and its derivatives. Quick check - Verify correct implementation of $J_T^G(x)$ for chosen transformations.
- **Stochastic optimization convergence**: Why needed - ERED uses stochastic sampling of transformations. Quick check - Ensure proper handling of Monte Carlo estimation in the equivariant denoiser computation.

## Architecture Onboarding
- **Component map**: Image → Blur Kernel → Noisy Observation → ERED iterations → Denoiser (GS-DRUNet/DRUNet/DnCNN) → Transformation Sampling (π) → Output Restored Image
- **Critical path**: Forward model application → ERED gradient update with π-equivariant denoiser → Denoiser evaluation under sampled transformation → Image update
- **Design tradeoffs**: The choice between discrete (flips, rotations) and continuous (subpixel rotations, translations) transformation groups involves a tradeoff between computational cost and invariance coverage. Discrete groups are cheaper but may miss important invariances, while continuous groups require more samples but can capture finer-grained symmetries.
- **Failure signatures**: Poor convergence or performance degradation may indicate improper parameter tuning (step-size, regularization weight, or denoising parameter), insufficient Monte Carlo samples for continuous transformations, or inappropriate transformation choices for the specific degradation type.
- **3 first experiments**: 1) Implement basic ERED with flip transformations and GS-DRUNet on a simple deblurring problem, 2) Compare convergence behavior with standard RED on the same problem, 3) Test different transformation sets (rotations vs flips) to identify which provides the most benefit for the chosen degradation.

## Open Questions the Paper Calls Out
**Open Question 1**: Under what conditions does the practical improvement from equivariance (ERED) become significant compared to standard RED? The paper observes only modest improvements (+0.3 dB) in quantitative metrics and discusses that the practical benefit of equivariance appears limited compared to standard methods. Systematic experiments varying factors like degradation type, noise levels, kernel characteristics, and image content are needed to identify regimes where equivariant methods show substantial improvements.

**Open Question 2**: How does the choice of transformation set G affect the convergence properties of ERED beyond the theoretical guarantees? The paper notes that "the choice of the transformation impacts the restoration quality" and that "flips and rotations are beneficial" but doesn't provide theoretical analysis of this impact. Convergence rate analysis comparing different transformation sets and empirical studies showing how convergence speed varies with transformation choice would help address this question.

**Open Question 3**: Does the Lipschitz constant of the equivariant denoiser $\tilde{D}_\sigma$ provide useful bounds for ERED convergence like it does for standard PnP methods? The paper states "no clue indicates that this property still holds for stochastic PnP algorithms" and develops alternative convergence analysis that doesn't rely on Lipschitz bounds. Empirical studies demonstrating whether Lipschitz bounds on $\tilde{D}_\sigma$ predict convergence behavior, or theoretical work establishing conditions under which such bounds are useful for ERED, would help resolve this question.

**Open Question 4**: What is the relationship between the noise level σ of the denoiser and the approximation error between s and $s_{\pi\sigma}$? Proposition 4 establishes that $\|s - s_{\pi\sigma}\|_{∞,K} \to 0$ when σ → 0 under certain conditions, but doesn't quantify the rate of convergence or explore practical implications. Quantitative analysis of $\|s - s_{\pi\sigma}\|_{∞,K}$ as a function of σ for different priors and transformation sets would provide practical guidance on choosing σ.

## Limitations
- The practical benefit of equivariance is limited, with only modest improvements (+0.3 dB) over standard RED
- The theoretical convergence guarantees rely on assumptions that may not hold in practice, particularly regarding the invertibility of the Jacobian in stochastic settings
- Implementation details for π-equivariant denoisers with continuous transformation groups are not fully specified
- The paper does not explore the impact of different transformation groups or denoiser architectures on performance

## Confidence
- Theoretical framework and convergence analysis: High
- Quantitative improvement over RED: Medium
- Practical advantages of equivariance: Low

## Next Checks
1. Reproduce the deblurring experiments on CBSD68 with multiple denoisers (GS-DRUNet, DRUNet, DnCNN) and compare PSNR/SSIM against standard RED and other state-of-the-art methods.
2. Test ERED with different transformation groups (e.g., translations, subpixel rotations) and evaluate whether the performance gains generalize beyond flips and rotations.
3. Conduct ablation studies to isolate the impact of equivariance by comparing ERED with a stochastic (non-equivariant) variant of RED using the same Monte Carlo sampling strategy.