---
ver: rpa2
title: Long Range Propagation on Continuous-Time Dynamic Graphs
arxiv_id: '2406.02740'
source_url: https://arxiv.org/abs/2406.02740
tags:
- graph
- information
- node
- time
- propagation
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the problem of long-range information propagation
  in Continuous-Time Dynamic Graphs (C-TDGs), where most existing methods struggle
  to correlate information that is spatially or temporally distant from the current
  event. The authors propose CTAN (Continuous-Time Graph Anti-Symmetric Network),
  a framework based on stable and non-dissipative ordinary differential equations
  (ODEs) that enables efficient propagation of information in C-TDGs.
---

# Long Range Propagation on Continuous-Time Dynamic Graphs

## Quick Facts
- arXiv ID: 2406.02740
- Source URL: https://arxiv.org/abs/2406.02740
- Authors: Alessio Gravina; Giulio Lovisotto; Claudio Gallicchio; Davide Bacciu; Claas Grohnfeldt
- Reference count: 39
- Primary result: CTAN achieves state-of-the-art performance on long-range continuous-time dynamic graph tasks

## Executive Summary
This paper addresses the critical challenge of long-range information propagation in Continuous-Time Dynamic Graphs (C-TDGs), where existing methods struggle to correlate information across spatial and temporal distances. The authors propose CTAN (Continuous-Time Graph Anti-Symmetric Network), a novel framework built on stable, non-dissipative ordinary differential equations that enables efficient propagation of information in C-TDGs. By leveraging anti-symmetric weight matrices and carefully designed initial condition functions, CTAN preserves long-term dependencies and outperforms state-of-the-art dynamic graph networks on both synthetic benchmarks and real-world datasets.

## Method Summary
CTAN is built on stable, non-dissipative ODEs where node states evolve according to an anti-symmetric weight matrix Wt and an aggregation function Φ. The key innovation is using anti-symmetric matrices to ensure purely imaginary eigenvalues in the Jacobian, preventing information dissipation over space. The initial condition function ψ controls non-dissipativeness over time by including past node representations. The model uses forward Euler discretization for practical implementation and is evaluated through grid search optimization with binary cross-entropy loss.

## Key Results
- CTAN outperforms state-of-the-art DGNs on synthetic long-range sequence classification tasks, even with graphs of length 20
- On PascalVOC-SP, CTAN achieves significant F1-score improvements, especially when limited to local neighborhoods
- CTAN ranks first across real-world link prediction datasets (Wikipedia, Reddit, LastFM, MOOC), demonstrating superior long-range dependency capture

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Anti-symmetric weight matrices ensure non-dissipative propagation over space in CTAN.
- Mechanism: The Jacobian of the ODE has purely imaginary eigenvalues when Wt is anti-symmetric, leading to constant sensitivity of the solution to initial conditions and preserving long-range information flow.
- Core assumption: The aggregation function Φ does not depend on hu(t).
- Evidence anchors:
  - [abstract]: "CTAN leverages anti-symmetric weight matrices to ensure stability and non-dissipativeness"
  - [section]: "Proposition 3.3... the ODE in Eq. 4 is stable and non-dissipative over space and time if the resulting Jacobian matrix has purely imaginary eigenvalues"
- Break condition: If Φ depends on hu(t) or Wt is not anti-symmetric, eigenvalues may have non-zero real parts, causing dissipation.

### Mechanism 2
- Claim: Non-dissipative propagation over time preserves historical node context indefinitely.
- Mechanism: When ψ includes past node representations (e.g., addition or concatenation with hu(t)), the ODE maintains information from past events through the initial condition function.
- Core assumption: The function ψ must include hu(t) in its formulation.
- Evidence anchors:
  - [abstract]: "non-dissipativeness... allowing for the preservation of long-term dependencies in the information flow"
  - [section]: "Proposition A.1... if the function ψ is implemented as one of the following functions: addition, concatenation, or composition of tanh and concatenation"
- Break condition: If ψ = xu(t) only, historical information is always discarded between events, causing dissipation.

### Mechanism 3
- Claim: Truncated non-dissipative propagation scales long-range information spread without increasing layers.
- Mechanism: Even with limited discretization steps (small te), information can propagate to distant nodes through intermediate nodes that capture and retain information, enabling scalable long-range propagation.
- Core assumption: Future events can occur at intermediate nodes to relay information further.
- Evidence anchors:
  - [section]: "even with a limited number of discretization steps, the non-dissipative behavior enables scaling the single event propagation to cover a larger portion of the C-TDG"
- Break condition: If no future events occur at intermediate nodes, information cannot propagate beyond the truncation limit.

## Foundational Learning

- Concept: Ordinary Differential Equations (ODEs) and their discretization
  - Why needed here: CTAN is built on ODEs, and understanding discretization methods (like forward Euler) is crucial for grasping how node states evolve over time.
  - Quick check question: What is the trade-off between step size ϵ and stability when using forward Euler's method for ODE discretization?

- Concept: Graph Neural Networks (GNNs) and message passing
  - Why needed here: CTAN extends GNNs to continuous-time dynamic graphs, so understanding static GNN architectures and aggregation functions is essential.
  - Quick check question: How does the aggregation function Φ in CTAN differ from standard GNN message passing?

- Concept: Eigenvalues and stability of dynamical systems
  - Why needed here: The stability and non-dissipativeness of CTAN rely on the eigenvalues of the Jacobian matrix, particularly being purely imaginary.
  - Quick check question: What does it mean for a system to be non-dissipative in the context of ODEs and information propagation?

## Architecture Onboarding

- Component map:
  - Event stream → Node state initialization (ψ) → ODE update (Wt, Φ) → Discretization → Output prediction

- Critical path: Event stream → Node state initialization (ψ) → ODE update (Wt, Φ) → Discretization → Output prediction

- Design tradeoffs:
  - Larger step size ϵ enables longer-range propagation but may reduce stability
  - Including more past information in ψ improves non-dissipativeness but may increase complexity
  - Using task-specific aggregation functions (Φ) can improve performance but requires domain knowledge

- Failure signatures:
  - Poor long-range performance: Check if Wt is anti-symmetric and if ψ includes past node representations
  - Numerical instability: Reduce step size ϵ or increase γ (stability parameter)
  - Overfitting: Increase dropout or reduce model capacity

- First 3 experiments:
  1. Test CTAN on the sequence classification task (Section 4.1.1) with increasing graph lengths to verify long-range propagation
  2. Compare CTAN performance with and without anti-symmetric weight matrices on the temporal PascalVOC task
  3. Evaluate CTAN's ability to preserve information over time by testing with different ψ functions (addition vs. concatenation) on a simple temporal graph task

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does CTAN's performance scale with increasing graph sizes in real-world datasets, and what are the theoretical limits of its long-range propagation capabilities?
- Basis in paper: [explicit] The paper mentions that CTAN's performance is evaluated on various graph sizes in synthetic tasks and real-world datasets, but does not explore the theoretical limits of its long-range propagation capabilities in depth.
- Why unresolved: The paper focuses on demonstrating CTAN's effectiveness compared to baselines but does not delve into the theoretical bounds of its scalability.
- What evidence would resolve it: Conducting experiments with progressively larger graphs and analyzing the trade-offs between performance and computational complexity would provide insights into CTAN's scalability limits.

### Open Question 2
- Question: What are the potential benefits and drawbacks of using different discretization methods (e.g., adaptive multi-step schemes) for CTAN, and how do they compare to the forward Euler's method used in the paper?
- Basis in paper: [explicit] The paper mentions the possibility of exploring alternative architectures resulting from different discretization methods, such as adaptive multi-step schemes, but does not provide a comparative analysis.
- Why unresolved: The paper does not explore the impact of different discretization methods on CTAN's performance and stability.
- What evidence would resolve it: Implementing and comparing CTAN with various discretization methods on benchmark tasks would reveal the benefits and drawbacks of each approach.

### Open Question 3
- Question: How does CTAN handle graphs with varying densities and edge types, and what are the implications for its performance in heterogeneous network scenarios?
- Basis in paper: [inferred] The paper evaluates CTAN on several datasets but does not explicitly address its performance on heterogeneous networks with varying densities and edge types.
- Why unresolved: The experiments focus on homogeneous graphs, leaving the model's adaptability to heterogeneous networks unexplored.
- What evidence would resolve it: Testing CTAN on heterogeneous networks with diverse edge types and densities would clarify its adaptability and robustness in such scenarios.

## Limitations
- The theoretical assumptions about non-dissipative propagation may not fully hold in practice, particularly regarding the aggregation function's independence from node states
- The paper lacks ablation studies demonstrating the practical significance of non-dissipativeness for real-world applications
- Scalability with increasing graph sizes and the impact of discretization step size on long-range propagation effectiveness are not thoroughly explored

## Confidence
- **High Confidence**: Claims about anti-symmetric matrices enabling stable ODE solutions and the mathematical framework for non-dissipative propagation over space
- **Medium Confidence**: Claims about superior performance on benchmark tasks compared to state-of-the-art methods
- **Low Confidence**: Claims about the practical significance of non-dissipativeness for real-world applications and the scalability of the approach

## Next Checks
1. Conduct ablation studies on the PascalVOC-SP task with different ψ functions (including ψ = xu(t)) to empirically validate the time non-dissipativeness claims
2. Test CTAN's performance on graphs with lengths beyond 20 nodes to evaluate scalability claims
3. Implement CTAN with varying discretization step sizes (ϵ) to quantify the trade-off between propagation range and stability in practice