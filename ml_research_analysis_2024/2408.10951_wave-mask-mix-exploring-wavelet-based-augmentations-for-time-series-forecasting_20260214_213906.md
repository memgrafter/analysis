---
ver: rpa2
title: 'Wave-Mask/Mix: Exploring Wavelet-Based Augmentations for Time Series Forecasting'
arxiv_id: '2408.10951'
source_url: https://arxiv.org/abs/2408.10951
tags:
- time
- data
- forecasting
- methods
- series
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of data augmentation for time
  series forecasting, where traditional methods are insufficient to maintain temporal
  coherence. The authors propose two novel approaches, WaveMask and WaveMix, which
  utilize discrete wavelet transform (DWT) to adjust frequency elements while preserving
  temporal dependencies.
---

# Wave-Mask/Mix: Exploring Wavelet-Based Augmentations for Time Series Forecasting

## Quick Facts
- arXiv ID: 2408.10951
- Source URL: https://arxiv.org/abs/2408.10951
- Reference count: 23
- Primary result: WaveMask and WaveMix outperform baseline augmentation methods in 12 out of 16 forecasting horizon tasks

## Executive Summary
This paper addresses the challenge of data augmentation for time series forecasting, where traditional methods are insufficient to maintain temporal coherence. The authors propose two novel approaches, WaveMask and WaveMix, which utilize discrete wavelet transform (DWT) to adjust frequency elements while preserving temporal dependencies. Experiments on four datasets (ETTh1, ETTh2, Weather, ILI) show that these wavelet-based methods consistently outperform baseline augmentation techniques.

## Method Summary
WaveMask and WaveMix are wavelet-based augmentation methods that operate in the frequency domain while preserving temporal structure. WaveMask selectively eliminates specific wavelet coefficients to introduce variability, while WaveMix exchanges wavelet coefficients between different instances to enhance diversity. Both methods leverage DWT to decompose time series into multi-scale frequency components, manipulate these coefficients according to augmentation rules, and reconstruct the augmented series using inverse DWT. The methods are evaluated using a DLinear model with 30 epochs, patience level of 12, batch size 64, and random sampling strategy across four diverse datasets.

## Key Results
- WaveMask and WaveMix outperform baseline methods in 12 out of 16 forecasting horizon tasks
- The methods rank second best in the remaining 4 tasks
- WaveMask achieves an MSE of 0.4967±0.0001 on ETTh1 with 336-hour forecasting horizon
- WaveMix achieves an MSE of 0.4967±0.0001 on ETTh1 with 336-hour forecasting horizon
- Both methods demonstrate superior performance in cold-start forecasting using downsampled training datasets

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Wavelet masking selectively eliminates frequency components at different resolution levels, introducing variability while preserving temporal structure
- Mechanism: The discrete wavelet transform decomposes a time series into approximation and detail coefficients at multiple levels. WaveMask masks (sets to zero) selected coefficients at each level based on a masking rate, then reconstructs the signal using inverse DWT
- Core assumption: Frequency-domain perturbations introduced by masking do not destroy the underlying temporal dependencies needed for forecasting
- Evidence anchors:
  - [abstract] "WaveMask selectively eliminates specific wavelet coefficients to introduce variability"
  - [section] "Masking wavelet coefficients allow us to eliminate frequency components at various time scales selectively"
- Break condition: If masking rates are too high, the reconstructed signal loses essential patterns, degrading forecast accuracy

### Mechanism 2
- Claim: Wavelet mixing exchanges wavelet coefficients between two time series, enhancing diversity by blending frequency information
- Mechanism: WaveMix decomposes two input series into wavelet coefficients, generates complementary masks to select coefficients from each, swaps the masked coefficients, and reconstructs two new series
- Core assumption: Swapping frequency components between related time series preserves meaningful temporal dynamics and improves generalization
- Evidence anchors:
  - [abstract] "WaveMix exchanges wavelet coefficients between different instances to enhance diversity"
  - [section] "By exchanging wavelet coefficients between inputs, the frequency components of one data instance are integrated into the other"
- Break condition: If mix rates are too high or series are too dissimilar, the reconstructed series may become incoherent, harming model performance

### Mechanism 3
- Claim: Wavelet-based augmentations outperform frequency-only methods because they maintain time-frequency localization
- Mechanism: Unlike Fourier-based methods (FrAug), which lose time resolution, wavelet transforms provide multi-resolution analysis, allowing selective frequency manipulation at different time scales
- Core assumption: Maintaining time-frequency localization is more important than pure frequency manipulation for time series forecasting
- Evidence anchors:
  - [abstract] "utilize discrete wavelet transform (DWT) to adjust frequency elements while preserving temporal dependencies"
  - [section] "The DWT accomplishes this decomposition by employing a sequence of filtering and downsampling procedures, resulting in a structured representation of the signal at different levels of resolution"
- Break condition: If the wavelet transform is applied incorrectly or with inappropriate basis functions, the method may not preserve temporal coherence

## Foundational Learning

- Concept: Discrete Wavelet Transform (DWT)
  - Why needed here: DWT decomposes time series into multi-scale frequency components, enabling selective augmentation without losing temporal structure
  - Quick check question: What is the difference between approximation and detail coefficients in DWT?

- Concept: Time-frequency localization
  - Why needed here: Understanding why wavelets preserve time alignment while Fourier methods do not is key to grasping the augmentation advantage
  - Quick check question: How does wavelet resolution vary with scale compared to Fourier analysis?

- Concept: Time series forecasting formulation
  - Why needed here: The problem setup (look-back window + forecasting horizon) determines how augmentations must preserve temporal coherence
  - Quick check question: In the given formulation, what do X and F represent?

## Architecture Onboarding

- Component map: Input → DWT decomposition → Masking/Mixing → IDWT reconstruction → Output. Random sampling controls how many augmented samples are used per batch
- Critical path: DWT → coefficient manipulation → IDWT → model training. Any failure here breaks the augmentation pipeline
- Design tradeoffs: Higher masking/mixing rates increase diversity but risk destroying signal structure; wavelet level selection affects which frequencies are altered
- Failure signatures: If MSE/MAE degrade significantly, check coefficient manipulation logic; if GPU memory errors occur, check DWT tensor sizes
- First 3 experiments:
  1. Run WaveMask with low masking rate (e.g., 0.1) on ETTh1 96-hour horizon; verify MSE improvement over baseline
  2. Run WaveMix with mix rate 0.5 on ETTh2; compare stability vs. FreqMix
  3. Test cold-start forecasting with 15% downsampled data; confirm WaveMask/WaveMix advantage over baselines

## Open Questions the Paper Calls Out
None

## Limitations
- Implementation detail dependency: Performance hinges on precise coefficient masking/mixing algorithms and DWT implementation details not fully specified
- Dataset generalization: Results may not generalize to other domains or different time series characteristics
- Baseline comparison scope: Only compares against specific augmentation methods, not exploring all possible strategies

## Confidence

- High confidence: The core mechanism of using DWT for frequency-based augmentation while preserving temporal structure is theoretically sound and well-supported by the literature on wavelet transforms
- Medium confidence: The empirical results showing WaveMask/WaveMix outperforming baselines across 12/16 tasks are compelling, though implementation details affect exact performance
- Medium confidence: The claim that wavelet-based methods maintain time-frequency localization advantage over Fourier methods is reasonable but not explicitly validated through direct comparison

## Next Checks

1. Reproduce baseline performance: Implement FreqMix, STAug, and MT-Augment methods exactly as described in their original papers to verify the claimed performance gaps
2. Ablation on wavelet parameters: Systematically vary mother wavelet type, decomposition levels, and masking/mixing rates to identify optimal configurations and robustness boundaries
3. Cross-domain testing: Apply WaveMask/WaveMix to additional time series datasets (e.g., financial, medical, sensor data) with different characteristics to assess generalization beyond the four tested domains