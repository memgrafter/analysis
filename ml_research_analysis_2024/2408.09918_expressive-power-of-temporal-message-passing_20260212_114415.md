---
ver: rpa2
title: Expressive Power of Temporal Message Passing
arxiv_id: '2408.09918'
source_url: https://arxiv.org/abs/2408.09918
tags:
- temporal
- divides
- alt0
- mp-tgnns
- global
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a comprehensive theoretical and experimental
  analysis of temporal message-passing mechanisms in graph neural networks. The authors
  categorize these mechanisms into global and local types, providing formal characterizations
  using the Weisfeiler-Leman test.
---

# Expressive Power of Temporal Message Passing

## Quick Facts
- arXiv ID: 2408.09918
- Source URL: https://arxiv.org/abs/2408.09918
- Authors: Przemysław Andrzej Wałęga; Michael Rawson
- Reference count: 40
- Primary result: Local temporal message-passing mechanisms are strictly more expressive than global ones on color-persistent temporal graphs, with comparable performance on link-prediction benchmarks.

## Executive Summary
This paper presents a comprehensive theoretical and experimental analysis of temporal message-passing mechanisms in graph neural networks. The authors categorize these mechanisms into global and local types, providing formal characterizations using the Weisfeiler-Leman test. Their theoretical results show that while these mechanisms have incomparable expressive power on arbitrary temporal graphs, local mechanisms are strictly more expressive than global ones on color-persistent graphs. The theoretical findings are validated through experiments on temporal link-prediction benchmarks, where local models consistently outperform global models, with the performance gap increasing as the number of layers increases.

## Method Summary
The authors analyze global and local temporal message-passing mechanisms by transforming temporal graphs into knowledge graphs (Kglob for global, Kloc for local) and applying the 1-Weisfeiler-Leman algorithm. They establish theoretical characterizations of expressive power through indistinguishability relations and validate their findings experimentally using the Temporal Graph Benchmark (TGB) 2.0 suite. The experiments compare global and local MP-TGNNs on three datasets (tgbl-wiki, tgbl-review, tgbl-coin) using 4-layer models with concatenation and summation functions, trained until validation loss fails to improve for 10 epochs.

## Key Results
- Global and local MP-TGNNs have incomparable expressive power on arbitrary temporal graphs
- Local MP-TGNNs are strictly more expressive than global MP-TGNNs on color-persistent temporal graphs
- Experimental results on TGB benchmarks show local models consistently outperform global models, with performance gap increasing with layer depth

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Local MP-TGNNs can distinguish timestamped nodes that global MP-TGNNs cannot distinguish in color-persistent graphs.
- Mechanism: In local MP-TGNNs, message aggregation occurs only between nodes at the same timestamp, while information about other timestamps is encoded within messages. This allows local models to capture temporal patterns that global models miss.
- Core assumption: Color-persistence (node colors don't change over time) is maintained in the input graphs.
- Evidence anchors:
  - [abstract] "However, the local mechanism is strictly more expressive than the global mechanism when applied to colour-persistent temporal graphs"
  - [section] "In colour-persistent graphs local MP-TGNNs are strictly more expressive than global MP-TGNNs"
  - [corpus] Weak corpus evidence for this specific mechanism
- Break condition: If input graphs are not color-persistent, the advantage disappears as shown in Theorem 11.

### Mechanism 2
- Claim: Global and local MP-TGNNs have incomparable expressive power on arbitrary temporal graphs.
- Mechanism: Global MP-TGNNs can distinguish nodes based on temporal neighborhood embeddings from different timestamps, while local MP-TGNNs can distinguish nodes based on structural patterns at individual timestamps that global models cannot capture.
- Core assumption: Temporal graphs can have arbitrary structure and coloring patterns.
- Evidence anchors:
  - [abstract] "global and local temporal message-passing mechanisms have incomparable expressive power when applied to arbitrary temporal graphs"
  - [section] "global MP-TGNNs can distinguish timestamped nodes which are indistinguishable by local MP-TGNNs" and "there are timestamped nodes which can be distinguished by local, but not by global MP-TGNNs"
  - [corpus] Weak corpus evidence for this specific mechanism
- Break condition: If graphs are restricted to specific structures (like color-persistent), the incomparability relationship may change.

### Mechanism 3
- Claim: Temporal Weisfeiler-Leman characterization allows precise analysis of expressive power differences between global and local MP-TGNNs.
- Mechanism: By transforming temporal graphs into knowledge graphs (Kglob for global, Kloc for local) and applying standard 1-WL algorithm, the expressive power of MP-TGNNs can be characterized and compared.
- Core assumption: The knowledge graph transformation preserves the distinguishability properties relevant to MP-TGNNs.
- Evidence anchors:
  - [section] "Our approach to determine which nodes in a temporal graph T G are distinguishable by MP-TGNN: we construct knowledge graphs Kglob( T G) and Kloc( T G), and then apply 1-WL"
  - [section] "The Weisfeiler-Leman characterisation of global and local MP-TGNNs established in the above theorems provides us with a versatile tool for analysing expressive power"
  - [corpus] Weak corpus evidence for this specific mechanism
- Break condition: If the transformation introduces artifacts that don't preserve distinguishability, the characterization breaks.

## Foundational Learning

- Concept: Weisfeiler-Leman (WL) test for graph isomorphism
  - Why needed here: The WL test provides a theoretical framework to analyze and compare the expressive power of different MP-TGNN mechanisms
  - Quick check question: What is the relationship between the WL test and the expressive power of standard GNNs?

- Concept: Temporal graph representation (snapshot model)
  - Why needed here: Understanding how temporal graphs are structured is essential for grasping the differences between global and local message-passing
  - Quick check question: How does the snapshot representation differ from other temporal graph representations?

- Concept: Color-persistence in temporal graphs
  - Why needed here: This property is crucial for understanding when local MP-TGNNs have strict advantage over global ones
  - Quick check question: What does it mean for a temporal graph to be color-persistent, and why is this important for expressiveness analysis?

## Architecture Onboarding

- Component map:
  - Temporal graph input layer (snapshot representation) -> Message passing layer (global vs local distinction) -> Aggregation and combination functions -> Knowledge graph transformation module (Kglob/Kloc) -> Weisfeiler-Leman algorithm application -> Output layer (link prediction/classification)

- Critical path:
  1. Transform input temporal graph into appropriate knowledge graph (Kglob or Kloc)
  2. Apply Weisfeiler-Leman algorithm to determine node distinguishability
  3. Use results to select appropriate MP-TGNN mechanism for given task
  4. Train and evaluate chosen model

- Design tradeoffs:
  - Global vs local message passing: Global captures cross-temporal dependencies but is computationally expensive; local is more efficient but may miss some temporal patterns
  - Knowledge graph transformation: Provides theoretical insights but adds preprocessing overhead
  - Layer depth: More layers increase expressiveness but also computational cost and overfitting risk

- Failure signatures:
  - If global and local models perform similarly on color-persistent graphs, check if color-persistence assumption holds
  - If theoretical predictions don't match experimental results, verify knowledge graph transformation implementation
  - If performance degrades with more layers, check for overfitting or vanishing gradients

- First 3 experiments:
  1. Compare global vs local MP-TGNN performance on a color-persistent synthetic dataset to verify theoretical advantage
  2. Test the effect of varying the number of layers on both model types to identify optimal configurations
  3. Apply the knowledge graph transformation and Weisfeiler-Leman test to a small dataset to manually verify distinguishability results

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the performance of temporal message-passing mechanisms scale with graph size and density?
- Basis in paper: [inferred] The paper discusses experimental results on TGB benchmarks but focuses on small-to-medium datasets, suggesting potential gaps in understanding performance at larger scales.
- Why unresolved: The experiments are limited to specific datasets and do not explore extreme graph sizes or densities.
- What evidence would resolve it: Systematic experiments on larger, more diverse temporal graphs, measuring runtime and accuracy across varying graph properties.

### Open Question 2
- Question: What are the trade-offs between expressiveness and computational efficiency in temporal message-passing models?
- Basis in paper: [explicit] The paper notes that global models require significant computational resources, particularly for aggregating embeddings across all time points.
- Why unresolved: While the paper discusses computational challenges, it does not provide a detailed analysis of how expressiveness and efficiency trade off in practice.
- What evidence would resolve it: Empirical studies comparing model expressiveness and computational cost across different temporal message-passing mechanisms and graph structures.

### Open Question 3
- Question: How do different temporal message-passing mechanisms perform on non-color-persistent temporal graphs?
- Basis in paper: [explicit] The paper shows that global and local mechanisms have incomparable expressive power on arbitrary temporal graphs, but only local mechanisms are strictly more expressive on color-persistent graphs.
- Why unresolved: The paper does not provide experimental results for non-color-persistent graphs, leaving a gap in understanding practical performance differences.
- What evidence would resolve it: Experiments comparing global and local models on non-color-persistent graphs, measuring accuracy and expressiveness.

### Open Question 4
- Question: Can the expressiveness of temporal message-passing mechanisms be further enhanced by incorporating additional temporal features?
- Basis in paper: [inferred] The paper focuses on basic temporal message-passing mechanisms without exploring the impact of additional temporal features, such as time intervals or event frequencies.
- Why unresolved: The paper does not investigate the potential benefits of incorporating richer temporal features into the message-passing process.
- What evidence would resolve it: Experimental results showing the impact of additional temporal features on model expressiveness and performance, potentially leading to new mechanisms or hybrid approaches.

## Limitations
- The theoretical characterizations assume color-persistence, which may not hold in many real-world temporal graphs
- Experimental validation is limited to three datasets from the TGB benchmark without node features
- The computational complexity of global MP-TGNNs is not fully characterized, particularly for large-scale graphs

## Confidence
- Theoretical characterization of expressive power differences: High
- Experimental validation on TGB datasets: Medium
- Generalizability to non-color-persistent real-world graphs: Low

## Next Checks
1. Test the theoretical predictions on synthetic temporal graphs with controlled color-persistence properties to verify the conditions under which local models strictly outperform global ones.
2. Evaluate the impact of adding node features to the current datasets to determine if the performance gap between global and local models changes.
3. Apply the proposed analysis framework to additional temporal graph benchmarks (beyond TGB) with different structural properties to assess the robustness of the findings.