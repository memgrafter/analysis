---
ver: rpa2
title: 'The Impact of Scanner Domain Shift on Deep Learning Performance in Medical
  Imaging: an Experimental Study'
arxiv_id: '2409.04368'
source_url: https://arxiv.org/abs/2409.04368
tags:
- domain
- scanner
- shift
- medical
- training
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This study systematically investigates the impact of scanner domain\
  \ shift\u2014variations in image appearance due to differences in scanner models,\
  \ acquisition parameters, and post-processing\u2014on the performance of deep neural\
  \ networks for medical image analysis across multiple modalities (X-ray, CT, MRI)\
  \ and diagnostic tasks. Using seven publicly available datasets, models were trained\
  \ on images from one scanner manufacturer and tested on images from another, with\
  \ performance measured by AUC."
---

# The Impact of Scanner Domain Shift on Deep Learning Performance in Medical Imaging: an Experimental Study

## Quick Facts
- arXiv ID: 2409.04368
- Source URL: https://arxiv.org/abs/2409.04368
- Reference count: 39
- Primary result: Deep learning models show significant performance drops when tested on images from different scanner manufacturers, with MRI experiencing the largest domain shift effects (average ΔAUC = -0.097)

## Executive Summary
This study systematically investigates how variations in medical imaging scanners affect deep learning model performance across X-ray, CT, and MRI modalities. Using seven publicly available datasets, models were trained on images from one scanner manufacturer and tested on images from another, revealing consistent performance degradation in 11 out of 14 domain shift scenarios. The severity of domain shift varied by modality, with MRI showing the largest drops in performance, followed by X-ray and then CT. The authors attribute these differences to variations in scanner parameter variability and standardization across modalities. Additional experiments showed that gradually injecting target domain data improved generalization for MRI but not CT, while adding Gaussian noise to training images did not improve cross-domain performance.

## Method Summary
The study used seven publicly available medical imaging datasets spanning CT, MRI, and X-ray modalities, each containing images from two different scanner manufacturers. For each dataset, models were trained on images from one scanner type and tested on both the same scanner and the other scanner manufacturer's images. The researchers used MRNet2D for 2D tasks, NoduleX for 3D tasks, and DenseNet-121 for X-ray classification. Models were trained for 60 epochs with batch size 50 and learning rate 0.0001, and training was repeated 10 times with different random seeds. Additional experiments tested gradual injection of target domain data (mixing fractions 0.1-0.5) and additive Gaussian noise (α=1-50) to training images.

## Key Results
- Models trained on one scanner domain consistently showed performance drops when tested on different scanner domains in 11 out of 14 scenarios
- MRI tasks experienced the largest performance drops (average ΔAUC = -0.097), followed by X-ray (ΔAUC = -0.067) and CT (ΔAUC = -0.02)
- Gradually injecting target domain data improved MRI generalization but not CT
- Adding Gaussian noise to training images did not improve cross-domain generalization

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Scanner domain shift causes performance degradation because deep learning models learn modality-specific imaging features that are not present in images from other domains.
- Mechanism: Different scanner models and acquisition parameters produce distinct visual features in the resulting images. Deep learning models trained on one scanner's images learn to rely on these features for their predictions. When tested on images from a different scanner, these learned features may be absent or different, leading to reduced model performance.
- Core assumption: The visual features learned by the deep learning model are strongly tied to the specific scanner characteristics and are not robust across different scanner domains.
- Evidence anchors:
  - [abstract] "scanner domain shift, can result in a drop in the performance of deep neural networks which are trained on data acquired by one scanner and tested on another"
  - [section] "When radiological images are acquired at different imaging sites, referred to as domains, various attributes of the medical image acquisition pipeline such as scanner model and manufacturer, image acquisition parameters (e.g., echo and repetition times for MRI), and post-processing can differ between the two domains, resulting in images with different characteristics"
  - [corpus] Weak - no direct evidence in corpus, but related to domain generalization in medical imaging

### Mechanism 2
- Claim: The severity of scanner domain shift varies by imaging modality due to differences in the standardization of acquisition systems and the sensitivity of image appearance to scanner parameters.
- Mechanism: CT imaging systems are more standardized compared to MRI and X-ray, resulting in less variability in image appearance across different scanner domains. MRI and X-ray imaging systems have more variable acquisition parameters that significantly affect image appearance, leading to greater domain shift.
- Core assumption: The degree of standardization in the acquisition system and the sensitivity of image appearance to scanner parameters are the primary factors determining the severity of scanner domain shift for a given modality.
- Evidence anchors:
  - [abstract] "we attribute this pattern to differences in scanner parameter variability and standardization across modalities"
  - [section] "We hypothesize that this varying severity of domain shift is dependent on both how much scanner image acquisition parameters and proprietary post-processing methods usually differ between imaging settings/domains for a given scanner type, and the strength of the effect of these factors on image appearance"
  - [corpus] Weak - no direct evidence in corpus, but related to modality-specific challenges in domain adaptation

### Mechanism 3
- Claim: Adding noise to training images does not improve domain generalization because the noise does not make the model more robust to the specific types of domain shift caused by scanner differences.
- Mechanism: The domain shift caused by scanner differences is due to systematic changes in image appearance, not random noise. Adding random noise to the training images does not help the model learn to be invariant to these systematic changes.
- Core assumption: The domain shift caused by scanner differences is a systematic effect, not a random one, and therefore cannot be mitigated by adding random noise to the training data.
- Evidence anchors:
  - [section] "adding simple Gaussian noise to images in training did not assist with performance in other domains, indicating that more complex solutions to prevent in-domain overfitting and encourage out-of-domain generalization are necessary"
  - [section] "In fact, adding noise to training images never assisted out-of-domain generalization, even at small noise levels"
  - [corpus] Weak - no direct evidence in corpus, but related to the limitations of noise-based domain adaptation techniques

## Foundational Learning

- Concept: Domain shift in machine learning
  - Why needed here: Understanding the concept of domain shift is crucial for grasping the main problem addressed in this paper, which is the impact of scanner domain shift on deep learning performance in medical imaging.
  - Quick check question: What is domain shift, and why is it a problem in machine learning?

- Concept: Modality-specific image acquisition parameters
  - Why needed here: Different imaging modalities (X-ray, CT, MRI) have different acquisition parameters that can vary between scanner domains, leading to domain shift. Understanding these parameters is key to interpreting the results of this study.
  - Quick check question: What are some common image acquisition parameters for MRI, CT, and X-ray, and how can they affect image appearance?

- Concept: Deep learning model generalization
  - Why needed here: The paper discusses the generalization ability of deep learning models across different scanner domains. Understanding the factors that affect model generalization is important for interpreting the results and implications of this study.
  - Quick check question: What factors can affect the ability of a deep learning model to generalize across different domains?

## Architecture Onboarding

- Component map: Data collection and preprocessing -> Model training and evaluation -> Performance analysis
- Critical path: 1) Collect and preprocess seven datasets 2) Split each dataset into training, validation, and test sets by scanner domain 3) Train two models per dataset (one per scanner type) 4) Evaluate each model on both same-domain and cross-domain test sets 5) Analyze performance differences and domain shift impact
- Design tradeoffs: Using a limited number of datasets and modalities vs. broader but potentially less in-depth study; focusing on AUC as primary metric vs. using additional metrics; using fixed model architecture vs. exploring different architectures
- Failure signatures: Poor performance on same-domain test sets indicating model training or data quality issues; unexpectedly high performance on different-domain test sets suggesting data leakage; inconsistent results across runs indicating experimental design or implementation issues
- First 3 experiments:
  1. Verify data preprocessing pipeline by visualizing sample images from each dataset and modality
  2. Train simple model (e.g., logistic regression) on one dataset and evaluate on both same and different scanner domains to establish baseline
  3. Train MRNet2D model on MRI-Breast dataset and evaluate on both GE and Siemens domains to confirm domain shift results

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Why does domain shift severity vary by modality (MRI > X-ray > CT) despite all being medical imaging?
- Basis in paper: [explicit] The authors attribute this pattern to differences in scanner parameter variability and standardization across modalities
- Why unresolved: The paper hypothesizes about acquisition parameter differences but doesn't provide quantitative evidence linking specific parameters to domain shift severity
- What evidence would resolve it: Systematic measurement of how acquisition parameter variations (TE, TR, flip angle for MRI; radiation energy/dosage for X-ray; slice thickness for CT) directly correlate with performance degradation across domains

### Open Question 2
- Question: Would larger training datasets reduce the impact of scanner domain shift?
- Basis in paper: [inferred] The authors note that all experiments used fixed training sizes and mention "future studies could explore...training set sizes"
- Why unresolved: The study used consistent dataset splits but didn't systematically vary training set size to test its effect on domain generalization
- What evidence would resolve it: Experiments training models with progressively larger training sets (10%, 25%, 50%, 100% of available data) and measuring cross-domain performance

### Open Question 3
- Question: Do different neural network architectures show different sensitivities to scanner domain shift?
- Basis in paper: [inferred] The authors used specific architectures (MRNet2D, NoduleX, DenseNet-121) but note "future studies could explore...additional network architectures"
- Why unresolved: The study tested only three architectures across all modalities without comparing their relative robustness to domain shift
- What evidence would resolve it: Comparative experiments using architectures with different inductive biases (CNNs, transformers, vision MLPs) trained on identical data splits and evaluated for cross-domain performance

### Open Question 4
- Question: Could more sophisticated noise injection techniques help with domain generalization?
- Basis in paper: [explicit] The authors found that simple Gaussian noise injection did not assist with out-of-domain generalization
- Why unresolved: The study only tested basic additive Gaussian noise, not more complex augmentation strategies that might better simulate scanner differences
- What evidence would resolve it: Experiments with advanced augmentation techniques like style transfer, frequency-based perturbations, or learned noise patterns that better mimic real scanner variations

## Limitations

- Limited dataset diversity: The study relies on only seven datasets across three modalities, which may not capture the full diversity of scanner domain shifts encountered in clinical practice.
- Single performance metric: Focusing primarily on AUC as the performance metric potentially overlooks other clinically relevant metrics such as sensitivity and specificity.
- Basic domain adaptation techniques: The study tested only simple Gaussian noise injection and gradual target domain injection, without exploring more sophisticated domain adaptation methods.

## Confidence

- **High Confidence**: The core finding that scanner domain shift causes performance degradation across medical imaging modalities is well-supported by the experimental results and consistent across all tested datasets.
- **Medium Confidence**: The observed pattern of severity differences across modalities (MRI > X-ray > CT) is supported by the data but relies on the assumption that scanner parameter variability is the primary driver, which requires further validation.
- **Low Confidence**: The claim that adding Gaussian noise to training images does not improve cross-domain generalization is based on a limited set of noise levels and may not generalize to other noise types or distributions.

## Next Checks

1. Expand dataset diversity by testing findings on additional datasets with more scanner manufacturers and imaging protocols to verify generalizability across broader clinical scenarios.
2. Evaluate model performance using clinically relevant metrics beyond AUC, such as sensitivity, specificity, and diagnostic accuracy, to ensure findings are meaningful for real-world clinical applications.
3. Investigate effectiveness of more sophisticated domain adaptation methods, such as adversarial training, feature disentanglement, or meta-learning, to mitigate scanner domain shift and improve cross-domain generalization.