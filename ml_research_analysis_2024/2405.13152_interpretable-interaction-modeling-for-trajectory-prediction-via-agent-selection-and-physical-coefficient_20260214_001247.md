---
ver: rpa2
title: Interpretable Interaction Modeling for Trajectory Prediction via Agent Selection
  and Physical Coefficient
arxiv_id: '2405.13152'
source_url: https://arxiv.org/abs/2405.13152
tags:
- agent
- prediction
- interaction
- agents
- trajectory
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents ASPILin, a trajectory prediction model that
  improves interpretability by manually selecting interacting agents and using a physical
  correlation coefficient instead of learned attention scores. The approach selects
  four types of interacting agents (same lane/leading, future lane/leading, future
  lane/following, merging/leading) based on road topology and current/future lanes.
---

# Interpretable Interaction Modeling for Trajectory Prediction via Agent Selection and Physical Coefficient

## Quick Facts
- arXiv ID: 2405.13152
- Source URL: https://arxiv.org/abs/2405.13152
- Reference count: 39
- State-of-the-art performance on INTERACTION with minADE6 of 0.07 and minFDE6 of 0.24 on validation set

## Executive Summary
This paper presents ASPILin, a trajectory prediction model that improves interpretability by manually selecting interacting agents and using a physical correlation coefficient instead of learned attention scores. The approach selects four types of interacting agents (same lane/leading, future lane/leading, future lane/following, merging/leading) based on road topology and current/future lanes. The physical correlation coefficient combines distance and approach speed to quantify agent interactions. Experiments on INTERACTION, highD, and CitySim datasets show ASPILin achieves state-of-the-art performance while reducing inference latency compared to baseline methods.

## Method Summary
ASPILin is a CVAE-based trajectory prediction model that uses lane-aware agent selection and physical correlation coefficients for interaction modeling. The model first predicts future lane assignments for all agents, then selects four specific types of interacting agents (same lane/leading, future lane/leading, future lane/following, merging/leading) based on these predictions and road topology. Instead of learned attention weights, it computes interaction strengths using a physical correlation coefficient that combines Euclidean distance and relative approach speed. The model employs three parallel spatiotemporal encoders (interaction encoder, target agent encoder, map encoder) followed by a decoder with reparameterization to generate multimodal trajectory predictions.

## Key Results
- Achieves minADE6 of 0.07 and minFDE6 of 0.24 on INTERACTION validation set
- Outperforms state-of-the-art models including M2M-T, MultiXNet, and TNG
- Reduces inference latency through selective agent inclusion
- Demonstrates improved interpretability through physical correlation coefficients

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Agent selection based on lane topology and future lanes reduces noise and improves inference efficiency
- Mechanism: Instead of using all agents within a fixed distance threshold, the model selects only four specific agent types (same lane/leading, future lane/leading, future lane/following, merging/leading) based on current and predicted future lane assignments. This focuses computation on agents most likely to interact with the target.
- Core assumption: Interactions are primarily governed by lane topology and relative positioning rather than raw proximity alone
- Evidence anchors:
  - [abstract]: "manually selects interacting agents and replaces the attention scores in Transformer with a newly computed physical correlation coefficient"
  - [section]: "we refine the selection of interacting agents by leveraging their road topology"
  - [corpus]: No direct evidence about lane-based selection in neighbors
- Break condition: If agents frequently interact across lanes without clear topological boundaries (e.g., aggressive weaving), or if future lane prediction is inaccurate

### Mechanism 2
- Claim: Physical correlation coefficient combining distance and approach speed provides more interpretable interaction modeling than learned attention
- Mechanism: The physical attention score normalizes a closeness index that accounts for both Euclidean distance and relative approach speed, replacing learned attention weights. This makes interaction strength more physically meaningful and explainable.
- Core assumption: Interaction strength correlates with both proximity and relative velocity rather than just spatial distance
- Evidence anchors:
  - [abstract]: "replaces the attention scores in Transformer with a newly computed physical correlation coefficient"
  - [section]: "we quantify the correlations between agents using a handcrafted simple physical attention score"
  - [corpus]: No direct evidence about physical coefficients in neighbors
- Break condition: If interaction patterns are too complex for simple physical heuristics, or if learned attention captures non-physical but important correlations

### Mechanism 3
- Claim: Selecting interacting agents at each historical timestep preserves causal interaction links
- Mechanism: Rather than selecting agents only at the current timestep, the method applies agent selection to all historical timesteps. This maintains the historical context of interactions that may have changed over time.
- Core assumption: Historical interaction context is important for trajectory prediction, not just current state
- Evidence anchors:
  - [abstract]: "we conduct agent selection for each historical time step (rather than only the current time)"
  - [section]: "conducting agent selection solely at the current time is entirely reasonable, as their simplistic agent selection methods diminish the variability of selection across different time steps"
  - [corpus]: No direct evidence about historical timestep selection in neighbors
- Break condition: If computational cost of per-timestep selection outweighs benefits, or if interactions are truly Markovian

## Foundational Learning

- Concept: Transformer attention mechanisms
  - Why needed here: The paper replaces learned attention scores with physical correlation coefficients in a Transformer framework
  - Quick check question: What are the three main components of standard Transformer attention (Query, Key, Value), and how does the attention weight calculation work?

- Concept: Lane topology and road network representation
  - Why needed here: Agent selection is based on lane assignments and future lane predictions, requiring understanding of how roads and lanes are represented
  - Quick check question: How would you represent a multi-lane road segment in a data structure that allows efficient querying of which lane an agent is in?

- Concept: Probabilistic trajectory prediction and CVAE frameworks
  - Why needed here: The model uses a Conditional Variational Autoencoder to generate multimodal trajectory predictions
  - Quick check question: What is the key difference between a standard VAE and a CVAE, and why is this distinction important for trajectory prediction?

## Architecture Onboarding

- Component map: Historical trajectories → Lane predictor → Agent selector → Interaction encoder (physical attention) → Spatiotemporal encoders (3 parallel) → Decoder → Reparameterization → Output trajectories
- Critical path: Historical trajectories → Lane prediction → Agent selection (4 types) → Physical attention calculation → Interaction encoding → Trajectory generation
- Design tradeoffs: Interpretability vs. performance (simplified map encoding), efficiency vs. accuracy (selective agent inclusion), physical heuristics vs. learned attention
- Failure signatures: Poor performance on non-lane-following agents, degraded accuracy when lane prediction fails, suboptimal results on highly interactive scenarios with many cross-lane interactions
- First 3 experiments:
  1. Validate that lane-based agent selection correctly identifies interacting agents in simple scenarios with clear lane boundaries
  2. Test physical attention coefficient formulation by comparing with learned attention on scenarios with known interaction patterns
  3. Measure inference latency improvement from agent selection reduction on datasets with varying agent densities

## Open Questions the Paper Calls Out
The paper does not explicitly call out open questions, but identifies several limitations including the assumption that vehicle interactions are inferred exclusively through lane-based criteria, omitting traffic signals and other environmental factors that may influence interactions.

## Limitations
- Model assumes vehicle interactions are inferred exclusively through lane-based criteria, omitting traffic signals and other environmental factors
- Performance may degrade when lane prediction is inaccurate or in scenarios with frequent cross-lane interactions
- Limited evaluation on pedestrian and cyclist prediction tasks despite claims of generalizability

## Confidence
- **High confidence**: Performance improvements on INTERACTION, highD, and CitySim datasets; latency reduction claims; core architectural components (CVAE framework, lane predictor, interaction encoder structure)
- **Medium confidence**: Claims about interpretability benefits; effectiveness of physical correlation coefficient over learned attention; agent selection methodology generalizability
- **Low confidence**: Direct interpretability claims without human studies; generalizability to non-lane-following agents; robustness when lane prediction fails

## Next Checks
1. Conduct a user study where traffic engineers attempt to debug model predictions using physical correlation coefficients versus learned attention scores, measuring time to identify issues and accuracy of diagnoses.

2. Evaluate ASPILin on datasets with significant non-lane-following behavior (e.g., pedestrian crowds, sports scenarios) to assess whether the lane-based agent selection approach remains effective.

3. Systematically degrade lane prediction accuracy (e.g., by adding noise) and measure the resulting performance drop in trajectory prediction to quantify the model's dependence on accurate lane assignments.