---
ver: rpa2
title: State-space systems as dynamic generative models
arxiv_id: '2404.08717'
source_url: https://arxiv.org/abs/2404.08717
tags:
- input
- then
- state
- stochastic
- theorem
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a probabilistic framework for studying the
  dependence structure induced by deterministic discrete-time state-space systems
  between input and output processes. General sufficient conditions are formulated
  under which output processes exist and are unique once an input process has been
  fixed, a property known as the stochastic echo state property.
---

# State-space systems as dynamic generative models

## Quick Facts
- arXiv ID: 2404.08717
- Source URL: https://arxiv.org/abs/2404.08717
- Reference count: 33
- This paper introduces a probabilistic framework for studying the dependence structure induced by deterministic discrete-time state-space systems between input and output processes.

## Executive Summary
This paper develops a probabilistic framework for analyzing how deterministic state-space systems induce dependence structures between input and output processes. The key innovation is establishing sufficient conditions under which unique output processes exist when an input process is fixed, a property termed the stochastic echo state property. The work shows that state-space systems can create purely probabilistic dependencies between input and output sequences even when no functional relation exists between them. The framework generalizes the deterministic echo state property by allowing weaker contractivity conditions while maintaining uniqueness of solutions.

## Method Summary
The method centers on defining and proving the stochastic echo state property for discrete-time state-space systems. The approach uses contractivity conditions on state maps and input measures, framed within Wasserstein spaces and causal Bernoulli shifts. The framework establishes that when input processes arise as stochastic outputs of other state-space systems with independent hidden inputs, unique causal output processes exist and depend continuously on the input in the Wasserstein metric sense. The proofs leverage fixed point theorems in appropriate topological spaces and construct causal measures through conjugate systems.

## Key Results
- General sufficient conditions for the stochastic echo state property, allowing unique stochastic outputs to exist when deterministic solutions fail
- Output processes depend continuously on input processes in the Wasserstein metric sense
- Weaker contractivity conditions compared to deterministic echo state property while maintaining uniqueness
- The output processes are shown to be causal in a specific sense, generalizing deterministic solutions

## Why This Works (Mechanism)

### Mechanism 1
- Claim: State-space systems can induce purely probabilistic dependence structures between input and output sequences even without functional relations.
- Mechanism: The stochastic echo state property allows unique stochastic outputs to exist when deterministic solutions fail, enabling probabilistic generative modeling.
- Core assumption: The input process can be represented as the stochastic output of another state-space system with independent hidden inputs.
- Evidence anchors:
  - [abstract] "state-space systems can induce a purely probabilistic dependence structure between input and output sequence spaces even when there is no functional relation between those two spaces"
  - [section 1] "state-space systems can create dependences between input and output processes that are purely probabilistic and are not backed by a deterministic functional relation between the corresponding sequence spaces"
  - [corpus] Weak - only 1 related paper on stochastic dynamics learning, but not directly addressing this mechanism
- Break condition: If the hidden input marginals are not κ-contractive, the stochastic echo state property fails.

### Mechanism 2
- Claim: The output process depends continuously on the input in Wasserstein metric sense.
- Mechanism: Contractivity conditions on the hidden input marginals ensure that the map from input measure to output measure is Lipschitz continuous with respect to Wasserstein distances.
- Core assumption: The state map f satisfies certain boundedness conditions relative to the input measure.
- Evidence anchors:
  - [abstract] "those conditions guarantee that the output depends continuously on the input when using the Wasserstein metric"
  - [section 3.2] "the continuous dependence of the unique solution on the input process constitutes a stochastic analog of the fading memory property"
  - [corpus] Missing - no direct evidence in related papers about Wasserstein continuity
- Break condition: If κ ≥ |w|^-1 or the boundedness conditions fail, continuity breaks.

### Mechanism 3
- Claim: Causal Bernoulli shifts as inputs enable the stochastic echo state property.
- Mechanism: When inputs are generated as Ug(Z) where Z has independent marginals, the resulting stochastic output inherits causality properties that generalize deterministic solutions.
- Core assumption: The input-generating state equation g has the echo state property and its filter is continuous.
- Evidence anchors:
  - [section 2.1] "The class of stochastic inputs we are interested in are those that arise as the stochastic output of another state-space system, which is fed independent stochastic inputs"
  - [section 4] Proof constructs causal measures through the conjugate system G
  - [corpus] Weak - only indirect connection through stochastic dynamics learning paper
- Break condition: If the input-generating system lacks the echo state property, causality breaks.

## Foundational Learning

- Concept: Wasserstein spaces and distances
  - Why needed here: The main result establishes continuity of the output measure as a function of the input measure using Wasserstein metric
  - Quick check question: Given two probability measures on R with p-th moments finite, what does it mean for them to be close in Wp metric?

- Concept: Echo state property (deterministic and stochastic)
  - Why needed here: The paper generalizes the deterministic echo state property to a stochastic setting, which is central to the main theorem
  - Quick check question: In the deterministic case, what property must the state map f have for the echo state property to hold?

- Concept: Causal filters and Bernoulli shifts
  - Why needed here: The paper restricts to inputs that are stochastic outputs of state-space systems, which are causal Bernoulli shifts
  - Quick check question: What does it mean for a stochastic process to be a causal Bernoulli shift?

## Architecture Onboarding

- Component map: Hidden state Z → Input U via Ug → State evolution X via f → Output process via readout
- Critical path: Hidden inputs Z → Input process U → State evolution X → Output process
  - The key is establishing the stochastic echo state property along this path
- Design tradeoffs:
  - Using Wasserstein metric enables stronger continuity results but requires finite moment conditions
  - Restricting to causal Bernoulli shift inputs simplifies the analysis but limits generality
  - The contractivity condition is weaker than deterministic case but requires careful verification
- Failure signatures:
  - If marginals of hidden inputs are not κ-contractive, the stochastic echo state property fails
  - If boundedness conditions on f are violated, the output measure may not exist in the required spaces
  - If the topology on X is too fine, the state map may not be continuous
- First 3 experiments:
  1. Verify the stochastic echo state property for a simple GARCH model with known contractivity parameters
  2. Test the continuity of the output measure with respect to input measure perturbations in Wasserstein metric
  3. Implement the echo state network example and verify the weaker contractivity conditions compared to deterministic case

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the stochastic echo state property framework be extended to more general classes of input processes beyond those arising from state-space systems?
- Basis in paper: The authors note in Appendix A that more general inputs of the form U = V(Z) where V is a causal filter (not necessarily from a state-space system) could be considered, and that their main result continues to hold for such inputs.
- Why unresolved: While mentioned, this generalization is not explored in detail or proven in the main body of the paper.
- What evidence would resolve it: A rigorous proof extending Theorem 9 to handle arbitrary causal filters V, along with examples demonstrating the broader applicability.

### Open Question 2
- Question: What are the universality properties of state-space systems as process-generating mechanisms?
- Basis in paper: The authors mention in the conclusion that a related question to the input/output universality results in [11] is whether state-space systems can approximate arbitrary causal and stationary processes in Wasserstein spaces.
- Why unresolved: This is explicitly stated as an open problem and subject of ongoing work by the authors.
- What evidence would resolve it: A proof showing that certain families of state-space systems (like echo state networks or state-affine systems) are dense in the space of all causal and stationary processes under the Wasserstein metric.

### Open Question 3
- Question: Can the integrability conditions required for the stochastic echo state property be relaxed or made easier to verify in practice?
- Basis in paper: The authors note in the conclusion that the Lp-integrability properties imposed in [11] are difficult to verify in practice, and suggest that their stochastic setup might allow for weaker conditions.
- Why unresolved: The paper focuses on establishing the existence of stochastic solutions under certain conditions, but doesn't explore whether these conditions can be significantly weakened or simplified.
- What evidence would resolve it: Development of alternative sufficient conditions for the stochastic echo state property that are easier to check, along with examples where these conditions hold but the original ones do not.

## Limitations
- The framework requires restrictive assumptions that input processes must be stochastic outputs of other state-space systems (causal Bernoulli shifts)
- Contractivity conditions (κ-boundedness and κ-contractivity) may be difficult to verify in practice for complex systems
- The framework relies heavily on existence of sufficient finite moments for Wasserstein continuity results, which may not hold in heavy-tailed applications

## Confidence
- High confidence: The theoretical framework for establishing the stochastic echo state property is sound, supported by rigorous mathematical proofs in the paper
- Medium confidence: The practical applicability of the weaker contractivity conditions compared to deterministic cases requires empirical validation
- Low confidence: The generalizability beyond causal Bernoulli shift inputs remains uncertain without extending the theoretical framework

## Next Checks
1. **Verification of Contractivity**: For a concrete example like a GARCH(1,1) model, explicitly verify that the contractivity conditions (κ-boundedness and κ-contractivity) hold by computing the relevant norms and constants from the model parameters.

2. **Wasserstein Continuity Test**: Implement a numerical experiment where an input measure is perturbed and track how the output measure changes in W₁ distance, comparing the observed continuity to the theoretical Lipschitz bounds.

3. **Echo State Network Comparison**: Implement the echo state network example from the paper and compare the contractivity constants required for the stochastic echo state property versus those needed for the deterministic echo state property in the same network architecture.