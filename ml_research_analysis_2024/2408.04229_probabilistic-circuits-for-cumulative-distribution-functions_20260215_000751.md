---
ver: rpa2
title: Probabilistic Circuits for Cumulative Distribution Functions
arxiv_id: '2408.04229'
source_url: https://arxiv.org/abs/2408.04229
tags:
- variables
- circuit
- computing
- polynomial
- distribution
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper explores the relationship between probabilistic circuits
  (PCs) that compute cumulative distribution functions (CDFs) and those that compute
  probability mass/density functions (PMFs/PDFs). The key finding is that for binary
  random variables, CDF polynomials are exactly equivalent to probability generating
  functions (PGFs), enabling efficient transformation between PMF and CDF computing
  circuits in polynomial time.
---

# Probabilistic Circuits for Cumulative Distribution Functions

## Quick Facts
- arXiv ID: 2408.04229
- Source URL: https://arxiv.org/abs/2408.04229
- Reference count: 13
- Key finding: CDF and PMF/PDF computing probabilistic circuits are equally succinct models for binary, finite discrete, and continuous variables under specific conditions.

## Executive Summary
This paper establishes that cumulative distribution functions (CDFs) and probability mass/density functions (PMFs/PDFs) are equally succinct representations when computed by probabilistic circuits (PCs). The authors show that for binary random variables, CDF polynomials are exactly equivalent to probability generating functions (PGFs), enabling efficient transformation between PMF and CDF computing circuits in polynomial time. For finite discrete variables, a novel Less-Than Encoding scheme respects the necessary order relationships, allowing similar transformations. In the continuous case, smooth decomposable PCs can be transformed between PDFs and CDFs by modifying only the leaves. These results significantly expand the range of tractable probabilistic models and inference tasks that can be expressed using PCs.

## Method Summary
The paper develops transformation techniques between CDF and PMF/PDF computing probabilistic circuits across three variable types. For binary variables, it leverages the equivalence between CDF polynomials and PGFs. For finite discrete variables, it introduces the Less-Than Encoding that preserves the elementwise order relationship. For continuous variables, it exploits the structural properties of smooth and decomposable PCs to push integration and differentiation operations to the leaves. Each transformation is proven to be computable in polynomial time while preserving circuit size and the underlying distribution.

## Key Results
- Binary random variables: CDF polynomials are exactly equivalent to PGFs, enabling polynomial-time transformation between PMF and CDF circuits
- Finite discrete variables: Less-Than Encoding preserves order relationships, allowing transformation between CDF and PMF circuits
- Continuous variables: Smooth, decomposable PCs can transform between PDF and CDF representations by modifying only the leaves
- Overall: CDFs and PMFs/PDFs are equally succinct probabilistic models in all three settings studied

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Probabilistic circuits computing CDF polynomials for binary variables are exactly equivalent to PGFs, enabling polynomial-time transformation to PMF-computing circuits.
- Mechanism: The CDF polynomial c(x) = Σ_{y≤x} p(y) simplifies to the PGF g(x) = Σ_{S⊆[n]} f(v_S)∏_{i∈S} x_i because the sum over all y ≤ x collapses to the sum over all y ≤ 1^n (the all-ones vector), which equals the original PGF.
- Core assumption: The equivalence holds specifically for binary variables where the characteristic vector representation maps sets to binary assignments naturally.
- Evidence anchors:
  - [abstract] "We show that for distributions over binary random variables these representations (PMF and CDF) are essentially equivalent, in the sense that one can be transformed to the other in polynomial time."
  - [section] "Proposition 1. Fix a probability distribution over binary random variables X1, ..., Xn taking values {0, 1} ⊂ R with CDF polynomial c and PGF g. Then c = g."
- Break condition: This mechanism fails when variables are not binary, as the characteristic vector representation no longer preserves the ≤ relationship needed for the sum transformation.

### Mechanism 2
- Claim: For finite discrete variables encoded with the Less-Than Encoding, CDFs and PMFs remain equivalent up to the encoding transformation.
- Mechanism: The Less-Than Encoding LT_k(x) = [1_x, 0_{k-x}] respects the elementwise ≤ relationship such that x ≤ y if and only if LT_k(x) ≤ LT_k(y), allowing the CDF sum to be preserved through the encoding.
- Core assumption: The encoding must preserve the order structure of the original finite discrete space.
- Evidence anchors:
  - [section] "We observe that there is a simple alternative encoding of finite discrete variables with binary variables that does respect the elementwise less-than-or-equal-to relation."
  - [section] "Note that the Less-Than Encoding respects the less-than-or-equal-to relation in the sense that for any x, y ∈ {0, 1, ..., k-1}, x ≤ y if and only if LT_k(x) ≤ LT_k(y)."
- Break condition: This encoding breaks when the original discrete values don't have a natural order, or when using encodings like one-hot that don't preserve the ≤ relationship.

### Mechanism 3
- Claim: For continuous variables, smooth and decomposable PCs can transform between PDFs and CDFs by modifying only the leaves.
- Mechanism: The structural properties of smoothness and decomposability allow pushing integration operations to the leaves (for CDF) and partial derivatives through the circuit (for PDF) without changing the overall circuit structure.
- Core assumption: The PC must be both smooth and decomposable to enable these operations.
- Evidence anchors:
  - [abstract] "In the continuous case, smooth, decomposable PCs can be transformed between PDFs and CDFs by modifying only the leaves."
  - [section] "Proposition 2. A smooth, decomposable PC of size s computing the PDF f can be transformed to a smooth, decomposable PC of size s computing the CDF F."
- Break condition: This mechanism fails if the circuit lacks smoothness or decomposability, as the operations cannot be pushed through the structure.

## Foundational Learning

- Concept: Multilinear polynomials and their circuit representations
  - Why needed here: The paper relies on understanding that PCs compute multilinear polynomials that represent probability distributions, and the transformations between PMF, CDF, and PGF rely on polynomial manipulations.
  - Quick check question: What makes a polynomial "multilinear" and why is this property important for the transformations described?

- Concept: Cumulative distribution functions and their relationship to probability mass/density functions
  - Why needed here: The core contribution is establishing equivalence between circuits computing CDFs versus PMFs/PDFs, which requires understanding the mathematical relationship between these function types.
  - Quick check question: How does the CDF mathematically relate to the PMF for discrete variables, and what integral relationship exists for continuous variables?

- Concept: Network polynomials and probability generating functions
  - Why needed here: The paper connects CDF polynomials to PGFs, which is a crucial insight for the binary case transformation. Understanding PGFs is essential for grasping the equivalence.
  - Quick check question: What is the standard definition of a probability generating function for discrete random variables?

## Architecture Onboarding

- Component map: Binary Case → Finite Discrete Case → Continuous Case → Transformation Module
- Critical path: Input → Variable type detection → Select appropriate transformation module → Apply encoding (if needed) → Transform circuit representation → Output equivalent circuit
- Design tradeoffs: Binary case offers exact equivalence but limited applicability; finite discrete requires careful encoding choices; continuous requires structural constraints (smoothness, decomposability) that may limit expressiveness.
- Failure signatures: Wrong encoding choice leads to non-equivalent CDFs; missing structural properties cause transformation failures; incorrect variable type classification leads to applying wrong transformation.
- First 3 experiments:
  1. Verify the binary case transformation on a simple 2-variable distribution by constructing both PMF and CDF circuits and confirming their equivalence
  2. Test the Less-Than Encoding on a small finite discrete example (e.g., k=3) to verify the ≤ relationship preservation
  3. Apply the continuous transformation to a smooth, decomposable circuit computing a simple PDF and verify the resulting CDF circuit correctness

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the equivalence between CDF and PMF/PDF computing probabilistic circuits be extended to distributions with infinite domains?
- Basis in paper: [inferred] The paper explicitly states this as an open question in the conclusion, noting it remains open for circuit models handling discrete variables over infinite domains.
- Why unresolved: The paper's proofs rely on finite representations and polynomial-time transformations that may not generalize to infinite domains.
- What evidence would resolve it: A proof showing that for distributions over infinite domains (e.g., countably infinite discrete variables), there exists a polynomial-time transformation between CDF and PMF/PDF computing circuits, or a counterexample demonstrating this is impossible.

### Open Question 2
- Question: Can the transformation between CDF and PMF/PDF computing circuits be made more efficient for finite discrete variables using encodings like those in Cao et al. [2023] or Garg et al. [2023]?
- Basis in paper: [explicit] The conclusion mentions this as an open question, specifically asking about more efficient encodings than the less-than encoding.
- Why unresolved: The less-than encoding used in the paper may not be optimal in terms of circuit size or transformation complexity.
- What evidence would resolve it: A demonstration that using more efficient encodings (e.g., bit-blasting or discretization-based encodings) allows for polynomial-time transformations with better complexity bounds than the less-than encoding.

### Open Question 3
- Question: Can the equivalence results be extended to mixed distributions (combinations of discrete and continuous variables)?
- Basis in paper: [inferred] The paper only considers three separate cases (binary, finite discrete, and purely continuous) and does not address mixed distributions.
- Why unresolved: Mixed distributions require handling both summation over discrete variables and integration over continuous ones, which may complicate the transformations.
- What evidence would resolve it: A proof showing that for mixed distributions, CDF and PMF/PDF computing circuits can be transformed to each other in polynomial time, or a counterexample demonstrating this is impossible.

## Limitations
- The continuous case transformation is limited to smooth and decomposable PCs, which may restrict the class of representable distributions
- The Less-Than Encoding for finite discrete variables may lead to high-dimensional representations that impact computational efficiency
- The paper only considers distributions with finite support or continuous domains, leaving open questions for infinite discrete domains

## Confidence
- **High Confidence**: The binary case equivalence (PMF ≡ CDF) - this follows directly from established PGF theory with clear mathematical proofs
- **Medium Confidence**: The finite discrete case transformation - while the encoding is correct, the practical performance and scalability remain untested
- **Medium Confidence**: The continuous case transformation - the theoretical foundation is sound, but the practical limitations of smooth, decomposable circuits are not fully characterized

## Next Checks
1. **Scalability Test**: Implement the finite discrete transformation on larger alphabets (k > 10) to measure computational overhead and verify correctness of the Less-Than Encoding approach
2. **Distribution Coverage**: Systematically evaluate which continuous distributions cannot be represented by smooth, decomposable PCs to quantify the practical limitations of the continuous transformation
3. **Equivalence Verification**: Create automated testing framework that randomly generates binary distributions, computes both PMF and CDF circuits, and verifies their mathematical equivalence across a large sample space