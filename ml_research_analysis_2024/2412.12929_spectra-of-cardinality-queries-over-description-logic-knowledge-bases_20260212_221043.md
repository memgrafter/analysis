---
ver: rpa2
title: Spectra of Cardinality Queries over Description Logic Knowledge Bases
arxiv_id: '2412.12929'
source_url: https://arxiv.org/abs/2412.12929
tags:
- concept
- lemma
- every
- then
- such
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This paper investigates the spectra of counting conjunctive queries\
  \ over Description Logic knowledge bases, focusing on atomic cardinality queries.\
  \ The key challenge is that spectra\u2014sets of possible answer values across all\
  \ models\u2014can be arbitrary subsets of natural numbers with infinity, making\
  \ them hard to represent."
---

# Spectra of Cardinality Queries over Description Logic Knowledge Bases

## Quick Facts
- arXiv ID: 2412.12929
- Source URL: https://arxiv.org/abs/2412.12929
- Authors: Quentin Manière; Marcin Przybyłko
- Reference count: 40
- Primary result: Spectra of atomic cardinality queries over ALCIF ontologies are subsemigroups of (N∞,+), enabling effective representation as finite sets plus periodic intervals

## Executive Summary
This paper investigates the spectra of counting conjunctive queries over Description Logic knowledge bases, focusing on atomic cardinality queries. The key challenge is that spectra—sets of possible answer values across all models—can be arbitrary subsets of natural numbers with infinity, making them hard to represent. The authors identify a class of queries whose spectra are always closed under addition, allowing effective representation as finite sets combined with periodic intervals. For concept cardinality queries over ALCIF ontologies, they prove all subsemigroups of natural numbers containing infinity are realizable, while for sublogics like ALCI and ALCF, spectra have simpler shapes like intervals. The paper also provides a cycle-reversion technique for the Horn fragment ELIF⊥ to handle more complex spectrum shapes. Finally, they analyze the data complexity of computing these representations, establishing FP^NP[log]-completeness for many settings, with some cases solvable in polynomial time.

## Method Summary
The authors employ several key techniques to characterize and compute spectra. For ELIF⊥ ontologies, they use cycle-reversion methods adapted from finite model reasoning to construct models with finite interpretations. For ALCIF and sublogics, they establish that connected, individual-free queries have spectra closed under addition (subsemigroups of N∞). They then develop polynomial-time algorithms using NP oracle calls and binary search to compute effective representations of these spectra. The cycle-reversion technique is refined to handle inverse functional roles and negation, while complexity results are established through reductions to known hard problems in FP^NP[log].

## Key Results
- Spectra of atomic cardinality queries over ALCIF ontologies are exactly the subsemigroups of (N∞,+) containing infinity
- For ALCI and ALCF, spectra have simpler interval shapes [m,∞)
- Cycle-reversion technique enables characterization of spectra for ELIF⊥ ontologies with non-trivial periodic components
- Data complexity of computing effective spectrum representations is FP^NP[log]-complete for most settings, with some cases solvable in polynomial time

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Spectra of atomic cardinality queries over ALCIF ontologies can be effectively represented because they are subsemigroups of (N∞,+).
- Mechanism: The authors identify that for connected and individual-free queries, spectra are closed under addition, meaning every element in the spectrum can be obtained by adding two other elements. This closure property allows spectra to be represented as finite sets combined with periodic intervals, enabling finite and efficiently testable representations.
- Core assumption: The query is connected and individual-free, and the ontology is in ALCIF or a sublogic where spectra retain this closure property.
- Evidence anchors:
  - [abstract]: "Focusing on atomic counting queries, we pinpoint the possible shapes of a spectrum over ALCIF ontologies: they are essentially the subsets of N ∪ { ∞ } closed under addition."
  - [section 2]: "Lemma 2. IfK is anALCIF KB and q a connected and individual-free CCQ, then SpK(q) is closed under addition."
- Break condition: If the query is not connected or individual-free, or if the ontology language is expressive enough to break the closure property (e.g., ALCIF with unrestricted inverse functional roles).

### Mechanism 2
- Claim: The data complexity of computing spectra representations is FP^NP[log]-complete for ALCIF, ALCI, and ALCF ontologies.
- Mechanism: The authors prove that computing the spectrum representation involves solving membership tests and minimality tests that can be reduced to NP oracle queries. Since the number of such queries is logarithmic in the input size (due to binary search), the overall complexity is FP^NP[log].
- Core assumption: The spectrum has the form S ∪ [M,∞) where S is a finite subset of [0,M] and M is bounded by a polynomial in the input size.
- Evidence anchors:
  - [abstract]: "We also study the data complexity of computing the proposed effective representation and establish the FP^NP[log]-completeness of this task under several settings."
  - [section 4]: "Theorem 6. Spectrum(qC,T ) is in: • FP^NP[log] ifT is inELIF ⊥ ,ALCI orALCF ."
- Break condition: If the spectrum shape is more complex than S ∪ [M,∞), or if the polynomial bound on M is not achievable.

### Mechanism 3
- Claim: The cycle-reversion technique allows characterizing spectra for ELIF⊥ ontologies, which can have non-trivial periodic components.
- Mechanism: The authors refine cycle-reversion techniques from finite model reasoning to characterize when a concept can have a finite interpretation. This involves identifying C-generating cycles and reversing them to obtain a TBox TC that preserves the property of having a finite interpretation. This technique allows proving that spectra for ELIF⊥ have shape {∞}, {0,∞}, or S ∪ [M,∞) with S ⊆ [0,M].
- Core assumption: The TBox is in normal form and the concept is safe (every axiom in TC is entailed by T).
- Evidence anchors:
  - [section 3.2]: "We now turn to the two remaining DLs, namelyELIF ⊥ and DL-LiteF , in which inverse functional roles and negation are supported... We notably use variations of the cycle-reversion techniques..."
  - [section 3.2]: "Lemma 3. Let (T,A) be anELIF ⊥ KB and C a concept name. There exists a modelI ofK s.t. |CI|<∞ iff the KB (TC,A) is satisﬁable."
- Break condition: If the TBox is not in normal form or if the concept is not safe, the cycle-reversion technique may not apply.

## Foundational Learning

- Concept: Description Logic and its fragments (ALC, ALCI, ALCF, EL, etc.)
  - Why needed here: The paper investigates spectra of cardinality queries over ontologies expressed in various Description Logics. Understanding the syntax and semantics of these logics is crucial for grasping the results.
  - Quick check question: What is the difference between ALC and ALCI, and how does adding inverse roles affect the expressivity of the logic?

- Concept: Conjunctive queries and counting conjunctive queries (CCQs)
  - Why needed here: The paper focuses on counting queries, which are conjunctive queries with designated counting variables. Understanding the semantics of CCQs is essential for understanding the notion of spectra.
  - Quick check question: How does the answer to a CCQ in a model of a knowledge base differ from the answer to a regular conjunctive query?

- Concept: Finite model reasoning and cycle-reversion techniques
  - Why needed here: The authors use cycle-reversion techniques to characterize spectra for ELIF⊥ ontologies. Understanding these techniques is crucial for grasping the proof of Theorem 4.
  - Quick check question: What is the purpose of reversing C-generating cycles in the context of finite model reasoning?

## Architecture Onboarding

- Component map: TBox (terminological axioms) -> ABox (assertions about individuals) -> Query (Boolean atomic CCQ) -> Spectrum (set of possible answers) -> Representation (finite set + periodic interval) -> Complexity class (FP^NP[log])

- Critical path:
  1. Parse the input KB and query
  2. Determine the spectrum shape based on the ontology language and query properties
  3. Compute the effective representation using the appropriate algorithm (e.g., binary search for ALCIF)
  4. Return the representation

- Design tradeoffs:
  - Expressiveness vs. tractability: More expressive ontology languages (e.g., ALCIF) allow for more complex spectrum shapes but increase the computational complexity of computing the representation
  - Connectedness and individual-freeness: Restricting queries to be connected and individual-free ensures that spectra have nice closure properties, but may limit the applicability of the results

- Failure signatures:
  - If the query is not connected or individual-free, the spectrum may not be closed under addition, and the effective representation may not be achievable
  - If the ontology language is too expressive (e.g., ALCIF with unrestricted inverse functional roles), the spectrum shape may be more complex than S ∪ [M,∞), and the FP^NP[log]-completeness result may not hold

- First 3 experiments:
  1. Implement the algorithm for computing spectra representations for ALCIF ontologies and test it on simple examples
  2. Verify the FP^NP[log]-completeness result by reducing a known FP^NP[log]-hard problem to spectrum computation
  3. Experiment with the cycle-reversion technique on ELIF⊥ ontologies to characterize spectra with non-trivial periodic components

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can an effective representation for the spectrum of a cardinality query over an ALCIF KB be computed in polynomial time?
- Basis in paper: [explicit] The paper states that while the possible shapes of spectra for ALCIF KBs are fully characterized, it remains an open question whether an effective representation can be computed.
- Why unresolved: The data complexity is only established as FP^NP[log]-complete for many cases, and the general case remains open.
- What evidence would resolve it: A polynomial-time algorithm that computes the effective representation for any ALCIF KB and cardinality query, or a proof that such an algorithm cannot exist.

### Open Question 2
- Question: Is the FP^NP[log]-hardness result for computing spectra over DL-Lite F KBs tight, or can the complexity be improved to P?
- Basis in paper: [inferred] The paper conjectures FP-membership for DL-Lite F KBs, noting that NP oracles might be replaced by direct polynomial-time checks.
- Why unresolved: The upper bound is only FP^NP[log], and the authors suggest this might not be necessary.
- What evidence would resolve it: A polynomial-time algorithm for computing spectra over DL-Lite F KBs, or a proof that the problem remains FP^NP[log]-complete.

### Open Question 3
- Question: How do the results on spectra of cardinality queries impact the complexity of answering queries under bag semantics?
- Basis in paper: [explicit] The conclusion mentions that considerations regarding spectra might be adapted to the bag semantics setting.
- Why unresolved: The relationship between spectra and bag semantics is not explored in detail.
- What evidence would resolve it: A formal analysis showing how spectrum computation techniques can be adapted to bag semantics, or a proof that such adaptation is not possible.

## Limitations

- The characterization of spectra as subsemigroups applies only to connected, individual-free queries, limiting practical applicability
- While all subsemigroups containing infinity are realizable in ALCIF, characterization of realizable spectra in sublogics like ALCI and ALCF remains open
- The cycle-reversion technique for ELIF⊥ requires TBoxes in normal form and safe concepts, restricting its applicability

## Confidence

- High: Spectrum shapes for ALCI and ALCF (intervals), FP^NP[log]-completeness results for connected individual-free queries
- Medium: Subsemigroup characterization for ALCIF, cycle-reversion technique for ELIF⊥
- Low: Practical applicability to non-connected queries, characterization of realizable spectra in sublogics

## Next Checks

1. **Empirical validation of cycle-reversion**: Implement the cycle-reversion technique on a suite of ELIF⊥ TBoxes with varying cycle structures to verify that the constructed models indeed have the claimed finite interpretation properties, particularly focusing on edge cases where multiple C-generating cycles interact.

2. **Complexity bounds verification**: For the binary search algorithm computing min(SpK(qC)), empirically measure the actual number of NP oracle calls needed across different ALCIF ontologies to verify that the logarithmic bound holds in practice and that the polynomial bounds from Lemma 7 are tight.

3. **Sublogic spectrum completeness**: Systematically test whether all interval-shaped spectra can be realized in ALCI and ALCF by attempting to construct knowledge bases for each possible interval [m,∞), verifying both the lower bound and the absence of smaller values in the spectrum.