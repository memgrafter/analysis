---
ver: rpa2
title: Leveraging Intra-Period and Inter-Period Features for Enhanced Passenger Flow
  Prediction of Subway Stations
arxiv_id: '2410.14727'
source_url: https://arxiv.org/abs/2410.14727
tags:
- flow
- passenger
- data
- time
- prediction
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a novel approach for short-term passenger
  flow prediction in subway stations. The method addresses the challenge of integrating
  intra-period and inter-period features by transforming one-dimensional time series
  data into two-dimensional matrices based on periods.
---

# Leveraging Intra-Period and Inter-Period Features for Enhanced Passenger Flow Prediction of Subway Stations

## Quick Facts
- arXiv ID: 2410.14727
- Source URL: https://arxiv.org/abs/2410.14727
- Authors: Xiannan Huang; Chao Yang; Quan Yuan
- Reference count: 40
- Primary result: Novel MPSTN model achieves state-of-the-art passenger flow prediction performance using CNN-GNN architecture for spatiotemporal feature extraction

## Executive Summary
This paper introduces a novel approach for short-term passenger flow prediction in subway stations by addressing the challenge of integrating intra-period and inter-period features. The method transforms one-dimensional time series data into two-dimensional matrices based on periods, enabling convolutional neural networks to capture both temporal and spatial dependencies. The proposed Multi Period Spatial Temporal Network (MPSTN) combines CNN and graph neural network modules to extract spatiotemporal features from passenger flow data. Experiments on Shanghai subway data demonstrate significant improvements over existing methods, particularly for longer-term predictions.

## Method Summary
The proposed method addresses the challenge of integrating intra-period and inter-period features in passenger flow prediction by transforming one-dimensional time series data into two-dimensional matrices based on periods. This transformation enables the application of convolutional neural networks to capture both temporal and spatial dependencies within the data. The MPSTN model consists of two main components: a CNN module for temporal feature extraction and a graph neural network module for spatial information integration. The CNN processes the period-based matrices to extract temporal patterns, while the GNN captures spatial relationships between different subway stations. The model is trained on a dataset from Shanghai subway system and evaluated against existing prediction methods.

## Key Results
- MPSTN achieves state-of-the-art performance with consistently lower MAE and RMSE metrics compared to existing methods
- The model demonstrates particular strength in longer-term predictions, maintaining accuracy even for 60-minute forecasts
- Ablation studies confirm the contribution of both CNN and GNN components to overall performance

## Why This Works (Mechanism)
The method works by addressing the fundamental challenge of integrating intra-period and inter-period features in passenger flow prediction. By transforming time series data into period-based matrices, the model can leverage the spatial convolution capabilities of CNNs to capture both temporal patterns within each period and inter-period dependencies. The subsequent graph neural network component then integrates spatial information across different subway stations, creating a comprehensive spatiotemporal feature representation. This dual approach allows the model to capture the complex, multi-scale patterns inherent in passenger flow dynamics.

## Foundational Learning
- **Period-based matrix transformation**: Converting 1D time series into 2D matrices by grouping data into periods, enabling spatial convolution operations to capture temporal dependencies.
  - Why needed: Standard 1D convolutions are insufficient for capturing complex intra-period and inter-period patterns in passenger flow data.
  - Quick check: Verify that period selection preserves meaningful temporal patterns while enabling effective matrix operations.

- **CNN-GNN hybrid architecture**: Combining convolutional neural networks for temporal feature extraction with graph neural networks for spatial integration.
  - Why needed: Passenger flow exhibits both temporal dependencies within stations and spatial relationships between stations.
  - Quick check: Ensure the graph structure accurately represents real-world station connectivity and passenger movement patterns.

- **Spatiotemporal feature extraction**: The process of simultaneously capturing temporal patterns within each period and spatial relationships between stations.
  - Why needed: Accurate passenger flow prediction requires understanding both how flow changes over time at individual stations and how it propagates across the network.
  - Quick check: Validate that extracted features improve prediction accuracy compared to temporal-only or spatial-only approaches.

## Architecture Onboarding

**Component map:** Raw passenger flow data -> Period-based matrix transformation -> CNN module (temporal features) -> GNN module (spatial integration) -> Prediction output

**Critical path:** Period transformation → CNN temporal feature extraction → GNN spatial integration → Prediction layer

**Design tradeoffs:** The period-based matrix transformation enables effective CNN application but requires careful period selection to balance temporal resolution with computational efficiency. The hybrid CNN-GNN architecture captures comprehensive spatiotemporal features but increases model complexity and training requirements.

**Failure signatures:** Poor period selection may lead to loss of important temporal patterns or excessive noise in the transformed matrices. Inadequate graph structure may fail to capture true spatial relationships between stations. Both issues manifest as degraded prediction accuracy, particularly for longer forecast horizons.

**3 first experiments:**
1. Vary period length (e.g., 15min, 30min, 60min) to determine optimal temporal resolution for different prediction horizons
2. Test different graph construction methods (distance-based, transfer-based, hybrid) to identify most effective spatial relationship representation
3. Compare prediction performance across different time of day periods (peak vs. off-peak) to understand model behavior under varying passenger flow dynamics

## Open Questions the Paper Calls Out
None

## Limitations
- The approach's generalizability to datasets with different temporal patterns or irregular sampling rates is unclear
- The model's handling of missing data or anomalies in real-world operational conditions is not addressed
- Claims of state-of-the-art performance are based on a single dataset from Shanghai, potentially limiting broader applicability

## Confidence
- **High**: The methodological framework combining CNN and GNN modules for spatiotemporal feature extraction is well-established and technically sound
- **Medium**: The experimental results showing improved performance metrics are credible but limited to one dataset
- **Low**: Claims about generalizability to other cities and operational robustness lack supporting evidence

## Next Checks
1. Test the model on multiple subway datasets from different cities to assess generalizability across varying passenger flow patterns and urban characteristics
2. Conduct experiments with synthetic missing data scenarios to evaluate the model's robustness to incomplete or noisy input
3. Measure inference time and computational resource requirements to determine real-time deployment feasibility and compare with existing operational systems