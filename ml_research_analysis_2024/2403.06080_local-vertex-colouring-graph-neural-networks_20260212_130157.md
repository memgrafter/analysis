---
ver: rpa2
title: Local Vertex Colouring Graph Neural Networks
arxiv_id: '2403.06080'
source_url: https://arxiv.org/abs/2403.06080
tags:
- vertex
- graph
- latexit
- vertices
- back
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes a new vertex colouring scheme, Local Vertex
  Colouring (LVC), based on graph search algorithms, which extends the expressiveness
  of Graph Neural Networks (GNNs) beyond the Weisfeiler-Lehman (1-WL) test. LVC leverages
  breadth-first search (BFS) and depth-first search (DFS) to propagate vertex information
  along search trees, capturing graph properties like biconnectivity, cycles, and
  cut vertices that 1-WL and standard GNNs cannot distinguish.
---

# Local Vertex Colouring Graph Neural Networks

## Quick Facts
- arXiv ID: 2403.06080
- Source URL: https://arxiv.org/abs/2403.06080
- Authors: Shouheng Li; Dongwoo Kim; Qing Wang
- Reference count: 40
- Key outcome: Proposes Local Vertex Colouring (LVC) that extends GNN expressiveness beyond 1-WL test by using graph search algorithms to capture structural properties like biconnectivity and cycles

## Executive Summary
This paper introduces Local Vertex Colouring (LVC), a novel graph representation learning framework that leverages graph search algorithms (BFS and DFS) to extend the expressiveness of Graph Neural Networks beyond the Weisfeiler-Lehman (1-WL) test. By propagating vertex information along search trees and selectively including back edges, LVC can capture graph properties like biconnectivity, cycles, and cut vertices that standard GNNs cannot distinguish. The authors demonstrate that LVC's expressiveness increases with the search radius, and they propose Search-guided Graph Neural Network (SGN) that inherits these properties while being practically implementable with MLPs.

## Method Summary
The method proposes Local Vertex Colouring (LVC) as a graph representation learning framework that uses graph search algorithms to extend GNN expressiveness. BFC (Breadth-First Colouring) uses BFS to propagate vertex colours along shortest-path tree edges, preserving shortest-path structure information. DFC (Depth-First Colouring) uses DFS to capture biconnectivity and cycle information by including vertices covered by transitively crossovered back edges. The Search-guided Graph Neural Network (SGN) architecture replaces LVC's injective functions with MLPs while preserving the search-guided propagation structure. The framework is evaluated on vertex and graph classification tasks using standard benchmark datasets.

## Key Results
- SGN with BFS/DFS guidance outperforms standard GNNs on vertex and graph classification benchmarks
- BFC can learn to distinguish ego shortest-path graphs that 1-WL cannot
- DFC can detect biconnectivity and articulation points that 1-WL misses
- Expressiveness of LVC increases hierarchically with search radius δ

## Why This Works (Mechanism)

### Mechanism 1: BFC Extends 1-WL Expressiveness
BFC uses BFS to propagate vertex colours along shortest-path tree edges while selectively including back edges that connect vertices at different BFS levels. This preserves shortest-path structure information that 1-WL cannot capture. The permutation invariant ηbfc function ensures consistent colouring regardless of vertex visiting order.

### Mechanism 2: DFC Captures Biconnectivity
DFC uses DFS to propagate colours along tree edges and includes vertices covered by transitively crossovered back edges. This mechanism captures articulation points and biconnected components by tracking how back edges relate to the DFS tree structure, enabling detection of cut vertices that 1-WL cannot identify.

### Mechanism 3: SGN Inherits LVC Properties
SGN replaces LVC's injective functions with MLPs and summations while maintaining the search-guided propagation structure. The architecture preserves the expressiveness properties of LVC through its update rules, allowing practical implementation while retaining theoretical guarantees about distinguishing non-isomorphic graphs.

## Foundational Learning

- Graph isomorphism and Weisfeiler-Lehman (WL) test: Understanding why standard GNNs are limited by 1-WL expressiveness is crucial for appreciating LVC's contribution. Quick check: Can you explain in one sentence why two vertices with identical 1-hop neighborhoods cannot be distinguished by standard GNNs?

- Breadth-First Search (BFS) and Depth-First Search (DFS) tree properties: LVC's mechanisms rely on understanding how BFS and DFS categorize edges into tree edges and back edges. Quick check: What is the key difference between how BFS and DFS classify back edges in terms of vertex levels or ancestor relationships?

- Graph biconnectivity and articulation points: DFC's ability to detect biconnectivity is one of its key distinguishing features from 1-WL. Quick check: Can you define what makes a vertex a cut vertex (articulation point) in graph theory terms?

## Architecture Onboarding

- Component map: Input graph -> Graph search (BFS/DFS) -> Vertex colour refinement -> Embeddings -> Output
- Critical path:
  1. Perform graph search (BFS or DFS) from each vertex to construct search trees
  2. Compute η function to determine which vertices contribute to each vertex's colour
  3. Iteratively refine vertex colours using Equations 1 and 2
  4. For SGN, replace colour refinement with MLP-based embedding updates
- Design tradeoffs:
  - BFS (BFC) vs DFS (DFC): BFS better for shortest-path properties, DFS better for biconnectivity detection
  - δ parameter: Larger