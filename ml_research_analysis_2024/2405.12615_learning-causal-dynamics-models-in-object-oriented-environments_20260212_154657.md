---
ver: rpa2
title: Learning Causal Dynamics Models in Object-Oriented Environments
arxiv_id: '2405.12615'
source_url: https://arxiv.org/abs/2405.12615
tags:
- causal
- dynamics
- learning
- environments
- oocdm
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes Object-Oriented Causal Dynamics Models (OOCDMs)
  for large-scale environments by sharing causalities and parameters among objects
  of the same class. The key innovation is the Object-Oriented Causal Graph (OOCG)
  structure, which enables class-level causal sharing while maintaining computational
  efficiency.
---

# Learning Causal Dynamics Models in Object-Oriented Environments

## Quick Facts
- arXiv ID: 2405.12615
- Source URL: https://arxiv.org/abs/2405.12615
- Reference count: 40
- Key outcome: OOCDM achieves 100% causal discovery accuracy vs 94-99% for existing CDMs, with 2-3 orders of magnitude faster computation in large-scale environments

## Executive Summary
This paper introduces Object-Oriented Causal Dynamics Models (OOCDMs) to extend causal dynamics models to large-scale object-oriented environments. The key innovation is the Object-Oriented Causal Graph (OOCG) structure that enables class-level parameter sharing while maintaining computational efficiency. By sharing causalities and parameters among objects of the same class, OOCDM dramatically reduces computational complexity from O(n³) to O(nmN k) while achieving perfect causal discovery accuracy in benchmark environments. The method demonstrates superior generalization to unseen states and tasks compared to existing approaches.

## Method Summary
OOCDM extends causal dynamics models to object-oriented environments by learning shared predictors for each state field that apply to all objects of a given class. The approach uses an Object-Oriented Causal Graph (OOCG) structure where class-level causalities are discovered through conditional mutual information tests. The model employs key-value attention mechanisms to enforce causation symmetry while handling varying numbers of objects. Model learning alternates between causal discovery and predictor optimization using a weighted maximum likelihood loss function.

## Key Results
- Causal discovery accuracy: 100% vs 94-99% for existing CDMs in Block environments
- Computational efficiency: 2-3 orders of magnitude faster causal discovery
- Prediction accuracy: Significant improvement over baselines in all tested environments
- Zero-shot transfer: Successfully generalizes to unseen states and tasks

## Why This Works (Mechanism)

### Mechanism 1
Class-level parameter sharing reduces the number of predictors from O(n) to O(m), exploiting result symmetry assumption that objects of the same class share transition functions.

### Mechanism 2
Class-level causal discovery reduces computational complexity from O(n³) to O(nmN k) by testing O(mN) class-level causalities instead of O(n²) pairwise edges.

### Mechanism 3
Key-value attention mechanism enforces causation symmetry while enabling flexible handling of varying object numbers through adaptive masking.

## Foundational Learning

- Concept: Structural Causal Models (SCMs)
  - Why needed here: OOCDM is built on SCM foundations - it learns causal graphs that represent structural equations for object transitions
  - Quick check question: What distinguishes an SCM from a general Bayesian Network?

- Concept: d-separation and conditional independence
  - Why needed here: Causal discovery relies on testing conditional independence to identify parent sets in the causal graph
  - Quick check question: How does d-separation in a DAG relate to conditional independence in the corresponding probability distribution?

- Concept: Factored MDPs and dynamic Bayesian networks
  - Why needed here: OOCDM extends CDMs for FMDPs - understanding the FMDP structure is essential for grasping why OOCDM works
  - Quick check question: What is the key assumption about state variable transitions in an FMDP that enables the bipartite causal graph structure?

## Architecture Onboarding

- Component map:
  - OOMDP Parser -> Attribute Encoders -> Class-level Predictors (with key-value attention) -> Causal Discovery Module -> Model Learning Loop

- Critical path:
  1. Parse OOMDP representation from environment
  2. Initialize shared predictors for each state field
  3. Estimate conditional mutual information for each candidate causality
  4. Build Object-Oriented Causal Graph from significant CMI values
  5. Optimize predictors using combined loss (AILL + causality regularization)
  6. Use learned model for prediction or planning

- Design tradeoffs:
  - Class granularity vs model capacity: Finer class distinctions allow more specific dynamics but reduce parameter sharing
  - Causality strictness vs robustness: Strict adherence to symmetries enables efficiency but may fail on imperfect OOMDPs
  - Attention complexity vs expressivity: Full attention captures complex dependencies but increases computation

- Failure signatures:
  - Poor generalization on o.o.d. data: Indicates learned causal graph contains spurious edges
  - High variance in predictions: Suggests insufficient data for reliable independence tests
  - Slow causal discovery: May indicate too many candidate causalities or weak independence signals

- First 3 experiments:
  1. Block environment with 2 objects: Verify causal discovery accuracy and computational speedup
  2. Block environment with 5+ objects: Test scalability and parameter sharing benefits
  3. Mouse environment with varying food/monster counts: Validate zero-shot transfer capability

## Open Questions the Paper Calls Out

### Open Question 1
How can object-oriented representations be learned automatically from raw pixel observations while maintaining the necessary symmetries? The authors acknowledge this as future work, noting that extracting OOP-style representations remains an open problem, especially when causation symmetry needs to be satisfied.

### Open Question 2
How can the OOCDM framework be extended to handle environments with confounders, partial observability, or non-Markovian dynamics? The authors mention this as a weakness, suggesting exploring these directions using more rigorous tools of causality in the future.

### Open Question 3
What is the optimal balance between model complexity and causal structure sparsity in OOCDMs for different types of environments? The paper demonstrates that effectiveness depends on environmental characteristics but doesn't provide systematic methods for determining this trade-off.

## Limitations

- Heavy reliance on the assumption that environments conform to Object-Oriented MDP structure with result symmetry among objects
- Cannot recover correct causal graph when ground-truth is not an OOCG
- Requires sufficient sample size for reliable conditional independence testing

## Confidence

*High Confidence* (experimental evidence and theoretical backing):
- Significant computational speedup (2-3 orders of magnitude) in causal discovery
- Perfect causal discovery accuracy (100%) in Block environments
- Parameter sharing enables better sample efficiency

*Medium Confidence* (limited experimental scope):
- Zero-shot transfer capability to unseen states and tasks (tested in 1-2 environments)
- Generalization to larger object counts without retraining (based on scaling experiments in controlled environments)

*Low Confidence* (largely theoretical):
- Assumption that real-world environments naturally conform to OOCG structures
- Robustness to noisy or imperfect OOMDP representations in practical applications

## Next Checks

1. **Robustness testing**: Evaluate OOCDM performance when result symmetry assumption is violated to quantify limitations in non-ideal scenarios.

2. **Sample efficiency analysis**: Systematically vary training data quantity to determine minimum sample requirements and identify failure thresholds.

3. **Real-world applicability assessment**: Apply OOCDM to complex physical simulation (e.g., robotic manipulation) to evaluate performance beyond synthetic benchmarks and test OOCG assumption in practical settings.