---
ver: rpa2
title: 'Advancing Diffusion Models: Alias-Free Resampling and Enhanced Rotational
  Equivariance'
arxiv_id: '2411.09174'
source_url: https://arxiv.org/abs/2411.09174
tags:
- config
- alias-free
- resampling
- image
- diffusion
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work addresses the issue of aliasing artifacts in diffusion
  models caused by improper resampling operations during upsampling and downsampling.
  The proposed solution integrates alias-free resampling layers into the UNet architecture
  of diffusion models, using anti-aliasing filters based on image processing theory.
---

# Advancing Diffusion Models: Alias-Free Resampling and Enhanced Rotational Equivariance

## Quick Facts
- arXiv ID: 2411.09174
- Source URL: https://arxiv.org/abs/2411.09174
- Authors: Md Fahim Anjum
- Reference count: 15
- One-line primary result: Integrating anti-aliasing filters into diffusion models reduces aliasing artifacts and improves rotational consistency without additional trainable parameters

## Executive Summary
This work addresses aliasing artifacts in diffusion models caused by improper resampling operations during upsampling and downsampling. The author proposes integrating alias-free resampling layers into the UNet architecture using anti-aliasing filters based on image processing theory. The approach improves image quality and rotational consistency without adding extra trainable parameters. Experiments on CIFAR-10, MNIST, and MNIST-M datasets show consistent gains in FID and KID scores, with Config D-1N achieving an 8.7% FID improvement on CIFAR-10 and Config D-2N achieving a 14.1% KID improvement on MNIST-M. Additionally, a modified diffusion process enables user-controlled rotation of generated images without requiring additional training.

## Method Summary
The method integrates alias-free resampling layers into the UNet architecture of diffusion models using anti-aliasing filters based on the Jinc function and Kaiser window. Standard up/downsampling operations are replaced with alias-free versions that apply low-pass filtering before downsampling and after upsampling. Additionally, alias-free resampling is applied around nonlinear operations (GeLU/ReLU) by first upsampling, applying the nonlinearity at higher resolution, then downsampling with anti-aliasing. A modified diffusion process progressively distributes rotation across all time steps rather than applying it at the end, enabling user-controlled rotation without additional training. The approach is evaluated on CIFAR-10, MNIST, and MNIST-M datasets using FID and KID metrics.

## Key Results
- Config D-1N achieves 8.7% FID improvement on CIFAR-10 compared to baseline
- Config D-2N achieves 14.1% KID improvement on MNIST-M compared to baseline
- User-controlled rotation capability demonstrated without additional training
- No additional trainable parameters required for alias-free resampling integration

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** Integrating alias-free resampling layers into the UNet architecture reduces aliasing artifacts during up/downsampling operations.
- **Mechanism:** The alias-free resampling applies a low-pass anti-aliasing filter before downsampling and after upsampling to eliminate high-frequency components that cause aliasing. This preserves fine details and prevents spurious artifacts.
- **Core assumption:** Standard max pooling and bilinear interpolation operations in diffusion models introduce aliasing that degrades image quality, and applying anti-aliasing filters can mitigate this.
- **Evidence anchors:**
  - [abstract] "We hypothesize that the primary cause of this issue is the improper resampling operation that introduces aliasing in the diffusion model"
  - [section 2.1] "Alias-free resampling is a critical signal processing technique for mitigating aliasing in 1D signals and 2D images"
  - [section 3.2] "First, we revise our baseline architecture (Config A) by replacing the up and downsampling layers, which do not guarantee alias-free outputs, with their alias-free versions respectively"
- **Break condition:** If the frequency content of the signal exceeds the Nyquist limit even after anti-aliasing filtering, aliasing artifacts will persist.

### Mechanism 2
- **Claim:** Applying alias-free resampling around nonlinear operations (GeLU/ReLU) prevents high-frequency artifacts introduced by these nonlinearities.
- **Mechanism:** Before applying nonlinearities, the signal is 2× alias-free upsampled to approximate a continuous representation. The nonlinearity is applied at higher resolution, then 2× alias-free downsampling with anti-aliasing filter returns to original sampling rate.
- **Core assumption:** Nonlinear operations like GeLU or ReLU in discrete domain introduce frequencies that cannot be properly represented, causing aliasing.
- **Evidence anchors:**
  - [section 2.2] "Nonlinear operations like GeLU or ReLU in the continuous domain introduce sudden fluctuations causing arbitrarily high frequencies that cannot be represented in the sampled output"
  - [section 3.3] "Next, we shift our attention to the nonlinear components of our baseline architecture (Config. A) and revise it by introducing 2× alias-free upsampling before the nonlinear ReLU or GeLU operations"
- **Break condition:** If the upsampling factor is insufficient to capture the high frequencies introduced by nonlinearities, aliasing will still occur.

### Mechanism 3
- **Claim:** The modified diffusion process with progressive rotation distribution enables user-controlled rotation without additional training.
- **Mechanism:** At each time step, the image is rotated by a small constant angle (ϕ/T), gradually achieving the target rotation by the end of the diffusion process.
- **Core assumption:** Distributing rotation across all time steps rather than applying it at the end allows the model to generate coherent rotated images.
- **Evidence anchors:**
  - [section 3.5] "The core idea is to progressively distribute the target rotation over the time steps... At each time step, the image is rotated by a small, constant angle"
  - [section 5.2] "We conducted an initial evaluation to assess the rotational equivariance of our modified diffusion process... by varying the target rotation angle ϕ from −π/2 to π/2 radians"
- **Break condition:** If the rotation angles are too large at any step, the diffusion process may become unstable or produce distorted outputs.

## Foundational Learning

- **Concept:** Shannon-Nyquist sampling theorem
  - Why needed here: Provides the theoretical foundation for understanding when aliasing occurs and how anti-aliasing filters work
  - Quick check question: What is the minimum sampling rate required to avoid aliasing according to the Shannon-Nyquist theorem?

- **Concept:** Jinc function and anti-aliasing filter design
  - Why needed here: The paper uses a circularly symmetric low-pass filter based on the Jinc function for alias-free resampling
  - Quick check question: How does the Jinc function relate to the 2D circularly symmetric low-pass filter used in the anti-aliasing process?

- **Concept:** Kaiser window function
  - Why needed here: Used to truncate the ideal anti-aliasing filter for practical implementation
  - Quick check question: What parameter controls the trade-off between frequency response and spatial extent in the Kaiser window?

## Architecture Onboarding

- **Component map:** Input image -> Alias-free downsampling -> Convolutional layers with alias-free resampling around nonlinearities -> Self-attention -> Skip connections -> Alias-free upsampling -> Output image

- **Critical path:** Input image → Alias-free downsampling → Convolutional layers with alias-free resampling around nonlinearities → Self-attention → Skip connections → Alias-free upsampling → Output image

- **Design tradeoffs:**
  - Adding alias-free resampling increases computational cost but maintains same number of trainable parameters
  - Kaiser window parameter β controls the trade-off between frequency response quality and filter spatial extent
  - Kernel normalization affects the overall scaling of the output

- **Failure signatures:**
  - Persistent high-frequency artifacts indicate insufficient anti-aliasing filtering
  - Blurry outputs suggest over-aggressive low-pass filtering
  - Inconsistent rotation indicates problems with the progressive rotation distribution

- **First 3 experiments:**
  1. Replace max pooling with alias-free downsampling in a simple UNet on CIFAR-10 and measure FID improvement
  2. Add alias-free resampling around nonlinearities in the baseline model and compare against Config B
  3. Test the modified diffusion process with progressive rotation on a trained model to verify controlled rotation capability

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does alias-free resampling impact the performance of diffusion models when scaled to larger, high-resolution datasets?
- Basis in paper: [explicit] The paper mentions that large-scale training on full high-resolution datasets was not conducted due to limited computational resources, but suggests that the proposed models could achieve even greater performance enhancements in such settings.
- Why unresolved: The study was limited to smaller benchmark datasets (CIFAR-10, MNIST, MNIST-M) and did not explore the effects of alias-free resampling on larger datasets with higher resolution images.
- What evidence would resolve it: Conducting large-scale training on high-resolution datasets (e.g., ImageNet) with alias-free resampling and comparing the results to standard diffusion models would provide evidence of the impact on performance at scale.

### Open Question 2
- Question: How effective are alias-free resampling techniques in improving temporal stability and image coherence across frames in video-generating diffusion models?
- Basis in paper: [explicit] The paper suggests that future work will explore incorporating alias-free resampling into video-generating diffusion models to enhance temporal stability and image coherence.
- Why unresolved: The current study focuses on image synthesis and does not address the application of alias-free resampling to video generation.
- What evidence would resolve it: Implementing alias-free resampling in video-generating diffusion models and evaluating the improvements in temporal stability and coherence across frames would provide evidence of its effectiveness in video synthesis.

### Open Question 3
- Question: What is the optimal configuration of kernel length and cutoff frequency for alias-free resampling across different layers of the UNet architecture in diffusion models?
- Basis in paper: [inferred] The paper mentions that future work will investigate filtering with various kernel lengths and cutoffs across different layers of the UNet to enhance image fidelity and stability during generative tasks.
- Why unresolved: The study kept the filter cutoff and kernel length fixed, and did not explore the effects of varying these parameters across different layers of the UNet.
- What evidence would resolve it: Experimenting with different kernel lengths and cutoff frequencies across various layers of the UNet architecture and evaluating the impact on image fidelity and stability would provide evidence of the optimal configuration.

## Limitations
- Results limited to small-scale datasets (CIFAR-10, MNIST, MNIST-M) without validation on larger, high-resolution datasets
- Computational overhead of alias-free resampling not explicitly quantified or benchmarked
- Rotational consistency evaluation relies primarily on qualitative assessment rather than comprehensive quantitative metrics

## Confidence
- **Medium** for aliasing reduction claims - well-supported by theory but modest empirical improvements
- **High** for user-controlled rotation capability - demonstrates clear effectiveness
- **Medium** for practical deployment - computational costs and optimal parameter tuning require further investigation

## Next Checks
1. **Ablation study on filter parameters**: Systematically vary the Kaiser window parameter β and cutoff frequency ωc to determine optimal settings for diffusion model applications, measuring the trade-off between aliasing reduction and computational cost.

2. **Cross-architecture evaluation**: Test the alias-free resampling approach on alternative generative architectures beyond UNet-based diffusion models (e.g., transformer-based or GAN-based models) to assess generalizability of the technique.

3. **High-resolution extension**: Evaluate the proposed methods on higher resolution datasets (e.g., 128×128 or 256×256 images) to determine scalability and whether aliasing artifacts become more pronounced at larger scales.