---
ver: rpa2
title: Intervention and Conditioning in Causal Bayesian Networks
arxiv_id: '2405.14728'
source_url: https://arxiv.org/abs/2405.14728
tags:
- probability
- causal
- variables
- formula
- formulas
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "The paper addresses the challenge of calculating probabilities\
  \ for interventional formulas in causal Bayesian networks (CBNs). It shows that\
  \ by assuming independence of mechanisms that determine interventions\u2014both\
  \ across different variables and for different parent settings of the same variable\u2014\
  one can uniquely estimate such probabilities, rather than obtaining only bounds."
---

# Intervention and Conditioning in Causal Bayesian Networks

## Quick Facts
- arXiv ID: 2405.14728
- Source URL: https://arxiv.org/abs/2405.14728
- Authors: Sainyam Galhotra; Joseph Y. Halpern
- Reference count: 1
- Primary result: By assuming independence of mechanisms in CBNs, interventional formula probabilities can be uniquely estimated from observational data without experiments.

## Executive Summary
This paper addresses the challenge of calculating probabilities for interventional formulas in causal Bayesian networks (CBNs). Traditional approaches either give only bounds on these probabilities or require experimental data. The authors show that by making simple independence assumptions about the mechanisms determining interventions—both across different variables and for different parent settings of the same variable—one can uniquely estimate such probabilities. This enables the conversion of CBNs into compatible causal models where probabilities of formulas like necessity and sufficiency can be computed from observational data alone, without requiring experiments.

## Method Summary
The approach involves converting a CBN into an i-compatible causal model by adding exogenous variables (response functions) for each endogenous variable with parents. Under the assumption that CPTs for different variables are independent and CPT entries for different parent settings of the same variable are independent, the probability of any interventional formula becomes a sum of products of CPT entries. This allows computation of counterfactual probabilities like PNX,Y and PSX,Y using only observational data, as these can be expressed as sums involving only conditional probabilities of simple formulas (not involving interventions).

## Key Results
- Probabilities of interventional formulas can be uniquely estimated from observational data when assuming independence of mechanisms
- CBNs can be converted to i-compatible causal models that satisfy the independence assumptions
- Probabilities of necessity and sufficiency can be computed using only exponentially many simple conditional probabilities from observational data

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Causal Bayesian Networks (CBNs) can uniquely estimate interventional formula probabilities when assuming independence of mechanisms.
- Mechanism: By assuming independence of conditional probability tables (CPTs) both across variables and across different parent settings of the same variable, we can convert CBNs into causal models where the probability of any interventional formula becomes a sum of products of CPT entries.
- Core assumption: Mechanisms that determine interventions are probabilistically independent - specifically, CPTs for different variables are independent, and CPT entries for different parent settings of the same variable are independent.
- Evidence anchors:
  - [abstract]: "by making simple yet often realistic independence assumptions, it is possible to uniquely estimate the probability of an interventional formula"
  - [section 3.4]: "the assumption that cpts involving different variables are independent is equivalent to the (conditional) independence assumptions made in Bayesian networks"
  - [corpus]: Found 25 related papers; corpus neighbors include works on Bayesian intervention optimization and causal discovery, suggesting this is an active research area
- Break condition: The independence assumption fails when there are latent exogenous variables affecting the value of a variable for different settings of its parents, or when observable parents do not screen off effects from other variables.

### Mechanism 2
- Claim: Probabilities of necessity and sufficiency can be computed using only observational data without experiments.
- Mechanism: Under the independence assumptions, counterfactual probabilities like PNX,Y and PSX,Y can be expressed as sums involving only conditional probabilities of simple formulas (no interventions), which can be estimated from observational data.
- Core assumption: The independence assumptions hold, and all parents of a variable Y are observable and screen off Y from effects of other variables.
- Evidence anchors:
  - [abstract]: "these probability estimates can be evaluated using observational data, which carries immense significance in scenarios where conducting experiments is impractical or unfeasible"
  - [section 5]: "These probabilities can be computed using only conditional probabilities of (singly) exponentially many simple formulas (not involving interventions)"
  - [corpus]: Corpus neighbors include "Causal Discovery under Off-Target Interventions" and "Bayesian Causal Inference with Gaussian Process Networks" suggesting related work on observational causal inference
- Break condition: When interventions are needed to observe certain conditional probabilities, or when the independence assumptions don't hold for the specific causal structure.

### Mechanism 3
- Claim: Any CBN can be converted to a compatible causal model satisfying independence assumptions.
- Mechanism: By adding exogenous variables (response functions) for each endogenous variable with parents, and constructing a probability distribution that ensures independence of interventions, we create an i-compatible causal model that reproduces the CBN's behavior.
- Core assumption: We can construct exogenous variables whose domains are functions from parent settings to variable values, and define probabilities that make different interventions independent.
- Evidence anchors:
  - [section 4]: "Starting with a CBN M, we want to construct an i-compatible probabilistic causal model (M′, Pr′)... We add a new exogenous variable UY for each endogenous variable Y"
  - [section 3.4]: "a causal model can be viewed as a CBN" and "the key point is that in a causal model, a context not only determines a state; it determines a state for every intervention"
  - [corpus]: Weak - corpus doesn't directly address conversion between CBNs and causal models
- Break condition: When the functional relationship between variables is not deterministic given parents, or when constructing the response function space is computationally infeasible.

## Foundational Learning

- Concept: Causal Bayesian Networks (CBNs) and their semantics
  - Why needed here: Understanding how CBNs differ from standard Bayesian networks and how interventions are represented is crucial for grasping the paper's approach
  - Quick check question: What is the key difference between how probabilities are defined for simple formulas versus interventional formulas in CBNs?

- Concept: d-separation and conditional independence in Bayesian networks
  - Why needed here: The paper relies on showing that independence of CPTs across variables is equivalent to the conditional independence assumptions encoded by d-separation
  - Quick check question: How does d-separation determine which variables are conditionally independent in a Bayesian network?

- Concept: Counterfactual reasoning and probabilities of necessity/sufficiency
  - Why needed here: The paper focuses on computing these specific counterfactual probabilities, which are important for understanding causal relationships
  - Quick check question: What is the formal definition of the probability of necessity of X for Y in a causal model?

## Architecture Onboarding

- Component map:
  Input CBN -> Independence module -> Conversion engine -> Formula evaluator -> Counterfactual calculator

- Critical path:
  1. Verify independence assumptions hold for the given CBN
  2. Convert CBN to i-compatible causal model
  3. Identify the interventional formula(s) of interest
  4. Compute probability using sums of products of CPT entries
  5. For counterfactuals, decompose into observational conditional probabilities

- Design tradeoffs:
  - Computational complexity vs. uniqueness of probability estimates (independence assumptions give unique values but may not always be appropriate)
  - Generality of approach vs. practical applicability (the approach works for all CBNs but independence assumptions may not hold in practice)
  - Observational data sufficiency vs. experimental data requirement (independence assumptions enable use of observational data but may require more data to estimate all needed conditional probabilities)

- Failure signatures:
  - If independence assumptions don't hold: probability estimates will be incorrect (too narrow)
  - If CBN has cycles: conversion to causal model won't work
  - If parent variables aren't fully observable: may not be able to verify independence assumptions
  - If formula involves interventions on variables with many parents: computational complexity may be prohibitive

- First 3 experiments:
  1. Implement the conversion from CBN to i-compatible causal model for a simple binary CBN with known CPTs, verify that interventional probabilities match theoretical calculations
  2. Test computation of PNX,Y and PSX,Y on a small CBN where independence assumptions clearly hold, compare results with and without independence assumptions
  3. Evaluate the approach on a CBN where independence assumptions don't hold (e.g., with latent confounders affecting different parent settings), observe how probability estimates differ from true values

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the independence assumption between equations for different settings of the same variable's parents impact the accuracy of probability estimates in real-world CBNs?
- Basis in paper: [explicit] The paper discusses independence assumptions for equations that give values of a variable for different parent settings, and provides examples where this assumption is appropriate.
- Why unresolved: The paper only provides theoretical justification for this assumption and doesn't empirically validate its accuracy across diverse real-world scenarios.
- What evidence would resolve it: Empirical studies comparing probability estimates with and without this assumption across various real-world CBN applications would help assess its validity and impact.

### Open Question 2
- Question: Can the independence assumption between equations for different variables be relaxed while still maintaining the ability to uniquely estimate interventional formula probabilities?
- Basis in paper: [inferred] The paper assumes independence between equations for different variables to enable unique probability estimation, but doesn't explore what happens if this assumption is weakened.
- Why unresolved: The paper doesn't investigate alternative assumptions that might allow for unique probability estimation without full independence.
- What evidence would resolve it: Developing and testing alternative assumptions that maintain identifiability while being less restrictive than full independence would help understand the limits of the current approach.

### Open Question 3
- Question: How does the complexity of computing probabilities scale with the size and structure of the CBN, and are there efficient approximation methods for large networks?
- Basis in paper: [explicit] The paper mentions that computing probabilities may involve exponentially many conditional probabilities, and provides complexity estimates for arbitrary formulas.
- Why unresolved: The paper doesn't provide concrete algorithms or complexity analysis for large-scale CBNs, nor does it explore approximation techniques.
- What evidence would resolve it: Developing efficient algorithms or approximation methods for large CBNs, along with empirical studies of their performance on real-world networks, would address this question.

## Limitations
- The approach relies heavily on independence assumptions that may not hold in many real-world scenarios
- Computational complexity grows exponentially with the number of variables and parent settings
- The conversion to causal models may be infeasible for CBNs with cycles or when response function spaces are too large

## Confidence
**High confidence**: The mechanism for converting CBNs to compatible causal models under independence assumptions is well-defined and theoretically sound. The relationship between independence of CPTs and conditional independence in Bayesian networks is established.

**Medium confidence**: The claim that probabilities of necessity and sufficiency can be computed from observational data alone is plausible under the independence assumptions, but may fail in practice when these assumptions are violated. The computational feasibility for moderately sized networks is reasonable but not guaranteed for larger networks.

**Low confidence**: The paper's handling of cases where independence assumptions don't hold is not well-developed. The conversion procedure for complex CBNs with multiple paths and potential cycles needs more rigorous specification.

## Next Checks
1. Test the approach on a CBN with known latent confounders to quantify how much probability estimates deviate from true values when independence assumptions fail.
2. Implement the formula evaluator for PNX,Y and PSX,Y on a moderately sized CBN (5-10 variables) and measure computational time and accuracy.
3. Apply the method to a real-world dataset where some experimental data is available, comparing estimates from observational data alone versus estimates that incorporate experimental results.