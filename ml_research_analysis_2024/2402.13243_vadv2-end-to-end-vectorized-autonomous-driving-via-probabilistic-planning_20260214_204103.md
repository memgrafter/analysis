---
ver: rpa2
title: 'VADv2: End-to-End Vectorized Autonomous Driving via Probabilistic Planning'
arxiv_id: '2402.13243'
source_url: https://arxiv.org/abs/2402.13243
tags:
- planning
- driving
- arxiv
- action
- adv2
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: VADv2 addresses the uncertainty and non-deterministic nature of
  autonomous driving planning by proposing probabilistic planning, which models the
  planning policy as an environment-conditioned stochastic process. The method discretizes
  the continuous action space into a large planning vocabulary, learns the probabilistic
  distribution from large-scale driving demonstrations, and samples actions to control
  the vehicle.
---

# VADv2: End-to-End Vectorized Autonomous Driving via Probabilistic Planning

## Quick Facts
- arXiv ID: 2402.13243
- Source URL: https://arxiv.org/abs/2402.13243
- Reference count: 40
- VADv2 achieves state-of-the-art closed-loop performance on CARLA Town05 with Drive Score 85.1, Route Completion 98.4, and Infraction Score 0.87

## Executive Summary
VADv2 addresses the challenge of uncertainty in autonomous driving planning by introducing probabilistic planning. The method models the planning policy as an environment-conditioned stochastic process, discretizing the continuous action space into a large planning vocabulary. By learning the probabilistic distribution from extensive driving demonstrations and sampling actions, VADv2 significantly outperforms existing methods on the CARLA benchmark, achieving superior performance in drive score, route completion, and infraction rate.

## Method Summary
VADv2 introduces a novel approach to end-to-end autonomous driving by framing planning as a probabilistic process. The method discretizes the continuous action space into a large vocabulary of discrete actions, allowing the model to learn a distribution over these actions from large-scale driving demonstrations. This approach addresses the non-deterministic nature of real-world driving scenarios by enabling the model to sample multiple potential actions rather than committing to a single deterministic output. The probabilistic planning framework conditions action distributions on environmental observations, allowing for context-aware decision making. The model is trained to predict the probability of each discrete action given the current driving scene, and during inference, actions are sampled from this learned distribution to control the vehicle.

## Key Results
- Achieves Drive Score of 85.1 on CARLA Town05 benchmark
- Attains Route Completion of 98.4%
- Maintains Infraction Score of 0.87, indicating high safety performance

## Why This Works (Mechanism)
VADv2's probabilistic planning approach works by addressing the inherent uncertainty in autonomous driving scenarios. By modeling the planning policy as an environment-conditioned stochastic process, the method can capture the multi-modal nature of driving decisions. The discretization of the continuous action space into a large vocabulary allows the model to represent a diverse set of potential maneuvers, while the learned probabilistic distribution enables the selection of actions that best fit the current driving context. This approach provides a balance between exploration of different driving strategies and exploitation of learned behaviors, leading to improved performance in complex driving scenarios.

## Foundational Learning

1. **Probabilistic Modeling**
   - Why needed: To capture the inherent uncertainty and multi-modality in driving decisions
   - Quick check: Verify that the model's output distribution matches the diversity of expert demonstrations

2. **Action Space Discretization**
   - Why needed: To represent a wide range of driving maneuvers in a tractable form for learning
   - Quick check: Ensure that the discretized actions cover the full spectrum of driving behaviors observed in the training data

3. **Environment-Conditioned Policies**
   - Why needed: To enable context-aware decision making based on current driving scene
   - Quick check: Validate that action distributions change appropriately in response to different environmental conditions

## Architecture Onboarding

**Component Map:** Input Perception -> Action Distribution Network -> Action Sampler -> Vehicle Control

**Critical Path:** The critical path in VADv2 involves processing environmental observations to predict a probability distribution over the discretized action space, followed by sampling an action from this distribution to control the vehicle.

**Design Tradeoffs:** The primary design tradeoff in VADv2 is between the granularity of the discretized action space and computational efficiency. A larger vocabulary allows for more nuanced driving behaviors but increases computational complexity during both training and inference.

**Failure Signatures:** Potential failure modes include:
- Oversimplification of complex driving scenarios due to coarse discretization
- Poor generalization to novel environments not well-represented in training data
- Computational bottlenecks in real-time action sampling from large vocabularies

**3 First Experiments:**
1. Evaluate the model's performance on a held-out validation set from the training distribution
2. Test the model's ability to generalize to slightly modified versions of the training environment
3. Measure the computational efficiency of the action sampling process in real-time scenarios

## Open Questions the Paper Calls Out
None

## Limitations
- The discretized action space may not capture all necessary maneuvers in highly dynamic real-world scenarios
- Reliance on large-scale driving demonstrations raises questions about adaptability to novel environments
- Computational efficiency of sampling from large planning vocabularies in real-time applications remains uncertain

## Confidence

| Claim | Confidence |
|-------|------------|
| VADv2 achieves state-of-the-art performance on CARLA benchmark | High |
| Probabilistic planning approach effectively handles uncertainty | Medium |
| Discretized action space adequately captures real-world driving complexity | Medium |

## Next Checks
1. Conduct real-world road tests to evaluate VADv2's performance in diverse and unpredictable traffic scenarios, comparing its behavior and safety metrics to those observed in the CARLA simulation.

2. Perform ablation studies to determine the optimal size and granularity of the discretized action space, assessing the trade-off between planning resolution and computational efficiency in real-time applications.

3. Implement transfer learning experiments using VADv2, pre-trained on large-scale driving demonstrations, to evaluate its ability to adapt to new environments with limited fine-tuning data, simulating scenarios of deployment in previously unseen locations.