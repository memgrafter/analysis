---
ver: rpa2
title: Towards Dynamic Graph Neural Networks with Provably High-Order Expressive Power
arxiv_id: '2410.01367'
source_url: https://arxiv.org/abs/2410.01367
tags:
- node
- dynamic
- test
- hopedgn
- graph
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes HopeDGN, a Dynamic Graph Neural Network with
  provably high-order expressive power. Existing DyGNNs have limited expressive power,
  unable to capture important evolving patterns like triangle structures.
---

# Towards Dynamic Graph Neural Networks with Provably High-Order Expressive Power

## Quick Facts
- arXiv ID: 2410.01367
- Source URL: https://arxiv.org/abs/2410.01367
- Authors: Zhe Wang; Tianjian Zhao; Zhen Zhang; Jiawei Chen; Sheng Zhou; Yan Feng; Chun Chen; Can Wang
- Reference count: 40
- Key outcome: HopeDGN achieves expressive power equivalent to 2-DWL test and outperforms baselines by up to 3.12% in link prediction

## Executive Summary
This paper addresses the limited expressive power of existing Dynamic Graph Neural Networks (DyGNNs), which are bounded by 1-Dynamic Weisfeiler-Lehman (1-DWL) tests and cannot capture important evolving patterns like triangle structures. The authors propose HopeDGN, a DyGNN with provably high-order expressive power, using Multi-Interacted Time Encoding (MITE) to encode bi-interaction history between node pairs and their neighbors. Theoretical analysis shows HopeDGN achieves expressive power equivalent to 2-DWL tests, and experiments on seven datasets demonstrate significant performance improvements over baselines in link prediction and node classification tasks.

## Method Summary
HopeDGN introduces Multi-Interacted Time Encoding (MITE) to encode the complete bi-interaction history of target node pairs with other nodes in dynamic graphs. The model updates temporal embeddings by aggregating neighboring node pairs along with their interaction history, mimicking the 2-DWL test procedure. A Transformer-based implementation with patching technique efficiently handles long-term dependencies while reducing computational complexity. The framework supports both global and local variants, with the local version only considering historical neighbors for improved efficiency.

## Key Results
- HopeDGN achieves expressive power equivalent to 2-DWL test, provably distinguishing node pairs that 1-DWL tests cannot
- Outperforms baseline DyGNNs by up to 3.12% in link prediction on Reddit dataset
- Consistent performance improvements across all seven evaluated datasets (Reddit, Wikipedia, UCI, Enron, LastFM, MOOC, CanParl)
- Local HopeDGN variant achieves similar performance to global variant with better computational efficiency

## Why This Works (Mechanism)

### Mechanism 1
- Claim: HopeDGN captures dependencies between node pairs that existing DyGNNs miss
- Mechanism: MITE encodes bi-interaction history between target node pairs and other nodes, allowing aggregation of neighboring node pairs with their joint interaction history
- Core assumption: Temporal dependencies between node pairs are encoded in their joint interaction history with other nodes
- Evidence anchors:
  - [abstract]: "MITE encodes the bi-interaction history of target node pairs with other nodes, thereby capturing the indirect dependencies between target node pairs"
  - [section 4.2]: "MITE encodes the complete bi-interaction history of target node pairs with other nodes in the dynamic graph, thereby capturing dependency information such as common neighbors"
  - [corpus]: Weak - no direct evidence in neighboring papers about bi-interaction history encoding

### Mechanism 2
- Claim: HopeDGN achieves expressive power equivalent to 2-DWL test
- Mechanism: HopeDGN updates node pair representations by aggregating neighboring node pairs with their MITE, mimicking the 2-DWL test procedure
- Core assumption: Aggregating neighboring node pairs with their joint interaction history is sufficient to distinguish non-isomorphic node pairs
- Evidence anchors:
  - [abstract]: "Our theoretical results demonstrate that HopeDGN can achieve expressive power equivalent to the 2-DWL test"
  - [section 4.3]: "HopeDGN update the temporal embedding of a central node pair by aggregating its neighboring node pairs as well as the their interaction history with central node pair"
  - [corpus]: Weak - no direct evidence in neighboring papers about achieving 2-DWL equivalent expressive power

### Mechanism 3
- Claim: Transformer-based implementation efficiently handles long-term dependencies
- Mechanism: Patching technique divides neighborhood sequence into non-overlapping patches, reducing computational complexity while maintaining representation capacity
- Core assumption: Long-term dependencies in dynamic graphs can be effectively modeled through attention mechanisms
- Evidence anchors:
  - [section 4.4]: "we leverage the patching technique to divide the neighborhood sequence into non-overlapping patches"
  - [section 4.4]: "Forwarding propagation using the Transformer encoder costs O(dS2/P 2) since the input length has been reduced to ⌈S/P ⌉"
  - [corpus]: Moderate - neighboring papers discuss attention mechanisms but not specifically for dynamic graphs with patching

## Foundational Learning

- Concept: Weisfeiler-Lehman (WL) test hierarchy
  - Why needed here: The paper extends WL tests to dynamic graphs (k-DWL tests) to quantify expressive power of DyGNNs
  - Quick check question: What is the key difference between 1-WL test and k-FWL test for static graphs?

- Concept: Dynamic graphs and temporal interactions
  - Why needed here: The paper operates on continuous-time dynamic graphs where node interactions have timestamps
  - Quick check question: How does the Dynamic Adjacency Tensor (DAT) represent interaction timestamps between node pairs?

- Concept: Graph isomorphism and distinguishability
  - Why needed here: Expressive power is measured by ability to distinguish non-isomorphic graphs or node pairs
  - Quick check question: Why does the 1-DWL test fail to distinguish certain node pairs that have common historical neighbors?

## Architecture Onboarding

- Component map: MITE encoding -> Aggregation with neighboring node pairs -> Representation update -> Isomorphism testing

- Critical path: Interaction history → MITE encoding → Aggregation with neighboring node pairs → Representation update → Isomorphism testing

- Design tradeoffs:
  - Global vs local HopeDGN: Global considers all nodes as replacing nodes but is computationally expensive; local only considers historical neighbors for efficiency
  - Patching size: Larger patches preserve more information but increase computational cost; smaller patches are faster but may lose context

- Failure signatures:
  - Poor link prediction performance: May indicate MITE not capturing distinguishing interaction patterns
  - High computational cost: May indicate need to adjust patching size or switch to local variant
  - Over-smoothing: May indicate insufficient expressive power in aggregation functions

- First 3 experiments:
  1. Implement MITE encoding and verify it produces different encodings for node pairs with different interaction histories
  2. Test HopeDGN on a simple synthetic dataset where 1-DWL test fails but 2-DWL test succeeds
  3. Compare performance of global vs local HopeDGN variants on a medium-sized dataset to understand tradeoff between expressiveness and efficiency

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can DyGNNs with provably high-order expressive power (beyond 2-DWL) be designed?
- Basis in paper: [explicit] The authors note that "the expressive power of the proposed HopeDGN is bounded by 2-DWL test" and mention it remains an open problem to design DyGNNs with higher order expressiveness than 2-DWL test.
- Why unresolved: The paper only proves that HopeDGN achieves expressive power equivalent to 2-DWL test. Extending this to higher-order tests like 3-DWL or beyond would require new theoretical frameworks and architectural innovations.
- What evidence would resolve it: A DyGNN framework with provable guarantees of expressive power equivalent to k-DWL for k>2, along with empirical validation showing improved performance on dynamic graph tasks compared to 2-DWL equivalent models.

### Open Question 2
- Question: How does the proposed k-Dynamic WL (k-DWL) test compare to other metrics for evaluating DyGNN expressiveness beyond Weisfeiler-Lehman tests?
- Basis in paper: [inferred] The authors mention that "some recent works study the expressiveness of GNNs via alternative metrics beyond WL test such as graph bi-connectivity" and suggest designing DyGNNs based on other metrics beyond DWL test may bring novel insights.
- Why unresolved: The paper focuses on extending WL tests to dynamic graphs but doesn't explore other graph-theoretic properties that could serve as alternative expressiveness metrics for DyGNNs.
- What evidence would resolve it: A comprehensive comparison study of DyGNN expressiveness using various metrics (e.g., k-DWL, graph bi-connectivity, motif counting) across multiple dynamic graph datasets, showing the relative strengths and weaknesses of each metric.

### Open Question 3
- Question: What is the impact of incorporating MITE on the computational efficiency and scalability of DyGNNs for large-scale dynamic graphs?
- Basis in paper: [explicit] The authors show that incorporating MITE with other baselines significantly boosts their performance, but they only briefly mention the computational complexity of HopeDGN as O(B(log(ng)+ S)+ dS2/P 2) and compare efficiency with some baselines on one dataset.
- Why unresolved: While the paper demonstrates the effectiveness of MITE in enhancing DyGNN expressiveness, it doesn't provide a thorough analysis of how MITE affects the computational efficiency and scalability of DyGNNs, especially for large-scale dynamic graphs with millions of nodes and interactions.
- What evidence would resolve it: Extensive experiments evaluating the training time, memory usage, and inference latency of DyGNNs with and without MITE across various dynamic graph datasets of different sizes, along with scalability analysis showing how these metrics scale with graph size and interaction density.

## Limitations
- The expressive power of HopeDGN is bounded by 2-DWL test, leaving open the question of achieving higher-order expressiveness
- Limited comparison to non-DyGNN baselines that might also capture temporal patterns in graphs
- Computational complexity analysis assumes specific dataset characteristics that may not generalize to all dynamic graphs

## Confidence
- Theoretical proof of 2-DWL expressive power: Medium
- Experimental results on seven datasets: High
- Generalization to other dynamic graph scenarios: Medium

## Next Checks
1. Verify the injectivity of the aggregation functions in HopeDGN through empirical testing on synthetic graphs where 1-DWL fails but 2-DWL succeeds
2. Conduct ablation studies to quantify the contribution of MITE encoding versus other architectural components to overall performance
3. Test HopeDGN on datasets with varying interaction patterns and node feature distributions to assess robustness beyond the seven evaluated datasets