---
ver: rpa2
title: Identifying Drift, Diffusion, and Causal Structure from Temporal Snapshots
arxiv_id: '2410.22729'
source_url: https://arxiv.org/abs/2410.22729
tags:
- diffusion
- drift
- noise
- causal
- additive
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work addresses the problem of identifying drift, diffusion,
  and causal structure from temporal marginals of stochastic differential equations
  (SDEs) when individual trajectories are unobservable. A key contribution is Theorem
  3, which shows that linear drift and additive diffusion parameters are identifiable
  from marginals if and only if the initial distribution lacks generalized rotational
  symmetries.
---

# Identifying Drift, Diffusion, and Causal Structure from Temporal Snapshots

## Quick Facts
- arXiv ID: 2410.22729
- Source URL: https://arxiv.org/abs/2410.22729
- Reference count: 26
- Key outcome: Linear drift and additive diffusion parameters are identifiable from temporal marginals if and only if the initial distribution lacks generalized rotational symmetries, resolved via APPEX algorithm

## Executive Summary
This work addresses the fundamental problem of identifying drift, diffusion, and causal structure from temporal marginals of stochastic differential equations when individual trajectories are unobservable. The authors prove that linear drift and additive diffusion parameters are identifiable if and only if the initial distribution lacks auto-rotational symmetry, resolving long-standing non-identifiability issues. Their APPEX algorithm alternates between trajectory inference using anisotropic entropy-regularized optimal transport and maximum likelihood estimation of SDE parameters, achieving state-of-the-art performance on simulated data while also recovering causal graph structure including feedback loops and latent confounders.

## Method Summary
The APPEX algorithm jointly identifies drift, diffusion, and causal structure from temporal marginals by alternating between trajectory inference and parameter estimation. It uses anisotropic entropy-regularized optimal transport to infer trajectories matching observed marginals, then applies maximum likelihood estimation to update drift and diffusion parameters. The method iteratively decreases Kullback-Leibler divergence to the true solution and provably recovers causal graphs for additive noise SDEs from their parameters. The approach works without prior knowledge of drift or diffusion structure and handles anisotropic diffusion patterns.

## Key Results
- APPEX accurately estimates drift, diffusion, and causal graphs across wide dimensional ranges, outperforming Waddington-OT
- Theorem 3 establishes bidirectional identifiability conditions: linear drift and additive diffusion parameters are recoverable if and only if initial distribution lacks auto-rotational symmetry
- APPEX successfully handles anisotropic diffusion and recovers causal structure including feedback loops and latent confounders

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: Linear drift and additive diffusion parameters are identifiable from temporal marginals if and only if the initial distribution lacks auto-rotational symmetry.
- **Mechanism**: Auto-rotational invariance creates degeneracy in Fokker-Planck dynamics. When initial distribution is invariant under non-trivial generalized rotation, multiple distinct SDE parameter pairs generate identical marginals, making system non-identifiable. Without such symmetry, parameters are uniquely recoverable.
- **Core assumption**: Initial distribution has finite moments and is not auto-rotationally invariant.
- **Evidence anchors**:
  - [abstract] "Assuming linear drift and additive diffusion, we prove that these parameters are identifiable from marginals if and only if the initial distribution lacks any generalized rotational symmetries."
  - [section 3.1] Theorem 3 provides formal proof of this bidirectional condition.
- **Break condition**: If initial distribution is auto-rotationally invariant (e.g., spherical Gaussian, cylindrical after transformation, or degenerate), method fails to uniquely identify parameters.

### Mechanism 2
- **Claim**: APPEX reduces KL divergence to true solution through alternating trajectory inference and MLE parameter estimation.
- **Mechanism**: Each iteration projects onto two spaces: finding trajectory distribution closest to current SDE estimate under KL divergence (via anisotropic entropy-regularized OT), then finding SDE parameters closest to inferred trajectories under KL divergence (via MLE). Alternating projection ensures monotonic decrease in divergence.
- **Core assumption**: Finite observed marginals and non-degenerate diffusion ensure finite KL divergence between discretized path measures.
- **Evidence anchors**:
  - [abstract] "We show that APPEX iteratively decreases Kullback–Leibler divergence to the true solution."
  - [section 4.3] Lemma 9 proves the decreasing KL divergence property.
- **Break condition**: If reference SDE has degenerate diffusion or temporal marginals are too few, KL divergence may not be well-defined, breaking convergence guarantee.

### Mechanism 3
- **Claim**: Causal graph structure can be recovered from drift and diffusion parameters for additive noise SDEs.
- **Mechanism**: Directed edges correspond to non-zero drift matrix entries (indicating direct influence on dynamics), while bidirectional edges (latent confounders) correspond to non-zero off-diagonal observational diffusion matrix entries. This mapping holds for linear drift and general additive diffusion.
- **Core assumption**: SDE follows additive noise model with identifiable drift and diffusion parameters.
- **Evidence anchors**:
  - [abstract] "We further prove that the causal graph of any SDE with additive diffusion can be recovered from the SDE parameters."
  - [section 3.2] Lemma 5 formally establishes correspondence between parameters and graph edges.
- **Break condition**: If diffusion is degenerate or drift is non-additive, causal structure may not be fully recoverable from parameters alone.

## Foundational Learning

- **Concept**: Stochastic Differential Equations (SDEs) and their Fokker-Planck evolution
  - Why needed here: Entire identification framework relies on understanding how SDE parameters govern temporal marginal distributions through Fokker-Planck equation.
  - **Quick check question**: What equation governs evolution of temporal marginals for SDE with linear drift and additive diffusion?

- **Concept**: Entropy-regularized Optimal Transport (EOT) and its anisotropic generalization
  - Why needed here: Trajectory inference in APPEX uses AEOT to find path distributions matching temporal marginals while respecting reference SDE dynamics.
  - **Quick check question**: How does anisotropic entropy-regularized OT differ from standard EOT in handling non-isotropic diffusion?

- **Concept**: Maximum Likelihood Estimation (MLE) for SDE parameters from multiple trajectories
  - Why needed here: Parameter updates in APPEX use MLE to fit SDE parameters to inferred trajectories, requiring understanding of likelihood structure for linear additive noise SDEs.
  - **Quick check question**: What are closed-form MLE solutions for drift and diffusion parameters when given multiple trajectories from linear additive noise SDE?

## Architecture Onboarding

- **Component map**: Temporal marginals → AEOT trajectory inference → MLE parameter estimation → (repeat) → causal graph extraction
- **Critical path**: Temporal marginals → AEOT trajectory inference → MLE parameter estimation → (repeat) → causal graph extraction
- **Design tradeoffs**:
  - Computational cost vs. accuracy: More iterations and samples improve accuracy but increase runtime
  - Initialization sensitivity: Poor initial diffusion estimates can slow convergence
  - Dimensionality scaling: Sinkhorn's algorithm complexity grows with dimension and sample size
- **Failure signatures**:
  - Stagnant KL divergence across iterations indicates potential non-identifiability or poor initialization
  - High variance in parameter estimates across replicates suggests insufficient data or degenerate diffusion
  - Inconsistent causal graph recovery points to correlated diffusion patterns not captured by model
- **First 3 experiments**:
  1. Verify identifiability on simple non-auto-rotationally invariant system (e.g., uniform initial distribution) where ground truth parameters are known
  2. Test convergence behavior on system with isotropic diffusion, comparing APPEX to Waddington-OT
  3. Evaluate causal graph recovery on small system with known latent confounders introduced through correlated diffusion

## Open Questions the Paper Calls Out

### Open Question 1
- **Question**: How can we extend identifiability conditions to time-inhomogeneous linear additive noise SDEs?
- **Basis in paper**: [explicit] Paper focuses on time-homogeneous linear additive noise SDEs and proves identifiability conditions for this specific case. Authors acknowledge this as limitation in Section 6.1.
- **Why unresolved**: Time-inhomogeneous SDEs introduce additional complexity as drift and diffusion parameters become time-dependent, potentially breaking closed-form solution structure that enables current identifiability proof.
- **What evidence would resolve it**: Proof showing necessary and sufficient conditions for identifiability of time-inhomogeneous linear additive noise SDEs from temporal marginals, or counterexample demonstrating non-identifiability in some cases.

### Open Question 2
- **Question**: What is sample complexity of APPEX for achieving consistent parameter estimation as function of dimension and number of time points?
- **Basis in paper**: [inferred] Authors mention they leave asymptotic analysis and consistency rates for future work in Section 6.1, noting that theory considers infinite data setting.
- **Why unresolved**: While paper demonstrates empirical effectiveness, there is no theoretical guarantee on how many samples needed per time point to achieve consistent estimates, particularly as dimensionality increases.
- **What evidence would resolve it**: Theoretical bounds on number of samples required per time point for estimates to converge to true parameters with high probability, as function of dimension d and number of time points N.

### Open Question 3
- **Question**: How can we develop more computationally efficient solvers for anisotropic entropy-regularized optimal transport problem in trajectory inference?
- **Basis in paper**: [explicit] Section 6.1 discusses computational limitations, noting that trajectory inference step is computationally intensive and impractical for very large datasets.
- **Why unresolved**: Current implementation relies on Sinkhorn's algorithm, which has poor scaling with sample size and dimensionality, making it unsuitable for large-scale biological applications.
- **What evidence would resolve it**: Comparison of alternative solvers (e.g., closed-form solutions, generative diffusion models, or other approximation methods) against APPEX in terms of both accuracy and computational efficiency on benchmark problems.

## Limitations
- Identifiability theorem requires strict absence of generalized rotational symmetries in initial distribution, which may not hold in many practical scenarios
- APPEX's convergence relies on well-defined KL divergence between discretized path measures, which may not be guaranteed for highly degenerate diffusion processes
- Causal graph recovery assumes linear drift and additive diffusion structure, limiting applicability to systems with more complex nonlinear dynamics

## Confidence

- **High Confidence**: Alternating projection framework for APPEX is mathematically sound, with formal proofs showing monotonic decrease in KL divergence under stated conditions
- **Medium Confidence**: Experimental validation demonstrates strong performance across diverse scenarios, though theoretical guarantees assume idealized conditions that may not fully capture real-world complexities
- **Medium Confidence**: Identifiability conditions are rigorously proven, but practical implications depend heavily on specific structure of initial distributions in application domains

## Next Checks

1. Test APPEX on systems with varying degrees of rotational symmetry in initial conditions to empirically verify boundaries of identifiability theorem
2. Evaluate performance degradation when applied to systems with degenerate diffusion matrices or limited temporal observations
3. Compare causal structure recovery accuracy against ground truth for systems with known feedback loops and latent confounders across multiple noise levels