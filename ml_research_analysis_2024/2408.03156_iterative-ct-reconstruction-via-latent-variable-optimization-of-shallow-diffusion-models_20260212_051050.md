---
ver: rpa2
title: Iterative CT Reconstruction via Latent Variable Optimization of Shallow Diffusion
  Models
arxiv_id: '2408.03156'
source_url: https://arxiv.org/abs/2408.03156
tags:
- image
- reconstruction
- diffusion
- proposed
- images
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This study proposes a novel computed tomography (CT) reconstruction
  method by combining the denoising diffusion probabilistic model with iterative CT
  reconstruction. The key innovation is optimizing the fidelity loss of CT reconstruction
  with respect to the latent variable of the diffusion model, rather than the image
  and model parameters.
---

# Iterative CT Reconstruction via Latent Variable Optimization of Shallow Diffusion Models

## Quick Facts
- arXiv ID: 2408.03156
- Source URL: https://arxiv.org/abs/2408.03156
- Authors: Sho Ozaki; Shizuo Kaji; Toshikazu Imae; Kanabu Nawa; Hideomi Yamashita; Keiichi Nakagawa
- Reference count: 40
- Primary result: Novel CT reconstruction method using latent variable optimization with shallow diffusion models achieves superior performance on sparse-projection data

## Executive Summary
This study presents a novel computed tomography (CT) reconstruction method that combines denoising diffusion probabilistic models (DDPM) with iterative reconstruction (IR) through latent variable optimization. The key innovation is optimizing the fidelity loss of CT reconstruction with respect to the latent variable of the diffusion model rather than the image itself, which preserves anatomical structures while enhancing image quality. By shallowing the diffusion and reverse processes and using fixed noises to make the reverse process deterministic, the method suppresses structural changes that would otherwise occur during reconstruction. The approach was demonstrated on sparse-projection CT reconstruction using only 1/10 and 1/20 of the full projection data, achieving image quality comparable to full-scan CT reconstruction while outperforming existing methods including iterative reconstruction, iterative reconstruction with total variation, and diffusion model alone.

## Method Summary
The proposed method integrates denoising diffusion probabilistic models with iterative CT reconstruction by optimizing the reconstruction loss with respect to the latent variable rather than the image or model parameters. The approach uses a shallow DDPM with T=1 time step and fixed noise in the reverse process to maintain structural integrity. During reconstruction, the method first performs iterative reconstruction on observed sparse projections to obtain an initial image, then adds noise to obtain a latent variable. The reconstruction loss is optimized with respect to this latent variable using stochastic gradient descent, effectively leveraging the DDPM as a learned prior while avoiding structural degradation. The method was trained on 3615 high-quality CT slices from 20 prostate cancer patients and evaluated on 20 test slices from 10 different patients, with simulated fan-beam projection data.

## Key Results
- Achieved SSIM of 0.9604 and PSNR of 36.5387 using only 1/10 projection data, outperforming FBP (SSIM 0.7872, PSNR 27.6509), TV-IR (SSIM 0.8291, PSNR 28.5241), and DDPM alone (SSIM 0.9134, PSNR 30.9658)
- With 1/20 projection data, the method achieved SSIM of 0.9449 and PSNR of 34.9247, demonstrating robust performance under extreme sparsity
- The method preserved anatomical structures better than conventional approaches while reducing streak artifacts in the reconstructed images
- Performance was comparable to full-scan CT reconstruction using only 1/10 of the projection data, representing a 10-fold reduction in acquisition time

## Why This Works (Mechanism)
The method works by decoupling the noise injection from the reconstruction process. Traditional DDPM approaches add noise during the reverse process, which can distort anatomical structures. By fixing the noise and optimizing the latent variable directly, the method maintains the original structural information while still benefiting from the learned prior of the DDPM. The shallow architecture (T=1) further ensures that the diffusion process doesn't introduce unnecessary complexity that could lead to structural changes. This approach effectively combines the strengths of iterative reconstruction (preserving measured data fidelity) with the learned prior of diffusion models (enhancing image quality) while avoiding their individual weaknesses.

## Foundational Learning
- **Computed Tomography Reconstruction**: Mathematical framework for recovering cross-sectional images from X-ray projections using filtered backprojection or iterative methods - needed to understand the reconstruction problem and evaluation metrics
- **Denoising Diffusion Probabilistic Models**: Generative models that learn to reverse a gradual noising process through a Markov chain - needed to understand how the diffusion model serves as a learned prior
- **Latent Variable Optimization**: Technique of optimizing model parameters or intermediate representations rather than direct outputs - needed to understand the core innovation of optimizing the latent space
- **Structural Similarity Index (SSIM)**: Perceptual metric for image quality assessment that considers luminance, contrast, and structure - needed to evaluate reconstruction quality in a clinically meaningful way
- **Fan-beam Geometry**: Specific CT acquisition geometry where X-rays originate from a point source and are detected by an array of detectors - needed to understand the data simulation and reconstruction process
- **Sparse Projection Reconstruction**: CT reconstruction from limited projection angles or detector elements - needed to understand the challenging reconstruction scenario addressed by the method

## Architecture Onboarding

**Component Map**: Sparse Projections -> Iterative Reconstruction -> Latent Variable Initialization -> Latent Variable Optimization -> Final Image

**Critical Path**: The most critical computational path is the latent variable optimization loop, where the reconstruction loss is computed and gradients are backpropagated through the DDPM to update the latent variable. This iterative process directly determines the final image quality and computational efficiency.

**Design Tradeoffs**: The choice of T=1 for the shallow DDPM represents a key tradeoff between computational efficiency and reconstruction quality. While deeper DDPMs might provide better priors, they risk introducing structural changes during the reverse process. The fixed noise approach trades the stochastic nature of DDPM for deterministic reconstruction, which improves consistency but may reduce the model's ability to handle diverse noise patterns.

**Failure Signatures**: Poor reconstruction quality with visible streak artifacts indicates issues with the iterative reconstruction initialization or projection data simulation. Loss of anatomical structure suggests the shallow DDPM is not properly preserving structure or the fixed noise implementation is incorrect. Low SSIM/PSNR values compared to benchmarks indicate problems with the latent variable optimization process or training of the DDPM.

**First Experiments**:
1. Verify that the shallow DDPM (T=1) trained on high-quality CT images can reconstruct clean images from noisy latents
2. Test the iterative reconstruction initialization with sparse projections to ensure reasonable starting points for optimization
3. Evaluate the latent variable optimization process with synthetic data where ground truth is known

## Open Questions the Paper Calls Out
**Open Question 1**: How does the proposed method's performance scale with increasing resolution (e.g., from 256x256 to 512x512) in clinical CT imaging scenarios?
The paper notes that GPU memory limitations restricted experiments to 256x256 resolution, while clinical practice typically uses 512x512. This suggests the method's effectiveness at higher resolutions is untested. The computational cost and memory requirements for the method at higher resolutions are unknown, as is whether the denoising model's performance would degrade or improve.

**Open Question 2**: What is the optimal balance between the number of iterations and noise strength (β₁) for the proposed method in practical clinical applications?
The paper explored the β₁-dependence of SSIM and PSNR, finding that values ≤1×10⁻⁴ yield stable performance, but the optimal balance for specific clinical scenarios is not established. The relationship between noise strength, reconstruction quality, and computational cost is not fully characterized for diverse clinical CT applications.

**Open Question 3**: Can the proposed method be extended to other medical imaging modalities beyond CT, such as MRI or PET, without significant retraining or architectural changes?
The authors suggest the method could be applied to MRI and other modalities but do not provide experimental validation or analysis of necessary modifications. The effectiveness of the latent variable optimization approach for modalities with different physical principles and data characteristics is unknown.

## Limitations
- The method was only tested on prostate CT data and simulated fan-beam geometry, limiting generalizability to other anatomical regions and scanner configurations
- Computational requirements for the latent variable optimization process may be prohibitive for real-time clinical applications
- The shallow DDPM architecture (T=1) may limit the method's ability to handle complex noise patterns or extreme sparse sampling scenarios
- The study did not address potential issues with noise propagation over multiple reconstruction iterations or long-term stability

## Confidence
**High**: The core methodological claims about using latent variable optimization with shallow diffusion models for CT reconstruction are well-supported by quantitative metrics and clear technical innovation.
**Medium**: The generalizability of the approach to other imaging modalities or anatomical regions beyond prostate CT remains to be validated through additional experiments.
**Medium**: The long-term stability and clinical applicability of the method in real-world settings requires further investigation beyond the controlled experimental conditions.

## Next Checks
1. Verify that the shallow DDPM architecture (T=1) and fixed noise implementation correctly preserve anatomical structures during reconstruction
2. Test the method's performance on different anatomical regions and CT scanner geometries beyond the prostate cancer dataset used in this study
3. Conduct a comprehensive ablation study to quantify the individual contributions of latent variable optimization versus the shallow diffusion model architecture to the overall performance gains