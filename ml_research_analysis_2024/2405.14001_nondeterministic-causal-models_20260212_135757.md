---
ver: rpa2
title: Nondeterministic Causal Models
arxiv_id: '2405.14001'
source_url: https://arxiv.org/abs/2405.14001
tags:
- causal
- solution
- logic
- such
- have
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces Nondeterministic Structural Causal Models
  (NSCMs) as a generalization of deterministic causal models that allows for multiple
  possible outcomes given parent values. The key innovation is using multi-valued
  functions in structural equations, which enables representing situations where the
  same cause can lead to different effects.
---

# Nondeterministic Causal Models

## Quick Facts
- arXiv ID: 2405.14001
- Source URL: https://arxiv.org/abs/2405.14001
- Reference count: 16
- Key outcome: Introduces Nondeterministic Structural Causal Models (NSCMs) using multi-valued functions to represent multiple possible outcomes for the same cause

## Executive Summary
This paper presents a generalization of structural causal models that allows for nondeterministic relationships where the same cause can lead to different effects. By introducing multi-valued functions in structural equations, the framework captures uncertainty about causal outcomes without requiring additional exogenous variables. The author develops formal logics for counterfactual reasoning in these models that avoid the unrealistic assumption of unique counterfactual outcomes, providing sound and complete axiomatizations for different levels of specificity in counterfactual evaluation.

## Method Summary
The method introduces NSCMs by replacing deterministic functions fX: R(PaX)→R(X) with multi-valued functions fX: R(PaX)→P(R(X)), where P(R(X)) represents the power set of possible outcomes. The key innovation is the actualized refinement operation, which updates equations based on observed behavior in the actual world to preserve actual outcomes in counterfactual evaluations. This framework is then extended to probabilistic causal models (PNSCMs), enabling computation of counterfactual probabilities even in standard Causal Bayesian Networks by leveraging the independence assumptions across counterfactual variables.

## Key Results
- Sound and complete axiomatizations for single-world (swc) and single-context (scc) counterfactual logics
- Proof that scc semantics is equivalent to standard DSCM semantics for contexts without interventions
- Extension to probabilistic case enabling counterfactual probability computation in CBNs
- Demonstration of computing probabilities of necessity and sufficiency in medical treatment scenarios

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The actualized refinement operation preserves the actual behavior of equations in counterfactual worlds.
- Mechanism: When evaluating a counterfactual [Y←y]ϕ, the actualized refinement M(u,v) updates each equation fX to behave deterministically for the specific parent values paX that occurred in the actual world (u,v). This ensures that counterfactual worlds respect the observed outcomes while still allowing for nondeterministic behavior elsewhere.
- Core assumption: The actual world solution (u,v) is consistent with the model M.
- Evidence anchors:
  - [section] "Given a solution (u, v) of a model M = (S,F,G), we define the actualized refinement M(u,v) as the refinement of M in which F is replaced by F(u,v), as follows: for each variable X∈V, its function fX is replaced by f(paX,x)X that behaves identically to fX for all inputs except for paX. Instead, f(paX,x)X(paX) = x, where (x, paX)⊆(u, v)."
  - [abstract] "I drop both of them in my proposal. I do so by allowing multi-valued functions in the structural equations. In addition, I adjust the semantics so that the solutions to the equations that obtained in the actual world are preserved in any counterfactual world."
- Break condition: If the actual world (u,v) is not a solution of M, the actualized refinement is undefined.

### Mechanism 2
- Claim: The swc logic can express counterfactual statements relative to a specific actual world without committing to unique outcomes.
- Mechanism: By using actualized refinements, the swc logic evaluates [Y←y]ϕ relative to a single world (u,v), allowing multiple possible counterfactual outcomes while preserving the actual behavior of equations for the values that occurred in the actual world.
- Core assumption: The language L(S) includes atomic formulas X=x and allows Boolean combinations of these with interventions [Y←y].
- Evidence anchors:
  - [section] "The first evaluates causal formulas relative to a single world (u, v), and thus we will call the resulting logic the single world counterfactual logic, or swc logic for short."
  - [abstract] "I drop both of them in my proposal... and it assumes that the actual world... specifies a unique counterfactual world for each intervention."
- Break condition: If D10(b) is added to the axiomatization, the logic commits to unique outcomes and loses its nondeterministic character.

### Mechanism 3
- Claim: Probabilistic causal models with nondeterminism allow counterfactual probabilities to be computed even in standard Causal Bayesian Networks.
- Mechanism: By defining actualized refinements for PNSCMs and using the independence assumption across counterfactual variables, probabilities of counterfactuals PM(yx,...,zw) can be computed directly from the CBN when assuming U=∅, bypassing the need for exogenous variables.
- Core assumption: The CBN already contains all relevant variables (U=∅) or weaker assumptions can be made about the structure.
- Evidence anchors:
  - [section] "Thus one option that is always available for any CBN is to take the probabilities PX at face value and simply assume that the CBN already contains all relevant variables, so that the ground truth PNSCM is simply identical to the CBN, i.e, to assume that U =∅."
  - [abstract] "I extend these models to the probabilistic case and show that they open up the way to identifying counterfactuals even in Causal Bayesian Networks."
- Break condition: If the CBN is missing critical variables that should be exogenous, the computed probabilities will be incorrect.

## Foundational Learning

- Concept: Multi-valued functions in structural equations
  - Why needed here: They allow representing situations where the same cause can lead to different effects, which is essential for modeling nondeterministic causal relationships.
  - Quick check question: What is the difference between fX: R(PaX)→R(X) in DSCMs and fX: R(PaX)→P(R(X)) in NSCMs?

- Concept: Actualized refinement operation
  - Why needed here: It updates the model's equations to incorporate the actual behavior observed in a specific world, ensuring counterfactual worlds respect observed outcomes while allowing nondeterministic behavior elsewhere.
  - Quick check question: How does the actualized refinement M(u,v) differ from the original model M?

- Concept: Three semantics for counterfactuals (swc, scc, smc)
  - Why needed here: They provide different levels of specificity for evaluating counterfactuals - relative to a single world, a single context, or the entire model - corresponding to different philosophical and practical needs.
  - Quick check question: What distinguishes the single world counterfactual logic (swc) from the single context counterfactual logic (scc)?

## Architecture Onboarding

- Component map:
  - Signature (S): Contains exogenous variables U, endogenous variables V, and range function R
  - Model (M): Contains signature S, structural equations F, and causal graph G
  - Actualized refinement: Operation that updates equations based on actual world behavior
  - Semantics: Three evaluation modes (swc, scc, smc) for counterfactual formulas
  - Axiomatization: AXnon systems for the different logics

- Critical path:
  1. Define signature and model structure
  2. Implement actualized refinement operation
  3. Implement semantics for evaluating counterfactual formulas
  4. Implement axiomatization and proof system
  5. Extend to probabilistic case with PNSCMs

- Design tradeoffs:
  - Using multi-valued functions vs. introducing additional exogenous variables: Multi-valued functions provide more direct representation but may complicate inference
  - Three different semantics vs. single unified semantics: Multiple semantics provide flexibility but increase complexity
  - Actualized refinement vs. standard intervention: Actualized refinement preserves actual behavior but requires access to actual world

- Failure signatures:
  - Undefined actualized refinement: Actual world (u,v) is not a solution of M
  - Inconsistent probabilities: Computed counterfactual probabilities don't sum to 1
  - Violation of D10(b): Multiple possible outcomes exist when uniqueness is assumed

- First 3 experiments:
  1. Implement a simple NSCM with two binary variables and verify that multiple counterfactual outcomes are possible
  2. Implement the actualized refinement operation and verify it preserves actual behavior
  3. Compute counterfactual probabilities in a simple CBN using the U=∅ assumption and compare with ground truth

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What are the minimal conditions under which a probabilistic causal model (PNSCM) is identifiable from observational data alone?
- Basis in paper: [explicit] The paper discusses partial identification in Section 6.1, noting that standard procedures for identifying probabilities of counterfactuals from CBNs assume the ground truth causal model must be a PDSCM, and suggests that allowing PNSCMs opens up new possibilities for partial identification.
- Why unresolved: The paper only provides a preliminary investigation and defers a full discussion of this change in perspective to future work.
- What evidence would resolve it: A systematic study of which assumptions (beyond Markovianity and acyclicity) enable or prevent partial identification of counterfactual probabilities from observational data in PNSCMs.

### Open Question 2
- Question: Can the acyclicity of the graph GM (as opposed to just the dependence graph GD) be expressed in the causal language developed in Section 3?
- Basis in paper: [explicit] The author states in Footnote 5 that "It is unclear whether it is possible to also express the acyclicity of GM in the causal language."
- Why unresolved: This appears to be an open question about the expressive power of the axiomatization developed for the counterfactual logics.
- What evidence would resolve it: Either a proof that acyclicity of GM can be expressed as a formula in the causal language, or a proof that it cannot be expressed within the given logical framework.

### Open Question 3
- Question: How does the nondeterministic causal model framework handle cases where the uncertainty in outcomes is due to latent variables versus cases where it reflects genuine indeterminism?
- Basis in paper: [inferred] The paper distinguishes between dropping the assumption that values must be uniquely determined by parents versus dropping the assumption that the world is fundamentally deterministic, but doesn't explicitly address how to distinguish these cases in practice.
- Why unresolved: The framework allows for multiple possible outcomes given parent values, but doesn't provide criteria for determining whether this reflects epistemic uncertainty about hidden causes or ontological indeterminism.
- What evidence would resolve it: A formal characterization of when nondeterminism in a causal model corresponds to hidden variables versus genuine indeterminism, potentially through statistical tests or structural assumptions.

## Limitations

- The framework relies on access to the actual world solution (u,v), making counterfactual reasoning undefined if this solution is unknown or inconsistent with the model
- The independence conditions across counterfactual variables may not hold in complex real-world scenarios, potentially invalidating computed probabilities
- The framework doesn't provide criteria for distinguishing between uncertainty due to hidden variables versus genuine indeterminism

## Confidence

- High confidence in the formal axiomatization for swc and scc logics
- Medium confidence in the computational feasibility of the probabilistic extension
- Medium confidence in the philosophical justification for multiple counterfactual outcomes

## Next Checks

1. Implement a simple NSCM with two binary variables and verify that multiple counterfactual outcomes are possible by explicitly enumerating all solutions for a given context.

2. Test the actualized refinement operation by creating a model where the actual world behavior differs from the default equation behavior, and verify that counterfactual evaluations respect the actualized behavior.

3. Compute counterfactual probabilities in a simple CBN using the U=∅ assumption and compare with ground truth by explicitly enumerating all possible worlds and their probabilities.