---
ver: rpa2
title: Inferring biological processes with intrinsic noise from cross-sectional data
arxiv_id: '2410.07501'
source_url: https://arxiv.org/abs/2410.07501
tags:
- force
- noise
- data
- inferred
- score
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper introduces Probability Flow Inference (PFI), a method
  for inferring force fields in stochastic biological processes from cross-sectional
  data. PFI circumvents the identifiability issue by separating force inference from
  noise modeling, using recent advances in score-based generative modeling.
---

# Inferring biological processes with intrinsic noise from cross-sectional data

## Quick Facts
- arXiv ID: 2410.07501
- Source URL: https://arxiv.org/abs/2410.07501
- Reference count: 0
- Authors: Suryanarayana Maddu; Victor Chardès; Michael. J. Shelley
- Key outcome: Introduces Probability Flow Inference (PFI), a method for inferring force fields in stochastic biological processes from cross-sectional data by separating force inference from noise modeling using score-based generative modeling.

## Executive Summary
This paper addresses the fundamental challenge of inferring biological force fields and stochastic dynamics from cross-sectional time-series data, where traditional approaches struggle with the identifiability issue arising from simultaneous inference of forces and intrinsic noise. The authors propose Probability Flow Inference (PFI), which circumvents this problem by fitting the probability flow ODE that shares the same marginal distributions as the underlying stochastic process, rather than the full SDE. By leveraging score-based generative modeling to estimate the score function from empirical data, PFI disentangles force field inference from noise modeling while maintaining algorithmic efficiency.

The method is analytically validated for Ornstein-Uhlenbeck processes, proving that regularized PFI yields a unique solution in the limit of well-sampled distributions. Empirically, PFI demonstrates superior performance in inferring parameters and regulatory networks in high-dimensional stochastic reaction networks, particularly when using the Chemical Langevin Equation to capture molecular noise. Applied to hematopoietic stem cell differentiation, PFI successfully captures branching trajectories and regulatory interactions, emphasizing the importance of modeling intrinsic noise for accurate biological inference.

## Method Summary
PFI is a two-step approach that first estimates time-dependent score functions from cross-sectional data using sliced score matching or denoising score matching, then fits force fields by minimizing the Wasserstein distance between predicted and observed marginals under the probability flow ODE. The method introduces ℓ2-regularization on the Jacobian of the inferred force field to ensure a unique solution and control the bias-variance tradeoff. PFI can incorporate various noise models, with particular emphasis on the Chemical Langevin Equation for capturing molecular noise in gene regulatory networks. The approach is validated through extensive simulations and applied to real biological data including hematopoietic stem cell differentiation.

## Key Results
- PFI accurately infers force fields and parameters in high-dimensional stochastic reaction networks, outperforming state-of-the-art methods
- The method successfully captures branching trajectories and regulatory interactions in hematopoietic stem cell differentiation
- Analytical proof shows regularized PFI yields unique solutions for Ornstein-Uhlenbeck processes in well-sampled regimes
- Incorporating the Chemical Langevin Equation for molecular noise significantly improves inference accuracy compared to simpler noise models

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** PFI separates deterministic force field from intrinsic noise model, avoiding the identifiability issue that arises when inferring both simultaneously from cross-sectional data.
- **Mechanism:** PFI fits the probability flow ODE (which only depends on the force) rather than the full SDE (which depends on both force and noise). By leveraging score-based generative modeling to estimate the score function ∇ log p(x,t) from empirical data, PFI decouples the inference of the force field f(x) from the noise model D(x).
- **Core assumption:** The noise model D(x) is known or can be accurately estimated from biophysical priors (e.g., molecular noise in gene regulation follows a known functional form).
- **Evidence anchors:**
  - [abstract]: "Our approach, probability flow inference (PFI), disentangles force from intrinsic stochasticity while retaining the algorithmic ease of ODE inference."
  - [section]: "We circumvent this compromise by inferring the phase-space probability flow that shares the same time-dependent marginal distributions as the underlying stochastic process."
- **Break condition:** If the assumed noise model D(x) is significantly inaccurate or if there are unobserved exogenous factors driving the evolution, the force field inference will be compromised.

### Mechanism 2
- **Claim:** Regularization on the Jacobian of the inferred force field ensures a unique solution to the inverse problem and controls the bias-variance tradeoff in finite sample settings.
- **Mechanism:** An ℓ2-regularization on the Jacobian of the force field is added to the loss function, making it strongly convex and ensuring a unique global minimum. This regularization acts as a threshold for learning non-equilibrium contributions to the force field - larger deformations of the marginals allow learning of non-conservative forces, while smaller deformations are washed out by regularization.
- **Core assumption:** The regularization parameter λ can be tuned to balance the bias-variance tradeoff, with smaller λ allowing exact recovery of non-conservative forces but increasing variance from finite sampling.
- **Evidence anchors:**
  - [abstract]: "Analytically, we prove that for Ornstein-Uhlenbeck processes the regularized PFI formalism yields a unique solution in the limit of well-sampled distributions."
  - [section]: "This lack of uniqueness, referred to as the identifiability issue, has been of long standing concern in the analysis of single-cell RNA-seq data... To circumvent this ill-posedness, we choose to introduce an ℓ2-regularization on the Jacobian matrix of the inferred force field to the loss function."
- **Break condition:** If the regularization is too strong, non-conservative forces will be incorrectly set to zero. If too weak, the variance from finite sampling will dominate and the solution will be unstable.

### Mechanism 3
- **Claim:** PFI can accurately infer parameters and regulatory networks in high-dimensional stochastic reaction networks by incorporating realistic noise models (Chemical Langevin Equation) that capture molecular noise.
- **Mechanism:** PFI is applied to the Chemical Langevin Equation (CLE) approximation of stochastic reaction networks, where the diffusion tensor D(x) is force and state-dependent, reflecting the Poisson nature of chemical reactions. This allows PFI to learn accurate force fields and parameter estimates that generalize to unseen initial conditions.
- **Core assumption:** The CLE provides a good approximation to the underlying discrete-state stochastic process, and the functional form of D(x) is appropriate for the biological system being studied.
- **Evidence anchors:**
  - [abstract]: "In practical applications, we show that PFI enables accurate parameter and force estimation in high-dimensional stochastic reaction networks, and that it allows inference of cell differentiation dynamics with molecular noise, outperforming state-of-the-art approaches."
  - [section]: "By leveraging the CLE formulation in Eq. (10), the PFI approach can be readily applied to infer parameters and forces in high-dimensional SRNs."
- **Break condition:** If the CLE approximation breaks down (e.g., at very small reaction volumes with few molecules), or if the noise model D(x) is incorrectly specified, the inferred force fields and parameters will be inaccurate.

## Foundational Learning

- **Concept: Stochastic Differential Equations (SDEs) and Fokker-Planck Equations**
  - Why needed here: The paper models biological processes as diffusion processes governed by SDEs, and the inverse problem involves inferring the underlying force field from marginal distributions using the Fokker-Planck equation.
  - Quick check question: What is the relationship between the SDE dx = f(x)dt + √2G(x)dW and the Fokker-Planck equation ∂tpt(x) = -∇ · [f(x)pt(x) - ∇ · (D(x)pt(x))]?

- **Concept: Probability Flow ODEs and Score Functions**
  - Why needed here: PFI transforms the SDE inference problem into fitting the probability flow ODE, which requires estimating the score function ∇ log p(x,t) from data.
  - Quick check question: How does the probability flow ODE dx/dt = f(x) - ∇ · D(x) - D(x)∇ log pt(x) relate to the original SDE, and why does it share the same marginal distributions?

- **Concept: Ornstein-Uhlenbeck Processes and Regularization**
  - Why needed here: The paper proves uniqueness of the PFI solution for Ornstein-Uhlenbeck processes with regularization, and studies the bias-variance tradeoff in the isotropic case.
  - Quick check question: In the context of the Ornstein-Uhlenbeck process dx = Ωxdt + √2DdW, what role does the regularization parameter λ play in ensuring a unique solution, and how does it affect the recovery of non-conservative forces?

## Architecture Onboarding

- **Component map:** Cross-sectional data samples -> Score network (ϕ(x,t)) -> Force field network (fθ(x)) -> Wasserstein distance computation -> Loss function with Jacobian regularization -> Parameter updates

- **Critical path:**
  1. Estimate score function from empirical marginals using sliced score matching
  2. Initialize force field network
  3. For each batch of data at time t_k:
     - Push samples forward using probability flow ODE with current force and estimated score
     - Compute Wasserstein distance to observed samples at t_{k+1}
     - Compute Jacobian regularization term
     - Update force field parameters using gradient descent
  4. Evaluate inferred force field and parameters

- **Design tradeoffs:**
  - Score estimation method: Sliced score matching (memory-efficient, scales linearly with dimension) vs. denoising score matching (computationally cheaper per update, scales quadratically)
  - Distance metric: Wasserstein distance (theoretically sound, but expensive) vs. Sinkhorn divergence (faster, but introduces entropic regularization)
  - Regularization strength: Larger λ ensures uniqueness but may wash out non-conservative forces; smaller λ allows recovery of non-conservative forces but increases variance
  - Noise model: CLE (biophysically realistic, but requires correct functional form) vs. simpler models (additive, multiplicative) that may be easier to fit but less accurate

- **Failure signatures:**
  - High Wasserstein distance between predicted and observed marginals indicates poor force field fit
  - Large variance in inferred parameters across multiple training runs indicates instability due to weak regularization or insufficient data
  - Poor generalization to unseen initial conditions indicates overfitting or incorrect noise model
  - Jacobian regularization term dominates the loss function indicates the force field is being over-regularized

- **First 3 experiments:**
  1. **Linear cyclic network:** Infer kinetic rate parameters in a 30-species linear cyclic network with varying reaction volumes to test scalability and the importance of the CLE noise model
  2. **mCAD gene regulatory network:** Infer regulatory interactions in the 5-gene mCAD network with different noise models to demonstrate the superiority of the CLE approach
  3. **Ornstein-Uhlenbeck process:** Test the theoretical predictions on bias-variance tradeoff and recovery of non-conservative forces in the isotropic case with varying regularization strength and sample sizes

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What is the precise relationship between the regularization parameter λ and the effective dimensionality k* of the inferred force field, and how does this relationship vary with sample size n and time step ∆t?
- Basis in paper: Inferred from the discussion of the bias-variance tradeoff and the analytical solution for the Ornstein-Uhlenbeck process, where the authors show that non-conservative forces are only recovered in the subspace spanned by the k leading eigenvectors of P, with an effective dimension k* beyond which only equilibrium dynamics are inferred.
- Why unresolved: While the authors demonstrate the existence of an effective dimension k* and its dependence on λ, they do not provide a precise formula or quantitative relationship between λ, k*, n, and ∆t. The interplay between these factors is described qualitatively, but a more rigorous analysis would be needed to determine the optimal λ for a given dataset.
- What evidence would resolve it: A detailed theoretical analysis or empirical study that quantifies the relationship between λ, k*, n, and ∆t, potentially through numerical experiments or analytical derivations.

### Open Question 2
- Question: How does the choice of noise model (e.g., CLE, additive, state-dependent) affect the inference of gene regulatory networks in high-dimensional settings, and what are the underlying mechanisms that lead to these differences?
- Basis in paper: Explicit in the discussion of parameter and force estimation for stochastic reaction networks, where the authors compare the performance of the CLE model with other noise models and show that the CLE model outperforms others in terms of force field accuracy and regulatory network inference.
- Why unresolved: While the authors demonstrate the superior performance of the CLE model, they do not provide a detailed explanation of the underlying mechanisms that lead to these differences. A deeper understanding of how different noise models affect the inference process would be valuable for improving the accuracy of gene regulatory network inference.
- What evidence would resolve it: A comprehensive theoretical analysis or empirical study that investigates the impact of different noise models on the inference of gene regulatory networks, potentially through sensitivity analysis or comparison of inferred networks across different models.

### Open Question 3
- Question: How can the PFI approach be extended to account for unobserved protein dynamics and their regulatory effects on transcription, and what are the potential challenges and limitations of such an extension?
- Basis in paper: Inferred from the discussion of future work, where the authors suggest extending the PFI approach to account for unobserved protein dynamics between protein production and its regulatory effects on transcription.
- Why unresolved: While the authors acknowledge the importance of protein dynamics, they do not provide a concrete plan or methodology for incorporating them into the PFI framework. Extending the approach to account for protein dynamics would require significant modifications to the current formulation and may introduce additional challenges related to identifiability and computational complexity.
- What evidence would resolve it: A detailed theoretical framework or empirical study that demonstrates how protein dynamics can be incorporated into the PFI approach, potentially through the use of additional latent variables or more complex noise models.

## Limitations

- The identifiability proof for Ornstein-Uhlenbeck processes relies on regularization ensuring uniqueness, but sensitivity to regularization strength λ is not fully characterized
- The CLE approximation may break down in regimes with very low molecule counts where discrete-state effects become significant
- Computational complexity of Wasserstein distance calculations may limit scalability to very high-dimensional systems

## Confidence

- **High Confidence**: The theoretical framework of PFI separating force field inference from noise modeling is mathematically sound and the basic mechanics of score estimation via sliced score matching are well-established in the literature
- **Medium Confidence**: The practical performance claims for high-dimensional stochastic reaction networks and hematopoietic stem cell differentiation, while demonstrated, require careful validation of the CLE approximation and noise model specification in real biological systems
- **Medium Confidence**: The generalization claims to unseen initial conditions and perturbations are supported by simulation studies but would benefit from more extensive validation across diverse biological systems

## Next Checks

1. **Regularization Sensitivity Analysis**: Systematically vary the regularization parameter λ across several orders of magnitude in the Ornstein-Uhlenbeck process and measure the recovery of non-conservative forces, bias-variance tradeoff, and uniqueness of solutions to characterize the stability of the PFI framework

2. **CLE Approximation Breakdown**: Identify the regime where the CLE approximation fails by comparing PFI inference using CLE vs. discrete-state simulations across varying reaction volumes and molecule counts, quantifying the error in force field and parameter estimates

3. **Scalability Benchmarks**: Evaluate PFI's computational scaling with dimensionality using synthetic high-dimensional stochastic reaction networks, comparing performance using different distance metrics (Wasserstein vs. Sinkhorn) and score estimation methods (SSM vs. DSM)