---
ver: rpa2
title: Fairness Analysis with Shapley-Owen Effects
arxiv_id: '2409.19318'
source_url: https://arxiv.org/abs/2409.19318
tags:
- effects
- fairness
- shapley-owen
- shapley
- inputs
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper addresses the challenge of measuring algorithmic fairness
  by developing a method to quantify the relative importance of sensitive input attributes
  on decision outcomes. The authors propose using Shapley-Owen effects, a cooperative
  game-theoretic approach, to attribute variance in model outputs to subsets of inputs
  in a fair manner.
---

# Fairness Analysis with Shapley-Owen Effects

## Quick Facts
- arXiv ID: 2409.19318
- Source URL: https://arxiv.org/abs/2409.19318
- Reference count: 15
- Key outcome: The paper develops a method using Shapley-Owen effects to quantify the relative importance of sensitive input attributes on decision outcomes, providing a theoretically sound and computationally efficient framework for fairness analysis in AI systems.

## Executive Summary
This paper addresses the challenge of measuring algorithmic fairness by quantifying the relative importance of sensitive input attributes on decision outcomes. The authors propose using Shapley-Owen effects, a cooperative game-theoretic approach, to attribute variance in model outputs to subsets of inputs in a fair manner. They introduce a spectral decomposition that separates the computation into model-independent and model-specific parts, allowing efficient calculation of Shapley-Owen effects using polynomial chaos expansions (PCE). The method provides known error bounds and can handle input dependencies, making it more accurate than traditional Sobol' indices. The approach is validated through examples and shown to converge to true values.

## Method Summary
The method computes Shapley-Owen effects via spectral decomposition using polynomial chaos expansions. The key innovation is decomposing the computation into a model-independent part (precomputed elementary Shapley-Owen values) and a model-specific part (PCE coefficients). The approach handles dependent inputs through Rosenblatt transformations and provides error bounds based on PCE truncation errors. The method requires constructing an orthonormal polynomial basis, computing PCE coefficients, precomputing elementary Shapley-Owen values, and then combining these to calculate the final effects.

## Key Results
- Shapley-Owen effects computed via spectral decomposition separate model-independent and model-dependent computations
- Error bounds provided for PCE-based approximations using orthogonality properties and Chebyshev's inequality
- Method handles dependent inputs correctly using Rosenblatt transformations
- Convergence demonstrated on example problems, with approximations approaching true values

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The spectral decomposition separates Shapley-Owen effect computation into a model-independent part (precomputed) and a model-specific part (PCE coefficients).
- Mechanism: By expressing Shapley-Owen effects as an infinite sum over orthogonal polynomial chaos expansion (PCE) coefficients weighted by precomputed elementary Shapley-Owen values, the computationally expensive model-independent values are computed once and reused for different fairness analyses.
- Core assumption: The PCE converges sufficiently fast and the elementary Shapley-Owen values can be accurately precomputed.
- Evidence anchors:
  - [abstract]: "decomposes the computation of these indices into a model-specific and a model-independent part"
  - [section 6]: "Shapley-Owen effects are expressed analytically in terms of the PCE coefficients"
  - [corpus]: Weak evidence - no direct mentions of spectral decomposition or PCE-based Shapley-Owen effects

### Mechanism 2
- Claim: The method provides known error bounds for Shapley-Owen effect approximations.
- Mechanism: The orthogonality of the PCE truncation error combined with upper bounds on elementary Shapley-Owen values creates a computable bound on the total approximation error.
- Core assumption: The truncation error of the PCE is orthogonal to the truncated terms and can be bounded using Chebyshev's inequality.
- Evidence anchors:
  - [section 6]: "an upper bound on the approximation error of (46)" and "Corollary 6.1"
  - [section 5.3]: "Pythagorean theorem for inner product spaces" and "Chebyshev's inequality"
  - [corpus]: No direct evidence of error bounds in related works

### Mechanism 3
- Claim: The method handles dependent inputs correctly, unlike Sobol' indices.
- Mechanism: Using a Rosenblatt transformation to convert dependent inputs to independent uniform variables allows the PCE and Shapley-Owen computation to work without assuming input independence.
- Core assumption: The Rosenblatt transform exists and is invertible for the given input distribution.
- Evidence anchors:
  - [section 5.6]: "Rosenblatt transformation method involves mapping the original random variables" and "Lemma 5.2"
  - [section 3]: "Sobol' indices are difficult to interpret in the presence of statistical dependence"
  - [corpus]: Weak evidence - only general mentions of dependent inputs in related works

## Foundational Learning

- Concept: Polynomial Chaos Expansion (PCE)
  - Why needed here: PCE provides the spectral decomposition that enables the efficient computation of Shapley-Owen effects
  - Quick check question: What is the relationship between PCE coefficients and the variance of the model output?

- Concept: Shapley-Owen effects and their axioms
  - Why needed here: Understanding the fairness properties that Shapley-Owen effects satisfy is crucial for interpreting results
  - Quick check question: What are the four axioms that Shapley-Owen effects satisfy for fair attribution?

- Concept: Rosenblatt transformation for dependent inputs
  - Why needed here: This transformation allows handling correlated inputs without making independence assumptions
  - Quick check question: How does the Rosenblatt transform convert dependent inputs to independent ones?

## Architecture Onboarding

- Component map: Input preprocessing (Rosenblatt transform) -> PCE construction (orthonormal basis + Galerkin projection) -> Elementary Shapley-Owen value precomputation -> Shapley-Owen effect computation (spectral decomposition) -> Error bound calculation
- Critical path: 1. Transform inputs using Rosenblatt transform 2. Construct PCE of the decision model 3. Precompute elementary Shapley-Owen values 4. Compute Shapley-Owen effects using spectral decomposition 5. Calculate error bounds
- Design tradeoffs:
  - Accuracy vs. computational cost: Higher PCE order increases accuracy but computational cost
  - Precomputation vs. memory: Storing elementary Shapley-Owen values requires memory but speeds up computation
  - Sparsity vs. completeness: Sparse PCE is faster but may miss important interactions
- Failure signatures:
  - Slow convergence: PCE truncation error doesn't decrease sufficiently
  - Memory overflow: Too many elementary Shapley-Owen values to store
  - Numerical instability: Galerkin projections or Rosenblatt transform calculations fail
- First 3 experiments:
  1. Verify PCE construction on a simple linear model with known Shapley-Owen effects
  2. Test Rosenblatt transform on a bivariate Gaussian with known correlation
  3. Compare Shapley-Owen effects with Sobol' indices on a model with dependent inputs

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How do Shapley-Owen effects compare to other fairness metrics in real-world applications with correlated sensitive attributes?
- Basis in paper: [inferred] The paper discusses Shapley-Owen effects as a theoretically sound approach but doesn't provide empirical comparisons with other fairness metrics in real-world scenarios.
- Why unresolved: While the paper provides theoretical foundations and error bounds, it lacks practical implementation and comparison studies with existing fairness metrics.
- What evidence would resolve it: Empirical studies comparing Shapley-Owen effects to other fairness metrics (e.g., disparate impact, differential fairness) on real-world datasets with correlated sensitive attributes.

### Open Question 2
- Question: What is the computational efficiency of the proposed algorithm for computing Shapley-Owen effects in high-dimensional settings?
- Basis in paper: [explicit] The paper mentions that computing Shapley-Owen effects can be very demanding due to the exponential number of coalitions, but it proposes a spectral decomposition approach to improve efficiency.
- Why unresolved: The paper doesn't provide detailed computational complexity analysis or performance benchmarks for the proposed algorithm in high-dimensional settings.
- What evidence would resolve it: Computational complexity analysis and performance benchmarks comparing the proposed algorithm to existing methods for computing Shapley-Owen effects in high-dimensional settings.

### Open Question 3
- Question: How sensitive are Shapley-Owen effects to the choice of input distribution and the corresponding polynomial chaos expansion?
- Basis in paper: [explicit] The paper discusses the use of polynomial chaos expansions and Rosenblatt transformations for handling dependent inputs, but it doesn't explore the sensitivity of Shapley-Owen effects to different input distributions.
- Why unresolved: While the paper provides a theoretical framework for computing Shapley-Owen effects, it doesn't investigate how the choice of input distribution and polynomial chaos expansion affects the results.
- What evidence would resolve it: Sensitivity analysis studies exploring how different input distributions and polynomial chaos expansions impact the computed Shapley-Owen effects for various decision models.

## Limitations
- The computational complexity of precomputing elementary Shapley-Owen values remains exponential in the number of inputs, potentially limiting scalability to high-dimensional problems
- The convergence properties of PCE for non-Gaussian distributions (Weibull, Lévy, χ²) are not fully characterized, with exact recurrence relations unknown for these distributions
- The practical performance on real-world fairness scenarios with complex, non-linear models is not demonstrated beyond synthetic examples

## Confidence
- High confidence: The theoretical framework for decomposing Shapley-Owen effects using spectral methods is mathematically sound and follows established results in cooperative game theory
- Medium confidence: The error bounds for PCE truncation are valid under the stated assumptions, but their tightness in practice requires empirical validation
- Medium confidence: The Rosenblatt transformation approach for handling dependent inputs is theoretically correct, but numerical stability for high-dimensional correlated inputs needs verification

## Next Checks
1. Benchmark the PCE-based Shapley-Owen computation against Monte Carlo methods on a high-dimensional fairness problem to quantify computational gains
2. Test the method on real-world datasets with known fairness concerns (e.g., credit scoring, hiring decisions) to validate practical utility
3. Conduct sensitivity analysis on PCE order and quadrature rules to determine optimal parameter settings for different input distributions