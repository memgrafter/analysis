---
ver: rpa2
title: 'Learning to Balance: Diverse Normalization for Cloth-Changing Person Re-Identification'
arxiv_id: '2410.03977'
source_url: https://arxiv.org/abs/2410.03977
tags:
- features
- clothing
- person
- clothes
- learning
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of cloth-changing person re-identification
  (CC-ReID), where the goal is to recognize individuals across images regardless of
  clothing changes. The authors propose a novel module called Diverse Norm, which
  expands personal features into orthogonal spaces and employs channel attention to
  separate clothing and identity features.
---

# Learning to Balance: Diverse Normalization for Cloth-Changing Person Re-Identification

## Quick Facts
- arXiv ID: 2410.03977
- Source URL: https://arxiv.org/abs/2410.03977
- Authors: Hongjun Wang; Jiyuan Chen; Zhengwei Yin; Xuan Song; Yinqiang Zheng
- Reference count: 20
- One-line primary result: Proposes Diverse Norm module that expands features into orthogonal spaces to separate clothing and identity features, achieving state-of-the-art results on CC-ReID benchmarks.

## Executive Summary
This paper addresses the cloth-changing person re-identification (CC-ReID) challenge by proposing Diverse Norm, a novel module that separates clothing and identity features through orthogonal decomposition without requiring clothing labels. The method uses whitening to decorrelate features and channel attention to split them into two orthogonal branches, with a sample re-weighting strategy ensuring opposite optimization directions. Integrated into ResNet50, the approach achieves significant improvements over state-of-the-art methods on LTCC, PRCC, and VC-Clothes datasets.

## Method Summary
The Diverse Norm module decorrelates features through whitening and employs channel attention to separate clothing and identity features into orthogonal spaces. This is combined with a sample re-weighting optimization strategy that ensures opposite optimization directions for the two branches. The method is seamlessly integrated into ResNet50 and evaluates using mAP and CMC metrics at Rank1 and Rank5 accuracy. Training uses Adam optimizer with learning rate 3.5e-4, reduced by factor 10 every 20 epochs, with batch size 64.

## Key Results
- Significant improvements over state-of-the-art methods on LTCC, PRCC, and VC-Clothes datasets
- Superior performance in both clothing-consistent and clothing-changing scenarios
- Notable improvements in mAP and rank-1 accuracy
- Effective performance without requiring additional data or clothing labels

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Orthogonal feature expansion separates clothing and identity information effectively.
- Mechanism: The Diverse Norm module applies whitening to decorrelate features, then uses channel attention weights to split the whitened features into two orthogonal branches - one emphasizing clothing features and the other emphasizing identity features.
- Core assumption: Clothing and identity features are naturally decorrelated in the latent space, allowing orthogonal decomposition to separate them without explicit labels.
- Evidence anchors:
  - [abstract] "expands personal features into orthogonal spaces and employs channel attention to separate clothing and identity features"
  - [section] "whitening is defined as...ψ(Z) = W(Z − μ), where μ is the sample mean and W is the whitening matrix satisfying W⊤W = Σ−1"
  - [corpus] Weak - no direct corpus evidence found for this specific orthogonal decomposition approach
- Break condition: If clothing and identity features are not naturally decorrelated (e.g., highly correlated attributes like shoes that appear in both branches), the orthogonal separation will fail to produce meaningful separation.

### Mechanism 2
- Claim: Sample re-weighting ensures opposite optimization directions for the two branches.
- Mechanism: The sample re-weighting strategy assigns weights based on relative loss difficulty - samples that are easier to classify by clothing features get higher weights for the identity branch and vice versa, forcing the branches to focus on different aspects of the input.
- Core assumption: Different samples have different levels of identifiability through clothing vs identity features, and this variation can be exploited for better separation.
- Evidence anchors:
  - [abstract] "A sample re-weighting optimization strategy is also introduced to ensure opposite optimization directions"
  - [section] "We employ a reweighting strategy...to amplify this distinction, encouraging classifiers to be biased towards certain types of samples"
  - [corpus] Weak - no direct corpus evidence found for this specific re-weighting approach for CC-ReID
- Break condition: If most samples are equally identifiable through both clothing and identity features, the re-weighting strategy loses its effectiveness as there's no meaningful distinction to exploit.

### Mechanism 3
- Claim: Separate cosine similarity calculations prevent feature dominance bias.
- Mechanism: Instead of computing similarity on concatenated features where clothing features might dominate due to their larger visual presence, the method calculates cosine similarities separately for identity and clothing features and then combines them, giving appropriate weight to both aspects.
- Core assumption: Clothing features visually dominate identity features in RGB images, leading to biased similarity calculations if features are concatenated before comparison.
- Evidence anchors:
  - [abstract] "We employ cosine distance to measure the similarity between the feature of the query and gallery images and then aggregate these similarities"
  - [section] "We found that the primary reason for the traditional baseline's failure is the overshadowing of ID features, which account for a much smaller proportion compared to clothing features"
  - [corpus] Weak - no direct corpus evidence found for this specific separate similarity calculation approach
- Break condition: If identity features are not actually overshadowed by clothing features in the learned representations, the separate calculation provides no benefit over simple concatenation.

## Foundational Learning

- Concept: Orthogonal decomposition through whitening
  - Why needed here: To separate naturally decorrelated clothing and identity features into distinct orthogonal spaces without requiring clothing labels
  - Quick check question: What property must the whitening matrix W satisfy to ensure orthogonality of the transformed features?

- Concept: Channel attention for feature selection
  - Why needed here: To dynamically determine which channels correspond to clothing vs identity features based on the input sample characteristics
  - Quick check question: How does the sigmoid activation function in the channel attention module constrain the output weights?

- Concept: Sample re-weighting based on relative loss difficulty
  - Why needed here: To ensure the two branches optimize in opposite directions by emphasizing different samples for each branch
  - Quick check question: What does it mean if the relative difficulty score W(hc) equals 1 for a given sample?

## Architecture Onboarding

- Component map: Input → Backbone (ResNet50) → Diverse Norm (Whitening + Channel Attention) → Two parallel branches (Identity classifier, Clothing classifier) → Separate cosine similarity calculations → Aggregated matching score
- Critical path: Feature extraction → Orthogonal decomposition → Branch-specific classification → Separate similarity calculation → Aggregation
- Design tradeoffs: Simplicity vs explicit supervision (no clothing labels needed but relies on natural feature decorrelation), computational cost vs performance gain (additional whitening and two classifiers)
- Failure signatures: Both branches learning similar features (indicating whitening failed), one branch consistently outperforming the other (indicating imbalance), performance degradation on datasets with many similar clothing items
- First 3 experiments:
  1. Verify orthogonal decomposition works by checking correlation between identity and clothing branch features on validation set
  2. Test re-weighting effectiveness by comparing branch performance with and without re-weighting on samples with varying clothing/identity distinguishability
  3. Validate separate similarity calculation by comparing results when using concatenated vs separate features on same/different clothing scenarios

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the performance of Diverse Norm vary with different numbers of clothing items per person in the dataset?
- Basis in paper: [explicit] The paper mentions that the number of clothes per person differs between LTCC and PRCC datasets and conducted experiments by removing different proportions of outfits in the LTCC dataset.
- Why unresolved: The paper only provides results for varying the number of outfits in LTCC, but doesn't explore the full range of possible clothing variations or other datasets.
- What evidence would resolve it: Comprehensive experiments on multiple datasets with varying numbers of clothing items per person, including extreme cases with very few or very many clothing items.

### Open Question 2
- Question: What is the impact of Diverse Norm on long-term person re-identification in scenarios with extreme clothing changes?
- Basis in paper: [inferred] The paper focuses on cloth-changing person re-identification but doesn't specifically address extreme clothing changes or long-term scenarios beyond the datasets mentioned.
- Why unresolved: The experiments are limited to specific datasets and don't explore the full spectrum of clothing changes or extremely long time spans.
- What evidence would resolve it: Extensive testing on datasets with extreme clothing changes, including different seasons, styles, and long time spans between images.

### Open Question 3
- Question: How does the performance of Diverse Norm compare to other state-of-the-art methods when additional modalities or clothing labels are available?
- Basis in paper: [explicit] The paper states that Diverse Norm doesn't require additional data, multi-modality inputs, or clothing labels, but doesn't compare its performance when these are available.
- Why unresolved: The paper focuses on the effectiveness of Diverse Norm without additional information, but doesn't explore potential performance gains when such information is provided.
- What evidence would resolve it: Comparative experiments using Diverse Norm with and without additional modalities or clothing labels, alongside other state-of-the-art methods that utilize such information.

## Limitations
- The paper lacks rigorous validation that whitening actually produces decorrelated features in practice
- Channel attention weights are not analyzed to verify they capture clothing vs identity information as claimed
- The sample re-weighting strategy's effectiveness is asserted but not empirically isolated

## Confidence
- Orthogonal feature separation mechanism: Medium confidence
- Sample re-weighting strategy: Low confidence
- Performance improvements on benchmarks: High confidence

## Next Checks
1. Compute and report the correlation coefficients between identity and clothing branch features across validation samples to verify orthogonal separation
2. Conduct an ablation study removing the sample re-weighting strategy to quantify its contribution to performance gains
3. Analyze channel attention weight distributions to determine if they consistently separate clothing and identity features across different samples