---
ver: rpa2
title: Optimal Defender Strategies for CAGE-2 using Causal Modeling and Tree Search
arxiv_id: '2407.11070'
source_url: https://arxiv.org/abs/2407.11070
tags:
- causal
- defender
- which
- search
- cage
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents Causal Partially Observable Monte-Carlo Planning
  (C-POMCP), an online method that produces provably optimal defender strategies for
  the CAGE-2 autonomous cyber defense benchmark. C-POMCP leverages the causal structure
  of the target system to prune the search space of defender strategies, achieving
  state-of-the-art performance while being two orders of magnitude more computationally
  efficient than the closest competitor method.
---

# Optimal Defender Strategies for CAGE-2 using Causal Modeling and Tree Search

## Quick Facts
- arXiv ID: 2407.11070
- Source URL: https://arxiv.org/abs/2407.11070
- Reference count: 40
- This paper presents C-POMCP, an online method that produces provably optimal defender strategies for CAGE-2, achieving state-of-the-art performance while being two orders of magnitude more computationally efficient than baselines.

## Executive Summary
This paper introduces Causal Partially Observable Monte-Carlo Planning (C-POMCP), a novel approach for computing optimal defender strategies in the CAGE-2 autonomous cyber defense benchmark. The method leverages the causal structure of the target system to dramatically prune the search space of defender strategies, achieving superior performance with significantly reduced computational cost. C-POMCP uses a causal graph to identify minimal intervention sets that could affect the defender objective, then applies Monte Carlo Tree Search to find optimal strategies while updating the defender strategy at each time step.

## Method Summary
C-POMCP combines causal modeling with online planning to defend against Advanced Persistent Threats in the CAGE-2 environment. The approach constructs a causal graph of the system, uses particle filtering to estimate belief states over latent variables, computes possibly optimal minimal intervention sets (POMIS) to prune the search tree, and employs Monte Carlo Tree Search with upper confidence bounds to find optimal defender strategies. The method updates strategies at each time step based on observations, achieving provably optimal solutions while reducing computational complexity by 85-95% compared to non-causal approaches.

## Key Results
- C-POMCP achieves cumulative rewards of -4.52 to -13.32 across different scenarios with T=30 to T=100
- The method is two orders of magnitude more computationally efficient than closest competitor methods
- Causal pruning reduces search tree size by 85-95% while maintaining optimal performance
- C-POMCP outperforms baselines with cumulative regrets ranging from -4.29 to -38.71

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The causal graph enables optimal pruning of the search tree by excluding interventions that do not affect the objective J.
- Mechanism: The causal structure is used to compute a set of possibly optimal minimal intervention sets (POMIS), which represent all interventions that could potentially affect the defender objective. Interventions not in this set are pruned from the search tree, dramatically reducing the search space.
- Core assumption: The causal graph accurately captures the dependencies between system variables and the defender objective.
- Evidence anchors:
  - [abstract]: "it incorporates the causal structure of the target system, i.e., the causal relationships among the system variables. This structure allows for a significant reduction of the search space of defender strategies."
  - [section]: "We use the causal graph G (Fig. 6) to prune the search tree by excluding histories hk (11) that contain interventions that do not belong to a POMIS (Def. 3)."
  - [corpus]: Weak - the related papers do not discuss causal pruning of search trees in the context of cyber defense.

### Mechanism 2
- Claim: Particle filtering provides an accurate approximation of the belief state over latent variables, enabling effective online decision making.
- Mechanism: The particle filter recursively updates a set of M particles representing possible states of the system based on observations. As M increases, the particle distribution converges to the true belief state, providing a good approximation for the tree search.
- Core assumption: The particle filter with sufficient particles accurately approximates the belief state.
- Evidence anchors:
  - [abstract]: "It is an online method that updates the defender strategy at each time step via tree search."
  - [section]: "We use the particle filter to estimate the values of the latent variables L in (M1), e.g., the intrusion state Ii,t (5)."
  - [corpus]: Weak - the related papers do not discuss particle filtering for belief state estimation in cyber defense.

### Mechanism 3
- Claim: Monte Carlo Tree Search with upper confidence bounds converges to the optimal defender strategy as search time increases.
- Mechanism: The tree search iteratively selects nodes to expand based on an upper confidence bound that balances exploration and exploitation. As the number of simulations increases, the value estimates at each node converge to the true values, and the algorithm selects the optimal intervention.
- Core assumption: The tree search with sufficient simulations converges to the optimal strategy.
- Evidence anchors:
  - [abstract]: "it is an online method that updates the defender strategy at each time step via tree search."
  - [section]: "C-POMCP searches for optimal interventions using the tree search algorithm described in [24, Alg. 1]."
  - [corpus]: Weak - the related papers discuss MCTS but not specifically in the context of cyber defense or convergence guarantees.

## Foundational Learning

- Concept: Structural Causal Models (SCMs)
  - Why needed here: The paper uses an SCM to model the CAGE-2 scenario, capturing the causal relationships between system variables and the defender objective.
  - Quick check question: What is the difference between an SCM and a probabilistic graphical model?

- Concept: Partially Observable Markov Decision Processes (POMDPs)
  - Why needed here: The defender problem in CAGE-2 is formulated as a POMDP, where the defender must make decisions based on partial observations of the system state.
  - Quick check question: What is the belief state in a POMDP and how is it updated?

- Concept: Monte Carlo Tree Search (MCTS)
  - Why needed here: C-POMCP uses MCTS to search for optimal defender strategies, iteratively expanding the search tree and estimating the value of each node.
  - Quick check question: How does the upper confidence bound balance exploration and exploitation in MCTS?

## Architecture Onboarding

- Component map:
  Causal Model (SCM) -> Particle Filter -> POMIS Computation -> Monte Carlo Tree Search -> Simulator

- Critical path:
  1. Initialize particle filter with initial belief state
  2. At each time step:
     a. Update particle filter based on observations
     b. Compute POMIS to prune search tree
     c. Run MCTS to find optimal intervention
     d. Execute intervention and observe new state
     e. Update history and repeat

- Design tradeoffs:
  - Particle filter accuracy vs. computational cost (number of particles M)
  - Search tree depth vs. computational cost (time horizon T)
  - Exploration vs. exploitation in MCTS (exploration parameter c)

- Failure signatures:
  - Poor performance: Check if particle filter is accurate and POMIS computation is correct
  - High computational cost: Reduce number of particles or search tree depth
  - Non-convergence: Increase search time or adjust exploration parameter

- First 3 experiments:
  1. Run C-POMCP with a small number of particles (M=10) and observe performance degradation
  2. Disable POMIS pruning and compare performance and computational cost
  3. Vary the exploration parameter c and observe its effect on convergence and performance

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What is the optimal level of abstraction for the causal model of CAGE-2 to balance computational complexity and generalization ability?
- Basis in paper: [explicit] The paper states "A key question is the level of abstraction at which CAGE-2 is modeled" and follows the principle that "a model should be detailed enough so that a theoretically optimal defender strategy exhibits state-of-the-art performance".
- Why unresolved: This requires empirical testing across different abstraction levels to find the optimal trade-off point.
- What evidence would resolve it: Systematic experiments comparing C-POMCP performance across varying levels of model detail and complexity.

### Open Question 2
- Question: How can causal discovery techniques be leveraged to automate the process of creating a causal graph of the underlying system?
- Basis in paper: [explicit] The paper states "Future work will focus on leveraging causal discovery techniques to automate the process of creating a causal graph of the underlying system."
- Why unresolved: Causal discovery in complex, dynamic systems like CAGE-2 involves challenges in handling latent variables, temporal dependencies, and ensuring identifiability.
- What evidence would resolve it: Demonstration of automated causal graph generation that produces results comparable to expert-designed graphs.

### Open Question 3
- Question: What is the impact of the exploration-exploitation trade-off parameter c on the convergence and performance of C-POMCP?
- Basis in paper: [explicit] The paper states "c is chosen such that P[Bj(hk) ≤ E[Bj(hk)] ± c√(ln Nk-1/Nk)] ≤ k-4 for all k ≥ 1" and mentions that "c can always be satisfied by choosing a large c."
- Why unresolved: The optimal value of c likely depends on the specific characteristics of the CAGE-2 environment and may affect the balance between exploration and exploitation.
- What evidence would resolve it: Empirical studies varying c and measuring its impact on convergence speed and final performance across different CAGE-2 scenarios.

## Limitations

- The method's performance is highly dependent on the accuracy and completeness of the causal graph, with potential for significant degradation if the causal structure is misspecified.
- Computational overhead of maintaining particle filters in high-dimensional state spaces may become prohibitive as system complexity increases.
- Lack of theoretical guarantees for the combined causal pruning and MCTS approach specifically for the CAGE-2 domain.

## Confidence

- Causal graph pruning effectiveness: High
- Particle filter accuracy: Medium
- MCTS convergence with pruning: Medium
- Computational efficiency gains: High
- Overall performance claims: Medium

## Next Checks

1. Test C-POMCP with intentionally corrupted causal graphs to quantify sensitivity to model misspecification and identify failure modes.

2. Conduct ablation studies comparing particle filter performance with varying numbers of particles (M=10, 50, 100, 200) to establish the trade-off between accuracy and computational cost.

3. Implement a baseline method that uses MCTS without causal pruning to isolate the contribution of the pruning mechanism to performance improvements.