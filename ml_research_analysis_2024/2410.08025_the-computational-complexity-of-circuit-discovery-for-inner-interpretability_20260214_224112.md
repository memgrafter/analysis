---
ver: rpa2
title: The Computational Complexity of Circuit Discovery for Inner Interpretability
arxiv_id: '2410.08025'
source_url: https://arxiv.org/abs/2410.08025
tags:
- neurons
- input
- output
- circuit
- neuron
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents the first systematic exploration of the computational
  complexity of circuit discovery problems for inner interpretability in neural networks.
  The authors formalize a comprehensive set of queries that capture mechanistic explanation,
  such as finding sufficient circuits, necessary circuits, circuit ablation, and circuit
  patching.
---

# The Computational Complexity of Circuit Discovery for Inner Interpretability

## Quick Facts
- arXiv ID: 2410.08025
- Source URL: https://arxiv.org/abs/2410.08025
- Authors: Federico Adolfi; Martina G. Vilas; Todd Wareham
- Reference count: 40
- This paper presents the first systematic exploration of the computational complexity of circuit discovery problems for inner interpretability in neural networks.

## Executive Summary
This paper provides the first comprehensive complexity analysis of circuit discovery problems in mechanistic interpretability. The authors formalize various interpretability queries including finding sufficient and necessary circuits, circuit ablation, and circuit patching. Through rigorous proofs, they demonstrate that many of these queries are computationally intractable (NP-hard, Σ₂ᴾ-hard), remain fixed-parameter intractable when constrained by model features, and resist approximation under multiple schemes. However, the analysis also identifies tractable variants that retain useful interpretability affordances, establishing theoretical boundaries for what mechanistic explanations can be feasibly computed.

## Method Summary
The authors employ reduction-based proofs to establish computational complexity bounds for circuit discovery queries. They reduce from well-known hard problems like Subset Sum and Dominating Set to prove NP-hardness, and from problems in the polynomial hierarchy to establish Σ₂ᴾ-hardness. For fixed-parameter intractability, they demonstrate W[1]-hardness under various parameterizations. Approximability results are established through reductions that preserve approximation ratios, showing that certain queries cannot be approximated within any constant factor under additive, multiplicative, or probabilistic schemes. The proofs systematically cover different query types including circuit existence, sufficiency, necessity, ablation, and patching.

## Key Results
- Many circuit discovery queries (sufficient circuits, necessary circuits, circuit ablation) are NP-hard or Σ₂ᴾ-hard
- These problems remain W[1]-hard even when constrained by model features
- Most queries are inapproximable under additive, multiplicative, and probabilistic approximation schemes
- Some tractable variants exist, including quasi-minimal sufficient circuits and quasi-minimal circuit patching

## Why This Works (Mechanism)
The paper's approach works by systematically formalizing interpretability queries as computational problems and applying established complexity theory techniques. By reducing from known hard problems, the authors establish lower bounds on computational resources required. The fixed-parameter analysis reveals which structural constraints might make problems tractable. The approximability proofs show fundamental limits on how well these problems can be approximated, even with significant computational resources. This framework provides a principled way to understand which interpretability queries are computationally feasible and which are fundamentally limited.

## Foundational Learning
- **Boolean Circuit Complexity**: Understanding the computational resources needed to solve problems on Boolean circuits
  - Why needed: The core objects being analyzed are neural network circuits, which can be represented as Boolean circuits
  - Quick check: Can you explain the difference between P, NP, and Σ₂ᴾ complexity classes?

- **Reduction Techniques**: Methods for proving computational hardness by transforming one problem into another
  - Why needed: The paper uses reductions from Subset Sum and Dominating Set to establish hardness results
  - Quick check: Can you describe how a reduction from Subset Sum proves NP-hardness?

- **Fixed-Parameter Tractability**: Analyzing problems where complexity depends on certain parameters
  - Why needed: The paper examines whether constraining model features makes problems tractable
  - Quick check: What does W[1]-hardness imply about fixed-parameter tractability?

- **Approximability Theory**: Understanding how well optimization problems can be approximated
  - Why needed: The paper proves certain queries cannot be approximated under various schemes
  - Quick check: Can you explain the difference between additive and multiplicative approximation?

## Architecture Onboarding

**Component Map:**
Boolean Circuit Model -> Interpretability Queries -> Complexity Analysis -> Tractability Assessment

**Critical Path:**
Circuit formalization → Query definition → Complexity classification → Practical implications

**Design Tradeoffs:**
The paper trades comprehensiveness (covering many query types) against specificity (focusing on single-layer Boolean circuits rather than general architectures). This allows for rigorous proofs but limits direct applicability to real-world multi-layer networks.

**Failure Signatures:**
- If a circuit discovery problem is NP-hard, exact solutions are computationally infeasible for large instances
- W[1]-hardness indicates that even with structural constraints, the problem remains intractable
- Inapproximability results mean that even approximate solutions cannot be guaranteed to be close to optimal

**3 First Experiments:**
1. Implement the quasi-minimal sufficient circuit algorithm on small Boolean circuits to verify tractability claims
2. Apply the circuit patching algorithm to a synthetic neural network and measure computational resources
3. Test whether practical instances of NP-hard queries fall into tractable parameter regimes

## Open Questions the Paper Calls Out
None

## Limitations
- Analysis focuses on Boolean circuits with single-layer neural network architectures, leaving multi-layer and continuous architectures unexamined
- Hardness proofs rely on worst-case reductions that may not reflect practical instances encountered in real models
- Approximability results apply to specific schemes (additive, multiplicative, probabilistic) but do not exhaust all possible approximation frameworks

## Confidence

**Major claim clusters confidence:**
- Computational hardness results: **High** - reductions from well-established NP and Σ₂ᴾ problems provide strong theoretical grounding
- Fixed-parameter intractability: **Medium** - W[1]-hardness proofs are sound but the practical implications for parameter constraints need empirical validation
- Approximability limits: **Medium** - reductions establish theoretical barriers, but the restricted schemes examined may not capture all practical approximation approaches

## Next Checks
1. Empirical evaluation of whether practical circuit discovery instances fall into tractable parameter regimes identified by the analysis
2. Extension of complexity analysis to multi-layer architectures and continuous-valued activation functions
3. Investigation of alternative approximation schemes not covered by the additive, multiplicative, and probabilistic frameworks analyzed in the paper