---
ver: rpa2
title: Denoising Plane Wave Ultrasound Images Using Diffusion Probabilistic Models
arxiv_id: '2408.10987'
source_url: https://arxiv.org/abs/2408.10987
tags:
- image
- ultrasound
- images
- data
- denoising
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces a novel approach to denoise ultrasound plane
  wave images using Denoising Diffusion Probabilistic Models (DDPMs). The method adapts
  DDPM to beamformed radiofrequency (RF) data, treating the distinction between low-angle
  and high-angle compounding plane waves as noise.
---

# Denoising Plane Wave Ultrasound Images Using Diffusion Probabilistic Models

## Quick Facts
- arXiv ID: 2408.10987
- Source URL: https://arxiv.org/abs/2408.10987
- Reference count: 40
- Primary result: Novel DDPM-based method for ultrasound plane wave denoising that achieves superior image quality with fewer iterations than traditional approaches

## Executive Summary
This paper introduces a novel approach to denoise ultrasound plane wave images using Denoising Diffusion Probabilistic Models (DDPMs). The method adapts DDPM to beamformed radiofrequency (RF) data, treating the distinction between low-angle and high-angle compounding plane waves as noise. It was trained on only 400 simulated images using natural image segmentation masks as intensity maps, enabling effective denoising across various anatomy shapes. The proposed method was evaluated on simulation, phantom, and in vivo images, showing significant improvements in image quality compared to existing methods.

## Method Summary
The method treats the difference between low-compounded and high-compounded plane waves as noise in a diffusion model framework. A CNN predicts this noise at each time step, allowing the reverse process to iteratively denoise the image. The model uses a U-Net-like architecture with time embeddings and is trained on simulated data generated using natural image segmentation masks. During inference, the reverse process starts from a single plane wave image rather than pure noise, reducing the number of required iterations. The method was trained for 350 epochs and evaluated on simulation, phantom, and in vivo data using metrics like CNR, gCNR, NRMSE, and SSIM.

## Key Results
- Outperforms existing methods (DANUIE, MSLAE, FCNN) on phantom data in terms of CNR, gCNR, and NRMSE
- Effective denoising across various anatomy shapes using only 400 simulated training images
- Successfully preserves speckle pattern while enhancing anatomical structure visibility
- Achieves clinically relevant denoising with only 3-7 reverse iterations

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The method reduces image noise by iteratively predicting the difference between low-compounded and high-compounded plane waves, treated as noise in the diffusion model.
- Mechanism: In the forward process, the difference between high-compounding (π0) and low-compounding (π1) images is modeled as a velocity term. A CNN predicts this velocity at each time step, allowing the reverse process to iteratively denoise the image.
- Core assumption: The difference between low- and high-compounding images can be approximated as a deterministic flow from π1 to π0.
- Evidence anchors:
  - [abstract]: "Specifically, the method considers the distinction between low-angle and high-angle compounding plane waves as noise and effectively eliminates it by adapting a DDPM to beamformed radiofrequency (RF) data."
  - [section]: "The analysis indicates that the distribution of this difference can be close to a Gaussian distribution."
- Break condition: If the difference distribution deviates significantly from Gaussian or deterministic flow assumptions, denoising performance will degrade.

### Mechanism 2
- Claim: The model achieves effective denoising with fewer iterations than traditional DDPMs by conditioning the reverse process on low-quality input images instead of pure noise.
- Mechanism: Traditional DDPMs start the reverse process from pure noise, requiring many steps. Here, the reverse process starts from a single PW image, reducing the number of required iterations.
- Core assumption: Starting from a noisy image close to the final result reduces the number of iterations needed compared to starting from pure noise.
- Evidence anchors:
  - [section]: "Our primary objective is to enhance the quality of a PW image initially constructed with a restricted number of compounded angles to closely resemble the quality of an image constructed using a larger number of angles."
  - [section]: "This conditioning helps us to reduce the required number of reverse steps, leading to less computations."
- Break condition: If the initial image is too far from the target quality, fewer iterations may not converge properly.

### Mechanism 3
- Claim: Training on simulated data with diverse anatomy shapes generalizes well to real phantom and in vivo data.
- Mechanism: Simulated images are generated using natural image segmentation masks as intensity maps, providing varied anatomical structures. The network learns to denoise based on these diverse shapes.
- Core assumption: Simulated data with diverse anatomical shapes captures the essential features needed for denoising real ultrasound images.
- Evidence anchors:
  - [abstract]: "The method underwent training using only 400 simulated images. In addition, our approach employs natural image segmentation masks as intensity maps for the generated images, resulting in accurate denoising for various anatomy shapes."
  - [section]: "The image simulation method outlined in this subsection has the benefit of supplying the network with more extensive features than just including simple cyst-shaped regions."
- Break condition: If real data contains features not represented in the simulated data, the model may fail to generalize.

## Foundational Learning

- Concept: Understanding of ultrasound plane wave imaging and its noise characteristics.
  - Why needed here: The method specifically targets denoising plane wave images, which have unique noise profiles compared to focused imaging.
  - Quick check question: What is the primary source of noise in plane wave ultrasound imaging compared to focused imaging?

- Concept: Knowledge of diffusion probabilistic models and their forward/reverse processes.
  - Why needed here: The method adapts DDPMs to ultrasound data, requiring understanding of how the forward and reverse processes work.
  - Quick check question: In a standard DDPM, what is the role of the forward process?

- Concept: Familiarity with deep learning architectures for image denoising (e.g., U-Net).
  - Why needed here: The method uses a CNN architecture inspired by U-Net for predicting noise parameters.
  - Quick check question: How does the U-Net architecture facilitate feature extraction in denoising tasks?

## Architecture Onboarding

- Component map: Time embedding module -> Convolutional blocks -> Loss function
- Critical path: Forward process → Noise prediction → Reverse process → Output denoised image
- Design tradeoffs:
  - Fewer iterations in reverse process reduce computation but may sacrifice some denoising quality
  - Using simulated data for training reduces cost but may limit generalization
- Failure signatures:
  - Artifacts in denoised images if the model overfits to simulated data
  - Poor performance if the noise distribution in real data differs from simulated data
- First 3 experiments:
  1. Test the model on a simulated image with known ground truth to verify denoising performance
  2. Evaluate the model on phantom data to assess generalization to real data
  3. Test the model on in vivo data to evaluate clinical applicability

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the performance of the DDPM-based denoising method compare to other deep learning-based methods when applied to real in vivo ultrasound data?
- Basis in paper: [explicit] The paper mentions that the proposed method outperforms other methods like DANUIE, MSLAE, and FCNN on phantom data and shows promising results on in vivo carotid artery data.
- Why unresolved: The paper does not provide a direct comparison of the proposed method with other deep learning-based methods on a large in vivo dataset.
- What evidence would resolve it: Conducting experiments on a large in vivo dataset and comparing the performance of the proposed method with other deep learning-based methods using metrics like CNR, gCNR, and SSIM would provide a definitive answer.

### Open Question 2
- Question: How does the number of reverse iterations in the proposed method affect the quality of the denoised ultrasound images?
- Basis in paper: [explicit] The paper mentions that the number of reverse iterations is set to 3, 5, and 7, and the resulting images are compared in terms of quality metrics and visual inspection.
- Why unresolved: The paper does not provide a systematic study on how the number of reverse iterations affects the denoising performance and whether there is an optimal number of iterations for different types of ultrasound data.
- What evidence would resolve it: Conducting experiments with different numbers of reverse iterations on various ultrasound datasets and analyzing the impact on quality metrics and visual inspection would help determine the optimal number of iterations.

### Open Question 3
- Question: Can the proposed method be extended to other ultrasound imaging modalities beyond plane wave imaging?
- Basis in paper: [explicit] The paper mentions that the method can be trained for other types of ultrasound imaging, such as focused and synthetic aperture imaging, by generating new simulated data and fine-tuning the network.
- Why unresolved: The paper does not provide experimental results on other ultrasound imaging modalities, and it is unclear how well the method would generalize to these different scenarios.
- What evidence would resolve it: Conducting experiments on other ultrasound imaging modalities using the proposed method and comparing the results with state-of-the-art methods would demonstrate the generalizability and effectiveness of the approach.

## Limitations

- Reliance on simulated data for training may not fully capture the complexity of real ultrasound images, potentially limiting clinical applicability
- Computational savings during inference may be offset by the complexity of the time embedding module
- Evaluation metrics (CNR, gCNR, NRMSE, SSIM) may not fully capture clinical relevance or diagnostic utility

## Confidence

**High Confidence**: The core DDPM framework adaptation and the general improvement in quantitative metrics (CNR, gCNR, NRMSE) compared to baseline methods.

**Medium Confidence**: The claim of effective denoising with fewer iterations, as this optimization strategy is somewhat novel for ultrasound applications.

**Low Confidence**: The generalizability of the model to diverse clinical applications and patient populations, given the limited training data (400 simulated images).

## Next Checks

1. **Cross-Institution Validation**: Test the trained model on ultrasound datasets from multiple institutions to assess robustness across different scanner models and acquisition protocols. Compare performance metrics and identify any systematic failures.

2. **Clinical Relevance Assessment**: Conduct a reader study with ultrasound experts to evaluate whether the denoised images provide meaningful improvements in diagnostic confidence and accuracy compared to raw plane wave images.

3. **Ablation Study on Iteration Count**: Systematically vary the number of reverse iterations (1-10) on both simulated and real data to quantify the trade-off between computational efficiency and denoising quality, identifying the optimal balance for different clinical scenarios.