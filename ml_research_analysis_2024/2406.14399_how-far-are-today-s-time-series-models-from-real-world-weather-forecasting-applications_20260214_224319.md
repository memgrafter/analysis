---
ver: rpa2
title: How far are today's time-series models from real-world weather forecasting
  applications?
arxiv_id: '2406.14399'
source_url: https://arxiv.org/abs/2406.14399
tags:
- i255
- weather
- data
- forecasting
- dataset
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper introduces the WEATHER-5K dataset, a comprehensive collection
  of 5,672 global weather stations with 10 years of hourly data. This dataset aims
  to bridge the gap between academic time-series forecasting models and real-world
  weather forecasting applications.
---

# How far are today's time-series models from real-world weather forecasting applications?

## Quick Facts
- arXiv ID: 2406.14399
- Source URL: https://arxiv.org/abs/2406.14399
- Authors: Tao Han; Song Guo; Zhenghao Chen; Wanghan Xu; Lei Bai
- Reference count: 40
- Introduces WEATHER-5K dataset and benchmarks TSF models against NWP models

## Executive Summary
This paper addresses the gap between academic time-series forecasting models and real-world weather forecasting applications by introducing the WEATHER-5K dataset, a comprehensive collection of 5,672 global weather stations with 10 years of hourly data. The dataset enables training and evaluation of time-series forecasting methods with real-world representativeness, overcoming limitations of existing small-scale, sparse datasets. Extensive benchmarking against operational Numerical Weather Prediction (NWP) models reveals that current TSF models lag behind NWP models, particularly for longer lead times, highlighting the need for developing spatial-aware forecasting methods and bridging GSWF with numerical prediction models.

## Method Summary
The paper introduces WEATHER-5K, a comprehensive dataset constructed from Integrated Surface Database (ISD) data from the National Centers for Environmental Information (NCEI), covering 5,672 weather stations worldwide with 10 years of hourly data (2014-2023) across 5 key weather variables and 2 auxiliary features. The dataset construction involves quality control, station selection (≥90% valid hourly data), and gap filling using ERA5 reanalysis. Nine baseline time-series forecasting models (Informer, Autoformer, Pyraformer, FEDformer, DLinear, PatchTST, Corrformer, Mamba, iTransformer) are implemented and evaluated using 48 input steps to predict 72 output steps, with training on 2014-2021, validation on 2022, and testing on 2023. The models are benchmarked against operational NWP models using MAE, MSE, and SEDI metrics for overall and extreme weather event prediction performance.

## Key Results
- WEATHER-5K dataset provides 5,672 weather stations with 10 years of hourly data, enabling comprehensive evaluation of time-series forecasting methods
- Current TSF models lag behind NWP models, particularly for longer lead times (3+ days), revealing a significant performance gap
- Different TSF models exhibit variable-specific preferences, with some showing better performance for long-term forecasting than others

## Why This Works (Mechanism)

### Mechanism 1
- **Claim:** WEATHER-5K enables training and evaluation of time-series forecasting models with real-world representativeness by providing extensive, globally distributed, long-term, hourly weather data.
- **Mechanism:** The dataset overcomes limitations of existing small-scale, sparse datasets by offering 5,672 weather stations worldwide with 10 years of hourly data across 5 key weather variables. This enables models to learn from more diverse patterns, seasonal variations, and spatial correlations that are critical for accurate weather forecasting.
- **Core assumption:** Larger and more diverse datasets improve the generalizability and performance of time-series forecasting models by exposing them to more complex patterns and spatial dependencies.
- **Evidence anchors:**
  - [abstract] "This is particularly problematic for time-series weather forecasting, where commonly used datasets suffer from significant limitations such as small size, limited temporal coverage, and sparse spatial distribution."
  - [section] "Our dataset offers a diverse temporal and spatial range of time-series data, enabling a comprehensive evaluation of time-series forecasting methods and driving significant advancements in the field."
  - [corpus] Found 25 related papers (using 8). Average neighbor FMR=0.44, average citations=0.0. Top related titles include comprehensive benchmarks for time series forecasting, indicating community interest in large-scale evaluation datasets.

### Mechanism 2
- **Claim:** The WEATHER-5K dataset exposes the gap between academic time-series forecasting models and operational Numerical Weather Prediction (NWP) models, especially for longer lead times.
- **Mechanism:** Benchmarking existing state-of-the-art forecasting methods (Informer, Autoformer, Pyraformer, etc.) against operational NWP models on WEATHER-5K reveals performance disparities, particularly as forecast horizon increases beyond 3 days.
- **Core assumption:** Operational NWP models incorporate complex physical modeling and data assimilation that current academic TSF models cannot match without spatial awareness and domain-specific adaptation.
- **Evidence anchors:**
  - [abstract] "Extensive benchmarking against operational Numerical Weather Prediction (NWP) models shows that current TSF models lag behind NWP models, particularly for longer lead times."
  - [section] "We observe that different models exhibit preferences for some variables... some models show preferences for long-term forecasting... the cumulative error stabilizes and increases significantly after the third day."
  - [corpus] The corpus includes papers on OOD generalization and comprehensive benchmarks, suggesting academic interest in bridging gaps between academic models and real-world applications.

### Mechanism 3
- **Claim:** WEATHER-5K enables development of spatial-aware time-series forecasting methods by providing geographically distributed station data with auxiliary spatial features.
- **Mechanism:** By including station coordinates (latitude, longitude) and elevation, the dataset allows models to learn spatial correlations between nearby stations, which is critical for capturing local weather patterns and improving prediction accuracy.
- **Core assumption:** Weather variables exhibit spatial dependencies that can be exploited by models incorporating geographic information, leading to better forecasts than purely temporal models.
- **Evidence anchors:**
  - [abstract] "The paper highlights the need for developing spatial-aware forecasting methods and bridging GSWF with numerical prediction models."
  - [section] "Our observation shows that different regions exhibit distinct weather patterns... while current forecasting methods do not fully capture global spatial relationships."
  - [corpus] Weak corpus support for spatial-aware TSF methods specifically, but related papers on multimodal and irregular time series suggest growing interest in incorporating auxiliary information beyond pure time series.

## Foundational Learning

- **Concept:** Time-series forecasting fundamentals (temporal dependencies, autocorrelation, seasonality)
  - Why needed here: Understanding how weather variables exhibit temporal patterns (daily, seasonal) is essential for evaluating model performance and interpreting results on WEATHER-5K.
  - Quick check question: What are the key temporal patterns observed in temperature data across different latitudes according to the dataset analysis?

- **Concept:** Numerical Weather Prediction (NWP) vs. data-driven forecasting
  - Why needed here: Recognizing the fundamental differences between physics-based NWP models and purely data-driven TSF models is crucial for interpreting the performance gap highlighted by WEATHER-5K benchmarking.
  - Quick check question: What are the two primary challenges of NWP models mentioned in the paper that motivate the need for GSWF approaches?

- **Concept:** Spatial autocorrelation and geographic information systems (GIS) basics
  - Why needed here: Understanding how weather variables correlate across geographic space is essential for leveraging the station coordinates and elevation data provided in WEATHER-5K to develop spatial-aware forecasting methods.
  - Quick check question: According to the dataset analysis, how does the spatial distribution of weather stations vary across different regions?

## Architecture Onboarding

- **Component map:** Data collection -> Quality control -> Station selection -> Variable processing -> Dataset construction -> Baseline model implementation -> Benchmarking -> Analysis -> Documentation
- **Critical path:** Data collection → Quality control → Station selection → Variable processing → Dataset construction → Baseline model implementation → Benchmarking → Analysis → Documentation
- **Design tradeoffs:**
  - Scale vs. quality: Including more stations increases dataset size but may introduce more missing data and interpolation errors
  - Temporal resolution: Hourly data provides fine-grained patterns but increases computational requirements for training and evaluation
  - Variable selection: Focusing on 5 key variables balances comprehensiveness with model complexity and data availability
- **Failure signatures:**
  - Poor model performance: May indicate insufficient training data, inappropriate model architecture, or failure to capture spatial dependencies
  - High interpolation error: Suggests inadequate quality control or excessive missing data in source stations
  - Computational bottlenecks: May result from dataset size, model complexity, or inefficient implementation
- **First 3 experiments:**
  1. **Baseline sanity check:** Run Informer on WEATHER-5K with default settings to verify data loading and basic functionality
  2. **Spatial correlation analysis:** Train Corrformer and compare performance to temporal-only baselines to assess value of spatial modeling
  3. **Lead time sensitivity:** Evaluate model performance across 1, 3, 5, and 7-day forecast horizons to identify performance degradation patterns

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What is the precise gap between current time-series forecasting models and NWP models for weather forecasting, particularly for longer lead times?
- Basis in paper: [explicit] The paper states that current TSF models lag behind NWP models, particularly for longer lead times, and highlights the significant performance disparity between TSF and NWP models.
- Why unresolved: While the paper benchmarks various TSF models against operational NWP models, it does not provide a detailed quantitative analysis of the exact performance gap between the two approaches for different lead times and variables.
- What evidence would resolve it: A comprehensive study comparing the performance of state-of-the-art TSF and NWP models on the WEATHER-5K dataset for various lead times (e.g., 1-day, 3-day, 5-day, 7-day) and weather variables, with statistical significance tests to determine the performance gap.

### Open Question 2
- Question: How can spatial information be effectively incorporated into time-series forecasting models to improve weather forecasting accuracy?
- Basis in paper: [explicit] The paper suggests that developing spatial-aware time-series forecasting methods is a key future research opportunity, as current models do not fully capture global spatial relationships.
- Why unresolved: While the paper mentions the potential benefits of incorporating spatial information, it does not provide specific approaches or techniques for effectively integrating spatial data into TSF models.
- What evidence would resolve it: A study exploring various methods for incorporating spatial information (e.g., geographical coordinates, spatial dependencies) into TSF models and evaluating their impact on weather forecasting accuracy compared to traditional temporal-only models.

### Open Question 3
- Question: How can time-series forecasting models be optimized to better capture extreme weather events?
- Basis in paper: [explicit] The paper highlights that current TSF models struggle to effectively capture extreme values, especially for lower and upper percentiles, and suggests that paying more attention to extreme values is a research direction for future time-series forecasting.
- Why unresolved: The paper does not provide specific techniques or model modifications to improve the prediction of extreme weather events.
- What evidence would resolve it: A study investigating methods to enhance the prediction of extreme weather events, such as using specialized loss functions, data augmentation techniques, or model architectures designed to capture rare events, and evaluating their performance on the WEATHER-5K dataset.

## Limitations

- The exact data preprocessing steps for handling missing values and ensuring hourly data availability are not fully detailed, potentially affecting reproducibility.
- The comparison with NWP models may be limited by differences in input/output formats and evaluation protocols, making direct performance comparisons challenging.
- The dataset's spatial coverage, while extensive, may still have gaps in certain regions, limiting the generalizability of models trained on WEATHER-5K.

## Confidence

- **High confidence**: The claim that WEATHER-5K provides a comprehensive, globally distributed dataset for time-series weather forecasting is well-supported by the detailed dataset construction process and the extensive number of weather stations included.
- **Medium confidence**: The assertion that current TSF models lag behind NWP models for longer lead times is supported by benchmarking results, but the direct comparability of NWP models and TSF models remains uncertain due to potential differences in evaluation metrics and operational contexts.
- **Medium confidence**: The need for spatial-aware forecasting methods is highlighted, but the evidence from the dataset analysis is limited, and the potential benefits of incorporating geographic information into TSF models are not fully explored.

## Next Checks

1. **Data Quality Verification**: Conduct a thorough analysis of the dataset's quality control procedures and interpolation methods to ensure the reliability of the data and identify any potential biases introduced during preprocessing.
2. **Hyperparameter Sensitivity Analysis**: Perform experiments with different hyperparameter settings for the baseline models to assess the robustness of the benchmarking results and identify the optimal configurations for each model.
3. **Spatial Correlation Analysis**: Investigate the spatial autocorrelation patterns in the dataset and evaluate the performance of spatial-aware forecasting methods, such as Corrformer, against purely temporal models to quantify the benefits of incorporating geographic information.