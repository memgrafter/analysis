---
ver: rpa2
title: Towards Complete Causal Explanation with Expert Knowledge
arxiv_id: '2407.07338'
source_url: https://arxiv.org/abs/2407.07338
tags:
- lemma
- edge
- path
- ancestral
- graph
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper studies the problem of restricting a Markov equivalence
  class of maximal ancestral graphs (MAGs) to only those MAGs that contain certain
  edge marks, which we refer to as expert or orientation knowledge. Such a restriction
  of the Markov equivalence class can be uniquely represented by a restricted essential
  ancestral graph.
---

# Towards Complete Causal Explanation with Expert Knowledge

## Quick Facts
- arXiv ID: 2407.07338
- Source URL: https://arxiv.org/abs/2407.07338
- Reference count: 20
- One-line primary result: Presents new orientation rules and algorithms for restricting Markov equivalence classes of maximal ancestral graphs with expert knowledge

## Executive Summary
This paper addresses the problem of incorporating expert orientation knowledge into causal structure learning with latent confounders. The authors extend previous work by developing new graphical orientation rules and algorithms for adding orientation knowledge to essential ancestral graphs while preserving their fundamental properties. They prove several properties of Markov equivalence classes and provide both an algorithm for adding orientation knowledge and a verification algorithm for checking completeness in the general case.

## Method Summary
The method involves starting with an essential ancestral graph representing a Markov equivalence class of maximal ancestral graphs (MAGs), then incorporating expert orientation knowledge using Algorithm 2 (addOrKnowledge). This algorithm iteratively applies new orientation rules (R11-R13, R4) alongside existing rules to propagate logical consequences while maintaining the graph's ancestral and maximal properties. When completeness is not guaranteed by specific scenarios, Algorithm 3 (verifyCompleteness) checks whether the resulting graph is a valid restricted essential ancestral graph by examining ancestry, minimal collider paths, and viable complementary orientations.

## Key Results
- Proved properties for entire Markov equivalence classes, including a conjecture from Ali et al. (2009)
- Developed new sound graphical orientation rules (R11-R13, R4) for incorporating expert knowledge
- Showed that some Zhang (2008b) orientation rules are unnecessary for this setting
- Provided algorithms for both adding orientation knowledge and verifying restricted essential ancestral graphs
- Demonstrated completeness in specific scenarios while acknowledging limitations in the general case

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Adding orientation knowledge to an essential ancestral graph and closing under new orientation rules yields a restricted essential ancestral graph
- Mechanism: The addOrKnowledge algorithm iteratively incorporates each piece of orientation knowledge, applies closure rules to propagate logical consequences, and ensures the resulting graph remains ancestral and maximal while preserving invariant edge marks
- Core assumption: The orientation knowledge is consistent with at least one MAG in the original Markov equivalence class
- Evidence anchors:
  - [abstract] "We provide an algorithm for including this orientation knowledge and show that in certain settings the output of our algorithm is a restricted essential ancestral graph"
  - [section 6] "Algorithm 2 takes as input a partial mixed graph G, which could be an essential or a restricted essential ancestral graph, and a set of expert knowledge K"
- Break condition: Algorithm fails when attempting non-admissible orientation knowledge, creating directed/almost directed cycles of length 3, or adding new unshielded colliders or colliders discriminated by paths

### Mechanism 2
- Claim: New orientation rules (R11-R13, revised R4) enable completeness in specific scenarios where original rules are insufficient
- Mechanism: These rules capture additional logical relationships between edge orientations that arise with latent variables, allowing inference of edge marks invariant across the restricted Markov equivalence class
- Core assumption: The essential ancestral graph has no minimal collider paths, or expert knowledge doesn't orient certain edges as bidirected, or all variant edge marks are fully specified
- Evidence anchors:
  - [section 5] "We present several new graphical orientation rules that are distinct from R1-R3, Zhao-R4, and R8-R10"
  - [section 6.2] "We prove that a graph output by Algorithm 2 will be sound and complete in specific scenarios"
- Break condition: Orientation rules are not complete in general setting, requiring additional rule R14 and resulting in verifyCompleteness returning FALSE in some cases

### Mechanism 3
- Claim: Algorithm 3 can verify whether a partial mixed graph is a restricted essential ancestral graph
- Mechanism: The algorithm systematically constructs graphs with different edge orientation combinations and checks whether these graphs satisfy restricted essential ancestral graph properties relative to the original essential graph
- Core assumption: Input graph was obtained by applying addOrKnowledge to an essential ancestral graph and orientation knowledge
- Evidence anchors:
  - [section 6.3] "In the absence of general completeness, we devise the verifyCompleteness algorithm for checking whether a partial mixed graph is a restricted essential ancestral graph"
  - [section 6.4] "Our simulations, verifyCompleteness(G,K,Gâ€²) has never returned FALSE"
- Break condition: Algorithm returns FALSE if graph contains directed/almost directed cycles of length 3, new unshielded colliders or colliders discriminated by paths, or has unviable complementary orientations

## Foundational Learning

- Concept: Markov equivalence class of MAGs
  - Why needed here: The entire framework is built around restricting a Markov equivalence class of MAGs to a subset that satisfies certain orientation knowledge
  - Quick check question: What is the unique partial mixed graph that represents a Markov equivalence class of MAGs?

- Concept: Essential ancestral graph
  - Why needed here: The essential ancestral graph is the starting point for incorporating orientation knowledge and is the unique representative of the Markov equivalence class
  - Quick check question: What types of edges can an essential ancestral graph contain, and what do they represent?

- Concept: Ancestral and maximal graphs
  - Why needed here: The resulting restricted essential ancestral graph must be both ancestral (no directed or almost directed cycles) and maximal (no inducing paths) to represent a valid set of MAGs
  - Quick check question: What are the two key properties that a partial mixed graph must satisfy to represent a set of MAGs?

## Architecture Onboarding

- Component map:
  addOrKnowledge algorithm -> Orientation rules (R1-R4, R8-R13) -> Restricted essential ancestral graph
  verifyCompleteness algorithm -> Check ancestry, minimal collider paths, viable complementary orientations

- Critical path:
  1. Start with an essential ancestral graph representing the Markov equivalence class
  2. Add orientation knowledge using addOrKnowledge algorithm
  3. If completeness is guaranteed by specific settings, output is the restricted essential ancestral graph
  4. Otherwise, use verifyCompleteness to check if output is a restricted essential ancestral graph

- Design tradeoffs:
  - Orientation rules are not complete in general setting, requiring computationally expensive verifyCompleteness algorithm
  - Completeness proofs rely on specific graph structures (no minimal collider paths) that may not always hold
  - Algorithm assumes orientation knowledge is consistent with at least one MAG in original Markov equivalence class

- Failure signatures:
  - addOrKnowledge fails: Non-admissible orientation knowledge or creation of directed/almost directed cycles or new colliders
  - verifyCompleteness returns FALSE: Non-ancestral graph, new minimal collider paths, or unviable complementary orientations

- First 3 experiments:
  1. Test addOrKnowledge on a simple essential ancestral graph with a single piece of orientation knowledge that is known to be consistent
  2. Verify that the output graph is ancestral and has the same minimal collider paths as the input graph
  3. Use verifyCompleteness to check if the output graph is a restricted essential ancestral graph, and compare the result with the expected outcome

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Is the set of orientation rules R1-R4, R8-R13 complete for general restricted essential ancestral graphs in the presence of latent confounding?
- Basis in paper: [explicit] The authors state that "our orientation rules are not complete in the general setting" and discovered R14 while their work was under review
- Why unresolved: While simulations never produced incompleteness, the authors acknowledge that cases of incompleteness occur in graphs that are difficult to elicit through simulations
- What evidence would resolve it: A proof of completeness or an explicit counterexample showing incompleteness of the current rule set, or discovery of additional orientation rules that handle the problematic cases

### Open Question 2
- Question: Can causal effect identification and estimation be performed given a restricted essential ancestral graph, and how do these results compare to those obtained from an unrestricted essential ancestral graph?
- Basis in paper: [explicit] The authors explicitly state "The remaining open questions also include considerations of expert knowledge in the presence of selection bias" and "The general completeness problem remains open" in the discussion section
- Why unresolved: The paper focuses on the theoretical foundation of restricting Markov equivalence classes but does not address the practical implications for causal inference once such restrictions are made
- What evidence would resolve it: Empirical studies comparing causal effect identification rates and estimation accuracy between restricted and unrestricted essential ancestral graphs on real-world datasets

### Open Question 3
- Question: How can expert knowledge be effectively incorporated into causal discovery algorithms in the presence of selection bias?
- Basis in paper: [inferred] The authors mention "The remaining open questions also include considerations of expert knowledge in the presence of selection bias" and note that their work "does not cover the topics of causal effect identification or estimation given a restricted essential ancestral graph"
- Why unresolved: The paper assumes no selection bias in its theoretical framework, but selection bias is a common issue in observational data that could invalidate the orientation rules and completeness results
- What evidence would resolve it: Extension of the orientation rules and completeness proofs to handle selection bias scenarios, validated through simulation studies and real-world applications

## Limitations

- The orientation rules (R11-R13, R4) are not complete in the general setting, requiring the computationally expensive verifyCompleteness algorithm in many cases
- Completeness theorems only apply under restrictive conditions (no minimal collider paths or very specific expert knowledge properties)
- Runtime complexity of verifyCompleteness is not fully characterized, making scalability assessment difficult

## Confidence

- Orientation rules completeness in general setting: Medium - Rules are proven sound and complete in specific scenarios, but general completeness remains unproven
- Completeness theorems validity: Medium - Depend on restrictive conditions that may not hold in practice
- Practical feasibility for large graphs: Low - Without clear complexity analysis of verifyCompleteness, scalability is uncertain

## Next Checks

1. Implement Algorithm 2 (addOrKnowledge) and verify its behavior on simple essential ancestral graphs with known consistent orientation knowledge, checking that it produces ancestral graphs with preserved minimal collider paths

2. Systematically test verifyCompleteness on graphs where the completeness theorems don't apply, measuring its runtime complexity as a function of graph size and density to establish scalability bounds

3. Extend the experimental evaluation to include cases with minimal collider paths and partial orientation knowledge to assess the practical limitations of the current rule set and identify scenarios requiring additional rules