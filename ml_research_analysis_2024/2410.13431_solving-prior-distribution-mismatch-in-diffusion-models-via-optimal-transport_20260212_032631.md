---
ver: rpa2
title: Solving Prior Distribution Mismatch in Diffusion Models via Optimal Transport
arxiv_id: '2410.13431'
source_url: https://arxiv.org/abs/2410.13431
tags:
- prior
- diffusion
- distribution
- error
- optimal
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the prior distribution mismatch problem in
  diffusion models (DMs), where the forward terminal distribution and reverse initial
  distribution fail to align, causing degraded generation quality and sampling efficiency.
  The authors propose an optimal transport (OT)-based framework to eliminate this
  mismatch.
---

# Solving Prior Distribution Mismatch in Diffusion Models via Optimal Transport
## Quick Facts
- arXiv ID: 2410.13431
- Source URL: https://arxiv.org/abs/2410.13431
- Reference count: 36
- Key outcome: Proposes OT-based framework to eliminate prior distribution mismatch in DMs, achieving complete prior error elimination (W₂=0) and improved generation quality

## Executive Summary
This paper addresses a fundamental limitation in diffusion models (DMs) where the forward terminal distribution and reverse initial distribution fail to align, causing degraded generation quality and sampling efficiency. The authors propose an optimal transport (OT)-based framework that constructs an OT map from the reverse initial distribution to the forward terminal distribution, enabling precise distribution matching. The method is theoretically proven to eliminate prior error with an upper bound quantified using Wasserstein distance, while maintaining compatibility with DMs' intrinsic mechanisms through asymptotic consistency between dynamic OT and probability flow.

## Method Summary
The proposed method introduces an optimal transport framework to solve the prior distribution mismatch problem in diffusion models. The core approach constructs an OT map that transforms the reverse initial distribution to match the forward terminal distribution precisely. This is achieved by formulating the alignment as an optimal transport problem and solving for the transport map between these distributions. The authors prove that this approach effectively eliminates prior error, with the theoretical guarantee that the Wasserstein distance between aligned distributions approaches zero. The method maintains compatibility with DMs' intrinsic mechanisms through asymptotic consistency between dynamic optimal transport and probability flow, ensuring that the OT-based correction integrates seamlessly with the diffusion process.

## Key Results
- Complete elimination of prior error both theoretically (W₂=0) and practically demonstrated
- Superior FID scores achieved on multiple datasets including CIFAR-10, CelebA, FFHQ, and AFHQ
- Improved sampling efficiency with reduced sampling steps compared to baseline methods

## Why This Works (Mechanism)
The method works by directly addressing the fundamental mismatch between the forward terminal distribution (typically Gaussian) and the reverse initial distribution in diffusion models. By constructing an optimal transport map between these distributions, the approach ensures precise alignment that eliminates the source of prior error. The theoretical proof establishes that this alignment guarantees convergence to the target distribution without the bias introduced by mismatched priors. The asymptotic consistency with probability flow ensures that the OT correction integrates naturally with the diffusion dynamics rather than disrupting them.

## Foundational Learning
**Optimal Transport Theory**: Framework for finding optimal mappings between probability distributions; needed to construct the transport map between forward and reverse distributions; quick check: verify Wasserstein distance computation correctness.
**Diffusion Model Mechanics**: Understanding forward noising and reverse denoising processes; needed to identify where prior mismatch occurs; quick check: confirm reverse process initialization matches theoretical expectations.
**Probability Flow ODE**: Continuous-time formulation of diffusion processes; needed to establish consistency with dynamic OT; quick check: verify numerical integration stability.

## Architecture Onboarding
**Component Map**: Forward Process -> Terminal Distribution -> Optimal Transport Map -> Reverse Initial Distribution -> Reverse Process
**Critical Path**: The transport map construction and application represents the critical path, as errors here directly impact generation quality and prior error elimination.
**Design Tradeoffs**: The method trades computational overhead of OT map construction for improved generation quality and reduced sampling steps. This represents a space-time tradeoff where pre-computation enables faster sampling.
**Failure Signatures**: If the OT map is poorly estimated or the distributions are too dissimilar, the method may fail to eliminate prior error completely, leading to generation artifacts or mode collapse.
**3 First Experiments**: 1) Verify Wasserstein distance computation on simple Gaussian distributions, 2) Test OT map application on synthetic data with known ground truth, 3) Compare FID scores on CIFAR-10 with varying numbers of sampling steps.

## Open Questions the Paper Calls Out
None identified in the provided material.

## Limitations
- Computational complexity of constructing and applying OT maps in high-dimensional spaces remains unaddressed
- Assumption that forward terminal distribution is known and fixed may not hold in conditional generation scenarios
- Asymptotic consistency relies on specific mathematical conditions that may not always be satisfied in practice

## Confidence
- **High confidence**: Theoretical framework for using optimal transport to address prior distribution mismatch is mathematically rigorous
- **Medium confidence**: Experimental results showing complete prior error elimination and improved FID scores are promising but based on standard benchmarks
- **Low confidence**: Claim about "accelerated inference" needs careful examination due to OT map computation overhead

## Next Checks
1. Conduct ablation studies comparing total computational cost (including OT map computation) against baseline diffusion models across different sampling step configurations
2. Apply the method to conditional generation tasks where the forward terminal distribution may not be fixed or known a priori
3. Evaluate performance on high-resolution image datasets and assess how OT map computation scales with dimensionality