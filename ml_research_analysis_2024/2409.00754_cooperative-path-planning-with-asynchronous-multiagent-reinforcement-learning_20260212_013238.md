---
ver: rpa2
title: Cooperative Path Planning with Asynchronous Multiagent Reinforcement Learning
arxiv_id: '2409.00754'
source_url: https://arxiv.org/abs/2409.00754
tags:
- road
- time
- network
- agent
- vehicles
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper studies the shortest path problem (SPP) with multiple
  source-destination pairs (MSD) in a road network, where the goal is to minimize
  average travel time while considering traffic capacity limits. The authors propose
  an asynchronous multi-agent reinforcement learning (asyn-MARL) framework to address
  the inefficiency and ineffectiveness of existing works in this asynchronous setting.
---

# Cooperative Path Planning with Asynchronous Multiagent Reinforcement Learning

## Quick Facts
- arXiv ID: 2409.00754
- Source URL: https://arxiv.org/abs/2409.00754
- Authors: Jiaming Yin; Weixiong Rao; Yu Xiao; Keshuang Tang
- Reference count: 40
- One-line primary result: Asyn-MARL framework outperforms state-of-the-art approaches in throughput, travel time, and CO2 emissions for multi-source-destination shortest path planning

## Executive Summary
This paper addresses the shortest path problem with multiple source-destination pairs (MSD-SPP) in road networks, where the goal is to minimize average travel time while considering traffic capacity limits. The key challenge is the asynchronous nature of the problem, where vehicles cannot simultaneously complete routing actions. The authors propose an asynchronous multi-agent reinforcement learning (asyn-MARL) framework that divides the road network into sub-graphs and executes a two-stage process of inter-region and intra-region route planning. The framework is evaluated on both synthetic and real road networks, demonstrating superior performance compared to state-of-the-art planning approaches.

## Method Summary
The paper proposes an asyn-MARL framework for MSD-SPP in road networks. The method divides the road network into M regions using the METIS algorithm, transforming vehicle routing into routing between regions followed by routing within destination regions. The inter-region planning is formulated as a Dec-POMDP and solved using the asyn-MARL framework, which includes a global state representation, asynchronous trajectory collection, and a reachability graph to prevent loops. Each region agent uses actor-critic networks with GRUs to encode request information. The framework is trained using the MAPPO algorithm and evaluated on synthetic (100-node) and real (2515-node Koln) networks.

## Key Results
- The asyn-MARL framework achieves higher throughput (more vehicles reaching destinations) compared to baselines including Random, SP, SPFR, Q-Routing, and AN approaches
- Average travel time is reduced compared to baseline methods, with the framework maintaining better performance as traffic volume increases
- CO2 emissions are lower with the proposed framework, indicating more efficient routing that reduces congestion and idle time

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Dividing the road network into regions reduces the complexity of multi-agent coordination from vehicle-level to region-level
- Mechanism: By modeling each region as an agent, the framework decomposes the original MSD-SPP problem into multiple sub-paths on smaller sub-graphs, making it scalable to large road networks
- Core assumption: Each region agent can observe and control the traffic within its sub-graph effectively
- Evidence anchors:
  - [abstract]: "we propose to divide an entire road network into multiple sub-graphs and subsequently execute a two-stage process of inter-region and intra-region route planning."
  - [section]: "We divide the road network into M regions, and transform the vehicle routing from source to destination intersections into the routing from source to destination regions, followed by routing within the destination region towards the destination intersection."
  - [corpus]: Weak evidence - no direct mention of graph partitioning for scalability in related works
- Break condition: If the region division creates too many cutting edges, the action space for region agents becomes too large, negating the scalability benefit

### Mechanism 2
- Claim: The global state design implicitly represents joint observations and actions of all agents, maintaining stationarity in the asynchronous setting
- Mechanism: Instead of explicitly representing joint observations and actions (which vary in dimensionality in asynchronous settings), a low-dimensional global state vector is used to capture the traffic state on cutting edges, which implicitly encodes the joint state of all region agents
- Core assumption: The traffic state on cutting edges is sufficient to represent the joint state of all agents in the asynchronous MSD-SPP setting
- Evidence anchors:
  - [abstract]: "we first design a global state, which exploits a low-dimensional vector to implicitly represent the joint observations and actions of multi-agents."
  - [section]: "We define the global state st at time step t as the concatenation of the features regarding all cutting edges E c in the road network G."
  - [corpus]: Weak evidence - no direct mention of global state design for asynchronous MARL in related works
- Break condition: If the global state becomes too high-dimensional due to a large number of cutting edges, it loses the benefit of being a low-dimensional representation

### Mechanism 3
- Claim: The asynchronous trajectory collection mechanism avoids redundancy in training data and improves training efficiency
- Mechanism: Instead of collecting joint transitions of all agents at each time step (which leads to redundancy in asynchronous settings), each agent independently inserts its own transition into a separate buffer when it takes an action
- Core assumption: The asynchronous nature of the MSD-SPP setting allows for independent transition collection without losing important information
- Evidence anchors:
  - [abstract]: "we develop an asynchronous trajectory collection mechanism to decrease the redundancy in training trajectories."
  - [section]: "Whenever an agent Ri takes an action, it inserts its own trajectory data into a separate buffer Di."
  - [corpus]: Weak evidence - no direct mention of asynchronous trajectory collection in related works
- Break condition: If the asynchronous collection misses important correlations between agent actions that occur at different time steps, the learned policy may be suboptimal

## Foundational Learning

- Concept: Multi-agent reinforcement learning (MARL) and the centralized training decentralized execution (CTDE) paradigm
  - Why needed here: The problem involves multiple vehicles (agents) cooperating to find shortest paths in a road network, and the CTDE paradigm is used to train the region agents
  - Quick check question: What is the key challenge in MARL that the CTDE paradigm addresses, and how does it do so?

- Concept: Decentralized partial observable Markov decision process (Dec-POMDP)
  - Why needed here: The inter-region routing problem is formulated as a Dec-POMDP, where each region agent has partial observability of the global state
  - Quick check question: How does the Dec-POMDP formulation differ from a standard MDP, and why is it appropriate for this problem?

- Concept: Graph partitioning and the METIS algorithm
  - Why needed here: The road network is divided into regions using graph partitioning, and the METIS algorithm is used to minimize the number of cutting edges and ensure balanced region sizes
  - Quick check question: What is the objective of graph partitioning in this context, and how does the METIS algorithm achieve it?

## Architecture Onboarding

- Component map: Graph division module -> Inter-region planning module (asyn-MARL) -> Intra-region planning module -> Vehicle routing
- Critical path: Graph division → Inter-region planning (asyn-MARL) → Intra-region planning → Vehicle routing
- Design tradeoffs:
  - Region size vs. action space: Smaller regions reduce the complexity of intra-region planning but increase the number of cutting edges and action space for inter-region planning
  - Global state dimensionality vs. representation power: A lower-dimensional global state is easier to learn but may not capture all relevant information
  - Asynchronous vs. synchronous training: Asynchronous training avoids redundancy but may miss important correlations between agent actions
- Failure signatures:
  - High travel times or CO2 emissions: Indicates poor cooperation among region agents or suboptimal route planning
  - Infinite loops in vehicle paths: Suggests the reachability graph is not effectively pruning invalid actions
  - Poor scalability: Indicates the region division is not effectively reducing the complexity of the problem
- First 3 experiments:
  1. Evaluate the impact of region size on performance by varying the number of regions and measuring throughput, average travel time, and CO2 emissions
  2. Compare the performance of the asyn-MARL framework with and without the global state design to assess its effectiveness in maintaining stationarity
  3. Test the reachability graph's ability to prevent infinite loops by introducing a scenario where incorrect routing decisions would lead to loops and measuring the success rate of the framework in avoiding them

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the proposed asyn-MARL framework perform under varying levels of network capacity constraints beyond the tested limits (8, 10, 12 vehicles per road segment)?
- Basis in paper: [explicit] The paper states "Section 5.4.5 will evaluate the performance of asyn-MARL under various capacity limits and maximum traffic volumes on the synthetic network" but only tests a limited range of capacity limits
- Why unresolved: The evaluation only covers a narrow range of capacity limits, leaving open the question of how the framework scales to more extreme congestion scenarios or more relaxed capacity constraints
- What evidence would resolve it: Additional experiments testing a wider range of capacity limits, including both more congested and less congested scenarios, would provide insights into the framework's robustness and adaptability to different traffic conditions

### Open Question 2
- Question: What is the computational overhead of the proposed two-stage routing framework compared to centralized approaches, and how does it scale with network size and number of vehicles?
- Basis in paper: [inferred] The paper claims scalability benefits from the two-stage approach but doesn't provide detailed computational complexity analysis or comparisons with centralized methods
- Why unresolved: While the paper mentions scalability advantages, it lacks quantitative analysis of computational overhead and scaling behavior, which is crucial for practical deployment
- What evidence would resolve it: A comprehensive computational complexity analysis comparing the proposed framework with centralized approaches, along with empirical measurements of runtime and memory usage across various network sizes and vehicle counts, would address this question

### Open Question 3
- Question: How sensitive is the performance of asyn-MARL to the choice of hyperparameters, such as the number of regions, embedding dimensions, and learning rates?
- Basis in paper: [explicit] The paper mentions that "we tune the number of divided regions mainly depending upon the capacity of region agents" and provides some hyperparameter values, but doesn't conduct a systematic sensitivity analysis
- Why unresolved: The paper doesn't explore the impact of hyperparameter choices on performance, leaving uncertainty about the robustness of the framework to different parameter settings
- What evidence would resolve it: A systematic hyperparameter sensitivity analysis, including ablation studies and parameter sweep experiments, would reveal the impact of different hyperparameter choices on the framework's performance and robustness

## Limitations

- The scalability claims rely heavily on the assumption that region-based decomposition maintains good performance, but experiments only validate on two network sizes (100 and 2515 nodes)
- The baselines chosen (particularly Random and SP) may not represent the strongest existing approaches for this problem domain
- The claim that asynchronous trajectory collection significantly improves training efficiency lacks direct empirical validation - no comparison with synchronous alternatives is provided

## Confidence

- **High confidence**: The core mechanism of using a global state to maintain stationarity in asynchronous settings is well-supported by the theoretical framework and implementation details
- **Medium confidence**: The performance improvements over baselines are demonstrated, but the baselines chosen may not represent the strongest existing approaches for this problem domain
- **Low confidence**: The claim that asynchronous trajectory collection significantly improves training efficiency lacks direct empirical validation - no comparison with synchronous alternatives is provided

## Next Checks

1. Test the framework on a larger, more diverse set of road networks (varying in size, topology, and traffic patterns) to validate scalability claims across different scenarios

2. Implement a synchronous MARL baseline using the same CTDE framework to empirically measure the claimed efficiency gains from asynchronous trajectory collection

3. Conduct ablation studies to quantify the individual contributions of the global state design, asynchronous trajectory collection, and reachability graph to overall performance