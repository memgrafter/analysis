---
ver: rpa2
title: 'Adjustment Identification Distance: A gadjid for Causal Structure Learning'
arxiv_id: '2402.08616'
source_url: https://arxiv.org/abs/2402.08616
tags:
- adjustment
- causal
- nodes
- walk
- node
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: We introduce a framework for developing distances between causal
  graphs based on how well they identify causal effects. Our framework enables the
  development of distances that canonically extend to CPDAGs with low polynomial runtime
  complexity.
---

# Adjustment Identification Distance: A gadjid for Causal Structure Learning

## Quick Facts
- arXiv ID: 2402.08616
- Source URL: https://arxiv.org/abs/2402.08616
- Authors: Leonard Henckel; Theo Würtzen; Sebastian Weichbaum
- Reference count: 40
- Key outcome: Introduces a framework for developing distances between causal graphs based on how well they identify causal effects, enabling efficient CPDAG distance computation with polynomial runtime complexity

## Executive Summary
This paper introduces a novel framework for measuring distances between causal graphs based on their ability to identify causal effects rather than just their structural differences. The framework develops three adjustment-based distance metrics (Parent-AID, Ancestor-AID, and Oset-AID) that extend canonically to CPDAGs with efficient polynomial-time computation. The implementation in the gadjid package demonstrates orders-of-magnitude speed improvements over existing alternatives and scales to previously prohibitive graph sizes.

## Method Summary
The framework defines distances between causal graphs by measuring how well identification formulas derived from one graph work in another. Given a sound and complete identification strategy I, the I-specific identification distance between two graphs Gtrue and Gguess counts the number of node pairs where Gguess's identification formula is incorrect in Gtrue. The framework develops efficient reachability algorithms to compute these distances without enumerating all DAGs in CPDAG equivalence classes. Three adjustment strategies are proposed: parent adjustment (local, O(p²) for sparse graphs), ancestor adjustment (captures causal order, O(p(p+m))), and optimal adjustment (statistically efficient, O(p²(p+m))).

## Key Results
- Parent-AID provides a canonical extension of Structural Intervention Distance to CPDAGs with O(p²) complexity for sparse graphs
- Ancestor-AID captures causal order similarity between DAGs with O(p(p+m)) complexity
- Oset-AID uses statistically efficient adjustment sets with O(p²(p+m)) complexity
- Implementation achieves orders-of-magnitude speedups over existing alternatives
- Scales to graph sizes previously prohibitive for CPDAG distance computation

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The framework creates a distance metric that reflects causal effect identifiability differences between graphs
- Mechanism: By defining distances based on how well identification formulas derived from one graph work in another, the metric captures the practical utility of graphs for causal inference rather than just edge count differences
- Core assumption: A sound and complete identification strategy plus corresponding verifier can be defined for the graph types of interest
- Break condition: If no sound and complete identification strategy exists for the graph type, the framework cannot be applied

### Mechanism 2
- Claim: The framework enables efficient CPDAG distance computation by avoiding DAG enumeration
- Mechanism: Instead of iterating over exponentially many DAGs in a CPDAG's equivalence class, the framework uses reachability algorithms that operate directly on CPDAGs
- Core assumption: Graphical criteria for non-identifiability and valid adjustment sets in CPDAGs can be checked efficiently using reachability algorithms
- Break condition: If graphical criteria for CPDAGs cannot be verified efficiently, the polynomial-time guarantee fails

### Mechanism 3
- Claim: Different adjustment strategies provide complementary distance metrics capturing different aspects of graph similarity
- Mechanism: Parent adjustment captures local differences, ancestor adjustment captures causal order similarity, and optimal adjustment captures statistical efficiency considerations
- Core assumption: Each adjustment strategy is sound and complete for the graph types considered
- Break condition: If an adjustment strategy is not sound and complete for the graph type, the resulting distance metric will be incorrect

## Foundational Learning

- Concept: Causal graphs and d-separation
  - Why needed here: The distance metrics are based on how well identification formulas work, which requires understanding causal graphs and d-separation criterion
  - Quick check question: In a DAG, if node A is d-separated from node B given node C, what does this imply about the conditional independence of A and B given C?

- Concept: Adjustment sets and identifiability
  - Why needed here: The distance metrics use different adjustment strategies to identify causal effects, so understanding what adjustment sets are is crucial
  - Quick check question: What are the three conditions that must be satisfied for a set Z to be a valid adjustment set for estimating the effect of T on Y in a DAG?

- Concept: Markov equivalence and CPDAGs
  - Why needed here: The paper extends distance metrics to CPDAGs, which represent Markov equivalence classes
  - Quick check question: How does a CPDAG represent a Markov equivalence class of DAGs, and what structural properties does it have?

## Architecture Onboarding

- Component map: Identification strategy -> Verifier -> Distance calculator -> Reachability algorithms -> Graph data structures

- Critical path: 1. Parse input graphs (DAGs or CPDAGs) 2. For each pair of nodes (T, Y), apply identification strategy to guess graph 3. Apply verifier to check if identification formulas are correct in true graph 4. Count incorrect formulas to compute distance 5. Return scalar distance value

- Design tradeoffs:
  - Local vs. non-local adjustment strategies: Local strategies enable O(p²) complexity for sparse graphs but may miss important global differences; non-local strategies capture more information but have higher complexity
  - Polynomial vs. exponential time: The framework achieves polynomial time by avoiding DAG enumeration, but this requires developing new reachability algorithms
  - Scalar vs. multi-set distances: Scalar distances are easier to interpret but may lose some information compared to multi-set distances

- Failure signatures:
  - Incorrect distances: Likely due to bugs in identification strategy or verifier implementation
  - Poor scalability: May indicate inefficiencies in reachability algorithms or graph data structures
  - Inconsistent results: Could be caused by floating-point precision issues or non-deterministic behavior

- First 3 experiments:
  1. Verify that Parent-AID between a DAG and its supergraph is zero, and between a fully connected DAG and an empty DAG equals p(p-1)/2
  2. Compare runtime of Parent-AID implementation to SID implementation on random DAGs of increasing size
  3. Check that Ancestor-AID between two DAGs with the same causal order is zero, while Parent-AID may not be

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the framework be extended to handle more general graph types beyond DAGs and CPDAGs, such as maximal ancestral graphs (MAGs) or partial ancestral graphs (PAGs) that allow for hidden variables?
- Basis in paper: The authors mention that "our framework gives a recipe for developing distances for other graph types, such as maximal ancestral graphs that allow for hidden variables" but note that "there are no verifiers for these alternatives."
- Why unresolved: While sound and complete identification strategies exist for MAGs and PAGs, the corresponding verifiers are not yet available. Developing such verifiers is necessary to extend the framework to these graph types.

### Open Question 2
- Question: How do the proposed distances perform in terms of statistical efficiency compared to other existing causal discovery evaluation metrics, especially in high-dimensional settings?
- Basis in paper: The paper discusses the statistical efficiency of the Oset adjustment strategy but does not provide a comprehensive comparison with other metrics in terms of statistical efficiency.
- Why unresolved: While the paper highlights the statistical efficiency of the Oset adjustment strategy, it does not empirically compare the performance of the proposed distances with other existing causal discovery evaluation metrics, particularly in high-dimensional settings.

### Open Question 3
- Question: Can the framework be adapted to handle non-linear causal relationships and non-Gaussian noise distributions, which are common in real-world applications?
- Basis in paper: The paper focuses on linear causal relationships and Gaussian noise distributions, as evidenced by the use of linear adjustment strategies.
- Why unresolved: The current framework is designed for linear causal relationships and Gaussian noise distributions. Adapting it to handle non-linear relationships and non-Gaussian noise would require significant modifications to the identification strategies and verifiers.

## Limitations
- The framework requires sound and complete identification strategies, which may not exist for all graph types with latent variables
- Limited empirical validation of the practical utility of these distance metrics for evaluating causal discovery algorithms
- Extension to causal orders is mentioned but not empirically validated
- Weak corpus evidence with limited related work and no citation data

## Confidence
- Theoretical soundness: High - framework is well-defined with clear algorithmic specifications
- Implementation quality: High - significant speedups demonstrated with polynomial-time guarantees
- Practical utility: Medium - runtime performance validated but practical utility for causal discovery evaluation not extensively tested
- Extension to CPDAGs: High - canonical extension with efficient algorithms developed
- Extension to causal orders: Low - mentioned but not empirically validated

## Next Checks
1. Verify the implementation matches the paper's specifications by testing on simple known examples (e.g., Parent-AID between DAG and its supergraph should be zero)
2. Reproduce the runtime performance comparisons between Parent-AID and SID implementations on random DAGs
3. Test the CPDAG distance computation on equivalence classes with known structural differences to verify correctness