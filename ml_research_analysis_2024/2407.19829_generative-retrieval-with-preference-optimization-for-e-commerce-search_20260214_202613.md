---
ver: rpa2
title: Generative Retrieval with Preference Optimization for E-commerce Search
arxiv_id: '2407.19829'
source_url: https://arxiv.org/abs/2407.19829
tags:
- item
- retrieval
- search
- queries
- task
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of applying generative retrieval
  to e-commerce search, where the task of generating detailed item titles from brief
  queries is complex due to noise in item titles, weak language order, long-tail queries,
  and the need for result interpretability. To tackle these issues, the authors propose
  a novel framework called Generative Retrieval with Preference Optimization (GenR-PO).
---

# Generative Retrieval with Preference Optimization for E-commerce Search

## Quick Facts
- **arXiv ID**: 2407.19829
- **Source URL**: https://arxiv.org/abs/2407.19829
- **Reference count**: 10
- **Primary result**: Novel GenR-PO framework significantly improves generative retrieval for e-commerce search, especially for long-tail queries, and achieves 0.225% UCVR gain in online A/B test.

## Executive Summary
This paper tackles the challenge of applying generative retrieval to e-commerce search, where detailed item titles must be generated from brief, often ambiguous queries. The main obstacles include noise in item titles, weak language order, long-tail queries, and the need for interpretable results. To address these, the authors introduce Generative Retrieval with Preference Optimization (GenR-PO), which reframes the task as query-to-multi-span generation. By splitting item titles into smaller, manageable segments, the framework leverages supervised fine-tuning, preference optimization using click data, and constrained beam search to generate and retrieve relevant items. Experimental results on a real-world dataset show GenR-PO outperforms both generative and dense retrieval baselines, particularly for long-tail queries, with a modest but meaningful 0.225% improvement in user click-through rate validated via online A/B testing.

## Method Summary
The GenR-PO framework redefines the query-to-title task as a query-to-multi-span task by segmenting item titles into smaller parts, making the generation process more manageable and interpretable. It uses supervised fine-tuning on item titles, preference optimization with click data to align with user preferences, and constrained beam search to ensure generated spans are both relevant and interpretable. This approach addresses the challenges of noise, weak language order, and long-tail queries in e-commerce search by focusing on generating and retrieving items through structured span-based outputs rather than whole titles.

## Key Results
- GenR-PO significantly outperforms existing generative retrieval and dense retrieval methods, especially on long-tail queries.
- Online A/B tests show a 0.225% improvement in UCVR (User Click-Through Rate), indicating higher conversion gains.
- The multi-span approach improves interpretability and robustness in noisy, real-world e-commerce search scenarios.

## Why This Works (Mechanism)
The framework works by breaking down the complex query-to-title generation task into smaller, more tractable query-to-multi-span tasks. This segmentation reduces the impact of noise and weak language order in item titles, making it easier for the model to generate relevant and interpretable results. Preference optimization using click data further aligns the model's outputs with actual user preferences, while constrained beam search ensures the generated spans are both relevant and interpretable. This combination effectively addresses the unique challenges of e-commerce search, particularly for long-tail and ambiguous queries.

## Foundational Learning
- **Multi-span generation**: Splitting item titles into smaller segments to simplify generation; needed to handle noise and weak language order; quick check: validate span coherence and relevance.
- **Preference optimization**: Using click data to align model outputs with user preferences; needed to improve relevance and conversion; quick check: ensure click data quality and unbiased feedback.
- **Constrained beam search**: Restricting search space to improve interpretability and relevance; needed to ensure generated spans are meaningful; quick check: balance constraint tightness and recall.
- **Supervised fine-tuning**: Training on item titles to establish a strong baseline; needed for initial model alignment; quick check: evaluate fine-tuning stability and overfitting.
- **Long-tail query handling**: Focusing on improving performance for rare or ambiguous queries; needed for e-commerce search coverage; quick check: measure improvement on tail query sets.
- **E-commerce search domain adaptation**: Tailoring retrieval methods to product search; needed for practical deployment; quick check: test across diverse product categories.

## Architecture Onboarding
- **Component map**: Query -> Multi-span generator (SFT + PO) -> Constrained beam search -> Retrieved items
- **Critical path**: Query input flows through supervised fine-tuning and preference optimization stages, then through constrained beam search to produce final retrieved items.
- **Design tradeoffs**: Multi-span generation improves interpretability but may limit recall; preference optimization depends on data quality; constrained beam search balances relevance and diversity.
- **Failure signatures**: Poor performance on highly diverse titles, sensitivity to noisy or biased click data, reduced recall from overly strict constraints.
- **First experiments**: 1) Test span generation quality on noisy titles; 2) Evaluate preference optimization impact with varying click data quality; 3) Assess constrained beam search on diverse item sets.

## Open Questions the Paper Calls Out
None.

## Limitations
- Practical scalability and robustness in production environments remain uncertain, especially under distribution shifts or adversarial queries.
- Performance depends on high-quality, unbiased click data, which may not always be available due to position bias or noisy interactions.
- Constrained beam search may limit recall for highly diverse item titles, affecting coverage.
- The modest 0.225% UCVR improvement, while meaningful, may not generalize across all e-commerce domains or user segments without further validation.

## Confidence
- **High confidence**: Core technical innovation of converting query-to-title into query-to-multi-span task and experimental superiority over dense retrieval for long-tail queries.
- **Medium confidence**: Effectiveness of preference optimization and constrained beam search, as results depend on data quality and implementation specifics.
- **Medium confidence**: Online A/B test results, given modest effect size and lack of extensive robustness or ablation analyses.

## Next Checks
1. Conduct stress tests with adversarial or highly ambiguous queries to evaluate robustness and failure modes of the multi-span generation approach.
2. Perform ablation studies to quantify the relative contribution of supervised fine-tuning, preference optimization, and constrained beam search to overall performance.
3. Test the framework on multiple e-commerce domains or datasets to assess generalization and scalability beyond the original dataset.