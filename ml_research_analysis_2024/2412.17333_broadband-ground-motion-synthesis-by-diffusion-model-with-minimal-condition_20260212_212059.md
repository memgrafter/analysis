---
ver: rpa2
title: Broadband Ground Motion Synthesis by Diffusion Model with Minimal Condition
arxiv_id: '2412.17333'
source_url: https://arxiv.org/abs/2412.17333
tags:
- waveform
- earthquake
- seismic
- waveforms
- training
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents HEGGS, a novel diffusion model for generating
  realistic earthquake ground motion waveforms with minimal conditioning information.
  The key innovation is exploiting the intrinsic pair-ability of seismic waveform
  datasets, where multiple stations observe the same earthquake event, allowing the
  model to learn from pairs of waveforms without requiring additional geological or
  seismological metadata.
---

# Broadband Ground Motion Synthesis by Diffusion Model with Minimal Condition

## Quick Facts
- **arXiv ID**: 2412.17333
- **Source URL**: https://arxiv.org/abs/2412.17333
- **Reference count**: 40
- **Key outcome**: HEGGS achieves superior performance generating realistic earthquake ground motion waveforms using minimal conditioning information through pair-exploiting diffusion training

## Executive Summary
This paper presents HEGGS, a novel diffusion model for generating realistic earthquake ground motion waveforms with minimal conditioning information. The key innovation is exploiting the intrinsic pair-ability of seismic waveform datasets, where multiple stations observe the same earthquake event, allowing the model to learn from pairs of waveforms without requiring additional geological or seismological metadata. HEGGS achieves superior performance compared to benchmark models on three regional datasets (SCEDC, KMA, INSTANCE), demonstrating accurate P/S phase arrivals, envelope correlation, GMPE analysis, and frequency content analysis. The model is trained end-to-end on a single GPU and generates high-fidelity 3D E-N-Z seismic waveforms that closely match real observations in both waveform morphology and spectrogram characteristics.

## Method Summary
HEGGS uses a pair-exploiting diffusion model that learns to transform latent representations between paired seismic waveforms from different stations observing the same earthquake. The model operates on spectrograms encoded through an autoencoder, with a U-Net backbone incorporating cross-attention to minimal conditioning information (station coordinates, earthquake location, depth, and magnitude). An amplitude correction module addresses waveform amplitude discrepancies. The training strategy leverages paired data to learn earthquake-specific features without requiring extensive geological metadata, enabling generation of realistic 3D seismic waveforms on a single GPU.

## Key Results
- HEGGS achieves superior P/S phase arrival time accuracy compared to baseline LDM models across all three datasets
- The model demonstrates strong envelope correlation and GMPE analysis performance, matching real observation statistics
- Spectrogram MSE analysis shows HEGGS-generated waveforms closely match ground truth frequency content
- Pair-exploiting training strategy outperforms conditioning-only approaches for waveform generation quality

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: Pair-exploiting diffusion training enables generation of realistic waveforms with minimal conditioning by leveraging the intrinsic correlation between multiple station observations of the same earthquake event.
- **Mechanism**: The model learns to transform latent representations of one waveform (src) to another (tgt) that shares the same earthquake source but differs in station-specific characteristics.
- **Core assumption**: Waveforms from different stations observing the same earthquake share sufficient common features about the source event to enable latent space transformation without requiring additional seismological metadata.
- **Evidence anchors**: [abstract], [section 3.1], [corpus]
- **Break condition**: If the correlation between station observations of the same event is insufficient to capture earthquake-specific features, the latent transformation assumption fails.

### Mechanism 2
- **Claim**: End-to-end training with amplitude correction module (ACM) enables accurate amplitude prediction for realistic waveform synthesis.
- **Mechanism**: The autoencoder (EAE/DAE) is trained directly with the diffusion model rather than using a pretrained VAE. The ACM module specifically corrects amplitude discrepancies that arise from spectrogram-to-waveform conversion.
- **Core assumption**: The amplitude characteristics of seismic waveforms cannot be adequately captured by a standard VAE pretraining approach and require joint optimization with the diffusion process.
- **Evidence anchors**: [section 3.2], [section 5], [corpus]
- **Break condition**: If the ACM cannot effectively correct amplitude discrepancies, the generated waveforms will have unrealistic energy distribution across frequency bands.

### Mechanism 3
- **Claim**: Conditional latent diffusion with cross-attention enables flexible generation from minimal metadata while maintaining seismological realism.
- **Mechanism**: The U-Net backbone uses cross-attention to incorporate the preprocessed conditional vector containing station coordinates, earthquake location, depth, and magnitude into the denoising process.
- **Core assumption**: The combination of station coordinates, earthquake coordinates, depth, and magnitude provides sufficient information to constrain the diffusion process toward seismologically realistic waveforms.
- **Evidence anchors**: [section 3.2], [section 4.1.3], [corpus]
- **Break condition**: If the minimal conditioning information is insufficient to constrain the physical characteristics of the generated waveforms, the results will lack seismological realism.

## Foundational Learning

- **Concept**: Diffusion probabilistic models and denoising score matching
  - Why needed here: The paper adapts diffusion models to seismic waveform generation, requiring understanding of how the forward noising process and reverse denoising process work together to learn data distributions.
  - Quick check question: In the denoising diffusion framework, what is the relationship between the forward process q(x_t|x_{t-1}) and the reverse process q(x_{t-1}|x_t, x_0)?

- **Concept**: Spectrogram construction and STFT analysis
  - Why needed here: The model operates on spectrograms rather than raw waveforms, requiring knowledge of time-frequency representation and how to convert between domains while preserving seismological features.
  - Quick check question: How does the choice of window length and hop size in STFT affect the time-frequency resolution of the resulting spectrogram for seismic signals?

- **Concept**: Seismic phase identification and arrival time analysis
  - Why needed here: The paper evaluates generated waveforms using P-wave and S-wave arrival times, requiring understanding of how seismic phases propagate and how to detect them in both real and synthetic data.
  - Quick check question: What are the typical velocity differences between P-waves and S-waves in crustal rocks, and how does this affect the P-S arrival time difference at various distances?

## Architecture Onboarding

- **Component map**: Input → Preprocessing (spectrogram + condition vector) → EAE (encoder) → Diffusion module (U-Net + cross-attention) → DAE (decoder) → ACM (amplitude correction) → Output waveform
- **Critical path**: Condition vector → cross-attention in U-Net → diffusion process → DAE → ACM → final waveform generation
- **Design tradeoffs**: Pair-exploiting training provides better phase arrival accuracy but requires paired data preparation; end-to-end training with ACM improves amplitude but increases complexity; minimal conditioning reduces data requirements but may limit fine-grained control.
- **Failure signatures**: Phase arrival times deviating significantly from ground truth (>0.5s); envelope correlation below 0.7; spectrogram MSE increasing; GMPE analysis showing unrealistic PGA distributions.
- **First 3 experiments**:
  1. Train with paired data but without ACM, compare phase arrival accuracy and envelope correlation to baseline LDM
  2. Train end-to-end with ACM but without pair exploitation, evaluate amplitude correction effectiveness
  3. Test generation without W_src input, validate if synthetic waveforms maintain realistic frequency content and magnitude scaling

## Open Questions the Paper Calls Out

### Open Question 1
- **Question**: How does the model's performance scale with increased conditioning information beyond the minimal set (slat, slon, elat, elon, edep, ML)?
- **Basis in paper**: [explicit] The authors note that additional geological features not included in the minimal condition could improve performance, particularly for non-existent earthquake synthesis, and suggest this as a potential future research direction.
- **Why unresolved**: The paper intentionally focuses on minimal conditioning to demonstrate feasibility, but does not experimentally explore the performance gains from adding more geological parameters like focal mechanism or VS30.
- **What evidence would resolve it**: Systematic ablation studies comparing model performance with varying levels of conditioning information, particularly for synthetic earthquake generation at different magnitudes.

### Open Question 2
- **Question**: What is the theoretical relationship between the diffusion model's latent space transformations and the physical processes governing seismic wave propagation?
- **Basis in paper**: [inferred] The paper describes the pair-exploiting training strategy that learns morphology η mapping source to target latents, but does not explicitly connect this mathematical transformation to seismological theory about wave propagation through heterogeneous media.
- **Why unresolved**: While the model achieves empirical success, the paper does not provide theoretical justification for why the learned latent transformations correspond to physical seismic processes.
- **What evidence would resolve it**: Analysis showing correlations between learned latent space features and known seismological parameters, or theoretical framework connecting diffusion model architecture to seismic wave physics.

### Open Question 3
- **Question**: How can the model be extended to handle multiple simultaneous earthquakes or complex source mechanisms beyond the current single-event framework?
- **Basis in paper**: [explicit] The paper focuses on single earthquake events and their paired observations, with no discussion of multi-event scenarios or complex focal mechanisms.
- **Why unresolved**: Real seismic data often contains overlapping signals from multiple sources, and the current framework assumes clean, single-event waveforms without addressing these complexities.
- **What evidence would resolve it**: Extension of the model architecture to handle multi-event scenarios, along with validation on datasets containing overlapping seismic signals from multiple earthquakes.

### Open Question 4
- **Question**: What are the limitations of the current pair-exploiting strategy when applied to sparse or unevenly distributed seismic networks?
- **Basis in paper**: [inferred] The paper demonstrates success on dense regional datasets (SCEDC, KMA, INSTANCE) but does not explore scenarios where earthquake-station pairs are limited or geographically sparse.
- **Why unresolved**: The effectiveness of the paired training approach depends on having sufficient paired observations per earthquake event, which may not hold in all seismic monitoring scenarios.
- **What evidence would resolve it**: Performance evaluation on datasets with varying station densities and earthquake coverage, particularly in regions with sparse seismic monitoring networks.

## Limitations
- The pair-exploiting approach requires datasets with multiple station recordings of the same earthquake event, limiting applicability to regions with dense seismic networks
- Minimal conditioning (magnitude, location, depth) may not capture site-specific amplification effects or complex focal mechanisms that influence ground motion characteristics
- The model generates waveforms for individual stations rather than complete spatial ground motion fields, restricting use in scenario-based seismic hazard analysis
- Performance evaluation relies primarily on Southern California (SCEDC) data; generalization to other tectonic settings remains unverified

## Confidence
- **High confidence**: Pair-exploiting training methodology and its effectiveness in generating realistic P/S phase arrivals
- **Medium confidence**: Amplitude correction module's contribution to waveform realism and GMPE analysis results
- **Low confidence**: Generalization capability to regions with different seismic characteristics and site conditions

## Next Checks
1. Test HEGGS on a dataset from a different tectonic setting (e.g., Japanese or Mediterranean seismicity) to evaluate cross-regional generalization
2. Compare generated waveforms against real recordings from stations not included in the training pairs to assess interpolation accuracy
3. Evaluate the impact of increasing conditioning information (adding Vs30 or site classification) on waveform quality and physical realism