---
ver: rpa2
title: Downscaling Precipitation with Bias-informed Conditional Diffusion Model
arxiv_id: '2412.14539'
source_url: https://arxiv.org/abs/2412.14539
tags:
- precipitation
- diffusion
- downscaling
- high-resolution
- climate
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a bias-informed conditional diffusion model
  for precipitation downscaling, addressing the challenge of generating high-resolution
  precipitation projections from coarse Global Climate Model outputs. The approach
  combines a conditional diffusion model with gamma correction preprocessing and bias-aware
  guided sampling to handle the long-tail distribution of precipitation and correct
  biases in downscaled results.
---

# Downscaling Precipitation with Bias-informed Conditional Diffusion Model

## Quick Facts
- arXiv ID: 2412.14539
- Source URL: https://arxiv.org/abs/2412.14539
- Authors: Ran Lyu; Linhan Wang; Yanshen Sun; Hedanqiu Bai; Chang-Tien Lu
- Reference count: 18
- Key outcome: Achieves RMSE of 2.972 mm/day and correlation of 0.945 in 8× downscaling of PRISM Climate precipitation data

## Executive Summary
This paper introduces a bias-informed conditional diffusion model for precipitation downscaling, addressing the challenge of generating high-resolution precipitation projections from coarse Global Climate Model outputs. The approach combines gamma correction preprocessing to handle the long-tail precipitation distribution with bias-aware guided sampling to correct systematic errors during the diffusion process. The model outperforms deterministic methods like SRCNN, demonstrating superior accuracy in both precipitation magnitude and spatial pattern reconstruction.

## Method Summary
The proposed method uses a conditional diffusion model with U-Net architecture that progressively denoises from pure noise to high-resolution precipitation through learned conditional transition distributions. Gamma correction (γ=0.15) is applied during preprocessing to transform the non-normal precipitation distribution into a form more amenable to diffusion model training. Bias-aware guided sampling leverages low-resolution input gradients to systematically reduce discrepancies between generated high-resolution precipitation and trusted low-resolution input at each denoising step.

## Key Results
- Achieves RMSE of 2.972 mm/day and correlation of 0.945 in 8× downscaling setting
- Outperforms previous deterministic methods like SRCNN on PRISM Climate data
- Successfully handles the long-tail distribution of precipitation through gamma correction
- Reduces systematic errors through bias-aware guided sampling

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Gamma correction transforms the non-normal precipitation distribution into a form more amenable to diffusion model training
- Mechanism: Precipitation follows a long-tail distribution where extreme values are rare but significant. By applying gamma correction with γ=0.15, the distribution is compressed, reducing the dominance of large precipitation areas during optimization. This makes the learning process more stable and effective.
- Core assumption: The gamma correction parameter γ=0.15 is optimal for precipitation data distribution
- Evidence anchors: Gamma correction inspired by similarity between precipitation and low-light images; long-tail distribution poses unique challenge for diffusion models

### Mechanism 2
- Claim: Bias-aware guided sampling reduces systematic errors by leveraging low-resolution input gradients
- Mechanism: The low-resolution input from GCMs contains expert knowledge with minimum bias from real climate variables. By quantifying bias using L2 norm ∥yt − x∥2 and incorporating its gradients into the sampling process, the model can systematically reduce discrepancies between generated high-resolution precipitation and the trusted low-resolution input at each denoising step.
- Core assumption: The low-resolution GCM input has minimal bias and can serve as a reliable reference for bias correction
- Evidence anchors: Bias-aware guided sampling uses L2 norm to quantify bias and gradients to steer generation process; low-resolution input contains expert knowledge with minimum bias

### Mechanism 3
- Claim: Conditional diffusion models can effectively learn the complex mapping between coarse and fine precipitation patterns
- Mechanism: The diffusion model progressively denoises from pure noise to high-resolution precipitation through learned conditional transition distributions pθ(yt−1|yt, x). The U-Net architecture, trained on both low-resolution and topography information, learns to generate physically plausible precipitation patterns that match the statistical characteristics of high-resolution observations.
- Core assumption: The relationship between low-resolution and high-resolution precipitation can be learned through iterative denoising
- Evidence anchors: Model generates high resolution precipitation in T refinement steps using learned conditional transition distributions; experiments demonstrate highly accurate results outperforming deterministic methods

## Foundational Learning

- Concept: Diffusion probabilistic models
  - Why needed here: Understanding how diffusion models work is essential for grasping the core methodology and why it outperforms deterministic approaches like SRCNN
  - Quick check question: What is the key difference between denoising diffusion probabilistic models and traditional generative models like GANs?

- Concept: Statistical downscaling in climate science
  - Why needed here: The paper bridges computer vision and climate modeling, so understanding the climate context is crucial for appreciating the problem formulation
  - Quick check question: Why is statistical downscaling necessary for climate impact studies when we already have Global Climate Models?

- Concept: Gamma correction and image enhancement
  - Why needed here: The preprocessing step is critical for handling the long-tail precipitation distribution, and understanding this technique helps explain the model's improved performance
  - Quick check question: How does gamma correction differ from simple normalization when dealing with skewed distributions?

## Architecture Onboarding

- Component map: Low-resolution precipitation + topography → U-Net → Gamma-corrected high-resolution precipitation → Bias-aware guided sampling → Final output
- Critical path: Low-resolution precipitation + topography → U-Net → Gamma-corrected high-resolution precipitation → Bias-aware guided sampling → Final output
- Design tradeoffs: The model trades increased computational complexity (diffusion sampling steps) for better handling of non-normal distributions and bias correction compared to deterministic methods
- Failure signatures: Poor RMSE values indicate failure to capture precipitation magnitude; low correlation suggests failure to capture spatial patterns; high bias indicates systematic errors
- First 3 experiments:
  1. Baseline test: Run SRCNN on the same dataset to verify the claimed performance gap
  2. Ablation study: Test the model without gamma correction to quantify its contribution to performance
  3. Sensitivity analysis: Vary the bias-aware guided sampling weight w to find optimal bias correction strength

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the proposed bias-informed conditional diffusion model perform on other climate variables beyond precipitation, such as temperature or wind speed?
- Basis in paper: The paper mentions that future work will explore extending the framework to other climate variables
- Why unresolved: The current study focuses solely on precipitation downscaling, and no experiments or results are presented for other climate variables
- What evidence would resolve it: Conducting experiments using the same model architecture and training procedure on temperature and wind speed data from the PRISM Climate dataset or similar sources

### Open Question 2
- Question: What is the impact of different gamma correction values on model performance, and is there an optimal value for different types of precipitation distributions?
- Basis in paper: The paper applies a fixed gamma correction value of 0.15 but does not explore the sensitivity of model performance to different gamma values
- Why unresolved: The paper only mentions using gamma correction and provides a specific value without justification or exploration of alternatives
- What evidence would resolve it: Conducting a sensitivity analysis by training and evaluating the model with various gamma correction values on the PRISM dataset

### Open Question 3
- Question: How does the bias-aware guided sampling approach compare to other bias correction methods in terms of computational efficiency and effectiveness?
- Basis in paper: The paper introduces bias-aware guided sampling as a novel approach but does not compare it to other bias correction methods commonly used in climate downscaling
- Why unresolved: The paper only demonstrates the effectiveness of BGS compared to not using it, without benchmarking against alternative bias correction techniques
- What evidence would resolve it: Implementing and comparing BGS with other bias correction methods such as distribution mapping or quantile mapping on the same dataset

### Open Question 4
- Question: What is the relationship between model performance and the spatial scale of downscaling (e.g., 4×, 16×, 32×) beyond the tested 8× setting?
- Basis in paper: The paper evaluates the model at an 8× downscaling setting but does not investigate how performance scales with different downscaling factors
- Why unresolved: The experimental results are limited to a single downscaling ratio, leaving uncertainty about the model's effectiveness at other scales
- What evidence would resolve it: Training and evaluating the model at multiple downscaling ratios on the PRISM dataset, analyzing how metrics change with increasing downscaling factor

## Limitations
- Performance relies on the assumption that low-resolution GCM inputs have minimal bias
- Fixed gamma correction parameter (γ=0.15) without systematic exploration of optimal values
- High computational cost of diffusion models may limit practical deployment

## Confidence
- **High Confidence**: Core methodology of combining diffusion models with gamma correction for handling non-normal distributions
- **Medium Confidence**: Specific bias-aware guided sampling implementation and its effectiveness in reducing systematic errors
- **Low Confidence**: Generalization of results to other regions or climate models beyond continental US evaluation

## Next Checks
1. Cross-validation across regions: Test the model on precipitation data from different geographic regions (tropical, arid, polar) to assess generalization
2. Bias sensitivity analysis: Systematically vary the low-resolution input bias levels to quantify sensitivity to different bias magnitudes
3. Extreme event preservation: Evaluate the model's ability to capture extreme precipitation events (99th percentile) using specialized metrics beyond RMSE and correlation