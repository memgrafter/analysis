---
ver: rpa2
title: 'Electrocardiogram-based diagnosis of liver diseases: an externally validated
  and explainable machine learning approach'
arxiv_id: '2412.03717'
source_url: https://arxiv.org/abs/2412.03717
tags:
- liver
- hepatic
- failure
- disease
- values
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: Liver diseases require costly, invasive diagnostics and are a major
  global health challenge. This study developed tree-based machine learning models
  using ECG features and demographics to detect liver diseases.
---

# Electrocardiogram-based diagnosis of liver diseases: an externally validated and explainable machine learning approach

## Quick Facts
- arXiv ID: 2412.03717
- Source URL: https://arxiv.org/abs/2412.03717
- Reference count: 40
- ECG-based machine learning models detect liver diseases with AUROCs of 0.8025 (alcoholic liver disease) and 0.7404 (hepatic failure) in external validation.

## Executive Summary
This study demonstrates that electrocardiogram-derived features combined with demographics can detect liver diseases through tree-based machine learning models. The approach was trained on 467,729 patients from MIMIC-IV-ECG and externally validated on 775,535 patients from ECG-View II, achieving AUROCs up to 0.8025 for alcoholic liver disease. The models identified age and prolonged QTc intervals as key predictors, providing interpretable insights into liver-disease cardiac manifestations. This non-invasive approach offers a promising diagnostic tool, particularly valuable for resource-limited settings where traditional liver diagnostics are costly and invasive.

## Method Summary
Tree-based machine learning models were trained to detect liver diseases using ECG features and demographics from two large datasets: MIMIC-IV-ECG (467,729 patients, 2008-2019) for training and ECG-View II (775,535 patients, 1994-2013) for external validation. XGBoost models were trained per ICD-10 liver disease code with early stopping (patience 10) and evaluated using AUROC, sensitivity, and specificity at a 0.70 threshold. Shapley value analysis provided interpretability by quantifying feature contributions to predictions.

## Key Results
- External validation achieved AUROC of 0.7644 for alcoholic liver disease (K70) and 0.7498 for hepatic failure (K72)
- Age and prolonged QTc intervals were consistently identified as key predictors across both datasets
- QTc prolongation showed strong association with liver disease, supporting cardiovascular-liver pathophysiology connections
- Performance remained robust across internal and external validation, demonstrating model generalizability

## Why This Works (Mechanism)

### Mechanism 1
- Claim: ECG-derived features can detect liver disease because shared cardiovascular-hepatic pathophysiology produces measurable cardiac electrical changes.
- Mechanism: Liver dysfunction disrupts systemic homeostasis through inflammation, electrolyte imbalance, and autonomic dysregulation, altering cardiac electrophysiology captured in ECG metrics like QTc prolongation.
- Core assumption: Cardiac manifestations of liver disease are consistent and detectable via standard ECG features without requiring raw waveform analysis.
- Evidence anchors:
  - "Features linked to autonomic regulation and electrical conduction abnormalities were also prominent, supporting known cardiovascular-liver connections and suggesting QTc as a potential biomarker."
  - "The interplay between liver and cardiovascular health is well-established. Liver diseases often manifest with cardiovascular complications such as cirrhosis-associated cardiomyopathy and portopulmonary hypertension."
- Break condition: If liver disease effects on ECG are too variable across populations, or if confounding factors overwhelm the liver-specific signal.

### Mechanism 2
- Claim: Tree-based models with interpretable Shapley values provide both strong predictive performance and actionable clinical insights.
- Mechanism: Gradient boosting aggregates simple decision rules that capture non-linear relationships between ECG features and liver disease. Shapley values quantify each feature's marginal contribution to predictions.
- Core assumption: Tree-based models can generalize across diverse populations when trained on large, representative datasets.
- Evidence anchors:
  - "The explainability analysis consistently identified age and prolonged QTc intervals (corrected QT, reflecting ventricular repolarization) as key predictors."
  - "We aim to go beyond a performance evaluation by providing insights into the trained models. To this end, we integrate Shapley values into our pipeline."
- Break condition: If model performance degrades significantly in populations not well-represented in training data.

### Mechanism 3
- Claim: External validation on independent datasets ensures the model's robustness and clinical generalizability.
- Mechanism: Training on MIMIC-IV-ECG and validating on ECG-View II (different geography, timeframe) tests whether ECG-liver disease associations hold beyond a single institution or cohort.
- Core assumption: Both datasets use comparable ECG feature extraction and ICD coding standards.
- Evidence anchors:
  - "We trained tree-based machine learning models on ECG features to detect liver diseases using two large datasets: MIMIC-IV-ECG (467,729 patients, 2008–2019) and ECG-View II (775,535 patients, 1994–2013)."
  - Weak or missing evidence on cross-dataset feature harmonization consistency.
- Break condition: If the external dataset's population characteristics or measurement protocols differ enough to invalidate direct performance comparison.

## Foundational Learning

- Concept: ECG feature engineering (RR, PR, QRS, QT, QTc intervals; P/QRS/T wave axes)
  - Why needed here: The study uses pre-computed ECG metrics as inputs; understanding what each feature captures is critical for interpreting model decisions and physiological relevance.
  - Quick check question: What does QTc prolongation typically indicate in the context of liver disease, and why is it a key predictor here?

- Concept: Explainable AI with Shapley values
  - Why needed here: The study's novelty relies on interpretability; engineers must understand how Shapley values decompose feature contributions for clinical trust.
  - Quick check question: How does a Shapley value differ from simple feature importance, and why is it more suitable for tree-based models in healthcare?

- Concept: External validation and generalization
  - Why needed here: The model's real-world utility depends on performance beyond the training set; engineers must grasp how to design and interpret external validation.
  - Quick check question: What are the key risks when validating on an external dataset, and how can they be mitigated?

## Architecture Onboarding

- Component map: Data ingestion -> ECG feature extraction -> Dataset splitting (train/val/test + external) -> XGBoost training with early stopping -> Shapley value analysis -> Performance reporting
- Critical path:
  1. Load MIMIC-IV-ECG and ECG-View II datasets
  2. Align feature sets and ensure consistent QTc calculation (Bazett's formula)
  3. Train XGBoost models per ICD code with early stopping
  4. Generate predictions on internal and external test sets
  5. Compute AUROC, sensitivity, specificity
  6. Run Shapley analysis for interpretability
- Design tradeoffs:
  - Tree-based vs. deep learning: Better interpretability and robustness on tabular data vs. potential higher accuracy with raw waveforms
  - Combined features vs. ECG alone: Improved performance but added demographic confounders
  - Early stopping patience: Balances overfitting risk vs. model convergence
- Failure signatures:
  - AUROC drop >0.05 in external validation: Possible distribution shift or feature misalignment
  - Shapley values dominated by non-ECG features: Demographics may be confounding predictions
  - High variance in prediction intervals: Overfitting or insufficient data per condition
- First 3 experiments:
  1. Train XGBoost on MIMIC-IV-ECG ECG features only; compare AUROC to combined model
  2. Replicate Shapley analysis on a single condition (e.g., K70) and verify top features match paper
  3. Test model performance on a subset of ECG-View II stratified by age/gender to check demographic effects

## Open Questions the Paper Calls Out

- Question: Do ECG-derived features maintain diagnostic accuracy across diverse ethnic populations beyond the U.S. and South Korean cohorts studied?
  - Basis in paper: The authors note that MIMIC-IV-ECG provides more ethnically diverse data than ECG-View II, but neither dataset includes race data, and the study's external validation was limited to a South Korean population.
  - Why unresolved: The study lacks racial/ethnic diversity in its validation dataset, which is crucial for generalizability of the diagnostic tool across global populations.
  - What evidence would resolve it: External validation studies using ECG datasets from diverse ethnic populations would demonstrate whether the model maintains predictive performance across different racial and ethnic groups.

- Question: Can ECG-based liver disease detection be improved by incorporating raw ECG waveform data instead of extracted features?
  - Basis in paper: The authors note that "recent findings on the superiority of raw ECG waveforms compared to ECG features for diagnostic tasks" suggest potential improvements in diagnostic accuracy using raw waveform data.
  - Why unresolved: The study used extracted ECG features rather than raw waveforms, despite acknowledging potential benefits of the latter approach.
  - What evidence would resolve it: Comparative studies applying the same methodology to raw ECG waveforms versus extracted features would demonstrate whether raw waveform analysis provides superior diagnostic accuracy.

- Question: What are the underlying physiological mechanisms linking ECG abnormalities to specific liver disease pathophysiology?
  - Basis in paper: The authors state that "the physiological mechanisms linking liver dysfunction to ECG abnormalities are not yet fully understood" and note this represents "an intriguing area for further research."
  - Why unresolved: While the study identifies correlations between ECG patterns and liver diseases, it does not investigate the biological pathways connecting cardiac electrical changes to hepatic dysfunction.
  - What evidence would resolve it: Mechanistic studies combining ECG analysis with hepatic biomarker measurements, cardiac imaging, and pathophysiological investigations could elucidate specific ECG changes reflecting liver disease progression.

## Limitations

- Limited generalizability across diverse ethnic populations due to validation dataset composition
- Potential confounding from medications and comorbidities not explicitly controlled for in the analysis
- No class imbalance correction may have affected model performance for rarer liver disease conditions

## Confidence

- High confidence: The observed QTc prolongation as a consistent predictor across both datasets, supported by established cardiovascular-liver pathophysiology literature.
- Medium confidence: AUROC values for K70 and K72, given external validation but without detailed analysis of potential confounding factors.
- Low confidence: The model's performance on rare liver diseases due to potential data sparsity and lack of imbalance correction.

## Next Checks

1. Stratify external validation performance by age deciles and gender to identify potential demographic bias or performance gaps.
2. Perform feature importance stability analysis by retraining models on 50% random subsamples of MIMIC-IV-ECG to assess robustness of key predictors.
3. Conduct ablation studies removing demographic features to quantify their contribution versus pure ECG-based predictions.