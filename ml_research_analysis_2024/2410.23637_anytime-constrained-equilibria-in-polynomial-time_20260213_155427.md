---
ver: rpa2
title: Anytime-Constrained Equilibria in Polynomial Time
arxiv_id: '2410.23637'
source_url: https://arxiv.org/abs/2410.23637
tags:
- feasible
- policy
- then
- cost
- algorithm
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces anytime-constrained equilibria (ACE) to the
  Markov game setting and develops the first comprehensive theory for computing them
  efficiently. The key contribution is a reduction from anytime-constrained Markov
  games to action-constrained Markov games, enabling the use of linear programming
  techniques.
---

# Anytime-Constrained Equilibria in Polynomial Time

## Quick Facts
- arXiv ID: 2410.23637
- Source URL: https://arxiv.org/abs/2410.23637
- Authors: Jeremy McMahan
- Reference count: 40
- Key outcome: Introduces anytime-constrained equilibria (ACE) to Markov games and develops the first comprehensive theory for computing them efficiently using linear programming reductions

## Executive Summary
This paper introduces anytime-constrained equilibria (ACE) to the Markov game setting and develops the first comprehensive theory for computing them efficiently. The key contribution is a reduction from anytime-constrained Markov games to action-constrained Markov games, enabling the use of linear programming techniques. The main algorithmic results include: (1) a fixed-parameter tractable algorithm for computing exact ACE when cost precision is small, and (2) a polynomial-time algorithm for computing approximately feasible ACE when the maximum supported cost is bounded by a polynomial factor of the budget. The paper also develops the first theory of efficient computation for action-constrained Markov games, which may be of independent interest.

## Method Summary
The paper develops algorithms for computing anytime-constrained equilibria (ACE) in Markov games with budget constraints. The approach reduces the anytime-constrained problem to an action-constrained Markov game by tracking cumulative costs and restricting actions based on remaining budget. The reduction enables the use of linear programming techniques for equilibrium computation. The algorithms include a feasibility checker to determine if any policy satisfies the constraints, a game reducer to construct the action-constrained game, and backward induction solvers for finding equilibria. For cases with high cost precision, an approximation algorithm rounds costs to nearest multiples of a parameter ℓ, creating a conservative approximation that preserves feasibility while reducing computational complexity.

## Key Results
- Reduction from anytime-constrained Markov games to action-constrained Markov games enables efficient LP-based computation of equilibria
- Fixed-parameter tractable algorithm for computing exact ACE when cost precision is small (exponential in agents but polynomial in game size)
- Polynomial-time algorithm for computing approximately feasible ACE when maximum supported cost is polynomially bounded by budget

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Reduction from anytime-constrained Markov games to action-constrained Markov games enables efficient LP-based computation of equilibria
- Mechanism: The anytime constraints are transformed into per-time state-dependent action constraints by tracking cumulative costs, allowing the problem to be solved as a standard Markov game with restricted action sets
- Core assumption: Feasible policies correspond exactly to policies that only select actions in the dynamically computed feasible action sets at each state-cost pair
- Evidence anchors:
  - [abstract] "reduction from anytime-constrained Markov games to action-constrained Markov games, enabling the use of linear programming techniques"
  - [section] "we can convert the anytime constraint on full histories into a per-time constraint on the available actions... the agents can convert their anytime-constrained MG into a traditional Markov game G with non-stationary state space FSh and non-stationary, state-dependent action space FAh(s, ¯c)"
  - [corpus] Weak evidence - no direct citations in corpus about this specific reduction approach
- Break condition: If the state-action space becomes too large due to high cost precision or many constraints, the LP becomes intractable even though theoretically polynomial

### Mechanism 2
- Claim: Fixed-parameter tractability (FPT) in cost precision allows polynomial-time computation when cost precision is small
- Mechanism: By showing the number of distinct cumulative cost vectors that need to be tracked grows only exponentially in the number of agents and cost precision (not in game size), the problem becomes FPT
- Core assumption: The cost precision d determines the number of distinct cumulative costs that must be tracked, and this scales as O(2(d+1)n) rather than exponentially in game size
- Evidence anchors:
  - [abstract] "a fixed-parameter tractable algorithm for computing subgame-perfect ACE"
  - [section] "DG ≤ poly(|G|)2O(dn), where d denotes the cost precision... our method is FPT [16] in the cost precision"
  - [corpus] Weak evidence - no direct citations in corpus about FPT algorithms for constrained games
- Break condition: When cost precision grows large (e.g., logarithmic in game size), the algorithm becomes exponential in the number of agents

### Mechanism 3
- Claim: Approximation algorithms provide polynomial-time solutions when cost bounds are polynomially related to budgets
- Mechanism: Rounding costs to nearest multiples of ℓ and truncating low-cost distributions creates an approximate game with finite support, whose solutions are approximately feasible for the original game
- Core assumption: Rounding down costs creates a conservative approximation that preserves feasibility while reducing the state space dramatically
- Evidence anchors:
  - [abstract] "a polynomial-time algorithm for computing approximately feasible ACE when the maximum supported cost is bounded by a polynomial factor of the budget"
  - [section] "The key idea of our approximations is to have players round down any cost vector they receive to the nearest multiple of some ℓ > 0"
  - [corpus] Weak evidence - no direct citations in corpus about approximation algorithms for constrained games
- Break condition: If maximum supported cost is super-polynomial in budget, the approximation becomes too loose to be useful

## Foundational Learning

- Concept: Linear programming duality and feasibility
  - Why needed here: The core algorithm solves action-constrained Markov games using linear programs that find feasible strategies satisfying equilibrium conditions
  - Quick check question: Can you write the LP that finds a correlated equilibrium for a matrix game with restricted action sets?

- Concept: Fixed-parameter tractability (FPT) theory
  - Why needed here: Understanding why the algorithm is polynomial when cost precision is small requires grasping the FPT framework
  - Quick check question: If an algorithm runs in time poly(n)·f(k) where k is a parameter, what does this tell you about its scalability with respect to k versus n?

- Concept: Markov game theory and subgame perfection
  - Why needed here: The solution concept requires policies to be optimal in every feasible subgame, not just from the initial state
  - Quick check question: What is the difference between a Nash equilibrium and a subgame-perfect equilibrium in extensive-form games?

## Architecture Onboarding

- Component map: Feasibility checker -> Game reducer -> Action-constrained solver -> Approximator
- Critical path:
  1. Run feasibility checker to determine if feasible policies exist
  2. If feasible, construct action-constrained game
  3. Solve action-constrained game via backward induction
  4. (Optional) Apply approximation if costs have high precision
- Design tradeoffs:
  - Exact vs. approximate: Exact algorithms are FPT in cost precision but may be exponential; approximation is polynomial but introduces bounded constraint violations
  - Space vs. time: Tracking all cumulative costs exactly requires exponential space in worst case; approximation reduces space at cost of precision
  - Generality vs. efficiency: The reduction approach works for correlated/Nash equilibria but requires different LP formulations
- Failure signatures:
  - "Infeasible" output: No policy can satisfy anytime constraints (NP-hard to verify)
  - Exponential running time: Cost precision too high relative to game size
  - Large memory usage: State space explosion from tracking many cumulative cost vectors
  - Constraint violations: Approximation parameter ℓ too large relative to budget constraints
- First 3 experiments:
  1. Small two-player zero-sum game with deterministic costs: Verify feasibility checker correctly identifies feasible policies and computes correct action sets
  2. Medium-sized game with small cost precision: Test that exact algorithm runs in polynomial time and produces correct equilibria
  3. Game with large cost precision: Compare exact algorithm runtime vs. approximation algorithm runtime and solution quality tradeoff

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can the anytime-constrained equilibria framework be extended to infinite-horizon Markov games with discounted rewards?
- Basis in paper: [explicit] The authors mention this as a potential extension in the conclusion, noting that "The infinite discounted case... follow[s] similarly to in [30]."
- Why unresolved: The authors defer the detailed analysis of this extension to future work, leaving the specific computational implications and algorithmic adaptations unexplored.
- What evidence would resolve it: A formal proof showing how the existing reduction from anytime-constrained to action-constrained Markov games generalizes to the infinite-horizon case, along with new complexity bounds for computing equilibria in this setting.

### Open Question 2
- Question: What is the exact relationship between anytime-constrained equilibria and traditional expected-cost constrained equilibria in Markov games?
- Basis in paper: [explicit] The authors state that "expectation-constrained policies can arbitrarily violate anytime constraints" but do not provide a precise characterization of when these two constraint types coincide.
- Why unresolved: While the paper establishes that anytime constraints are strictly stronger than expectation constraints, it does not explore the boundary cases or conditions under which they might align.
- What evidence would resolve it: A theorem characterizing the class of Markov games where anytime-constrained and expectation-constrained equilibria yield identical policies, potentially with examples showing where they diverge.

### Open Question 3
- Question: How do correlated and coarse-correlated equilibria compare to Nash equilibria in terms of computational efficiency for anytime-constrained Markov games?
- Basis in paper: [explicit] The authors note that "Our definition of ACE... technically corresponds to anytime-constrained course-correlated equilibria (ACCCE)" and that results apply equally to ACCE, but they don't compare the computational complexity of finding these different equilibrium types.
- Why unresolved: The paper develops algorithms for finding ACE but doesn't analyze whether the correlated variants can be computed more efficiently or with better approximation guarantees.
- What evidence would resolve it: A complexity analysis showing whether computing ACCE or ACCCE admits faster algorithms than ACNE, or proving that they are computationally equivalent up to polynomial factors.

## Limitations
- The feasibility checking problem is NP-hard even for simple two-player zero-sum games, limiting worst-case scalability
- Exact algorithms become exponential in the number of agents when cost precision is logarithmic in game size
- The approximation algorithm's practical performance bounds need empirical validation, as theoretical guarantees assume idealized conditions

## Confidence
- **High confidence**: The reduction framework and feasibility checking algorithms are theoretically sound. The NP-hardness of checking feasibility aligns with established complexity results for constrained games.
- **Medium confidence**: The FPT claim in cost precision is mathematically correct, but practical performance will degrade rapidly as the number of agents grows, even with small cost precision.
- **Low confidence**: The approximation algorithm's practical performance bounds and the impact of rounding costs on constraint satisfaction need empirical validation, as the theoretical guarantees assume idealized conditions.

## Next Checks
1. **Scalability test**: Implement the feasibility checker on increasingly large games with varying cost precision to empirically measure the exponential growth in state space.
2. **Approximation quality evaluation**: Compare the constraint violations in approximate solutions across different rounding parameters ℓ and verify the claimed polynomial bounds on maximum supported cost.
3. **LP solver robustness**: Test the action-constrained game solver with different linear programming formulations (primal/dual) to identify which approaches are most numerically stable for large action spaces.