---
ver: rpa2
title: Symmetries and Expressive Requirements for Learning General Policies
arxiv_id: '2409.15892'
source_url: https://arxiv.org/abs/2409.15892
tags:
- states
- state
- planning
- goal
- policies
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper investigates the expressive power of graph neural networks
  (GNNs) for learning general policies in classical planning. The key idea is to detect
  state symmetries and assess whether GNNs can distinguish non-isomorphic states.
---

# Symmetries and Expressive Requirements for Learning General Policies

## Quick Facts
- arXiv ID: 2409.15892
- Source URL: https://arxiv.org/abs/2409.15892
- Authors: Dominik Drexler; Simon Ståhlberg; Blai Bonet; Hector Geffner
- Reference count: 11
- Primary result: 1-WL coloring sufficient in 11/18 planning domains (61%), struggles with C3 features in others

## Executive Summary
This paper investigates the expressive power of graph neural networks (GNNs) for learning general policies in classical planning domains. The authors systematically analyze whether GNNs can distinguish non-isomorphic planning states by mapping states to object graphs and applying graph isomorphism and coloring algorithms. They find that while GNNs (via 1-WL) have sufficient expressive power in 61% of tested domains, they struggle with certain domains requiring higher-order features (C3). The study reveals important limitations of current GNN architectures in handling complex symmetries and suggests that additional techniques like goal marking may be necessary for improved performance in challenging domains.

## Method Summary
The authors map planning states to object graphs where nodes represent objects and edges represent relations between them. They use graph isomorphism algorithms to detect symmetries between states and determine if states can be distinguished. To assess whether GNNs can differentiate non-isomorphic states, they employ coloring algorithms (1-WL and 2-FWL) to check if C2 features are sufficient for discrimination. The experiments cover 18 classical planning domains, systematically evaluating when GNNs have adequate expressive power and when they fail due to symmetry issues.

## Key Results
- 1-WL coloring algorithm (representing GNN expressiveness) sufficient in 11/18 domains (61%)
- GNNs struggle with domains requiring C3 features: Barman, Blocks, Logistics, and Satellite
- Goal marking technique helps improve performance in some domains
- Symmetry detection reveals when GNNs cannot distinguish between states
- Results indicate fundamental limitations of GNNs for certain types of planning problems

## Why This Works (Mechanism)
The paper demonstrates that GNNs' ability to learn general policies depends critically on their expressive power to distinguish between different planning states. By mapping states to graphs and analyzing symmetries, the authors show that when states are isomorphic, GNNs cannot differentiate them regardless of training. The coloring algorithms (1-WL and 2-FWL) provide a theoretical framework to determine whether C2 features are sufficient for state discrimination. When these features are insufficient (as in C3-requiring domains), GNNs fail to learn correct policies, explaining observed performance limitations.

## Foundational Learning
- Graph Neural Networks (GNNs): Neural networks that operate on graph-structured data by aggregating information from neighboring nodes
  * Why needed: GNNs can naturally represent planning states as graphs where objects are nodes and relations are edges
  * Quick check: Verify node/edge feature representation matches domain requirements

- Graph Isomorphism: Testing whether two graphs are structurally identical through relabeling
  * Why needed: Identifies when states have identical structure but different labels, causing GNN indistinguishability
  * Quick check: Apply Weisfeiler-Lehman test to detect isomorphic states

- Weisfeiler-Lehman Coloring (1-WL and 2-FWL): Algorithms that iteratively refine node colorings to test graph distinguishability
  * Why needed: Determines theoretical expressiveness limits of GNNs for distinguishing states
  * Quick check: Run coloring iterations until stabilization or maximum depth

- Classical Planning Domains: Formal problem representations with states, actions, and goals
  * Why needed: Provides benchmark problems to test GNN expressiveness systematically
  * Quick check: Verify domain PDDL specifications correctly encode problem constraints

- C2 vs C3 Features: Second-order (pairwise relations) vs third-order (triple relations) features for state representation
  * Why needed: Determines whether GNNs can capture sufficient relational information for planning
  * Quick check: Analyze domain structure to identify required feature order

## Architecture Onboarding

Component Map: Planning State -> Object Graph -> GNN Input -> Policy Output
Critical Path: State Representation → Graph Construction → GNN Processing → Action Selection

Design Tradeoffs:
- Expressiveness vs. computational efficiency: Higher-order features improve discrimination but increase complexity
- Graph representation choices: Node/edge features must capture all relevant domain information
- Symmetry handling: Tradeoff between explicit symmetry detection and implicit learning

Failure Signatures:
- Identical GNN outputs for non-isomorphic states indicates insufficient expressiveness
- Poor performance in domains with complex relational structures
- Inability to distinguish symmetric states even with extensive training

First Experiments:
1. Apply 1-WL coloring to a simple domain (e.g., Grid) to verify basic functionality
2. Test graph isomorphism detection on handcrafted symmetric/unsymmetric state pairs
3. Evaluate GNN performance with and without goal marking on a medium-difficulty domain

## Open Questions the Paper Calls Out
None

## Limitations
- Limited to 18 classical planning domains, may not generalize to all planning scenarios
- Assumes C2 features are sufficient for most domains, which may not hold for complex real-world problems
- Does not explore alternative neural network architectures that might handle C3 features better
- Symmetry analysis focuses on structural properties, potentially missing semantic distinctions

## Confidence
- Domain representativeness: Medium - 18 domains provide coverage but may miss edge cases
- Theoretical framework: High - graph isomorphism and coloring algorithms are well-established
- Empirical results: Medium - results consistent within tested domains but limited scope
- Generalization claims: Low - findings may not extend to all planning or graph-structured problems

## Next Checks
1. Test GNNs on a larger and more diverse set of planning domains to assess generalizability
2. Investigate the impact of different graph representation techniques on GNN performance
3. Explore alternative neural network architectures that might better handle C3 features and complex symmetries in planning states