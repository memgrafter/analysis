---
ver: rpa2
title: 'TrajFM: A Vehicle Trajectory Foundation Model for Region and Task Transferability'
arxiv_id: '2408.15251'
source_url: https://arxiv.org/abs/2408.15251
tags:
- trajectory
- trajfm
- task
- tasks
- time
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces TrajFM, a foundation model for vehicle trajectory
  learning that achieves both region and task transferability. It tackles challenges
  in transferring across regions with different spatial features and POI arrangements,
  as well as adapting to diverse downstream tasks.
---

# TrajFM: A Vehicle Trajectory Foundation Model for Region and Task Transferability

## Quick Facts
- arXiv ID: 2408.15251
- Source URL: https://arxiv.org/abs/2408.15251
- Reference count: 40
- Key outcome: Achieves both region and task transferability for vehicle trajectories without retraining, with reported errors of 113.55s RMSE (travel time), 94.28s RMSE (OD travel time), and 196.10m RMSE (trajectory prediction)

## Executive Summary
TrajFM introduces a foundation model for vehicle trajectory learning that can transfer across different regions and tasks without retraining. The model addresses the challenge of transferring across regions with varying spatial features and POI arrangements while adapting to diverse downstream tasks. The core innovation combines STRFormer with a trajectory masking and recovery scheme that unifies task generation processes. Experiments demonstrate TrajFM significantly outperforms existing methods on real-world datasets, achieving state-of-the-art performance on trajectory travel time estimation, origin-destination travel time estimation, and trajectory prediction tasks.

## Method Summary
The paper proposes TrajFM, a foundation model that integrates STRFormer architecture with a trajectory masking and recovery scheme for pre-training. STRFormer combines spatial, temporal, and POI modalities using a learnable spatio-temporal Rotary position embedding (STRPE). The trajectory masking and recovery scheme includes both modality masking/recovery and sub-trajectory masking/recovery, enabling unified task generation. The model is pre-trained for 30 epochs using Adam optimizer with learning rate 1e-3 on real-world vehicle trajectory datasets (Chengdu and Xian) containing taxi trajectories resampled to intervals â‰¥6 seconds and filtered to retain trajectories with 5-120 points.

## Key Results
- Achieved 113.55 seconds RMSE on trajectory travel time estimation
- Achieved 94.28 seconds RMSE on origin-destination travel time estimation
- Achieved 196.10 meters RMSE on trajectory prediction
- All results obtained without retraining for different regions or tasks

## Why This Works (Mechanism)
The model achieves transferability through three key mechanisms: (1) the STRFormer architecture that integrates multiple modalities (spatial, temporal, POI) with learnable spatio-temporal embeddings that capture both local and global spatial-temporal patterns, (2) the unified trajectory masking and recovery scheme that enables the model to learn robust representations across different task formulations, and (3) the foundation model approach that learns general patterns during pre-training that can be applied to specific downstream tasks without fine-tuning.

## Foundational Learning
- **Modality integration**: Combining spatial, temporal, and POI data is essential because vehicle trajectories are inherently multi-modal, with each modality providing complementary information about movement patterns
  - Quick check: Verify that removing any single modality significantly degrades performance
- **Learnable spatio-temporal embeddings**: Traditional positional encodings are insufficient for capturing the complex spatial-temporal relationships in trajectories
  - Quick check: Compare performance with fixed vs. learnable position embeddings
- **Unified masking and recovery**: A single pre-training objective that encompasses multiple downstream tasks enables zero-shot task transferability
  - Quick check: Test performance when using task-specific vs. unified pre-training objectives

## Architecture Onboarding
- **Component map**: Trajectory data -> STRFormer (Spatial + Temporal + POI modalities + STRPE) -> Trajectory Masking & Recovery -> Pre-trained TrajFM -> Downstream tasks
- **Critical path**: Pre-training with trajectory masking and recovery scheme is the critical path, as it determines the quality of representations that enable downstream task performance
- **Design tradeoffs**: The unified pre-training objective trades task-specific optimization for generalization across tasks, while the learnable STRPE trades increased model complexity for better spatial-temporal representation learning
- **Failure signatures**: Poor downstream performance indicates inadequate pre-training, incorrect modality integration, or insufficient model capacity to capture spatial-temporal patterns
- **First experiments**:
  1. Implement and validate the exact masking ratios and recovery procedures described in the trajectory masking and recovery scheme
  2. Replicate experiments on held-out regions not seen during pre-training to verify true region transferability
  3. Perform a comprehensive ablation study isolating contributions of STRPE, modality mixing, and masking scheme

## Open Questions the Paper Calls Out
None specified in the provided material.

## Limitations
- The exact implementation details of the trajectory masking and recovery scheme are not fully disclosed, making exact reproduction challenging
- The specific architecture and hyperparameters of STRFormer are not completely detailed, which are crucial for achieving the reported performance
- The ablation studies could be more comprehensive to isolate the contribution of each component to transferability
- The model's performance on regions and tasks significantly different from the training distribution is not extensively evaluated

## Confidence
- **High confidence**: The general approach and problem formulation are sound and well-motivated
- **Medium confidence**: The reported performance improvements are likely real but may depend on specific implementation details not fully disclosed
- **Low confidence**: The exact mechanisms by which region and task transferability are achieved without retraining

## Next Checks
1. Implement and validate the exact masking ratios and recovery procedures described in the trajectory masking and recovery scheme to confirm they contribute to the reported performance gains
2. Replicate the experiments on held-out regions not seen during pre-training to verify true region transferability rather than overfitting to specific spatial patterns
3. Perform a comprehensive ablation study isolating the contributions of STRPE, modality mixing, and the masking scheme to understand which components are essential for transferability