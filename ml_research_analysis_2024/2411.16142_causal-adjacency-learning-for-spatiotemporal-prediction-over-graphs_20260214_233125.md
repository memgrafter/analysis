---
ver: rpa2
title: Causal Adjacency Learning for Spatiotemporal Prediction Over Graphs
arxiv_id: '2411.16142'
source_url: https://arxiv.org/abs/2411.16142
tags:
- causal
- matrix
- adjacency
- data
- graph
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the problem of spatiotemporal prediction over
  graphs (STPG) in transportation systems, particularly focusing on the out-of-distribution
  (OOD) generalization problem that occurs when test data has a different distribution
  from training data. The authors propose a Causal Adjacency Learning (CAL) framework
  that discovers causal relationships among graph nodes by incorporating temporal
  conditional independence tests and spatial pre-selection.
---

# Causal Adjacency Learning for Spatiotemporal Prediction Over Graphs

## Quick Facts
- arXiv ID: 2411.16142
- Source URL: https://arxiv.org/abs/2411.16142
- Authors: Zhaobin Mo; Qingyuan Liu; Baohua Yan; Longxiang Zhang; Xuan Di
- Reference count: 26
- Primary result: CAL framework achieves 14.23-50.27% RMSE improvement in spatiotemporal prediction over graphs

## Executive Summary
This paper addresses the critical challenge of out-of-distribution generalization in spatiotemporal prediction over graphs (STPG) for transportation systems. The authors propose a Causal Adjacency Learning (CAL) framework that discovers causal relationships among graph nodes by incorporating temporal conditional independence tests and spatial pre-selection. The method filters false positive/negative causal dependencies using the SyPI algorithm and generates a causal adjacency matrix that can be transferred to downstream tasks without requiring causal inference again.

Evaluated on real-world mobility data from New York City during the COVID-19 pandemic, the CAL method demonstrates significant improvements in predicting mobility patterns compared to traditional distance, correlation, and attention-based adjacency matrices. The approach not only achieves superior prediction accuracy but also reduces the number of edges in the adjacency matrix by up to 15.98%, indicating more efficient graph representations. Most notably, CAL successfully captures OOD patterns during the COVID outbreak period, demonstrating its effectiveness in handling distribution shifts.

## Method Summary
The CAL framework introduces a novel approach to spatiotemporal prediction by learning causal adjacency matrices through a two-stage process. First, it performs temporal conditional independence tests to identify potential causal relationships among graph nodes while accounting for temporal dependencies. Second, it applies spatial pre-selection to filter and refine these relationships, using the SyPI algorithm to eliminate false positive and false negative causal dependencies. The resulting causal adjacency matrix serves as a more robust foundation for spatiotemporal prediction tasks, particularly when test data exhibits distribution shifts compared to training data. The framework is evaluated on real-world mobility data from New York City, demonstrating significant improvements in prediction accuracy during the COVID-19 pandemic period.

## Key Results
- Achieved 14.23%, 15.49%, and 50.27% RMSE improvement in next-week mobility prediction compared to distance, correlation, and attention-based adjacency matrices respectively
- For 4-week predictions, CAL showed 24.71%, 10.98%, and 27.26% improvement over baseline methods
- Reduced the number of edges in the adjacency matrix by up to 15.98% compared to correlation-based methods
- Successfully captured OOD patterns during the COVID outbreak period, demonstrating superior performance in handling distribution shifts

## Why This Works (Mechanism)
The CAL framework works by explicitly modeling causal relationships rather than mere correlations between graph nodes. Traditional adjacency matrices based on distance or correlation capture statistical dependencies that may not represent true causal mechanisms, making them vulnerable to distribution shifts. By incorporating temporal conditional independence tests, CAL identifies relationships that persist across different temporal contexts, while the spatial pre-selection and SyPI algorithm filtering ensure that only genuine causal dependencies are retained. This causal structure proves more robust to changes in the underlying data distribution, such as those caused by the COVID-19 pandemic, because causal relationships tend to remain stable even when non-causal correlations change.

## Foundational Learning
**Temporal Conditional Independence Tests**: Statistical tests to determine whether two variables are independent given a set of conditioning variables over time; needed to identify potential causal relationships that are not merely coincidental; quick check: verify test sensitivity to different lag structures and sample sizes.

**SyPI Algorithm**: A causal discovery algorithm that filters false positive and false negative dependencies; needed to refine the initial causal estimates and improve the reliability of the adjacency matrix; quick check: assess algorithm performance on known causal structures with varying noise levels.

**Spatiotemporal Prediction Over Graphs**: The task of forecasting node attributes in graph-structured data that evolves over time; needed to model complex dependencies in transportation networks where spatial proximity and temporal dynamics both matter; quick check: evaluate prediction accuracy across different temporal horizons and spatial scales.

**Out-of-Distribution Generalization**: The ability of a model to perform well on data with different statistical properties than the training set; needed because real-world transportation systems face various distribution shifts (e.g., pandemics, special events); quick check: measure performance degradation when test data deviates from training distribution.

**Causal vs Correlation-based Relationships**: Causal relationships represent direct influence mechanisms while correlations may be spurious or indirect; needed to build models that are robust to distribution shifts where non-causal correlations may change; quick check: compare model performance when underlying causal structure remains stable but correlations change.

## Architecture Onboarding

**Component Map**: Data Preprocessing -> Temporal Conditional Independence Tests -> Spatial Pre-selection -> SyPI Filtering -> Causal Adjacency Matrix -> Spatiotemporal Prediction Model

**Critical Path**: The core workflow involves first preprocessing the spatiotemporal data, then performing temporal conditional independence tests to identify potential causal relationships, followed by spatial pre-selection to reduce the search space. The SyPI algorithm then filters these relationships to eliminate false dependencies, resulting in a refined causal adjacency matrix that serves as input to the spatiotemporal prediction model.

**Design Tradeoffs**: The framework trades computational complexity for improved generalization performance. Temporal conditional independence tests and the SyPI algorithm require significant computational resources compared to simple correlation-based methods, but this investment yields more robust adjacency matrices that better handle distribution shifts. The spatial pre-selection step reduces computational burden but may risk missing important long-range causal relationships.

**Failure Signatures**: The method may fail when temporal conditional independence assumptions are violated, such as in highly non-stationary environments where causal relationships themselves change over time. It may also underperform when the SyPI algorithm incorrectly filters genuine causal dependencies, or when spatial pre-selection is too aggressive and eliminates important relationships. Additionally, the method requires sufficient data to reliably estimate temporal dependencies, potentially limiting its effectiveness with sparse datasets.

**First 3 Experiments**:
1. Compare CAL performance against correlation-based adjacency matrices on a synthetic dataset with known causal structure and controlled distribution shifts
2. Evaluate the impact of different temporal lag structures in the conditional independence tests on prediction accuracy
3. Test the framework's sensitivity to the spatial pre-selection threshold by varying the neighborhood size and measuring performance changes

## Open Questions the Paper Calls Out
None

## Limitations
- The framework's dependence on the SyPI algorithm's accuracy for filtering false causal dependencies may limit performance in highly noisy environments
- The COVID-19 specific results, while impressive, may not generalize to other types of distribution shifts or environmental changes
- Computational complexity of temporal conditional independence tests and spatial pre-selection steps is not fully explored, potentially impacting scalability

## Confidence
- High confidence: The methodology for adjacency learning and its application to spatiotemporal prediction over graphs is well-established and technically sound
- Medium confidence: The comparative performance improvements against baseline methods are convincing but require further validation across different transportation systems and temporal contexts
- Medium confidence: The COVID-19 specific results demonstrate the framework's ability to handle OOD data, though the extent of generalizability to other distribution shifts remains uncertain

## Next Checks
1. Conduct ablation studies to isolate the contribution of temporal conditional independence tests versus spatial pre-selection in the overall performance improvement
2. Test the framework on multiple transportation datasets with different types of distribution shifts (e.g., weather events, special occasions, infrastructure changes) beyond the COVID-19 scenario
3. Evaluate the computational efficiency and scalability of the CAL framework on larger graph networks with increased node and edge complexity