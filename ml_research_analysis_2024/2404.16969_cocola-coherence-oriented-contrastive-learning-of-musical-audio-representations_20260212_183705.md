---
ver: rpa2
title: 'COCOLA: Coherence-Oriented Contrastive Learning of Musical Audio Representations'
arxiv_id: '2404.16969'
source_url: https://arxiv.org/abs/2404.16969
tags:
- cocola
- learning
- audio
- music
- arxiv
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: COCOLA addresses the lack of objective metrics for evaluating coherence
  between musical stems in accompaniment generation models. It uses contrastive learning
  on stem submixtures from the same musical window, training an encoder to maximize
  similarity for coherent pairs and minimize it for incoherent ones.
---

# COCOLA: Coherence-Oriented Contrastive Learning of Musical Audio Representations

## Quick Facts
- arXiv ID: 2404.16969
- Source URL: https://arxiv.org/abs/2404.16969
- Reference count: 40
- COCOLA achieves up to 93.87% classification accuracy and r=0.54 Pearson correlation with MOS

## Executive Summary
COCOLA introduces a novel contrastive learning approach to evaluate coherence between musical stems in accompaniment generation. By training an encoder on submixtures of stems from the same musical window, COCOLA learns to distinguish coherent from incoherent pairs. The resulting COCOLA Score measures similarity between conditioning tracks and generated accompaniments, showing better correlation with human perception than existing FAD metrics. The method operates at the stem level rather than full tracks, making it specifically suited for accompaniment generation evaluation.

## Method Summary
COCOLA uses contrastive learning on musical stem submixtures to learn embeddings that capture harmonic and rhythmic coherence. The encoder processes mel spectrograms (optionally with HPS preprocessing) of submixtures from the same audio window as positive pairs, and from different windows as negatives. A bilinear similarity metric computes the COCOLA Score between conditioning tracks and generated accompaniments. The model is trained on MUSDB18-HQ, MoisesDB, Slakh2100, and CocoChorales datasets with HPS augmentation, achieving high classification accuracy and moderate correlation with subjective MOS ratings.

## Key Results
- Up to 93.87% classification accuracy on held-out MUSDB18-HQ test set
- Pearson correlation r=0.54 between COCOLA Score and subjective MOS
- COCOLA better captures coherence than FAD metrics, showing higher scores for ground truth and Diff-A-Riff outputs
- HPS preprocessing improves classification accuracy compared to raw mel spectrograms

## Why This Works (Mechanism)

### Mechanism 1
The contrastive objective learns embeddings capturing harmonic and rhythmic coherence by aligning representations of musically coherent submixtures while distinguishing them from incoherent pairs. The bilinear similarity and cross-entropy loss maximize similarity for coherent submixtures from the same window. Core assumption: coherence within windows exceeds between-window coherence. Break condition: significant window overlap may introduce false negatives.

### Mechanism 2
HPS preprocessing improves coherence capture by learning separate representations for harmonic and rhythmic features. This factorized approach better discriminates differences due to harmonic versus rhythmic factors. Core assumption: harmonic and rhythmic coherence are largely independent. Break condition: if harmonic and percussive components are too interdependent, separation may lose coherence signals.

### Mechanism 3
COCOLA Score provides objective evaluation by measuring similarity in learned embedding space between conditioning and generated accompaniments. This targeted approach captures coherence better than FAD metrics focused on global quality. Core assumption: learned embeddings preserve relevant coherence aspects. Break condition: if model learns spurious correlations, COCOLA Score won't reflect true coherence.

## Foundational Learning

- Concept: Contrastive learning fundamentals
  - Why needed here: Entire COCOLA framework relies on contrastive learning to distinguish coherent from incoherent pairs
  - Quick check question: Can you explain the difference between positive and negative pairs in contrastive learning and why both are necessary?

- Concept: Musical structure and coherence
  - Why needed here: Understanding harmonic compatibility and rhythmic alignment is essential for interpreting results
  - Quick check question: What are the key elements that determine whether two musical stems sound coherent together?

- Concept: Audio feature extraction and representation
  - Why needed here: Encoder operates on mel spectrograms, understanding these representations is crucial for implementation
  - Quick check question: How does a mel spectrogram differ from a raw waveform, and what musical information does it preserve?

## Architecture Onboarding

- Component map: Audio → HPS (optional) → Mel spectrogram → COCOLA encoder → Embedding vectors → Similarity computation → Loss calculation → Parameter update
- Critical path: Raw audio flows through HPS preprocessing, mel spectrogram conversion, the encoder, similarity computation, and loss calculation for parameter updates
- Design tradeoffs: HPS preprocessing trades full spectral context for separated harmonic/rhythmic features; window overlap ratio balances positive pair quantity against false negatives
- Failure signatures: Poor classification accuracy indicates poor representation learning; low MOS correlation suggests wrong coherence aspects captured; overfitting shows poor generalization
- First 3 experiments:
  1. Train COCOLA on MUSDB18-HQ without HPS, evaluate classification accuracy to verify basic contrastive learning
  2. Add HPS preprocessing, compare accuracy to quantify benefit of factorized representations
  3. Compute COCOLA Scores for ground truth vs random accompaniments, verify ground truth scores are higher

## Open Questions the Paper Calls Out

### Open Question 1
How does COCOLA performance change when trained on datasets with more diverse musical genres and production styles? Experiments focus on similar domains without cross-genre transfer analysis.

### Open Question 2
What is the optimal window overlap ratio (r) for different musical contexts and stem combinations? Paper uses fixed r=50% without sensitivity analysis.

### Open Question 3
How does COCOLA compare to human perception of coherence in edge cases like cross-genre mashups or experimental music? Limited subjective testing scope doesn't address boundary cases.

### Open Question 4
What architectural modifications could improve COCOLA's sensitivity to specific aspects of musical coherence? Paper uses standard EfficientNet-B0 without exploring specialized architectures.

### Open Question 5
How does COCOLA's effectiveness scale with the number of stems in both conditioning and generated outputs? Experiments focus on 2-submix cases without comprehensive scalability study.

## Limitations

- Moderate correlation (r=0.54) between COCOLA Score and human perception indicates room for improvement
- Lack of direct evidence for key claims about HPS benefits and COCOLA's superiority over FAD metrics
- No analysis of potential biases in training data or generalization to musical styles outside training corpora

## Confidence

- High confidence: Contrastive learning framework and architecture specifications are clearly defined and reproducible
- Medium confidence: Classification accuracy results and basic functionality of COCOLA Score as similarity metric
- Low confidence: Claims about HPS improving harmonic/rhythmic separation and COCOLA's superiority over FAD metrics for coherence evaluation

## Next Checks

1. **Cross-style generalization test**: Evaluate COCOLA Score on accompaniment generation for genres not in training datasets (jazz, classical, ethnic) to verify generalizable coherence features.

2. **Ablation study on HPS**: Systematically compare COCOLA performance with and without HPS preprocessing across harmonic accuracy, rhythmic alignment, and overall coherence.

3. **Adversarial coherence test**: Generate pairs with controlled harmonic/rhythmic conflicts and verify COCOLA Score correctly identifies and ranks these as less coherent than naturally compatible pairs.