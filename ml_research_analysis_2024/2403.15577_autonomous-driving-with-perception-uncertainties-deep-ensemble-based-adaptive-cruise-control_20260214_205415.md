---
ver: rpa2
title: 'Autonomous Driving With Perception Uncertainties: Deep-Ensemble Based Adaptive
  Cruise Control'
arxiv_id: '2403.15577'
source_url: https://arxiv.org/abs/2403.15577
tags:
- vehicle
- distance
- headway
- speed
- deep
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes an ensemble of deep neural networks for estimating
  the distance headway to a lead vehicle from RGB images. The ensemble generates estimates
  with uncertainty quantification, which are used by a stochastic model predictive
  controller to ensure probabilistic safety in adaptive cruise control.
---

# Autonomous Driving With Perception Uncertainties: Deep-Ensemble Based Adaptive Cruise Control

## Quick Facts
- arXiv ID: 2403.15577
- Source URL: https://arxiv.org/abs/2403.15577
- Reference count: 22
- Key outcome: Ensemble of deep neural networks for distance headway estimation with uncertainty quantification used in stochastic MPC for safe ACC

## Executive Summary
This paper proposes an ensemble of deep neural networks to estimate distance headway to lead vehicles from RGB images, generating estimates with quantified uncertainty. The uncertainty estimates are used by a stochastic model predictive controller to ensure probabilistic safety in adaptive cruise control. The approach is validated using a high-fidelity simulator and real-world traffic dataset, demonstrating good performance in both in-distribution and out-of-distribution scenarios. The method achieves a time-to-collision greater than 4 seconds in most cases while maintaining comfortable acceleration profiles.

## Method Summary
The proposed approach combines a deep ensemble of neural networks for perception uncertainty quantification with a stochastic model predictive controller for motion planning. The ensemble consists of multiple deep neural networks trained to estimate distance headway from RGB images, with the variance across predictions serving as the uncertainty measure. This perception uncertainty is then incorporated into a stochastic MPC formulation that optimizes acceleration while ensuring probabilistic safety constraints. The controller uses a bicycle model for ego vehicle dynamics and formulates safety as probabilistic constraints on time-to-collision, allowing for adaptive risk tolerance based on the quality of perception input.

## Key Results
- Achieves time-to-collision greater than 4 seconds in most driving scenarios
- Regulates ego vehicle back to safe distance within 4 seconds
- Maintains moderate acceleration/deceleration and comfortable jerk values

## Why This Works (Mechanism)
The approach works by explicitly quantifying perception uncertainty and incorporating it into the motion planning optimization. By using an ensemble of deep networks, the method captures model uncertainty in the distance estimation task. This uncertainty information is then used by the stochastic MPC to adjust risk tolerance - when perception is uncertain (e.g., poor visibility), the controller becomes more conservative, and when perception is confident, it can operate more aggressively. This adaptive behavior ensures safety across varying perception conditions without requiring explicit hand-tuning of safety margins.

## Foundational Learning

1. **Deep Ensembles** - Multiple neural networks trained on the same task with different initializations to capture model uncertainty
   - Why needed: Single neural networks provide point estimates without uncertainty quantification
   - Quick check: Variance across ensemble predictions correlates with actual error

2. **Stochastic Model Predictive Control** - MPC formulation that incorporates probabilistic constraints and uncertainty
   - Why needed: Traditional MPC assumes perfect state estimation, which is unrealistic for perception-based systems
   - Quick check: Probabilistic constraints are satisfied with desired confidence level

3. **Time-to-Collision Metrics** - Safety metric measuring time until collision if current velocities are maintained
   - Why needed: Provides interpretable safety measure that can be incorporated into optimization
   - Quick check: TTC values remain above safety threshold during operation

## Architecture Onboarding

Component Map: Camera -> Deep Ensemble -> Uncertainty Quantification -> Stochastic MPC -> Vehicle Dynamics -> Acceleration Command

Critical Path: Image input flows through the ensemble to produce distance estimate with uncertainty, which feeds into the MPC optimization to generate acceleration commands. The controller considers vehicle dynamics and safety constraints to produce safe, comfortable motion plans.

Design Tradeoffs: The ensemble approach trades computational complexity for uncertainty quantification - multiple networks must be evaluated versus a single network. The stochastic MPC formulation trades optimality for safety guarantees by incorporating probabilistic constraints. The perception system trades off between using more sophisticated uncertainty quantification methods (like Bayesian NNs) versus the simpler ensemble approach.

Failure Signatures: The system may fail when ensemble uncertainty estimates are poorly calibrated, leading to inappropriate risk tolerance. It may also fail when the MPC cannot find feasible solutions under tight safety constraints, potentially causing the vehicle to stop unnecessarily. Perception failures (e.g., occlusion, extreme lighting) that the ensemble cannot capture may lead to unsafe behavior.

First Experiments:
1. Evaluate ensemble uncertainty calibration by comparing predicted variance to actual estimation error on validation set
2. Test MPC performance under synthetic uncertainty scenarios with known ground truth
3. Compare safety performance against baseline deterministic MPC in simulation with perception noise

## Open Questions the Paper Calls Out
None

## Limitations
- Limited real-world testing data to fully validate effectiveness across diverse driving conditions
- No discussion of computational constraints or integration challenges with existing autonomous vehicle systems
- Validation primarily conducted in simulator and with real-world traffic dataset, not actual road testing

## Confidence
- High confidence in theoretical framework and methodology for uncertainty quantification and MPC formulation
- Medium confidence in real-world performance claims due to limited validation scope
- Medium confidence in computational feasibility and system integration aspects

## Next Checks
1. Conduct extensive real-world testing in diverse driving conditions to validate approach's performance and robustness
2. Evaluate computational efficiency and integration challenges of deep ensemble approach in actual autonomous vehicles
3. Compare proposed method with other state-of-the-art approaches in terms of safety, efficiency, and computational requirements