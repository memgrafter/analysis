---
ver: rpa2
title: Discovering Latent Causal Graphs from Spatiotemporal Data
arxiv_id: '2411.05331'
source_url: https://arxiv.org/abs/2411.05331
tags:
- causal
- spatial
- latent
- data
- time
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: SPACY is a variational inference-based method for discovering causal
  structures in spatiotemporal gridded data. It jointly infers latent time series
  and their causal relationships, addressing high dimensionality and spatial correlation
  challenges by modeling spatial factors using radial basis functions.
---

# Discovering Latent Causal Graphs from Spatiotemporal Data

## Quick Facts
- **arXiv ID:** 2411.05331
- **Source URL:** https://arxiv.org/abs/2411.05331
- **Reference count:** 40
- **Primary result:** SPACY outperforms state-of-the-art baselines on synthetic datasets with F1 scores of 0.623-0.752 vs 0.549-0.642 for competitors

## Executive Summary
SPACY is a variational inference-based method for discovering causal structures in spatiotemporal gridded data. It jointly infers latent time series and their causal relationships, addressing high dimensionality and spatial correlation challenges by modeling spatial factors using radial basis functions. The method avoids assumptions about instantaneous effects or sufficient variability, making it more flexible than existing approaches. SPACY demonstrates superior performance on synthetic datasets and successfully identifies known climate phenomena in real-world data.

## Method Summary
SPACY uses an end-to-end variational inference framework to simultaneously discover latent causal structures in spatiotemporal data. The method encodes high-dimensional grid observations into a lower-dimensional latent space, models spatial correlations using radial basis function kernels, and infers causal relationships between latent variables through a structural causal model framework. The approach jointly optimizes the reconstruction of observed data and the discovery of the underlying causal graph, using an evidence-lower-bound (ELBO) objective. A freezing strategy is employed where latent causal modules are frozen for the first 200 epochs while spatial factors are optimized.

## Key Results
- SPACY achieves F1 scores of 0.623-0.752 on synthetic datasets, significantly outperforming competitors (0.549-0.642)
- The method correctly identifies known climate phenomena like the North Atlantic Oscillation and Antarctic Oscillation in real-world data
- SPACY demonstrates robustness to kernel choice and performs well even when the number of latent variables is over-specified

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Joint inference of latent time series and causal graph enables better handling of high-dimensional spatiotemporal data.
- Mechanism: SPACY uses variational inference to simultaneously infer latent time series (Z) and their causal relationships (G), avoiding the information loss that occurs when dimensionality reduction and causal discovery are performed independently.
- Core assumption: The observed high-dimensional spatiotemporal data can be represented as a function of a smaller number of latent time series with spatial factors.
- Evidence anchors:
  - [abstract] "Our method uses an end-to-end training process that maximizes an evidence-lower-bound (ELBO) for the data likelihood."
  - [section 3.1] "Our approach jointly infers both the latent time series and the underlying causal graph in an end-to-end process."
  - [corpus] Weak evidence - no direct mention of joint inference benefits in corpus papers.
- Break condition: If the latent space dimensionality is insufficient to capture the causal structure, or if spatial factors cannot effectively aggregate correlated grid points.

### Mechanism 2
- Claim: Spatial factors parameterized by radial basis functions (RBFs) effectively aggregate correlated grid points while maintaining interpretability.
- Mechanism: RBFs map grid locations to latent representations by centering kernels at specific locations and scaling their influence, ensuring that spatially proximate points are aggregated under the same latent variable.
- Core assumption: Spatial correlations in the data can be captured by smooth, localized functions centered at specific grid locations.
- Evidence anchors:
  - [abstract] "To aggregate spatially proximate, correlated grid points, we use spatial factors, parametrized by spatial kernel functions, to map observational time series to latent representations."
  - [section 3.1] "These spatial factors determine the grid locations corresponding to each inferred latent time series."
  - [corpus] Weak evidence - corpus papers focus on other spatial modeling approaches but don't directly address RBF-based aggregation.
- Break condition: If the true spatial structure is not well-represented by RBFs (e.g., highly irregular spatial patterns), or if the number of latent variables is mis-specified.

### Mechanism 3
- Claim: Theoretical identifiability guarantees that latent factors and time series can be recovered from observational data under certain conditions.
- Mechanism: The paper proves that when observations arise from a nonlinear, invertible function of the product of latent series and spatial factors, the latent variables are identifiable up to transformation by an invertible matrix.
- Core assumption: The observational data is generated by an invertible function of the latent variables and spatial factors, with no non-linearity mapping latents to observable space.
- Evidence anchors:
  - [abstract] "Theoretically, we generalize the problem to a continuous spatial domain and establish identifiability when the observations arise from a nonlinear, invertible function of the product of latent series and spatial factors."
  - [section 4] "We demonstrate that when the grid is infinitely fine, we can uniquely recover the spatial factors and latent time series (up to permutation) that generate the observed data distribution."
  - [corpus] Weak evidence - corpus papers don't discuss identifiability in the context of spatiotemporal causal discovery.
- Break condition: If the assumptions about invertibility or the absence of non-linear mappings are violated, or if the grid resolution is insufficient.

## Foundational Learning

- Concept: Variational inference and evidence lower bound (ELBO)
  - Why needed here: SPACY uses variational inference to optimize an intractable likelihood by maximizing the ELBO instead, which provides a tractable objective function.
  - Quick check question: What is the relationship between the ELBO and the true log-likelihood of the data?

- Concept: Radial basis functions (RBFs) and kernel methods
  - Why needed here: RBFs are used to parameterize spatial factors that aggregate spatially proximate grid points, capturing spatial correlations in the data.
  - Quick check question: How does the choice of kernel function (e.g., RBF vs. Matérn) affect the shape and smoothness of the spatial factors?

- Concept: Structural causal models (SCMs) and causal discovery
  - Why needed here: SPACY infers causal relationships between latent time series using an SCM framework, modeling the data generation process as a DAG with additive noise.
  - Quick check question: What is the difference between Granger causality and the SCM approach used in SPACY?

## Architecture Onboarding

- Component map: Observed data → Encoder → Latent Z → Spatial factors F → Reconstructed data; simultaneously infer causal graph G

- Critical path: Observed data → Encoder → Latent Z → Spatial factors F → Reconstructed data; simultaneously infer causal graph G

- Design tradeoffs:
  - Linear vs. non-linear SCM: Linear is computationally efficient but may miss complex relationships; non-linear can capture more complex dynamics but is computationally more expensive
  - Number of latent variables (D): Too few may miss important structure; too many may overfit
  - Kernel choice: RBF is smooth and interpretable; Matérn offers more flexibility in smoothness

- Failure signatures:
  - Poor F1 scores: Indicates incorrect causal structure inference
  - Low MCC scores: Indicates poor alignment between inferred and true latent representations
  - Spatial factors that are too diffuse: May indicate insufficient regularization or incorrect kernel parameters
  - Training instability: May indicate learning rate issues or poor initialization

- First 3 experiments:
  1. Run SPACY on a simple synthetic dataset with known linear SCM and linear spatial mapping to verify basic functionality
  2. Test SPACY on a synthetic dataset with non-linear SCM and spatial mapping to evaluate its ability to capture complex relationships
  3. Apply SPACY to a real-world climate dataset (e.g., global temperature) to assess its ability to identify known climate phenomena

## Open Questions the Paper Calls Out
The paper acknowledges several open questions for future research. These include extending SPACY to multivariate spatiotemporal settings where multiple interacting variables are present, exploring different kernel functions beyond RBFs to capture more complex spatial structures, and testing the method's scalability on extremely large spatiotemporal datasets with millions of grid points or thousands of time steps.

## Limitations
- Theoretical identifiability claims rely on assumptions about invertibility and infinite grid resolution that may not hold in practice
- Empirical evaluation is limited to two climate indices in real-world data, with most validation on synthetic datasets
- RBF kernel choice may not capture all spatial correlation patterns, particularly for irregular or highly non-smooth structures

## Confidence
- High confidence: SPACY's ability to outperform baselines on synthetic datasets (F1 scores 0.623-0.752 vs 0.549-0.642)
- Medium confidence: Claims about scalability and robustness to kernel choice, as these are based on limited ablation studies
- Medium confidence: Real-world applicability demonstrated by identifying known climate phenomena, as only two indices are examined

## Next Checks
1. Test SPACY on synthetic datasets with non-smooth spatial structures (e.g., checkerboard patterns) to evaluate RBF kernel limitations
2. Apply SPACY to additional real-world spatiotemporal datasets with known causal structures (e.g., epidemiological data, traffic patterns) to assess generalizability
3. Conduct a systematic ablation study varying the number of latent variables (D) across a wider range to quantify the over-specification robustness claim