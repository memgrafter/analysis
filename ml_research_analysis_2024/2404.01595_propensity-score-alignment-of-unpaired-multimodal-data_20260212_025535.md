---
ver: rpa2
title: Propensity Score Alignment of Unpaired Multimodal Data
arxiv_id: '2404.01595'
source_url: https://arxiv.org/abs/2404.01595
tags:
- matching
- each
- data
- modality
- samples
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of aligning unpaired multimodal
  data, where paired samples are difficult or impossible to collect due to destructive
  measurement processes. The authors draw an analogy between potential outcomes in
  causal inference and potential views in multimodal observations, using Rubin's framework
  to estimate a common space for matching samples.
---

# Propensity Score Alignment of Unpaired Multimodal Data

## Quick Facts
- arXiv ID: 2404.01595
- Source URL: https://arxiv.org/abs/2404.01595
- Authors: Johnny Xi; Jana Osea; Zuheng Xu; Jason Hartford
- Reference count: 28
- Primary result: Demonstrates significant improvements in aligning unpaired multimodal data using propensity score-based optimal transport matching, outperforming state-of-the-art methods on synthetic and biological datasets.

## Executive Summary
This paper addresses the challenge of aligning unpaired multimodal data, where paired samples are difficult or impossible to collect due to destructive measurement processes. The authors draw an analogy between potential outcomes in causal inference and potential views in multimodal observations, using Rubin's framework to estimate a common space for matching samples. Their approach leverages experimentally perturbed samples by treatments to estimate a propensity score from each modality, which encapsulates all shared information between a latent state and treatment. This propensity score can be used to define a distance between samples, enabling alignment across modalities. The authors experiment with two alignment techniques—shared nearest neighbors (SNN) and optimal transport (OT) matching—and find that OT matching results in significant improvements over state-of-the-art alignment approaches in both synthetic and real-world biological data, including the NeurIPS Multimodal Single-Cell Integration Challenge and a single-cell microscopy to expression prediction task.

## Method Summary
The proposed method treats multimodal data alignment as a causal inference problem, where each modality represents a potential outcome of a latent state under different treatments. By leveraging experimentally perturbed samples, the authors estimate a propensity score from each modality, which captures the shared information between the latent state and treatment. These propensity scores are then used to define a distance metric between samples, enabling alignment across modalities. The authors implement two alignment techniques: shared nearest neighbors (SNN) matching and optimal transport (OT) matching. OT matching is found to outperform SNN and other state-of-the-art methods in terms of alignment quality, as measured by various metrics on both synthetic and real-world biological datasets.

## Key Results
- Optimal transport matching using propensity scores significantly improves alignment quality compared to shared nearest neighbors and other state-of-the-art methods.
- The method demonstrates better generalization compared to random matching, VAE-based matching, and even ground truth matching on evaluated datasets.
- Significant improvements are observed in both synthetic data and real-world biological data, including the NeurIPS Multimodal Single-Cell Integration Challenge and single-cell microscopy to expression prediction tasks.

## Why This Works (Mechanism)
The method works by leveraging the concept of potential outcomes from causal inference and applying it to multimodal data alignment. By treating each modality as a potential outcome of a latent state under different treatments, the authors can estimate a propensity score that encapsulates the shared information between the latent state and treatment. This propensity score serves as a common representation that can be used to define a distance metric between samples, enabling alignment across modalities. The use of experimentally perturbed samples allows for more accurate estimation of propensity scores, which in turn leads to better alignment quality. The optimal transport matching technique further improves alignment by finding the optimal transport plan between the propensity score distributions of the two modalities.

## Foundational Learning
- **Propensity scores**: Used to estimate the probability of a sample being assigned to a particular treatment given its observed characteristics. Why needed: To capture the shared information between a latent state and treatment in each modality. Quick check: Verify that propensity scores are estimated accurately using experimentally perturbed samples.
- **Potential outcomes framework**: A causal inference framework that models the potential outcomes of a treatment for each unit. Why needed: To draw an analogy between causal inference and multimodal data alignment, treating each modality as a potential outcome of a latent state under different treatments. Quick check: Ensure that the analogy between potential outcomes and potential views in multimodal observations is valid and useful for the alignment task.
- **Optimal transport**: A mathematical framework for finding the optimal transport plan between two probability distributions. Why needed: To align the propensity score distributions of the two modalities by finding the optimal transport plan. Quick check: Verify that the optimal transport matching technique outperforms other alignment methods, such as shared nearest neighbors.
- **Multimodal data alignment**: The task of aligning data from multiple modalities, where paired samples are not available. Why needed: To enable joint analysis and modeling of multimodal data, which is increasingly common in fields such as biology and computer vision. Quick check: Assess the performance of the proposed method on various multimodal alignment tasks and compare it to state-of-the-art methods.
- **Experimentally perturbed samples**: Samples that have been subjected to different treatments or perturbations, allowing for estimation of causal effects. Why needed: To estimate propensity scores accurately, as they require knowledge of the treatment assignment mechanism. Quick check: Ensure that the availability of experimentally perturbed samples is sufficient for accurate propensity score estimation.

## Architecture Onboarding

Component Map:
Latent state -> Modality 1 (with treatment) -> Propensity score 1
Latent state -> Modality 2 (with treatment) -> Propensity score 2
Propensity score 1 <-> Propensity score 2 (alignment via OT or SNN)

Critical Path:
1. Estimate propensity scores from each modality using experimentally perturbed samples.
2. Define a distance metric between samples based on their propensity scores.
3. Align the propensity score distributions of the two modalities using optimal transport or shared nearest neighbors.

Design Tradeoffs:
- Using propensity scores as a common representation allows for alignment without paired samples, but relies on accurate estimation of propensity scores.
- Optimal transport matching provides better alignment quality than shared nearest neighbors but may be computationally more expensive.
- The method requires experimentally perturbed samples for accurate propensity score estimation, which may not always be available.

Failure Signatures:
- Poor alignment quality when propensity scores are not estimated accurately or do not capture the shared information between modalities.
- Suboptimal performance when the number of experimentally perturbed samples is insufficient for accurate propensity score estimation.
- Computational inefficiency when dealing with large datasets or high-dimensional propensity score distributions.

First Experiments:
1. Generate synthetic multimodal data with known latent states and treatments, and evaluate the alignment quality of the proposed method compared to other techniques.
2. Apply the method to a real-world biological dataset, such as the NeurIPS Multimodal Single-Cell Integration Challenge, and assess its performance on various alignment tasks.
3. Conduct ablation studies to quantify the impact of each component of the method (e.g., propensity score estimation, OT vs. SNN matching) on overall alignment quality.

## Open Questions the Paper Calls Out
None

## Limitations
- The approach relies heavily on the availability of experimentally perturbed samples to estimate propensity scores, which may not always be feasible in real-world scenarios.
- The assumption that shared information between modalities can be fully captured by propensity scores is a strong one, and its validity may vary depending on the specific characteristics of the data and modalities involved.
- While the paper demonstrates improvements over state-of-the-art methods on specific datasets, the generalizability of these results to other domains or data types remains to be fully explored.

## Confidence
- Major claims regarding the effectiveness of optimal transport matching and the overall improvement over existing alignment techniques: Medium
- Comparison to ground truth matching: Medium (may not be entirely fair as ground truth alignments are not typically available in real-world unpaired data scenarios)

## Next Checks
1. Test the method on a wider variety of unpaired multimodal datasets, including those with different data types, modalities, and perturbation strategies, to assess generalizability.
2. Conduct ablation studies to quantify the impact of each component of the method (e.g., propensity score estimation, SNN vs. OT matching) on overall performance.
3. Compare the method's performance to other state-of-the-art techniques for unpaired multimodal data alignment, such as cycle-consistent adversarial networks or contrastive learning approaches, to provide a more comprehensive benchmark.