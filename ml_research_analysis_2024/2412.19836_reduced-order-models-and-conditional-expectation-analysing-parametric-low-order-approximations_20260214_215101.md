---
ver: rpa2
title: Reduced Order Models and Conditional Expectation -- Analysing Parametric Low-Order
  Approximations
arxiv_id: '2412.19836'
source_url: https://arxiv.org/abs/2412.19836
tags:
- which
- expectation
- conditional
- probability
- space
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper connects reduced order models (ROMs) and conditional
  expectation (CEX) through a unified probabilistic framework. It shows that many
  ROM construction methods can be interpreted as conditional expectation computations,
  where the ROM approximates the conditional expectation of a parameter-dependent
  quantity given observed data.
---

# Reduced Order Models and Conditional Expectation -- Analysing Parametric Low-Order Approximations

## Quick Facts
- arXiv ID: 2412.19836
- Source URL: https://arxiv.org/abs/2412.19836
- Authors: Hermann G. Matthies
- Reference count: 40
- Primary result: Shows that reduced order models (ROMs) can be interpreted as conditional expectation computations, enabling a unified probabilistic framework for ROM construction that incorporates multiple sources of uncertainty.

## Executive Summary
This paper establishes a theoretical connection between reduced order models and conditional expectation through a unified probabilistic framework. It demonstrates that many ROM construction methods—including reduced basis methods, proper orthogonal decomposition, and Gaussian process emulation—are mathematically equivalent to computing conditional expectations of parameter-dependent quantities given observed data. The paper shows how uncertainties in both the physical system and numerical solution can be incorporated through this probabilistic interpretation, enabling explicit handling of modeling errors, discretization errors, and numerical errors. Using spectral decomposition and singular value decomposition, it provides a foundation for constructing optimal ROM approximations with quantifiable error bounds.

## Method Summary
The paper uses linear maps and spectral decompositions to show that ROMs built via various methods are equivalent to computing conditional expectations over appropriate manifolds. It constructs a linear map R: U → Q for a given parametric quantity r(p), where U is the span of r(p) values and Q is a Hilbert space of functions on the parameter space P. The correlation operator CU = R†R is computed and its spectral decomposition yields the Karhunen-Loève expansion. The conditional expectation framework is implemented by defining Eg(x|z) = arg min_{χ∈Sg(z)} Ψx(χ) and applying it to ROM construction, treating ROM approximations as conditional expectations over appropriate manifolds. This approach enables explicit incorporation of multiple uncertainty sources through probability theory.

## Key Results
- ROM construction methods can be mathematically interpreted as conditional expectation computations over appropriate manifolds
- The unified probabilistic framework naturally incorporates modeling errors, discretization errors, and numerical errors as random variables
- Spectral decomposition and SVD provide the mathematical foundation for constructing optimal ROM approximations with quantifiable error bounds
- Different ROM approaches (reduced basis, POD, Gaussian process emulation) are all special cases of the same probabilistic computation

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Reduced order models (ROMs) built via various methods are mathematically equivalent to computing conditional expectations over appropriate manifolds.
- Mechanism: The paper establishes that ROM construction methods minimize mean-square error, which is equivalent to finding the conditional expectation of a parameter-dependent quantity given observed data. This creates a unified framework where different ROM approaches (reduced basis, POD, Gaussian process emulation) are all special cases of the same probabilistic computation.
- Core assumption: The parameter-dependent system can be modeled as a random variable on a probability space, and the ROM construction minimizes mean-square error between the full model and its approximation.
- Evidence anchors:
  - [abstract]: "This paper connects reduced order models (ROMs) and conditional expectation (CEX) through a unified probabilistic framework. It shows that many ROM construction methods can be interpreted as conditional expectation computations"
  - [section 4.2]: "ra(µ) = Eg(r(µ)|z). This will be made a bit more concrete in the following sections, by specifying the observations z and the manifoldSg"
  - [corpus]: No direct corpus evidence found for this specific mechanism, but the paper title and abstract explicitly state this connection.
- Break condition: If the mean-square error is not the appropriate loss function for the application, or if the parameter dependence cannot be adequately modeled as random variables on a probability space.

### Mechanism 2
- Claim: The unified probabilistic framework enables explicit handling of multiple types of uncertainties in ROM construction.
- Mechanism: By interpreting ROMs as conditional expectations, the framework naturally incorporates modeling errors, discretization errors, numerical errors, and reduction errors as additional random variables. These uncertainties can be combined through probability theory to create more robust ROMs.
- Core assumption: Different sources of uncertainty can be modeled as independent or dependent random variables on appropriate probability spaces.
- Evidence anchors:
  - [section 4.1]: "One of the advantages of a probabilistic view... is that other 'uncertainties', which appear in the whole process, can be incorporated in the picture"
  - [section 4.1]: "For the sake of simplicity, let us combine all the uncertainties inherent in the HFM to a new random variableηM... Similarly, combine all the additional numerical uncertainties..."
  - [corpus]: No direct corpus evidence found for this specific mechanism, but the paper explicitly discusses incorporating uncertainties through probability theory.
- Break condition: If the independence assumption between different uncertainty sources is violated, or if the uncertainty cannot be adequately modeled as random variables.

### Mechanism 3
- Claim: Spectral decomposition and singular value decomposition provide the mathematical foundation for constructing optimal ROM approximations.
- Mechanism: The paper uses SVD of the linear map associated with the parametric model to find optimal bases for ROM construction. The singular values indicate the importance of different terms in the expansion, enabling truncation to create reduced order models with quantifiable error bounds.
- Core assumption: The linear map associated with the parametric model has a well-defined SVD with discrete spectrum.
- Evidence anchors:
  - [section 2.5]: "The singular value decomposition (SVD) — see Appendix A and Appendix B — of the adjoint mapR†:Q→U is then the basis for a representation"
  - [section 2.6]: "From Eq.(15) one can very easily build a reduced order model (ROM). Assume... that the singular valuesςj are ordered by decreasing magnitude. By truncating the sum in Eq.(15) at some numberM≪n, one has a ROM"
  - [corpus]: No direct corpus evidence found for this specific mechanism, but the paper explicitly uses SVD for ROM construction.
- Break condition: If the linear map does not have a well-defined SVD with discrete spectrum, or if the singular values do not provide meaningful importance information.

## Foundational Learning

- Concept: Conditional expectation as orthogonal projection
  - Why needed here: This forms the mathematical foundation for interpreting ROMs as conditional expectations
  - Quick check question: Can you explain why minimizing mean-square error is equivalent to finding an orthogonal projection onto a subspace?

- Concept: Reproducing kernel Hilbert spaces (RKHS)
  - Why needed here: RKHS provides the mathematical framework for kernel methods used in ROM construction
  - Quick check question: What is the reproducing property in RKHS and how does it relate to evaluation functionals?

- Concept: Singular value decomposition and its connection to low-rank approximation
  - Why needed here: SVD provides the mathematical basis for optimal ROM truncation and error quantification
  - Quick check question: How does the SVD of a linear map relate to the Karhunen-Loève expansion?

## Architecture Onboarding

- Component map: High-fidelity model (HFM) → Discretization (FOM) → Reduced order model (ROM) → Uncertainty quantification
- Critical path: Parameter dependence → Linear map construction → Spectral decomposition → SVD computation → ROM construction → Uncertainty incorporation
- Design tradeoffs:
  - Accuracy vs computational cost in choosing ROM dimension
  - Complexity of uncertainty modeling vs tractability of conditional expectation computation
  - Choice of basis functions (polynomial chaos, POD, etc.) vs approximation quality
- Failure signatures:
  - Poor ROM performance when singular values decay slowly
  - Numerical instability in SVD computation for ill-conditioned linear maps
  - Breakdown of conditional expectation interpretation when loss function deviates from mean-square error
- First 3 experiments:
  1. Implement simple ROM construction using SVD truncation on a linear parametric PDE and verify convergence
  2. Add uncertainty modeling to the ROM and compare performance with deterministic ROM
  3. Test different basis selection methods (POD vs reduced basis) on the same parametric problem and compare results

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the conditional expectation framework handle model-form uncertainty differently from standard reduced order model error analysis?
- Basis in paper: [explicit] The paper discusses incorporating various uncertainties including modeling error described by probability space (ΩHFM,FHFM,PHFM) and numerical error described by (ΩNUM,FNUM,PNUM)
- Why unresolved: The paper outlines the probabilistic interpretation but doesn't provide concrete examples or comparisons showing how this approach differs in practice from traditional error analysis methods
- What evidence would resolve it: Specific case studies comparing standard ROM error bounds with those derived from the conditional expectation framework, showing advantages in accuracy or computational efficiency

### Open Question 2
- Question: What is the relationship between neural network Gaussian process correspondence and conditional expectation-based ROM construction?
- Basis in paper: [explicit] The paper mentions that "broad artificial neural networks at initialisation behave like Gaussian processes" and notes the "neural network—Gaussian process correspondence"
- Why unresolved: While the paper identifies this connection, it doesn't explore how this correspondence could be leveraged to improve ROM construction methods or provide theoretical guarantees
- What evidence would resolve it: Rigorous mathematical proof establishing the equivalence between certain neural network architectures and conditional expectation-based ROMs, or empirical demonstrations of improved performance

### Open Question 3
- Question: How does the conditional expectation interpretation change when the parameters p are not probabilistically distributed but rather form a deterministic set?
- Basis in paper: [inferred] The paper discusses parameters as random variables in probability spaces but doesn't explicitly address the deterministic case where parameters form a finite or structured set
- Why unresolved: The conditional expectation framework relies on probability measures, but many practical ROM applications involve deterministic parameter sweeps or optimization over parameter spaces
- What evidence would resolve it: Extension of the conditional expectation framework to deterministic parameter settings, showing how to construct meaningful loss functions and manifolds without probabilistic interpretation

### Open Question 4
- Question: What are the computational advantages and disadvantages of using Fréchet conditional expectation versus standard conditional expectation in ROM construction?
- Basis in paper: [explicit] The paper mentions Fréchet conditional expectation as a generalization for more general metric spaces and discusses its use in rank-k approximations
- Why unresolved: The paper introduces Fréchet conditional expectation but doesn't compare its computational complexity or convergence properties to standard conditional expectation methods
- What evidence would resolve it: Numerical experiments comparing convergence rates, computational cost, and accuracy of Fréchet versus standard conditional expectation methods for various ROM problems

### Open Question 5
- Question: How does the choice of inner product on the parameter space affect the resulting ROM and its approximation properties?
- Basis in paper: [explicit] The paper discusses choosing inner products on Q (and implicitly on parameter spaces) and how this "measures what is important on P"
- Why unresolved: While the paper acknowledges the importance of inner product choice, it doesn't provide guidance on how to select appropriate inner products for specific applications or analyze the sensitivity of ROM quality to this choice
- What evidence would resolve it: Sensitivity analysis showing how different inner product choices affect ROM approximation error, or optimization framework for selecting optimal inner products based on application-specific criteria

## Limitations
- The computational complexity of spectral decompositions for high-dimensional problems is not fully addressed
- The framework assumes certain smoothness and regularity conditions on the parameter-dependent system that may not hold in practice
- The incorporation of multiple uncertainty sources through probability theory relies on assumptions about their independence that may not always be valid

## Confidence
- **High confidence**: The mathematical equivalence between ROM construction and conditional expectation computation (Mechanism 1) is well-established through rigorous proofs and theoretical foundations.
- **Medium confidence**: The ability to handle multiple types of uncertainties through the probabilistic framework (Mechanism 2) is theoretically sound but may face practical implementation challenges.
- **Medium confidence**: The use of SVD for optimal ROM truncation (Mechanism 3) is mathematically valid, but the practical effectiveness depends on the decay rate of singular values and problem-specific characteristics.

## Next Checks
1. Implement the conditional expectation framework on a simple parametric PDE with known analytical solution to verify the theoretical predictions match numerical results.
2. Test the uncertainty incorporation mechanism by adding synthetic modeling and discretization errors to a ROM and quantifying the impact on prediction accuracy.
3. Compare ROM performance using different basis selection methods (POD, reduced basis, Gaussian process emulation) on the same parametric problem to validate the unified interpretation.