---
ver: rpa2
title: Can Generative Agents Predict Emotion?
arxiv_id: '2402.04232'
source_url: https://arxiv.org/abs/2402.04232
tags:
- agents
- agent
- emotional
- emotion
- context
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes a novel generative agent architecture that
  uses episodic memories and a "norm" to contextualize new experiences and measure
  emotional evolution via the PANAS test. The method compares a new experience to
  past memories summarized as a norm, creating a contextual understanding that informs
  the agent's emotional response.
---

# Can Generative Agents Predict Emotion?

## Quick Facts
- arXiv ID: 2402.04232
- Source URL: https://arxiv.org/abs/2402.04232
- Reference count: 27
- Primary result: Proposed architecture using episodic memories and norms to contextualize experiences showed slight improvement in negative affect scores but still fell short of human-like responses

## Executive Summary
This paper proposes a novel generative agent architecture that uses episodic memories and a "norm" to contextualize new experiences and measure emotional evolution via the PANAS test. The method compares a new experience to past memories summarized as a norm, creating a contextual understanding that informs the agent's emotional response. Tested on 428 emotionally charged situations from EmotionBench, the architecture sometimes improved emotional alignment compared to baseline agents without context, particularly for negative emotions, but often failed when situations remained ambiguous even with context.

## Method Summary
The method implements a novel agent architecture that processes new experiences by first retrieving relevant past memories, creating a norm from these memories, comparing the new experience to this norm to generate contextual understanding, and then administering the PANAS test to measure emotional response. The architecture uses GPT-4 for story generation, GPT-3.5-Turbo for PANAS administration, and stores experiences and norms in a graph database. The system was tested on 428 emotionally charged situations from EmotionBench, converted into 5-scene stories, with agents compared against baseline versions without contextual processing.

## Key Results
- The proposed architecture showed a slight increase in negative affect over the baseline agent
- Both agents still fell short of expected human-like negative responses
- The architecture performed better for negative emotions but often failed when situations remained ambiguous even with context

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Comparing new experiences to a "norm" (summary of past memories) improves emotional alignment by providing context.
- Mechanism: The norm acts as a reference point against which new experiences are evaluated, allowing the agent to understand situations in context rather than in isolation. This follows appraisal theory of emotion which states that context is vital for accurate emotional responses.
- Core assumption: The norm accurately captures the relevant context and patterns from past experiences that would inform appropriate emotional responses.
- Evidence anchors:
  - [abstract] "Through this comparison, the agent gains the ability to understand new experiences in context, which according to the appraisal theory of emotion is vital in emotion creation."
  - [section 3] "The norm is compared to the new experience to create a 'contextual understanding'. The goal of this contextual understanding is to highlight the differences between the current situation and the norm."
  - [corpus] Weak evidence - no directly relevant corpus papers on this specific mechanism.
- Break condition: If the norm fails to capture relevant context or if the comparison process misinterprets the relationship between norm and new experience, the context could mislead rather than improve emotional alignment.

### Mechanism 2
- Claim: Administering PANAS after context-aware comparison captures more accurate emotional states.
- Mechanism: By first creating a contextual understanding and then administering the PANAS, the agent's emotional response is measured in context rather than in isolation, potentially capturing more nuanced emotional states.
- Core assumption: The contextual understanding provided to the agent during PANAS administration actually influences the emotional assessment in a meaningful way.
- Evidence anchors:
  - [abstract] "The PANAS, a test of affect, is administered to the agent, capturing the emotional state of the agent after the perception of the new event."
  - [section 5.1] "With this context, the positive and negative affect of the agent is increased in comparison to the agent without context"
  - [corpus] Weak evidence - corpus papers discuss emotion-aware agents but not specifically this PANAS-administration mechanism.
- Break condition: If the LLM administering PANAS (GPT-3.5-Turbo) has inherent biases that override contextual information, or if the context doesn't actually influence the emotional assessment.

### Mechanism 3
- Claim: Storing experiences as episodic memories in a graph database enables better emotional evolution tracking.
- Mechanism: Each experience and norm is stored as nodes in a graph database, allowing visualization of relationships between memories and norms, which helps identify influential memories and understand how emotional responses evolve over time.
- Core assumption: The graph structure and memory relationships provide meaningful insights into emotional evolution that would be missed with simpler storage approaches.
- Evidence anchors:
  - [section 3] "Finally, the new experience is stored as a memory, which can be utilised in the creation of subsequent norms to extract the emotion evoked in future experiences. In particular, we store each memory and norm as nodes in a graph database, allowing the relationship between memories and norms to be visualised."
  - [corpus] Weak evidence - corpus papers discuss memory systems but not specifically graph-based emotion tracking.
- Break condition: If the memory retrieval and weighting system (saliency, recency, relevance) doesn't effectively select the most relevant memories for norm creation, the graph structure won't provide meaningful insights.

## Foundational Learning

- Concept: Appraisal Theory of Emotion (ATE)
  - Why needed here: ATE provides the theoretical foundation for why context matters in emotional responses - emotions arise not just from events but from how those events are appraised based on context and past experiences.
  - Quick check question: According to appraisal theory, what two factors influence how we emotionally respond to an event?

- Concept: Episodic Memory Systems
  - Why needed here: Understanding how episodic memories work is crucial for grasping why storing past experiences and creating norms from them could improve emotional responses.
  - Quick check question: How do episodic memories differ from semantic memories, and why is this distinction important for emotional agents?

- Concept: PANAS (Positive and Negative Affect Schedule)
  - Why needed here: PANAS is the measurement tool used to quantify emotional states, so understanding its structure and what it measures is essential for interpreting results.
  - Quick check question: What are the two main scores produced by PANAS, and how are they calculated?

## Architecture Onboarding

- Component map:
  - Experience Input → Memory Retriever (weighted by saliency, recency, relevance) → Norm Creation → Context Comparison → PANAS Administration → Memory Storage (graph database)
  - Key components: GPT-4 for story generation, GPT-3.5-Turbo for PANAS administration, graph database for memory storage

- Critical path:
  1. Receive new experience as text
  2. Retrieve and weight relevant past memories
  3. Create norm from retrieved memories
  4. Compare new experience to norm to create contextual understanding
  5. Administer PANAS with contextual understanding
  6. Store new experience and norm in graph database

- Design tradeoffs:
  - Using GPT-3.5-Turbo for PANAS (faster, cheaper) vs GPT-4 (potentially more accurate emotional understanding)
  - Simple 5-scene stories vs more complex, varied experiences
  - Graph database storage vs simpler sequential storage approaches

- Failure signatures:
  - Emotional responses remain identical with and without context (context not being utilized)
  - Positive bias dominates regardless of negative situations (GPT-3.5-Turbo bias)
  - Norm creation fails to capture relevant context from memories
  - Memory retrieval system fails to select appropriate memories for norm creation

- First 3 experiments:
  1. Run the same 5-scene story through the system twice - once with context and once without - and compare PANAS scores to verify context is affecting emotional responses
  2. Create a simple story with clear emotional progression and verify the system captures the expected emotional changes
  3. Test with an ambiguous situation and analyze whether the context helps or hurts emotional alignment compared to no context

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How do different memory retriever functions and their weighting schemes (e.g., recency, relevance, importance) impact the emotional alignment of generative agents?
- Basis in paper: [inferred] The paper mentions that future work should explore how different memory retriever functions and their weighting schemes impact the emotional alignment of agents.
- Why unresolved: The current architecture uses a simple memory retriever, and the impact of more sophisticated retrievers on emotional alignment is unknown.
- What evidence would resolve it: Experiments comparing the emotional alignment of agents using different memory retriever functions and weighting schemes.

### Open Question 2
- Question: How do different large language models (LLMs) affect the emotional alignment of generative agents?
- Basis in paper: [explicit] The paper suggests that future work should explore how the choice of LLM affects the emotional alignment of agents, mentioning open-source models like Llama and Mistral as potential alternatives to GPT-3.5-Turbo.
- Why unresolved: The current experiments only use GPT-3.5-Turbo, and it is unclear how other LLMs would perform in the proposed architecture.
- What evidence would resolve it: Experiments comparing the emotional alignment of agents using different LLMs in the proposed architecture.

### Open Question 3
- Question: How do human evaluators' emotional responses compare to those of generative agents in the proposed architecture?
- Basis in paper: [explicit] The paper suggests that future work should involve administering the PANAS to humans after they read the 5-scene stories to validate the accuracy of the architecture and draw stronger conclusions.
- Why unresolved: The current experiments only compare the emotional responses of agents with and without the proposed architecture, without a human baseline.
- What evidence would resolve it: Experiments measuring human emotional responses to the 5-scene stories and comparing them to the responses of agents in the proposed architecture.

## Limitations
- Heavy reliance on GPT-3.5-Turbo for PANAS administration introduces potential bias that may override contextual information
- Inconsistent performance with "sometimes" improved emotional alignment but frequent failures on ambiguous situations
- Memory retrieval and weighting system's effectiveness is unclear with no detailed implementation discussion

## Confidence
- Mechanism 1 (Norm-based context): Medium confidence - the theoretical foundation is sound but empirical validation is limited
- Mechanism 2 (PANAS administration): Low confidence - heavily dependent on potentially biased LLM interpretation
- Overall architecture effectiveness: Medium confidence - shows promise but inconsistent results and unexplained failures

## Next Checks
1. **Ablation study of memory weighting**: Systematically vary the weighting factors (saliency, recency, relevance) in the memory retriever and measure their individual and combined effects on norm quality and subsequent emotional alignment.
2. **PANAS administration bias analysis**: Compare PANAS results from GPT-3.5-Turbo against human responses on the same emotionally charged situations to quantify and characterize the positive bias, then test whether different prompting strategies can mitigate this bias.
3. **Contextual ambiguity testing**: Create a controlled set of situations with varying degrees of ambiguity and systematically measure when context helps versus hurts emotional alignment, identifying the specific characteristics of situations where the proposed architecture fails.