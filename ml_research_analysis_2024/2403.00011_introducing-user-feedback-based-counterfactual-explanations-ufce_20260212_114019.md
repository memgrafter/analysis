---
ver: rpa2
title: Introducing User Feedback-based Counterfactual Explanations (UFCE)
arxiv_id: '2403.00011'
source_url: https://arxiv.org/abs/2403.00011
tags:
- features
- feature
- ufce
- user
- counterfactual
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The study addresses the challenge of generating interpretable counterfactual
  explanations for black-box machine learning models, specifically tackling the issues
  of user feedback incorporation and feature dependence. The proposed User Feedback-based
  Counterfactual Explanations (UFCE) algorithm introduces a novel methodology that
  allows users to specify constraints on feature modifications and considers feature
  dependencies through mutual information.
---

# Introducing User Feedback-based Counterfactual Explanations (UFCE)

## Quick Facts
- arXiv ID: 2403.00011
- Source URL: https://arxiv.org/abs/2403.00011
- Reference count: 40
- Primary result: UFCE outperforms DiCE and AR in generating feasible, sparse, and proximal counterfactual explanations while incorporating user feedback

## Executive Summary
UFCE addresses the challenge of generating interpretable counterfactual explanations for black-box ML models by incorporating user feedback and feature dependencies. The method allows users to specify constraints on feature modifications and uses mutual information to guide feature selection for perturbations. Through a hybrid search strategy combining single, double, and triple feature perturbations, UFCE generates counterfactuals that are both actionable and feasible. Evaluation on five datasets demonstrates superior performance compared to existing methods in terms of proximity, sparsity, and feasibility.

## Method Summary
UFCE is an algorithm that generates counterfactual explanations by first identifying the nearest neighbors in the desired outcome space using KD-tree search. It then constructs a feasible subspace based on user-specified feature constraints and computes mutual information between features to guide the selection of features for perturbation. The method employs a hybrid search strategy with three perturbation methods: single feature changes using binary search within user constraints, and double/triple feature changes using supervised models to predict dependent feature values. This approach ensures that generated counterfactuals are both actionable and feasible while considering feature dependencies.

## Key Results
- UFCE outperformed DiCE and AR in terms of proximity, sparsity, and feasibility metrics
- UFCE2 and UFCE3 methods showed better performance than single-feature perturbation approaches
- User constraints significantly improved the actionability and feasibility of generated counterfactuals

## Why This Works (Mechanism)

### Mechanism 1
- Claim: UFCE generates feasible counterfactuals by restricting perturbations to a user-defined subspace that intersects with the nearest neighborhood in the desired outcome space
- Mechanism: The algorithm uses KD-tree to find nearest neighbors in the desired class space, then constructs a subspace based on user-specified feature ranges. Counterfactuals are searched only within this intersection, ensuring feasibility
- Core assumption: User-specified feature ranges and nearest neighbors from the desired class represent a feasible region for generating actionable counterfactuals
- Evidence anchors:
  - [abstract]: "UFCE allows for the inclusion of user constraints to determine the smallest modifications in the subset of actionable features while considering feature dependence"
  - [section 4.3]: "To overcome the issue of implausibility, we restrict the perturbations to a neighbourhood of x in the desired space...adhering to user constraints"

### Mechanism 2
- Claim: Mutual information guides feature selection for perturbations, improving the quality of counterfactual explanations
- Mechanism: UFCE computes mutual information between features and uses this to select feature pairs/triplets for simultaneous perturbation, prioritizing features with higher mutual information scores
- Core assumption: Features with high mutual information are more likely to jointly influence the outcome, making their coordinated perturbation more effective for generating counterfactuals
- Evidence anchors:
  - [section 4.2]: "MI stands out as a robust feature selection method capturing both linear and non-linear relationships within data"
  - [section 4.4]: "The MI among the features is computed...which provides a sorted list of feature pairs mi_pair with MI scores"

### Mechanism 3
- Claim: Hybrid search strategy combining single, double, and triple feature perturbations improves both sparsity and feasibility
- Mechanism: UFCE employs three perturbation methods - single feature changes using binary search within user constraints, and double/triple feature changes using supervised models to predict dependent feature values
- Core assumption: Different perturbation strategies are appropriate for different feature types and dependency structures, and combining them captures more effective counterfactuals
- Evidence anchors:
  - [section 4.4]: "We have customised hybrid search in mixed-feature perturbations...It involves predicting the values of features using a supervised ML model"
  - [section 5.2]: "UFCE2 and UFCE3 performed better than the other methods"

## Foundational Learning

- Concept: KD-tree nearest neighbor search
  - Why needed here: UFCE uses KD-tree to efficiently find nearest neighbors in the desired outcome space, which forms the basis for constructing the feasible perturbation region
  - Quick check question: How does KD-tree partitioning improve search efficiency compared to brute-force nearest neighbor search in high-dimensional spaces?

- Concept: Mutual information computation
  - Why needed here: UFCE uses mutual information to identify feature dependencies and guide which features to perturb together for more effective counterfactual generation
  - Quick check question: What is the difference between mutual information and correlation coefficient when measuring feature dependencies?

- Concept: Binary search in feature space
  - Why needed here: UFCE uses binary search within user-specified feature ranges to find minimal perturbations that achieve the desired outcome while maintaining feasibility
  - Quick check question: How does binary search reduce the number of perturbations needed compared to linear search through feature ranges?

## Architecture Onboarding

- Component map: User Input Layer -> Feature Analysis -> Counterfactual Generation -> Validation Layer -> Output Layer
- Critical path: User input → Mutual information computation → Nearest neighbor search → Subspace construction → Perturbation generation → Feasibility validation → Output
- Design tradeoffs:
  - Single vs. multiple feature perturbations: Single perturbations are faster but may miss effective combinations; multiple perturbations capture dependencies but increase computational cost
  - Feature independence vs. dependence: Assuming independence simplifies computation but ignores real-world feature relationships; accounting for dependence improves quality but requires mutual information computation
- Failure signatures:
  - Empty intersection between user subspace and nearest neighborhood
  - Poor performance of supervised models in double/triple perturbation methods
  - High computational time for triple feature perturbations with wide user-specified ranges
- First 3 experiments:
  1. Test UFCE with synthetic data where ground truth counterfactuals are known to verify correctness
  2. Compare UFCE performance with varying levels of user constraints (very limited to more flexible)
  3. Evaluate UFCE on datasets with different feature dependency structures to test mutual information effectiveness

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can UFCE be effectively extended to handle multi-class classification problems while maintaining its performance advantages?
- Basis in paper: [explicit] The paper states "the extension of UFCE for multi-class classification problems will be addressed in future work."
- Why unresolved: The current UFCE algorithm is designed for binary classification and its adaptation to multi-class scenarios requires new methodological approaches
- What evidence would resolve it: A validated implementation of UFCE that successfully handles multi-class problems with comparable or improved performance metrics against existing multi-class counterfactual methods

### Open Question 2
- Question: What is the optimal way to balance user feedback constraints with the need for diverse counterfactual explanations?
- Basis in paper: [explicit] The paper discusses user feedback but notes "these requirements are necessary preconditions and do not ensure that the explanations are aligned with the users' cognitive abilities."
- Why unresolved: There is a tension between strict user constraints that may limit diversity and the need for diverse explanations to provide comprehensive insights
- What evidence would resolve it: Empirical studies comparing explanation quality and user satisfaction across different constraint-diversification trade-offs, with validated metrics for both diversity and user comprehension

### Open Question 3
- Question: How can UFCE's computational efficiency be improved for large-scale datasets with high-dimensional feature spaces?
- Basis in paper: [inferred] The paper mentions UFCE3 took more time on average than other methods, especially with flexible user constraints, suggesting scalability concerns
- Why unresolved: The current hybrid search approach may not scale efficiently to datasets with thousands of features or millions of instances
- What evidence would resolve it: Benchmark comparisons showing UFCE's runtime and resource usage against other methods on increasingly large and complex datasets, along with demonstrated optimizations

## Limitations
- Evaluation relies on simulated user constraints rather than real user studies, limiting ecological validity
- Computational complexity of triple feature perturbations may render UFCE impractical for datasets with wide feature ranges or many features
- Method's performance on datasets with complex, non-linear feature dependencies remains unclear

## Confidence

- **High confidence**: The core algorithmic approach (hybrid search with user constraints and mutual information guidance) is sound and well-implemented
- **Medium confidence**: Comparative performance against DiCE and AR is reliable within the tested conditions, though broader comparisons would strengthen claims
- **Low confidence**: Real-world applicability and user satisfaction remain unassessed without actual user studies

## Next Checks

1. Conduct user studies with domain experts to evaluate whether UFCE-generated explanations align with human reasoning and are actually actionable in practice
2. Benchmark UFCE on additional datasets with known ground truth counterfactuals to validate the quality and correctness of generated explanations
3. Test UFCE with varying degrees of feature correlation and non-linear dependencies to assess robustness when mutual information assumptions may not hold