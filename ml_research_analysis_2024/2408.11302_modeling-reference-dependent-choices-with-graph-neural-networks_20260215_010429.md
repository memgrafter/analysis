---
ver: rpa2
title: Modeling Reference-dependent Choices with Graph Neural Networks
arxiv_id: '2408.11302'
source_url: https://arxiv.org/abs/2408.11302
tags:
- product
- reference
- price
- consumers
- consumer
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes ArcRec, a deep learning-based framework for
  modeling reference-dependent consumer preferences in recommender systems. ArcRec
  constructs attributed reference networks from historical purchase records, decomposes
  them into attribute-specific sub-networks, and uses Graph Neural Networks to represent
  reference points.
---

# Modeling Reference-dependent Choices with Graph Neural Networks

## Quick Facts
- arXiv ID: 2408.11302
- Source URL: https://arxiv.org/abs/2408.11302
- Reference count: 20
- Outperforms fourteen state-of-the-art baselines on real-world datasets, particularly for cold-start products

## Executive Summary
This paper introduces ArcRec, a deep learning framework that models reference-dependent consumer preferences in recommender systems by constructing attributed reference networks from historical purchase records. The framework decomposes these networks into attribute-specific sub-networks and uses Graph Neural Networks to learn product representations, capturing both personalized and crowd-influenced reference points. ArcRec introduces an Attribute-level Willingness-To-Pay measure to quantify consumers' heterogeneous salience of product attributes, integrating this with interest-inspired and price-inspired preferences. Empirical evaluations show ArcRec significantly outperforms existing baselines, particularly in cold-start scenarios.

## Method Summary
ArcRec constructs attributed reference networks from aggregated historical purchase records, where edges represent co-purchased products. These networks are decomposed into attribute-specific sub-networks (ARNs), each corresponding to a product attribute like brand, category, or size. Graph Neural Networks learn product embeddings from these ARNs through message passing, capturing both individual consumer behavior and crowd influences. The model calculates reference-dependent utilities by combining interest-inspired preferences (based on attribute comparisons) and price-inspired preferences (with attribute-aware price sensitivity), weighted by an Attribute-level Willingness-To-Pay measure that captures each consumer's attribute salience. The framework is trained using a Bayesian Personalized Ranking objective to optimize personalized recommendations.

## Key Results
- ArcRec achieves 4.0%-18.3% improvements in Hit Ratio (HR@10) over state-of-the-art baselines
- The model shows 2.0%-15.6% improvements in nDCG@10 across real-world datasets
- Particularly effective for cold-start products, demonstrating superior performance when traditional collaborative filtering methods fail
- AWTP measure effectively captures heterogeneous attribute salience, with price sensitivity varying significantly across consumers and attributes

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The reference network captures both personalized and crowd-influenced reference points for consumers.
- Mechanism: The reference network is constructed from aggregated historical purchase records, with bi-directional edges between co-purchased products. This allows each consumer to form reference points from both their own purchase history and the collective behaviors of other consumers through high-order message propagation.
- Core assumption: Consumers' reference points are influenced by both their own experiences and the aggregated preferences of the crowd.
- Evidence anchors:
  - [abstract]: "ArcRec features in building a reference network from aggregated historical purchase records for instantiating theoretical reference points, which is then decomposed into product attribute specific sub-networks and represented through Graph Neural Networks."
  - [section]: "The reference network offers a global view of collective purchase behaviors, from which a consumer can form her reference points from both her own and the entire crowd's past purchases through high-order message propagation in the network."
- Break condition: If the co-purchase patterns do not reflect meaningful attribute-level relationships, the reference network may capture noise rather than useful reference information.

### Mechanism 2
- Claim: Attribute-level decomposition of the reference network enables fine-grained modeling of consumer preferences.
- Mechanism: The reference network is decomposed into multiple attributed reference networks (ARNs), each corresponding to a specific product attribute. Graph Neural Networks are then used to learn product representations from these ARNs, capturing attribute-level reference points.
- Core assumption: Consumers form different reference points when evaluating different product attributes, and attribute-level modeling is more appropriate than product-level modeling.
- Evidence anchors:
  - [abstract]: "ArcRec features in building a reference network...which is then decomposed into product attribute specific sub-networks and represented through Graph Neural Networks for fine-grained referencing."
  - [section]: "We consider decomposing the reference network at the product attribute level for pursuing fine-grained reference points modeling. Specifically, we assume the formation of connecting edges could be ascribed to several salient aspects that characterize the products."
- Break condition: If product attributes are not meaningfully separable or if the attribute decomposition does not capture genuine consumer behavior patterns.

### Mechanism 3
- Claim: The Attribute-level Willingness-To-Pay (AWTP) measure captures consumers' heterogeneous salience of product attributes.
- Mechanism: AWTP is calculated based on the price deviations of purchased products from their attribute center points. It measures how much price variation a consumer is willing to accept for a specific attribute, indicating the importance of that attribute to the consumer.
- Core assumption: Consumers' trade-offs among product attributes exist and are personalized, and can be discovered from their purchase records considering both interest and price.
- Evidence anchors:
  - [abstract]: "ArcRec introduces a novel Attribute-level Willingness-To-Pay measure to the reference-dependent utility function, which captures a consumer's heterogeneous salience of product attributes via observing her attribute-level price tolerance to a product."
  - [section]: "We consider the extent to which the product price will affect a consumer's demand for a particular product attribute as the measurement of the attribute importance."
- Break condition: If price sensitivity is not a reliable indicator of attribute importance or if consumers' attribute preferences are not stable enough to be inferred from purchase data.

## Foundational Learning

- Concept: Reference-dependent choice theory and Prospect Theory
  - Why needed here: The entire model is built on the theoretical foundation that consumers evaluate products relative to reference points, not in absolute terms.
  - Quick check question: What is the key difference between reference-dependent choice theory and traditional utility maximization models?

- Concept: Graph Neural Networks and message passing
  - Why needed here: GNNs are used to learn product representations from the attributed reference networks through iterative message passing and aggregation.
  - Quick check question: How does the normalization term 1/(p|N_i|^q|N_j|) in message passing prevent node embeddings from exploding?

- Concept: Attention mechanisms in neural networks
  - Why needed here: Attention is used to weight the importance of different reference points when calculating the final utility score.
  - Quick check question: Why is softmax normalization applied to the attention scores in the reference point weighting mechanism?

## Architecture Onboarding

- Component map:
  - Reference Network Construction -> ARN Decomposition -> GNN Layer -> Interest-inspired Preference Module -> Price-inspired Preference Module -> AWTP Module -> BPR Integration

- Critical path: Reference Network → ARN Decomposition → GNN Learning → Preference Modules → AWTP → BPR Ranking

- Design tradeoffs:
  - Fine-grained attribute modeling vs. computational complexity (more ARNs = more computation)
  - Reference network construction period (longer periods capture more behavior but may include outdated preferences)
  - Number of GNN layers (more layers capture higher-order relationships but risk oversmoothing)

- Failure signatures:
  - Poor cold-start performance: Indicates GNN layers aren't learning meaningful representations
  - Similar recommendations for all users: Suggests attention mechanism isn't differentiating reference points effectively
  - AWTP scores not correlating with price tolerance: Indicates price sensitivity calculation is flawed

- First 3 experiments:
  1. Baseline comparison: Run ArcRec vs. BPR-MF on a small dataset to verify the reference-dependent approach improves performance
  2. ARN ablation: Test with raw reference network vs. decomposed ARNs to validate attribute-level modeling benefit
  3. AWTP sensitivity: Vary the AWTP weight in the utility function to find optimal balance between attribute and price preferences

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can reference points be instantiated in a data-driven manner from consumer purchase data?
- Basis in paper: [explicit] The paper states "reference points were theoretically considered as consumers' subjective expectations and associated knowledge derived from their past experiences, and therefore, can hardly be instantiated in a data-driven manner from the traditional standpoint."
- Why unresolved: Traditional approaches struggle to operationalize reference points due to their subjective nature. The paper proposes using a reference network built from aggregated purchase records, but this is still a novel approach requiring further validation and refinement.
- What evidence would resolve it: Empirical studies comparing different methods for instantiating reference points (e.g., recent purchases vs. aggregated purchase history) and their impact on preference prediction accuracy.

### Open Question 2
- Question: How can product attribute-level reference points be effectively modeled in a data-driven manner?
- Basis in paper: [explicit] The paper argues that modeling reference points at the product level is "coarse-grained" and that "comparisons at the product attribute-level...are believed to be more sensible."
- Why unresolved: While the paper proposes decomposing the reference network into attribute-specific sub-networks, the optimal granularity and method for attribute-level modeling remain open questions.
- What evidence would resolve it: Comparative studies evaluating different attribute decomposition strategies (e.g., by category vs. individual attributes) and their impact on preference prediction and recommendation performance.

### Open Question 3
- Question: How can consumers' heterogeneous salience of product attributes be effectively captured and integrated into preference modeling?
- Basis in paper: [explicit] The paper introduces an Attribute-level Willingness-To-Pay measure to capture consumers' "heterogeneous salience of product attributes."
- Why unresolved: The paper presents a novel approach using AWTP, but its effectiveness compared to other salience modeling techniques and its generalizability across different product domains require further investigation.
- What evidence would resolve it: Empirical studies comparing AWTP to alternative salience modeling approaches (e.g., feature importance scores from machine learning models) and evaluating their performance across diverse product categories.

## Limitations
- The reference network construction assumes co-purchase patterns accurately reflect attribute-level relationships, which may not hold for all product categories or consumer segments
- The model requires substantial historical purchase data to construct meaningful reference networks, limiting applicability for truly new markets
- Attribute decomposition assumes product attributes are meaningfully separable, which may not capture complex attribute interactions

## Confidence
- High confidence: The GNN-based product representation learning and BPR optimization framework are well-established methods with proven effectiveness
- Medium confidence: The reference-dependent utility function combining interest and price preferences is theoretically sound but requires empirical validation across diverse domains
- Medium confidence: The AWTP measure's ability to capture attribute salience through price sensitivity is plausible but needs more extensive validation

## Next Checks
1. Cross-domain evaluation: Test ArcRec on multiple product categories (fashion, electronics, groceries) to assess generalizability of reference network construction
2. Reference network sensitivity: Systematically vary the co-purchase window length and minimum purchase thresholds to determine optimal network construction parameters
3. Ablation on attribute decomposition: Compare performance using full attribute decomposition vs. product-level modeling vs. aggregated attribute modeling to quantify the benefit of fine-grained decomposition