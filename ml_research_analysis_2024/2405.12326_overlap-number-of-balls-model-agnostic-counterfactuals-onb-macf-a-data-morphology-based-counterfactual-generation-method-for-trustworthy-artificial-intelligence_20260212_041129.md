---
ver: rpa2
title: 'Overlap Number of Balls Model-Agnostic CounterFactuals (ONB-MACF): A Data-Morphology-based
  Counterfactual Generation Method for Trustworthy Artificial Intelligence'
arxiv_id: '2405.12326'
source_url: https://arxiv.org/abs/2405.12326
tags:
- counterfactual
- norm
- onb-macf
- class
- counterfactuals
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper introduces ONB-MACF, a model-agnostic counterfactual
  explanation method that leverages data morphology to estimate decision boundaries.
  The approach constructs hyperspheres containing single-class data points and generates
  counterfactuals by incrementally adjusting instances toward the nearest alternate-class
  hypersphere.
---

# Overlap Number of Balls Model-Agnostic CounterFactuals (ONB-MACF): A Data-Morphology-based Counterfactual Generation Method for Trustworthy Artificial Intelligence

## Quick Facts
- arXiv ID: 2405.12326
- Source URL: https://arxiv.org/abs/2405.12326
- Reference count: 40
- Primary result: Introduces ONB-MACF, achieving superior performance across eight tabular datasets with minimal feature changes and high plausibility scores

## Executive Summary
ONB-MACF introduces a novel model-agnostic counterfactual explanation method that leverages data morphology to estimate decision boundaries. The approach constructs hyperspheres containing single-class data points and generates counterfactuals by incrementally adjusting instances toward the nearest alternate-class hypersphere. The method ensures feasibility, sparsity, and adherence to data distributions while avoiding changes to immutable features. Benchmarking against state-of-the-art counterfactual generation methods demonstrates ONB-MACF achieves superior performance with close, sparse counterfactuals and high plausibility scores.

## Method Summary
ONB-MACF operates by first constructing hyperspheres around data points of each class to estimate decision boundaries. For each instance requiring a counterfactual, the method identifies the nearest hypersphere belonging to a different class and incrementally adjusts the instance toward that hypersphere's center. The algorithm prioritizes changes to mutable features while preserving immutable ones, ensuring generated counterfactuals remain both feasible and interpretable. The approach employs a multi-objective optimization framework that balances proximity to the original instance, sparsity of feature changes, and constraint satisfaction.

## Key Results
- Achieves best overall mean performance (0.868) across evaluation criteria including L0/L1/L2/Lâˆž norms, constraint violations, redundancy, Y-nearest-neighbors, and success rates
- Consistently produces counterfactuals with minimal feature changes (1-3 features on average)
- Demonstrates high plausibility scores and low constraint violations across eight diverse tabular datasets

## Why This Works (Mechanism)
ONB-MACF leverages data morphology to create a geometric representation of decision boundaries through hypersphere construction. By identifying the nearest alternate-class hypersphere for each instance, the method creates a direct path toward feasible counterfactuals that naturally respect data distributions. The incremental adjustment approach ensures smooth transitions that maintain proximity to the original instance while avoiding unrealistic jumps in feature space. The focus on mutable features prevents generation of counterfactuals requiring impossible changes.

## Foundational Learning
- Hypersphere construction for decision boundary estimation: Needed to create geometric representations of class regions without relying on black-box model internals. Quick check: Verify hyperspheres contain primarily single-class points with minimal overlap.
- Incremental adjustment optimization: Required to balance proximity and sparsity while navigating toward alternate-class regions. Quick check: Track feature change trajectory for smoothness and convergence.
- Immutable feature preservation: Essential for generating realistic counterfactuals that respect real-world constraints. Quick check: Confirm immutable features remain unchanged in generated counterfactuals.

## Architecture Onboarding

**Component Map**
Data Preprocessing -> Hypersphere Construction -> Instance Analysis -> Counterfactual Generation -> Evaluation Metrics

**Critical Path**
The critical path flows from Hypersphere Construction through Instance Analysis to Counterfactual Generation, as these components directly determine the quality and feasibility of generated explanations.

**Design Tradeoffs**
The method trades computational complexity in hypersphere construction for improved counterfactual quality and interpretability. While alternative approaches might use simpler distance metrics, ONB-MACF's morphological approach provides better adherence to actual data distributions at the cost of increased preprocessing time.

**Failure Signatures**
Performance degradation occurs when class distributions have irregular shapes that poorly fit hyperspherical approximations, or when immutable features dominate the feature space, limiting feasible counterfactual generation. Datasets with substantial class overlap may produce counterfactuals that violate decision boundary assumptions.

**First Experiments**
1. Test hypersphere construction accuracy by measuring class purity within generated hyperspheres
2. Evaluate counterfactual proximity by comparing L1/L2 distances to baseline methods
3. Assess feature change sparsity by counting average features modified per counterfactual

## Open Questions the Paper Calls Out
None

## Limitations
- Performance depends on datasets having substantial immutable and discrete features, showing relative underperformance compared to methods with explicit feature type handling
- Assumes hypersphere-based decision boundary estimation is sufficient for complex decision surfaces, potentially failing on highly non-linear models or irregularly shaped class distributions
- Evaluates only tabular datasets, leaving uncertainty about performance on image, text, or mixed-modal data

## Confidence
- Superior overall performance across eight datasets: Medium
- Model-agnostic capabilities across diverse models: Medium
- Sparsity and feasibility claims: High

## Next Checks
1. Conduct statistical significance testing between ONB-MACF and competing methods across all benchmark datasets to confirm performance differences are not due to random variation
2. Test on non-tabular datasets including images and text to verify model-agnostic claims across different data modalities
3. Evaluate on highly imbalanced datasets to assess robustness when minority classes have sparse hypersphere representations