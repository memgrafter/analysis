---
ver: rpa2
title: What Sketch Explainability Really Means for Downstream Tasks
arxiv_id: '2403.09480'
source_url: https://arxiv.org/abs/2403.09480
tags:
- sketch
- stroke
- strokes
- attribution
- image
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This work introduces a novel approach to sketch explainability,
  focusing on human strokes rather than pixels. The key innovation is a lightweight,
  portable solution that integrates seamlessly with pre-trained models without re-training.
---

# What Sketch Explainability Really Means for Downstream Tasks

## Quick Facts
- arXiv ID: 2403.09480
- Source URL: https://arxiv.org/abs/2403.09480
- Authors: Hmrishav Bandyopadhyay; Pinaki Nath Chowdhury; Ayan Kumar Bhunia; Aneeshan Sain; Tao Xiang; Yi-Zhe Song
- Reference count: 40
- Primary result: Novel stroke-level attribution methods (SLA and P-SLA) that integrate with pre-trained models to provide interpretable explanations for sketch-based tasks

## Executive Summary
This work introduces a novel approach to sketch explainability that focuses on attributing importance to human strokes rather than pixels. The key innovation is a lightweight, portable solution that integrates seamlessly with pre-trained models without requiring re-training. Two methods are proposed: coarse stroke-level attribution (SLA) and partial stroke-level attribution (P-SLA), which address the non-differentiability of rasterization through differentiable approximations. The approach is evaluated across four downstream applications including sketch-based image retrieval, assisted drawing, sketch-to-photo generation, and adversarial attacks, demonstrating improved model reliability and interpretability.

## Method Summary
The method introduces two stroke-level attribution techniques: SLA (coarse stroke-level attribution) and P-SLA (partial stroke-level attribution). SLA attributes importance to entire strokes by rasterizing them individually and combining the results, while P-SLA provides fine-grained attribution to partial strokes through distance transforms and thresholding. Both methods leverage differentiable rasterization to backpropagate gradients to stroke coordinates, enabling integration with pre-trained models without re-training. The approach handles the non-differentiability of standard rasterization by computing distance transforms from vector points and applying threshold-based approximations.

## Key Results
- Human studies show 75.9%/63.4% accuracy in identifying correct/incorrect model predictions for SLA/P-SLA
- Stroke-level attributions improve model reliability across four downstream applications including robust sketch-based image retrieval and assisted drawing
- The lightweight, portable solution integrates seamlessly with pre-trained models without requiring re-training
- P-SLA provides fine-grained attribution to partial strokes while maintaining visual quality comparable to SLA

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The approach provides fine-grained stroke-level attributions that are more interpretable than pixel-level saliency maps for sketches.
- Mechanism: By backpropagating gradients through a differentiable rasterization pipeline, the method assigns attribution scores to individual strokes and their constituent points, capturing the human-drawn construction process.
- Core assumption: Strokes carry meaningful semantic content in sketches, unlike individual pixels in photos.
- Evidence anchors:
  - [abstract] "We propose a lightweight and portable explainability solution â€“ a seamless plugin that integrates effortlessly with any pre-trained model, eliminating the need for re-training."
  - [section] "Hence, it is most appropriate that sketch predictions should be attributed to strokes and not pixels."
  - [corpus] No direct evidence found for stroke semantic superiority in corpus.
- Break condition: If strokes are not semantically meaningful or the differentiable rasterization introduces significant approximation error.

### Mechanism 2
- Claim: The approach enables novel downstream applications like assisted drawing and sketch adversarial attacks.
- Mechanism: Stroke-level attributions allow for identifying important/unimportant strokes for removal (assisted drawing) or manipulation (adversarial attacks).
- Core assumption: Manipulating strokes based on attribution scores will have predictable effects on model predictions.
- Evidence anchors:
  - [section] "In assisted drawing, we assist novice artists in faithfully sketching a particular photo by identifying strokes that do not match the target photo."
  - [section] "In adversarial attacks, we unveil the vulnerability of state-of-the-art sketch encoders by removing a small imperceptible stroke in any sketch, resulting in significant changes to the model's prediction."
  - [corpus] No direct evidence found for stroke manipulation effects in corpus.
- Break condition: If attribution scores do not correlate with stroke importance or if adversarial attacks require larger perturbations than claimed.

### Mechanism 3
- Claim: The approach provides interpretable explanations that align with human understanding of sketches.
- Mechanism: Human studies show that stroke attributions can help identify correct/incorrect model predictions and understand model behavior.
- Core assumption: Humans understand sketches in terms of strokes rather than pixels, and can use stroke attributions to reason about model predictions.
- Evidence anchors:
  - [section] "Humans can identify correct/incorrect model predictions 75.9%/63.4% of times for SLA and 76.3%/65.2% for P-SLA."
  - [section] "Humans can identify the misclassified category 62.4%(66.3%) and the incorrectly retrieved photo 39.1%(37.2%) for SLA (P-SLA)."
  - [corpus] No direct evidence found for human sketch understanding in corpus.
- Break condition: If human understanding of sketches does not align with stroke attributions or if attribution scores are not intuitive.

## Foundational Learning

- Concept: Differentiable rasterization of vector sketches
  - Why needed here: To enable backpropagation of gradients to stroke coordinates for attribution calculation
  - Quick check question: How does the differentiable rasterization differ from standard non-differentiable rasterization?

- Concept: Stroke-level attribution vs pixel-level attribution
  - Why needed here: To understand why stroke-level attributions are more meaningful for sketches
  - Quick check question: What is the key difference between stroke-level and pixel-level attributions in terms of interpretability?

- Concept: Gumbel Softmax for discrete stroke selection
  - Why needed here: To enable differentiable selection of strokes for removal in assisted drawing
  - Quick check question: How does Gumbel Softmax enable differentiable selection of discrete strokes?

## Architecture Onboarding

- Component map: Vector sketch input (T x 5 tensor of stroke coordinates and pen states) -> Differentiable rasterization module (converts vector to raster with gradients) -> Pre-trained model (sketch encoder, image encoder, etc.) -> Attribution calculation module (computes SLA or P-SLA scores) -> Downstream application module (SBIR, assisted drawing, etc.)

- Critical path: Vector sketch -> Differentiable rasterization -> Pre-trained model -> Attribution calculation -> Downstream application

- Design tradeoffs:
  - SLA vs P-SLA: Coarse stroke-level vs fine-grained point-level attributions
  - Tradeoff between attribution granularity and computational cost
  - Tradeoff between attribution faithfulness and interpretability

- Failure signatures:
  - Poor attribution scores indicating incorrect gradient flow
  - Broken or incomplete strokes in P-SLA due to thresholding
  - Unexpected changes in model predictions after stroke manipulation

- First 3 experiments:
  1. Verify differentiable rasterization by comparing gradients of vector and raster sketches
  2. Test attribution scores on simple sketches with known important strokes
  3. Evaluate downstream application performance with and without stroke attributions

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How do more advanced attribution methods (e.g., guided integrated gradients, SHAP) compare to SLA and P-SLA in terms of fidelity and interpretability for sketch-based tasks?
- Basis in paper: [explicit] The authors mention that SLA and P-SLA can be paired with any pixel-attribution algorithm, but they used vanilla gradients for simplicity. They also state that selecting an optimal attribution algorithm is out-of-scope of this paper.
- Why unresolved: The paper does not compare SLA and P-SLA to other attribution methods, so it's unclear if these methods offer superior performance.
- What evidence would resolve it: Experiments comparing SLA and P-SLA to other attribution methods (e.g., guided integrated gradients, SHAP) on the same downstream tasks and evaluation metrics used in the paper.

### Open Question 2
- Question: Can the stroke-level attribution approach be extended to other non-differentiable operations in computer vision beyond rasterization, such as 3D mesh rendering or point cloud processing?
- Basis in paper: [inferred] The paper addresses the non-differentiability of rasterization by introducing differentiable approximations. This suggests that similar techniques could be applied to other non-differentiable operations.
- Why unresolved: The paper focuses solely on sketch rasterization and does not explore applications to other domains or operations.
- What evidence would resolve it: Demonstrations of applying the stroke-level attribution approach to other non-differentiable operations in computer vision, such as 3D mesh rendering or point cloud processing, with comparable results to the sketch applications presented in the paper.

### Open Question 3
- Question: How does the choice of threshold hyperparameters in the differentiable rasterization process affect the quality and stability of the stroke-level attributions, and can these hyperparameters be learned automatically?
- Basis in paper: [explicit] The authors mention that threshold hyperparameters control stroke thickness in the differentiable rasterization process, but they set these hyperparameters empirically.
- Why unresolved: The paper does not explore the impact of different threshold values on the attributions or investigate methods for automatic hyperparameter learning.
- What evidence would resolve it: A sensitivity analysis of the attributions to different threshold values, along with experiments on learning these hyperparameters automatically (e.g., through gradient-based optimization or Bayesian optimization) and evaluating the resulting attributions on downstream tasks.

## Limitations

- The computational overhead introduced by differentiable rasterization may not scale well to real-time applications
- Human study results are based on relatively small sample sizes (N=20) and may not generalize across diverse user populations
- The approach relies heavily on the quality of pre-trained models and may not transfer to all sketch domains

## Confidence

- High confidence: The mechanism of differentiable rasterization enabling stroke-level attributions is technically sound and well-supported by the implementation details
- Medium confidence: The downstream application results are promising but rely heavily on the quality of pre-trained models and may not transfer to all sketch domains
- Medium confidence: Human study results showing improved interpretability, though sample size limitations prevent strong generalization claims

## Next Checks

1. Scale validation: Test the approach on larger sketch datasets (e.g., QuickDraw's 50M+ sketches) to evaluate computational scalability and attribution stability
2. Cross-domain generalization: Apply the attribution methods to non-iconic sketch domains (e.g., architectural sketches, technical drawings) to assess broader applicability
3. Real-time feasibility: Measure inference time overhead for the differentiable rasterization pipeline and evaluate whether it meets real-time interaction requirements for assisted drawing applications