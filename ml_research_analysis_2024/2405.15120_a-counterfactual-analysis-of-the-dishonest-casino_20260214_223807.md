---
ver: rpa2
title: A Counterfactual Analysis of the Dishonest Casino
arxiv_id: '2405.15120'
source_url: https://arxiv.org/abs/2405.15120
tags: []
core_contribution: This paper addresses the problem of determining how much of a casino's
  winnings can be attributed to cheating in a hidden Markov model (HMM) setting. The
  authors introduce a class of structural causal models (SCMs) consistent with the
  HMM and define the expected winnings attributable to cheating (EWAC).
---

# A Counterfactual Analysis of the Dishonest Casino

## Quick Facts
- arXiv ID: 2405.15120
- Source URL: https://arxiv.org/abs/2405.15120
- Authors: Martin Haugh; Raghav Singal
- Reference count: 22
- Primary result: LP-based bounds on counterfactual casino winnings with theoretical guarantees on tightness and identifiability

## Executive Summary
This paper addresses the counterfactual question of how much of a casino's winnings can be attributed to cheating in a hidden Markov model setting. The authors introduce a class of structural causal models consistent with the HMM and define the expected winnings attributable to cheating (EWAC). They show that EWAC can be bounded using linear programs, with tighter bounds obtained under time-homogeneity conditions. The work contributes to bounding counterfactuals in causal inference and is the first to develop LP bounds in a dynamic HMM setting.

## Method Summary
The paper formulates the dishonest casino problem as a hidden Markov model where the casino alternates between fair and loaded dice. EWAC is defined as the expected winnings attributable to cheating, which is not identifiable from observational data alone. The authors construct a class of structural causal models (SCMs) consistent with the HMM and show that EWAC bounds can be computed via linear programming. They derive both time-homogeneous bounds (tighter but requiring more constraints) and time-inhomogeneous bounds (looser but with simpler LP structure). Domain knowledge like pathwise monotonicity or counterfactual stability can be incorporated through additional linear constraints. The paper also shows that time-averaged EWAC becomes fully identifiable as the number of time periods tends to infinity.

## Key Results
- EWAC bounds can be computed via linear programming, with tighter bounds under time-homogeneity assumptions
- Bounds become fully identifiable for time-averaged EWAC as the number of time periods increases
- Domain-specific knowledge like pathwise monotonicity and counterfactual stability can be incorporated to tighten bounds
- The approach represents the first LP-based method for bounding counterfactuals in dynamic HMM settings

## Why This Works (Mechanism)
The methodology works by constructing a set of SCMs consistent with the observed HMM and known structural constraints. By finding the extremal values of EWAC over this set, the approach provides bounds rather than point estimates. The linear programming formulation exploits the Markov structure and allows incorporation of various domain constraints. The time-homogeneity condition, while restrictive, enables tighter bounds by reducing the feasible set of SCMs.

## Foundational Learning
- Hidden Markov Models: Probabilistic models with hidden states generating observable outputs. Needed for modeling the casino's switching between fair and loaded dice. Quick check: Can compute filtering and smoothing probabilities.
- Structural Causal Models: Framework for defining counterfactuals and causal effects. Needed to formalize what it means for winnings to be "attributable to cheating." Quick check: Can express counterfactual queries as do-interventions.
- Linear Programming: Optimization technique for maximizing/minimizing linear objectives subject to linear constraints. Needed to compute bounds over the set of consistent SCMs. Quick check: Can formulate and solve basic LPs.
- Counterfactual Stability: Constraint ensuring that counterfactual outcomes are stable across time. Needed to incorporate domain knowledge about cheating behavior. Quick check: Can verify whether a given SCM satisfies the constraint.

## Architecture Onboarding

**Component Map:** Observed data -> HMM filtering/smoothing -> LP formulation -> EWAC bounds

**Critical Path:** The key computational path is from observed die rolls through HMM filtering/smoothing algorithms to compute posterior state probabilities, which are then used in the LP constraints for EWAC bounds.

**Design Tradeoffs:** Time-homogeneous bounds are tighter but require more constraints and are less flexible. Time-inhomogeneous bounds are looser but have simpler LP structure that decouples across time periods. Incorporating domain knowledge can tighten bounds but may introduce additional complexity.

**Failure Signatures:** Bounds that are too loose to be informative, infeasible LP solutions (indicating inconsistent constraints), or bounds that don't converge as T increases (suggesting model misspecification).

**First Experiments:** 1) Verify LP formulations with simple known SCMs where EWAC can be computed exactly. 2) Test the impact of pathwise monotonicity constraints on bound tightness. 3) Evaluate computational scaling as T increases from small to moderate values.

## Open Questions the Paper Calls Out

**Open Question 1:** How would bounds change with more than two hidden states (e.g., multiple loaded dice with different biases)? The paper only considers binary states, but extending to multiple states would require new mathematical analysis.

**Open Question 2:** What is the computational complexity of solving LP bounds as T increases? The paper doesn't analyze how computation time scales with sequence length.

**Open Question 3:** How sensitive are bounds to misspecification of emission probabilities? The paper assumes known parameters but doesn't consider the impact of estimation error.

**Open Question 4:** Can the methodology extend to continuous observation spaces rather than discrete die rolls? The current approach relies heavily on discrete structure.

## Limitations
- Computational tractability becomes challenging for longer sequences or more complex SCMs
- Time-homogeneity assumption may not hold in real casino settings where cheating strategies evolve
- The approach requires known HMM parameters, which may need to be estimated from data in practice

## Confidence
- **High confidence**: Mathematical formulation of EWAC bounds and LP representations are rigorously proven
- **Medium confidence**: Numerical results showing convergence as T increases are supported by experiments but could benefit from more formal proofs
- **Medium confidence**: Incorporation of domain knowledge through additional constraints appears sound but needs more empirical validation

## Next Checks
1. Verify LP formulations with known SCMs where EWAC can be computed exactly to test bound tightness
2. Implement and test counterfactual stability constraints to assess practical impact on bound computation
3. Scale approach to longer sequences (T > 100) to evaluate computational limits and bound convergence patterns