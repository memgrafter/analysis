---
ver: rpa2
title: Synthetic Data from Diffusion Models Improve Drug Discovery Prediction
arxiv_id: '2405.03799'
source_url: https://arxiv.org/abs/2405.03799
tags:
- data
- target
- synthetic
- drug
- diffusion
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper tackles the data sparsity problem in drug discovery,
  where key datasets are collected independently with little overlap, making it difficult
  to answer research questions requiring data across multiple sources. The authors
  propose Syngand, a novel diffusion GNN model capable of generating ligand structures
  and pharmacokinetic data end-to-end.
---

# Synthetic Data from Diffusion Models Improve Drug Discovery Prediction

## Quick Facts
- arXiv ID: 2405.03799
- Source URL: https://arxiv.org/abs/2405.03799
- Reference count: 40
- Primary result: Synthetic data augmentation improved regression task performance on water solubility, toxicity, and hERG inhibition in 15 out of 18 cases

## Executive Summary
This paper tackles the data sparsity problem in drug discovery, where key datasets are collected independently with little overlap, making it difficult to answer research questions requiring data across multiple sources. The authors propose Syngand, a novel diffusion GNN model capable of generating ligand structures and pharmacokinetic data end-to-end. They develop a methodology to sample target property values for existing ligands using their model. The generated synthetic data is evaluated on downstream regression tasks for water solubility (AqSolDB), acute toxicity (LD50), and hERG inhibition. Results show that the synthetic augmented real dataset can outperform real data alone on these tasks, with improved MSE, MAE, R2, and PCC metrics in 15 out of 18 cases. While the generated synthetic data is currently clustered around the mean, this work shows promise in addressing data sparsity challenges in drug discovery.

## Method Summary
The authors propose Syngand, a diffusion GNN model that extends discrete diffusion for molecular graphs with continuous diffusion for target properties, allowing end-to-end generation of molecular structures and their associated pharmacokinetic properties. The model is trained on a merged dataset of 1.33M molecules from Guacamol and target property datasets (AqSolDB, LD50, hERG). Synthetic properties are generated for 60k ligands using a noise sampling strategy, then combined with real data to create augmented training sets. Downstream regression models (Linear Regression and XGBoost) are trained on these augmented datasets and evaluated on test sets using MSE, MAE, R2, and PCC metrics.

## Key Results
- Synthetic augmented real datasets outperformed real data alone on downstream regression tasks in 15 out of 18 cases
- Generated synthetic data shows deviations of 2-16% from real data means, with variance differing by 1.17-3.16x
- Synthetic data improved MSE, MAE, R2, and PCC metrics across water solubility (AqSolDB), acute toxicity (LD50), and hERG inhibition tasks
- A key limitation is that generated data remains clustered around the mean, limiting utility for regression tasks

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Synthetic data improves downstream regression task performance by augmenting sparse real datasets
- Mechanism: The Syngand model generates synthetic ligand structures and pharmacokinetic properties, which are then combined with real data to create larger, more diverse training sets for machine learning models
- Core assumption: The synthetic data distribution is similar enough to real data to provide meaningful signal without introducing harmful bias
- Evidence anchors: "the synthetic augmented real dataset can outperform real data alone on these tasks, with improved MSE, MAE, R2, and PCC metrics in 15 out of 18 cases"
- Break condition: If the synthetic data distribution diverges significantly from real data, the augmented training sets could mislead the learning process and degrade model performance

### Mechanism 2
- Claim: End-to-end diffusion model can generate both molecular structures and their associated pharmacokinetic properties
- Mechanism: Syngand extends discrete diffusion for molecular graphs with continuous diffusion for target properties, allowing joint generation of structure-property pairs
- Core assumption: The same graph transformer network can effectively denoise both discrete molecular structures and continuous property values
- Evidence anchors: "Our model Syngand extends existing ligand diffusion models by integrating target property generation with ligand generation in a fully end-to-end diffusion pipeline"
- Break condition: If the model cannot learn the complex joint distribution between molecular structures and properties, the generated pairs may be unrealistic or inconsistent

### Mechanism 3
- Claim: Generated synthetic data remains clustered around the mean, limiting its utility for regression tasks
- Mechanism: The Gaussian noise sampling strategy and sampling hyperparameters cause the model to generate property values that cluster around the mean of the training distribution
- Core assumption: The current noise sampling and hyperparameters are not optimal for generating diverse property values across the full distribution
- Evidence anchors: "The mean of the generated synthetic data aligns closely with real data means with deviations between 2-16%. Synthetic data has variance much different from real data differing by a factor of 1.17-3.16x"
- Break condition: If the variance issue is not addressed, the synthetic data will have limited utility for regression tasks that require diverse property values across the full distribution

## Foundational Learning

- Concept: Denoising Diffusion Probabilistic Models (DDPMs)
  - Why needed here: The core of Syngand is a diffusion model that learns to denoise both molecular structures and pharmacokinetic properties
  - Quick check question: What is the key difference between the forward and reverse diffusion processes in DDPMs?

- Concept: Graph Neural Networks (GNNs) and message passing
  - Why needed here: Syngand uses a graph transformer network for denoising molecular structures represented as graphs
  - Quick check question: How do graph neural networks aggregate information from neighboring nodes in molecular graphs?

- Concept: Pharmacokinetic properties and their relationship to molecular structure
  - Why needed here: The paper focuses on generating synthetic data for water solubility, toxicity, and hERG inhibition, which are all structure-dependent properties
  - Quick check question: Why are water solubility and hERG inhibition important considerations in drug discovery?

## Architecture Onboarding

- Component map: Data preprocessing (Guacamol + target properties) -> Syngand model (extends DiGress) -> Training pipeline (100 epochs) -> Sampling pipeline (Algorithm 1) -> Evaluation pipeline (LR/XGBoost)

- Critical path:
  1. Preprocess data (merge Guacamol with target properties)
  2. Train Syngand model on 1.33M molecules
  3. Generate synthetic properties for 60k ligands
  4. Augment real data with synthetic data
  5. Train downstream models (LR/XGB)
  6. Evaluate performance on test sets

- Design tradeoffs:
  - End-to-end vs. separate structure and property models: End-to-end allows joint optimization but may be harder to train
  - Gaussian vs. other noise sampling: Gaussian is simple but may cause clustering around the mean
  - Synthetic data generation quantity: More data could improve downstream performance but requires more computation

- Failure signatures:
  - Poor downstream task performance despite synthetic augmentation
  - Generated properties clustering around mean with low variance
  - High reconstruction loss during training
  - Generated molecular structures failing validity checks

- First 3 experiments:
  1. Train Syngand on smaller subset (100k molecules) and verify it can generate valid structures
  2. Test property generation for existing ligands with Algorithm 1 using reduced parameters (M=5, N=10)
  3. Evaluate downstream performance on a single property (AqSolDB) before combining all three

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can the quality of synthetic data be improved to better match real data distributions, particularly for univariate and multivariate properties?
- Basis in paper: The paper identifies a key limitation: "A key limitation is that the generated data remains clustered around the mean" and notes that future work will look to optimize noise sampling strategies and hyperparameters to improve the univariate quality of the generated synthetic data.
- Why unresolved: The authors acknowledge this limitation but do not provide specific solutions or experimental results showing improved data quality.
- What evidence would resolve it: Results from experiments that demonstrate improved univariate and multivariate statistical properties of synthetic data compared to real data, along with ablation studies showing the impact of different noise sampling strategies and hyperparameters.

### Open Question 2
- Question: Can the Syngand model be extended to generate synthetic data for additional target properties beyond AqSolDB, LD50, and hERG?
- Basis in paper: The authors state, "Future work will look to improve our methods, scale to additional target properties, generate more synthetic data and create better evaluations of this new class of synthetic data."
- Why unresolved: The current study only focuses on three specific target properties, and the authors explicitly mention the need to extend the model to more properties.
- What evidence would resolve it: Successful application of the Syngand model to generate synthetic data for a broader range of target properties, with demonstrated improvements in downstream tasks.

### Open Question 3
- Question: How does the synthetic data generated by Syngand compare to real data in terms of facilitating research questions that require data spanning multiple datasets?
- Basis in paper: The paper's motivation is to address data sparsity challenges in drug discovery by generating synthetic data that can span multiple datasets. However, the current results focus on downstream regression tasks rather than directly addressing research questions requiring multi-dataset data.
- Why unresolved: While the paper shows improvements in downstream tasks, it does not explicitly demonstrate how the synthetic data facilitates research questions requiring data across multiple datasets.
- What evidence would resolve it: Case studies or experiments that show how synthetic data generated by Syngand enables researchers to answer specific research questions that were previously infeasible due to data sparsity, compared to using real data alone.

## Limitations
- Generated synthetic data remains clustered around the mean, limiting utility for regression tasks that require diverse property values
- Lack of directly comparable studies in literature makes benchmarking results difficult
- Hyperparameters for Syngand model are not fully specified, creating reproducibility challenges

## Confidence
- High: The core methodology of using diffusion models for synthetic data generation is technically sound
- Medium: The downstream performance improvements are demonstrated but limited by synthetic data quality issues
- Low: The generalizability of results to other drug discovery datasets and tasks remains uncertain

## Next Checks
1. Validate synthetic data diversity: Generate synthetic properties for test set molecules and compare distributions against real test data to quantify how much synthetic data diverges from real test distributions.

2. Ablation study on synthetic data quantity: Systematically vary the amount of synthetic data added to real datasets (0%, 25%, 50%, 75%, 100%) to determine the optimal augmentation ratio and identify potential diminishing returns.

3. Cross-dataset validation: Train Syngand on one combination of datasets and test synthetic data utility on a completely different drug discovery task not represented in the training data to assess generalization capability.