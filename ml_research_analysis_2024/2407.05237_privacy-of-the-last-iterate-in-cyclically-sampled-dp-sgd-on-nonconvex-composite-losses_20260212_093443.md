---
ver: rpa2
title: Privacy of the last iterate in cyclically-sampled DP-SGD on nonconvex composite
  losses
arxiv_id: '2407.05237'
source_url: https://arxiv.org/abs/2407.05237
tags:
- bounds
- convex
- privacy
- dp-sgd
- bound
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: "This paper establishes privacy guarantees for the last iterate\
  \ of differentially-private stochastic gradient descent (DP-SGD) under realistic\
  \ assumptions: cyclic data traversal, gradient clipping, and nonsmooth composite\
  \ losses. The authors provide R\xE9nyi differential privacy (RDP) bounds that are\
  \ tighter than previous work and do not require knowledge of global sensitivity\
  \ or convexity assumptions."
---

# Privacy of the last iterate in cyclically-sampled DP-SGD on nonconvex composite losses

## Quick Facts
- arXiv ID: 2407.05237
- Source URL: https://arxiv.org/abs/2407.05237
- Authors: Weiwei Kong; Mónica Ribero
- Reference count: 40
- This paper establishes privacy guarantees for the last iterate of differentially-private stochastic gradient descent (DP-SGD) under realistic assumptions: cyclic data traversal, gradient clipping, and nonsmooth composite losses.

## Executive Summary
This paper establishes privacy guarantees for the last iterate of differentially-private stochastic gradient descent (DP-SGD) under realistic assumptions: cyclic data traversal, gradient clipping, and nonsmooth composite losses. The authors provide Rényi differential privacy (RDP) bounds that are tighter than previous work and do not require knowledge of global sensitivity or convexity assumptions.

## Method Summary
The core method leverages optimal transport techniques to analyze privacy loss when data is traversed cyclically rather than randomly sampled. The key technical innovation is showing that the DP-SGD update operator is Lipschitz continuous under small step sizes, with a Lipschitz constant that depends on the weak-convexity parameter of the loss function.

## Key Results
- Two RDP bounds (Theorems 2.2 and 2.3) scale as $O(\alpha(\lambda C/b)^2)$ where $\lambda$ is step size, $C$ is clipping norm, and $b$ is batch size
- Bounds depend linearly on number of dataset passes $E$ rather than total iterations $T$, improving over composition-based bounds
- Analysis applies to both bounded and unbounded domains and transitions between convex and nonconvex settings

## Why This Works (Mechanism)
The analysis exploits the Lipschitz continuity of the DP-SGD update operator under small step sizes. By establishing this property, the authors can bound the privacy loss using optimal transport techniques. The weak-convexity parameter of the loss function directly influences the Lipschitz constant, enabling the transition between convex and nonconvex settings.

## Foundational Learning
- **Weak convexity**: A generalization of convexity where functions satisfy a relaxed convexity condition; needed to establish Lipschitz continuity of updates; quick check: verify $f(y) \geq f(x) + \nabla f(x)^T(y-x) - \frac{\mu}{2}\|y-x\|^2$
- **Rényi Differential Privacy (RDP)**: A privacy framework that provides tighter composition bounds than traditional DP; needed for precise privacy accounting; quick check: confirm $\alpha$-RDP implies $(\epsilon,\delta)$-DP via conversion formulas
- **Optimal transport**: Mathematical framework for comparing probability distributions; needed to analyze privacy loss under cyclic sampling; quick check: verify Wasserstein distance bounds between update distributions
- **Gradient clipping**: Technique to bound the sensitivity of gradient computations; needed to ensure bounded privacy loss; quick check: confirm clipping norm $C$ matches theoretical assumptions
- **Cyclic sampling**: Data access pattern where each example is visited exactly once per epoch; needed for realistic privacy analysis; quick check: verify data traversal matches cyclic assumption
- **Lipschitz continuity**: Property ensuring bounded changes in function output for bounded input changes; needed to establish privacy loss bounds; quick check: verify Lipschitz constant scales appropriately with step size

## Architecture Onboarding

Component map: DP-SGD update operator -> Lipschitz continuity verification -> Optimal transport privacy bound -> RDP composition

Critical path: Data traversal (cyclic) → Gradient computation (clipped) → Parameter update → Privacy loss accumulation → RDP bound calculation

Design tradeoffs: Small step sizes enable privacy guarantees but may slow convergence; cyclic sampling is more realistic but harder to analyze than random sampling

Failure signatures: Large step sizes break Lipschitz continuity; unbounded domains may violate technical assumptions; non-cyclic access patterns invalidate guarantees

First experiments:
1. Verify Lipschitz continuity empirically by measuring output variation under input perturbations
2. Test RDP bounds under different weak-convexity parameters to validate theoretical scaling
3. Compare privacy-utility trade-off with random sampling baseline

## Open Questions the Paper Calls Out
None

## Limitations
- Privacy guarantees depend on small step sizes, which may lead to slow convergence in practice
- Cyclic sampling assumption may not hold in all real-world implementations with variable data access patterns
- Analysis for unbounded domains involves additional technical assumptions that may be restrictive

## Confidence
- **High Confidence**: Theoretical derivation of RDP bounds using optimal transport techniques and Lipschitz continuity for small step sizes
- **Medium Confidence**: Practical implications of improved bounds, particularly T to E dependence transition requiring empirical validation
- **Medium Confidence**: Applicability to unbounded domains given additional technical assumptions

## Next Checks
1. **Empirical Convergence Study**: Evaluate convergence speed under small step sizes required for privacy guarantees to quantify privacy-utility trade-off
2. **Sensitivity Analysis**: Systematically vary weak-convexity parameter and measure Lipschitz constant changes to validate theoretical bounds
3. **Real-world Data Access Patterns**: Test privacy bounds under realistic data access patterns deviating from strict cyclic sampling to assess robustness