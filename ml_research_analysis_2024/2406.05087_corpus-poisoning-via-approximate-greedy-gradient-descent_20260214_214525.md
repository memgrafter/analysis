---
ver: rpa2
title: Corpus Poisoning via Approximate Greedy Gradient Descent
arxiv_id: '2406.05087'
source_url: https://arxiv.org/abs/2406.05087
tags:
- adversarial
- hotflip
- aggd
- retrieval
- candidate
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes Approximate Greedy Gradient Descent (AGGD),
  a new adversarial attack method for corpus poisoning in dense retrieval systems.
  AGGD improves upon the widely used HotFlip method by replacing its random token
  sampling with a more structured, deterministic search over the discrete token space.
---

# Corpus Poisoning via Approximate Greedy Gradient Descent

## Quick Facts
- arXiv ID: 2406.05087
- Source URL: https://arxiv.org/abs/2406.05087
- Reference count: 40
- Primary result: AGGD achieves up to 17.6% higher attack success rate than HotFlip on ANCE retrieval

## Executive Summary
This paper introduces Approximate Greedy Gradient Descent (AGGD), an adversarial attack method for corpus poisoning in dense retrieval systems. AGGD improves upon the HotFlip baseline by replacing random token sampling with a deterministic search strategy over the discrete token space. The method demonstrates significantly higher attack success rates, particularly against the ANCE retrieval model, while maintaining better generalization to unseen queries and cross-domain applicability.

## Method Summary
AGGD operates by iteratively modifying poisoned documents to maximize their retrieval score for target queries while minimizing their retrieval for legitimate queries. Unlike HotFlip which randomly samples tokens from the vocabulary, AGGD uses a greedy gradient-based approach to select the most effective tokens for poisoning. The method employs approximate gradient descent in the discrete token space, making it computationally feasible while maintaining attack effectiveness. The algorithm focuses on manipulating document embeddings to shift their position in the embedding space toward target query vectors.

## Key Results
- AGGD achieves up to 17.6% improvement in attack success rate compared to HotFlip on ANCE retrieval
- Demonstrates better generalization to unseen queries than HotFlip
- Shows cross-domain applicability with maintained effectiveness across different datasets
- Can be extended to knowledge poisoning in RAG systems beyond standard corpus poisoning

## Why This Works (Mechanism)
AGGD's effectiveness stems from its structured search approach that replaces HotFlip's random sampling with gradient-guided token selection. By leveraging the embedding space gradients, AGGD can identify tokens that maximally impact the document's retrieval behavior for target queries. The greedy approximation allows efficient search in the discrete token space while maintaining high attack success rates. This deterministic approach ensures that each poisoning iteration contributes meaningfully to the attack objective, rather than relying on chance selection.

## Foundational Learning

Token Embedding Space
- Why needed: Dense retrievers operate in continuous vector spaces where document-query similarity determines retrieval
- Quick check: Can you explain how cosine similarity between document and query embeddings determines retrieval ranking?

Adversarial Attack Objectives
- Why needed: Understanding the dual goals of maximizing target query retrieval while minimizing legitimate query retrieval
- Quick check: Can you describe the optimization problem formulation for corpus poisoning attacks?

Gradient-Based Optimization in Discrete Spaces
- Why needed: AGGD uses gradient information to guide token selection in a discrete vocabulary
- Quick check: How does approximate gradient descent differ from exact gradient descent in continuous spaces?

## Architecture Onboarding

Component Map:
Document Corpus -> Embedding Model -> Retrieval Model (ANCE) -> Query Interface -> Attack Target
^
Poisoned Document Generator (AGGD) |

Critical Path:
AGGD generates poisoned documents -> Documents are embedded -> Retrieval model ranks documents -> Attack success measured by target query retrieval position

Design Tradeoffs:
- Computational efficiency vs attack effectiveness (greedy approximation vs exact search)
- Stealth vs potency (more aggressive poisoning vs maintaining document legitimacy)
- Generalization vs specialization (broad applicability vs targeted model optimization)

Failure Signatures:
- Poor attack success rate despite high computational cost
- Rapid degradation of legitimate retrieval performance
- Detection by simple anomaly detection on embedding patterns

First Experiments:
1. Baseline comparison: Measure attack success rate of AGGD vs HotFlip on ANCE with identical computational budget
2. Cross-query evaluation: Test poisoned documents against held-out queries not seen during attack generation
3. Embedding space analysis: Visualize poisoned document trajectories in embedding space during iterative poisoning

## Open Questions the Paper Calls Out
None

## Limitations
- Effectiveness highly dependent on specific retrieval model architecture (ANCE)
- Computational overhead compared to HotFlip not quantified
- Assumes white-box access to embedding model, which may not reflect real-world scenarios
- Limited evaluation of collateral damage to legitimate retrieval performance

## Confidence

| Claim | Confidence |
|-------|------------|
| Attack effectiveness vs HotFlip | High |
| Cross-query generalization | Medium |
| Cross-domain applicability | Low |
| Computational efficiency claims | Low |
| Threat model realism | Low |

## Next Checks

1. Benchmark AGGD against multiple dense retriever architectures (DPR, SPLADE, TAS-B) to assess architectural generalization beyond ANCE.

2. Measure and report the wall-clock time and memory overhead of AGGD compared to HotFlip across varying corpus sizes to establish practical feasibility.

3. Evaluate attack detectability by testing whether simple anomaly detection on token embeddings or retrieval scores can identify poisoned documents with high accuracy.