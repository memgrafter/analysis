---
ver: rpa2
title: 'FreqRISE: Explaining time series using frequency masking'
arxiv_id: '2406.13584'
source_url: https://arxiv.org/abs/2406.13584
tags:
- domain
- time
- frequency
- relevance
- freqrise
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: FreqRISE is the first masking-based approach for explaining time
  series in the frequency and time-frequency domain. It addresses the limitation of
  existing saliency methods that assume localized information in the raw input space,
  which may not hold for many time series where salient information is better represented
  in transformed domains.
---

# FreqRISE: Explaining time series using frequency masking

## Quick Facts
- arXiv ID: 2406.13584
- Source URL: https://arxiv.org/abs/2406.13584
- Authors: Thea Brüsch; Kristoffer Knutsen Wickstrøm; Mikkel N. Schmidt; Tommy Sonne Alstrøm; Robert Jenssen
- Reference count: 40
- FreqRISE is the first masking-based approach for explaining time series in the frequency and time-frequency domain, consistently outperforming gradient-based baselines in faithfulness and noise robustness

## Executive Summary
FreqRISE introduces a novel masking-based explanation method for time series that operates in the frequency and time-frequency domain rather than the raw time domain. Unlike traditional saliency methods that assume localized information in the input space, FreqRISE recognizes that many time series contain salient information better represented in transformed domains. The method extends the RISE framework by applying masks in the frequency or time-frequency domain before mapping back to the time domain to measure output changes, enabling more accurate localization of relevant frequency components.

Evaluated across four tasks on synthetic data and AudioMNIST, FreqRISE demonstrates superior faithfulness compared to gradient-based baselines (IG, LRP), particularly under noisy conditions. The method achieves competitive complexity scores after post-processing and provides robust explanations for critical domains requiring explainable AI. This represents a significant advancement in time series interpretability by addressing the fundamental limitation that salient information in many time series is not localized in the raw time domain.

## Method Summary
FreqRISE is a masking-based explanation method that extends the RISE framework to operate in the frequency and time-frequency domain for time series. The method applies random masks in the frequency domain (using DFT) or time-frequency domain (using STFT) to generate masked time series, then measures the change in model output to compute importance scores. By transforming the input to domains where salient information is better localized, FreqRISE can identify relevant frequency components that traditional time-domain methods miss. The approach involves transforming the time series, applying random masks in the transformed domain, mapping back to the time domain, and computing explanation scores based on output changes. This frequency-domain masking strategy addresses the limitation that salient information in many time series is not localized in the raw input space.

## Key Results
- FreqRISE consistently outperforms gradient-based baselines (IG, LRP) in faithfulness across synthetic and AudioMNIST experiments
- The method shows superior noise robustness, maintaining explanation quality under various noise conditions
- FreqRISE more accurately localizes relevant frequency components compared to time-domain explanation methods
- Achieves competitive complexity scores after post-processing, demonstrating efficient and interpretable explanations

## Why This Works (Mechanism)
FreqRISE works by recognizing that salient information in many time series is better represented in transformed domains rather than the raw time domain. Traditional explanation methods assume localized information in the input space, which fails when important features are distributed across frequencies. By applying masks in the frequency or time-frequency domain before measuring output changes, FreqRISE can isolate and identify the specific frequency components that drive model predictions. This frequency-domain approach captures the spectral characteristics that determine model behavior, providing explanations that are more aligned with how time series models actually process temporal data.

## Foundational Learning

**Discrete Fourier Transform (DFT)** - Why needed: Converts time series from time domain to frequency domain to reveal spectral components; Quick check: Can decompose a periodic signal into its constituent frequencies

**Short-Time Fourier Transform (STFT)** - Why needed: Provides time-frequency representation by analyzing local segments, capturing non-stationary signal characteristics; Quick check: Can show how frequency content changes over time in a signal

**Randomized Input Sampling for Explanation (RISE)** - Why needed: Framework for generating input masks and measuring output changes to compute feature importance; Quick check: Can generate explanations by systematically occluding input regions

**Saliency Map Methods** - Why needed: Traditional approach for identifying important input regions, but limited by assumption of localized information; Quick check: Can highlight time points with high gradient magnitude for model predictions

**Fourier Transform Properties** - Why needed: Understanding linearity, shift properties, and Parseval's theorem for correct frequency-domain operations; Quick check: Can verify energy preservation between time and frequency domains

**Signal Reconstruction** - Why needed: Ability to invert frequency-domain representations back to time domain for masked signal generation; Quick check: Can perfectly reconstruct original signal from its Fourier coefficients

## Architecture Onboarding

Component map: Time Series -> DFT/STFT -> Masking -> Inverse Transform -> Model Input -> Output Change Measurement -> Importance Scores

Critical path: Input transformation (DFT/STFT) → Mask application in transformed domain → Inverse transformation to time domain → Model prediction → Output difference calculation → Explanation score aggregation

Design tradeoffs: Frequency vs. time-frequency domain selection based on signal stationarity; mask density tradeoff between explanation quality and computational cost; post-processing complexity vs. explanation clarity

Failure signatures: Poor performance on signals with information distributed across both time and frequency domains; degraded explanations for very short time series where frequency resolution is limited; sensitivity to window function selection in STFT

First experiments: 1) Test on simple periodic signals where ground truth frequency components are known, 2) Evaluate noise robustness by adding varying levels of Gaussian noise to test signals, 3) Compare frequency vs. time-frequency explanations on non-stationary signals

## Open Questions the Paper Calls Out

The paper does not explicitly call out open questions, as it presents FreqRISE as a complete method with demonstrated effectiveness. However, implicit open questions include how the method performs on multi-dimensional time series beyond the 1D signals tested, the computational scalability for real-time applications, and the sensitivity to hyperparameters like the number of mask samples and frequency resolution.

## Limitations

- Evaluation limited to synthetic data and AudioMNIST, lacking diversity in time series types and real-world domains
- Computational efficiency not thoroughly analyzed, particularly regarding DFT/STFT operations for each mask sample
- Post-processing step for complexity scores introduces manual tuning requirements affecting reproducibility
- Only compares against two gradient-based baselines (IG, LRP), leaving uncertainty about performance relative to other explanation methods

## Confidence

High - The core theoretical framework extending RISE to frequency domains is sound and well-defined. The synthetic experiments demonstrate the method's ability to identify relevant frequency components, and the results are internally consistent.

Medium - The AudioMNIST experiments show consistent improvements over baselines, but the real-world applicability beyond audio classification remains unproven. The post-processing for complexity scores adds an element of manual intervention that affects generalizability.

Low - The computational complexity analysis is insufficient, and the method's scalability to longer time series or real-time applications is unclear. The sensitivity to hyperparameters and the impact of different signal transformations are not thoroughly characterized.

## Next Checks

1. Evaluate FreqRISE on additional time series domains including physiological signals (ECG, EEG), financial data, and sensor time series to test generalizability beyond audio data.

2. Conduct a comprehensive ablation study varying key parameters: number of mask samples, frequency resolution, STFT window size, and threshold values for complexity score post-processing to establish robustness.

3. Compare FreqRISE against a broader range of explanation methods including SHAP variants, occlusion-based approaches, and attention-based explanations to establish its relative performance across different time series characteristics.