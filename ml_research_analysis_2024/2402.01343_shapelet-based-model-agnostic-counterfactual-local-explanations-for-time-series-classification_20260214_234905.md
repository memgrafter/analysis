---
ver: rpa2
title: Shapelet-based Model-agnostic Counterfactual Local Explanations for Time Series
  Classification
arxiv_id: '2402.01343'
source_url: https://arxiv.org/abs/2402.01343
tags:
- time
- series
- counterfactual
- instances
- explanations
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes Time-CF, a model-agnostic, instance-based,
  post-hoc explainability method for time series classification. Time-CF generates
  counterfactual explanations using shapelets and TimeGAN, identifying minimal contiguous
  segments of the original time series that, when altered, change the classifier's
  prediction.
---

# Shapelet-based Model-agnostic Counterfactual Local Explanations for Time Series Classification

## Quick Facts
- arXiv ID: 2402.01343
- Source URL: https://arxiv.org/abs/2402.01343
- Reference count: 9
- Proposes Time-CF, a model-agnostic counterfactual explanation method for time series classification

## Executive Summary
This paper introduces Time-CF, a novel model-agnostic approach for generating counterfactual explanations in time series classification. The method identifies minimal contiguous segments in the original time series that, when modified, can change the classifier's prediction. By combining shapelet-transform for identifying informative subsequences with TimeGAN for generating plausible counterfactuals, Time-CF provides interpretable explanations that are both minimal and meaningful. The approach is evaluated across four real-world univariate time series datasets from the UCR archive using four different classifiers, demonstrating superior performance compared to existing state-of-the-art methods.

## Method Summary
Time-CF operates through a two-stage process: first, it uses shapelet-transform to identify the most informative subsequences in the time series that are critical for the classifier's decision. These shapelets represent the key patterns that distinguish between classes. In the second stage, Time-CF employs TimeGAN to generate plausible counterfactual time series by modifying the identified shapelet segments while maintaining the overall temporal structure and characteristics of the original series. The method ensures that the generated counterfactuals are not only close to the original series (measured by L1-norm) but also plausible and sparse, focusing only on the minimal necessary changes to alter the classification outcome.

## Key Results
- Time-CF achieves L1-norm closeness scores of 200-300, significantly better than 100-200 for baseline methods
- Outlier ratio for plausibility is 0-0.1, compared to 0.1-0.4 for competing approaches
- Sparsity reaches 80-90% versus 0-10% for alternatives, indicating minimal modifications
- Sensibility score of 1.0 for most configurations, dropping to 0.8 only on the imbalanced Wafer dataset

## Why This Works (Mechanism)
Time-CF's effectiveness stems from its dual approach of leveraging both shapelet-transform and TimeGAN. The shapelet-transform identifies the most discriminative subsequences in the time series, ensuring that modifications target the most relevant features for classification. TimeGAN then generates realistic counterfactuals by learning the temporal distribution of the data, preventing implausible artifacts that could arise from naive perturbation. This combination allows Time-CF to make minimal yet meaningful changes that are both interpretable and effective at changing predictions.

## Foundational Learning
- Shapelet-transform: Identifies informative subsequences in time series; needed to focus modifications on classification-relevant patterns; quick check: verify shapelet length and coverage across datasets
- TimeGAN: Generates synthetic time series preserving temporal dependencies; needed to create plausible counterfactuals that don't violate data distribution; quick check: assess generated samples' similarity to real data distribution
- Counterfactual explanations: Provide actionable insights by showing minimal changes to alter predictions; needed for interpretable ML in safety-critical applications; quick check: validate that small changes indeed flip predictions

## Architecture Onboarding
- Component map: Shapelet-transform -> TimeGAN -> Counterfactual Generation -> Explanation Output
- Critical path: Identify shapelets → Generate counterfactuals → Measure explanation quality → Validate prediction change
- Design tradeoffs: Shapelet length vs. sparsity (longer shapelets may capture more information but reduce sparsity); counterfactual realism vs. proximity (more realistic generations may deviate more from original)
- Failure signatures: Low sensibility indicates ineffective shapelet identification or implausible counterfactual generation; high outlier ratio suggests TimeGAN produces unrealistic samples
- First experiments: 1) Run shapelet-transform on each dataset to identify key patterns; 2) Generate baseline counterfactuals using simple perturbations; 3) Compare TimeGAN-generated counterfactuals against real data distribution

## Open Questions the Paper Calls Out
None

## Limitations
- Restricted to univariate time series, limiting applicability to real-world multivariate scenarios
- No discussion of computational efficiency despite potentially expensive shapelet extraction and GAN training
- Evaluation on only four classifiers leaves uncertainty about performance with other architectures
- Does not address handling of missing values or irregularly sampled time series common in practice

## Confidence
- High confidence in closeness and plausibility metrics (consistent improvement across all datasets and classifiers)
- Medium confidence in sparsity results (potential sensitivity to segment definition)
- Medium confidence in sensibility (single failure case on Wafer dataset suggests possible instability)

## Next Checks
1. Test Time-CF on multivariate time series datasets and compare performance degradation against univariate results to assess method scalability
2. Conduct ablation studies to isolate the contribution of shapelet-transform versus TimeGAN components in achieving the reported performance improvements
3. Evaluate Time-CF's robustness on time series with missing values, noise corruption, and irregular sampling to determine real-world applicability beyond clean UCR archive data