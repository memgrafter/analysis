---
ver: rpa2
title: 'DarkSAM: Fooling Segment Anything Model to Segment Nothing'
arxiv_id: '2409.17874'
source_url: https://arxiv.org/abs/2409.17874
tags:
- attack
- darksam
- adversarial
- prompts
- image
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: DarkSAM is the first prompt-free universal adversarial attack framework
  against prompt-guided segmentation models like SAM and its variants. It decouples
  crucial object features in both spatial and frequency domains to render SAM incapable
  of segmenting objects across diverse images with varying prompts.
---

# DarkSAM: Fooling Segment Anything Model to Segment Nothing

## Quick Facts
- arXiv ID: 2409.17874
- Source URL: https://arxiv.org/abs/2409.17874
- Reference count: 40
- Primary result: First universal adversarial attack framework achieving over 60% average mIoU reduction across 96 experimental settings against SAM and variants

## Executive Summary
DarkSAM is the first universal adversarial attack framework targeting prompt-guided segmentation models like SAM and its variants. The method decouples crucial object features in both spatial and frequency domains to prevent SAM from segmenting objects across diverse images with varying prompts. By employing a shadow target strategy and combining semantic decoupling-based spatial attacks with texture distortion-based frequency attacks, DarkSAM achieves high attack success rates and strong transferability across domains, prompts, and model variants.

## Method Summary
DarkSAM generates universal adversarial perturbations (UAPs) that fool SAM by disrupting object features in both spatial and frequency domains. The method uses a shadow target strategy, creating semantic blueprints by merging masks from multiple random prompts. It then optimizes a UAP to destroy crucial object features by scrambling foreground and background semantics in the spatial domain while distorting high-frequency texture components in the frequency domain. The attack is evaluated on four datasets (ADE20K, MS-COCO, CITYSCAPES, SA-1B) with 100 images for UAP generation and 2,000 for testing, measuring attack success rate through mIoU reduction.

## Key Results
- Achieves over 60% average mIoU reduction across 96 experimental settings
- Maintains effectiveness under multipoint evaluation and moderate perturbation budgets
- Demonstrates strong cross-domain, cross-prompt, and cross-model transferability
- UAPs remain effective against SAM variants (HQ-SAM, PerSAM) with different architectures

## Why This Works (Mechanism)

### Mechanism 1
DarkSAM disrupts SAM's segmentation by decoupling object features in both spatial and frequency domains. It creates semantic blueprints from multiple prompts and optimizes UAPs to scramble foreground/background semantics spatially while distorting high-frequency texture components. SAM's segmentation relies heavily on local object features, and disrupting these across both domains renders it incapable of accurate segmentation.

### Mechanism 2
The shadow target strategy handles prompt ambiguity by generating multiple random prompts and merging their output masks to create a semantic blueprint. This blueprint represents the main object content and serves as a stable attack target, reducing uncertainty from varying prompts. Merging masks from multiple prompts creates a representative semantic blueprint that encompasses the main object content.

### Mechanism 3
Texture distortion in the frequency domain enhances attack effectiveness by exploiting SAM's texture bias. DarkSAM uses DWT to decompose images into high-frequency (texture) and low-frequency (shape) components, then increases dissimilarity in the HFC of adversarial and benign examples while maintaining consistency in their LFC. This distorts texture information while preserving shape information, effectively misleading the model.

## Foundational Learning

- **Universal Adversarial Perturbation (UAP)**
  - Why needed here: DarkSAM generates a single perturbation that can fool SAM across diverse images and prompts
  - Quick check question: What is the key difference between UAP and traditional sample-wise adversarial attacks?

- **Discrete Wavelet Transform (DWT)**
  - Why needed here: DWT decomposes images into high-frequency and low-frequency components for the frequency domain attack
  - Quick check question: What are the high-frequency and low-frequency components of an image, and how do they relate to texture and shape information?

- **Semantic Decoupling**
  - Why needed here: DarkSAM decouples and disrupts crucial object features in both spatial and frequency domains to mislead SAM
  - Quick check question: What is the difference between spatial domain and frequency domain attacks, and why is a combined approach more effective?

## Architecture Onboarding

- **Component map:** Image Encoder -> Prompt Encoder -> Mask Decoder -> DarkSAM Attack Framework (Spatial Attack + Frequency Attack)
- **Critical path:**
  1. Generate multiple random prompts and obtain SAM's output masks
  2. Merge masks to create a semantic blueprint as the attack target
  3. Optimize UAP to disrupt foreground and background semantics in the spatial domain
  4. Apply frequency domain attack to distort high-frequency texture components
  5. Evaluate attack success rate on SAM and its variants
- **Design tradeoffs:**
  - Spatial attack vs. frequency attack: Balancing effectiveness of disrupting object features in both domains
  - Prompt number: Increasing prompts improves stability but may introduce noise
  - Perturbation budget: Higher budgets increase success but reduce imperceptibility
- **Failure signatures:**
  - Low attack success rate across different datasets and prompts
  - High mIoU values on adversarial examples, indicating SAM's ability to segment objects accurately
  - Negative ASR values, suggesting the attack inadvertently enhances segmentation accuracy
- **First 3 experiments:**
  1. Evaluate DarkSAM's attack performance on SAM using a single dataset and prompt type
  2. Assess cross-domain transferability by testing UAPs on datasets from different domains
  3. Investigate the impact of the frequency attack on enhancing cross-domain transferability

## Open Questions the Paper Calls Out

### Open Question 1
Does DarkSAM's shadow target strategy maintain effectiveness when using fewer than 10 prompts, and what is the optimal number of prompts for balancing attack success rate and computational efficiency? The study tested only up to 100 prompts, leaving the optimal number within the 1-10 range unclear, particularly for different datasets or model variants.

### Open Question 2
How does DarkSAM perform against traditional segmentation models that output pixel-level labels rather than label-free masks, and what modifications would be needed for such attacks? The paper acknowledges that DarkSAM may not be suitable for traditional segmentation models because its output is not a label-free mask, potentially limiting its applicability in scenarios where labeled masks are essential.

### Open Question 3
Can DarkSAM be extended to attack 3D segmentation models or video segmentation frameworks, and what challenges would arise in adapting the spatial and frequency domain attacks to these domains? While the paper focuses on 2D image segmentation, SAM has been adapted for 3D point clouds and video segmentation. The spatial and frequency domain attacks could theoretically be extended, but the paper does not explore this.

## Limitations

- **Spatial attack mechanism validation gap:** No ablation study isolating the spatial attack component's effectiveness in the dual-domain approach
- **Frequency attack justification weakness:** No empirical evidence demonstrating SAM's reliance on high-frequency texture over low-frequency shape information
- **Shadow target strategy evaluation gap:** Effectiveness not compared against simpler alternatives like single prompts or ground truth masks

## Confidence

- **High confidence:** Overall experimental results showing over 60% average mIoU reduction across 96 settings with internally consistent methodology
- **Medium confidence:** Cross-domain and cross-prompt transferability claims, though mechanism relies on unvalidated frequency attack component
- **Low confidence:** Specific claim that shadow target strategy significantly enhances attack performance without comparative analysis

## Next Checks

1. **Spatial-only ablation study:** Run DarkSAM with frequency attack disabled (λ=0, μ=0) to measure the standalone effectiveness of the spatial semantic decoupling component and compare to full dual-domain attack.

2. **Ground truth vs shadow target comparison:** Implement a variant using semantic segmentation ground truth masks as attack targets instead of shadow targets to determine if shadow target strategy provides measurable benefits.

3. **Frequency component sensitivity analysis:** Systematically vary frequency attack parameters (λ, μ) while holding spatial attack constant to measure effects on attack success rate and cross-domain transferability.