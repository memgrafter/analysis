---
ver: rpa2
title: Causal Deconfounding via Confounder Disentanglement for Dual-Target Cross-Domain
  Recommendation
arxiv_id: '2404.11180'
source_url: https://arxiv.org/abs/2404.11180
tags:
- user
- recommendation
- confounders
- preferences
- domain
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper tackles dual-target cross-domain recommendation (CDR),
  where user-item interactions are confounded by both single-domain confounders (SDCs)
  and cross-domain confounders (CDCs). Existing methods either ignore CDCs or focus
  only on negative confounder effects, missing their positive impacts.
---

# Causal Deconfounding via Confounder Disentanglement for Dual-Target Cross-Domain Recommendation

## Quick Facts
- arXiv ID: 2404.11180
- Source URL: https://arxiv.org/abs/2404.11180
- Authors: Jiajie Zhu; Yan Wang; Feng Zhu; Zhu Sun
- Reference count: 40
- Primary result: CD2CDR outperforms state-of-the-art baselines with 6.17% HR@10 and 8.23% NDCG@10 improvements on seven real-world datasets

## Executive Summary
This paper addresses dual-target cross-domain recommendation (CDR) where user-item interactions are confounded by both single-domain confounders (SDCs) and cross-domain confounders (CDCs). The authors propose CD2CDR, which first disentangles observed SDCs and CDCs using a dual adversarial structure and half-sibling regression, then applies backdoor adjustment to preserve positive confounder effects while eliminating negative ones. Evaluated on seven real-world datasets, CD2CDR demonstrates substantial improvements over state-of-the-art methods with average gains of 6.17% and 8.23% in HR@10 and NDCG@10, respectively, while also generalizing well to challenging cross-system recommendation scenarios.

## Method Summary
CD2CDR employs a three-phase approach: (1) pre-training a DIDA-CDR backbone to learn user preference embeddings, (2) disentangling confounders through dual adversarial structure for SDCs and half-sibling regression for CDCs, and (3) applying causal deconfounding with backdoor adjustment and confounder selection function to preserve beneficial confounder effects while eliminating harmful ones. The method transforms raw user-item interactions into domain-specific preferences, identifies confounding influences, and adjusts for them to improve recommendation accuracy across domains.

## Key Results
- CD2CDR achieves average improvements of 6.17% HR@10 and 8.23% NDCG@10 over state-of-the-art baselines
- The model demonstrates strong generalization to cross-system recommendation scenarios
- Experimental results validate the effectiveness of both SDC and CDC disentanglement modules

## Why This Works (Mechanism)

### Mechanism 1
- Claim: CD2CDR effectively disentangles single-domain confounders (SDCs) using a dual adversarial structure with cycle consistency loss
- Mechanism: The dual adversarial structure transforms domain-specific user preferences between domains. The cycle consistency loss ensures that preferences remain aligned after bidirectional transformation, and the differences between transformed and original preferences reveal the SDCs
- Core assumption: Differences between transformed and original domain-specific user preferences represent confounders rather than true preferences
- Evidence anchors:
  - [abstract] "we first propose a confounder disentanglement module to effectively decouple observed single-domain and cross-domain confounders"
  - [section] "We devise a dual adversarial structure, which consists of two domain transformation generators and two discriminators, to disentangle SDCs in each domain"
  - [corpus] Weak evidence - no direct corpus papers discussing dual adversarial structures for SDC disentanglement in CDR

### Mechanism 2
- Claim: CD2CDR effectively disentangles cross-domain confounders (CDCs) using half-sibling regression
- Mechanism: Half-sibling regression predicts comprehensive user preferences in one domain based on preferences in another domain. The prediction captures only the influence of CDCs since domain-specific confounders are assumed independent
- Core assumption: Domain-specific confounders are independent between domains, so regression only captures CDC influence
- Evidence anchors:
  - [abstract] "We then propose a causal deconfounding module to preserve the positive effects of such observed confounders and eliminate their negative effects via backdoor adjustment"
  - [section] "Inspired by the method introduced in [82], we employ half-sibling regression to disentangle CDCs from the previously obtained comprehensive user preferences in both domains"
  - [corpus] Weak evidence - no direct corpus papers discussing half-sibling regression for CDC disentanglement in CDR

### Mechanism 3
- Claim: CD2CDR preserves positive confounder effects while eliminating negative effects through backdoor adjustment with confounder selection function
- Mechanism: Backdoor adjustment blocks paths from confounders to user preferences, eliminating negative bias. The confounder selection function weights confounders to preserve their direct positive effects on user-item interactions
- Core assumption: Positive and negative effects of confounders operate through different causal paths that can be selectively blocked or preserved
- Evidence anchors:
  - [abstract] "eliminate their negative effects on capturing comprehensive user preferences"
  - [section] "we devise a confounder selection function to effectively control decoupled confounders for more accurate deconfounding"
  - [corpus] Moderate evidence - several corpus papers discuss deconfounding and backdoor adjustment, but not specifically in CDR context

## Foundational Learning

- Concept: Causal graphs and backdoor adjustment
  - Why needed here: The model uses causal graphs to identify confounding paths and applies backdoor adjustment to block negative effects while preserving positive ones
  - Quick check question: Can you explain how backdoor adjustment blocks the path C→Z while preserving the direct path Z→Y?

- Concept: Half-sibling regression
  - Why needed here: Used to disentangle cross-domain confounders by predicting preferences in one domain from another, capturing only shared confounding influences
  - Quick check question: What assumption about domain-specific confounders makes half-sibling regression effective for CDC disentanglement?

- Concept: Adversarial learning and cycle consistency
  - Why needed here: Dual adversarial structure with cycle consistency loss is used to disentangle single-domain confounders while preserving user preferences
  - Quick check question: How does cycle consistency loss ensure that transformed preferences remain aligned with original user preferences?

## Architecture Onboarding

- Component map: User Preference Disentanglement → Confounder Disentanglement (SDC via dual adversarial + CDC via half-sibling regression) → Causal Deconfounding (backdoor adjustment with confounder selection) → Interaction Prediction
- Critical path: Confounder Disentanglement → Causal Deconfounding, as accurate confounder identification is prerequisite for effective deconfounding
- Design tradeoffs: Dual adversarial structure provides accurate SDC disentanglement but requires more training time; half-sibling regression is computationally efficient but relies on independence assumptions
- Failure signatures: Poor recommendation performance indicates confounder disentanglement failure; unstable training suggests issues with adversarial structure or cycle consistency
- First 3 experiments:
  1. Test SDC disentanglement by examining whether transformed preferences differ from originals when confounders are present
  2. Validate CDC disentanglement by checking if half-sibling regression predictions capture shared influences across domains
  3. Evaluate confounder selection function by measuring whether it appropriately weights confounders in different recommendation scenarios

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can CD2CDR be extended to handle multi-domain causal effects beyond the dual-target scenario?
- Basis in paper: [explicit] "A limitation of this work is its focus on a dual-target CDR scenario, which does not fully address the multi-domain causal effects presented in real-world applications."
- Why unresolved: The paper focuses exclusively on dual-target scenarios and acknowledges that users often interact across numerous domains simultaneously, creating intricate causal effect networks that the current framework cannot capture
- What evidence would resolve it: Experimental validation showing CD2CDR's performance when extended to three or more domains, with metrics comparing single-target, dual-target, and multi-target scenarios

### Open Question 2
- Question: What methods can be developed to address unobserved confounders in cross-domain recommendation?
- Basis in paper: [explicit] "Moreover, our model focuses exclusively on observed confounders... However, in real-world recommendation scenarios, there exist unobserved confounders that cannot be directly disentangled from available data... To address this challenge, we need to exploit instrumental variables or learn substitutes for unobserved confounders."
- Why unresolved: The paper identifies unobserved confounders as a significant limitation but does not provide concrete solutions beyond acknowledging the need for instrumental variables or learning substitutes
- What evidence would resolve it: Implementation and evaluation of specific methods for identifying and deconfounding unobserved confounders, with comparative results against observed-confounder-only approaches

### Open Question 3
- Question: How can the computational efficiency of CD2CDR be improved while maintaining or enhancing recommendation accuracy?
- Basis in paper: [inferred] "A limitation of this work is its focus on a dual-target CDR scenario" and the complexity analysis in Section 4.5 showing O(mn²(J+L)) time complexity
- Why unresolved: While the paper provides time complexity analysis and notes that confounder disentanglement represents only a fraction of overall computational cost, it does not explore optimization strategies for large-scale applications
- What evidence would resolve it: Comparative studies of simplified CD2CDR variants using techniques like knowledge distillation, with efficiency metrics (training time, inference latency) and accuracy trade-offs documented

## Limitations

- The dual adversarial structure for SDC disentanglement lacks direct corpus evidence supporting its effectiveness
- Half-sibling regression relies on the strong assumption that domain-specific confounders are independent between domains
- The complex three-phase training procedure may face practical implementation challenges and scalability issues

## Confidence

- **High confidence** in the overall framework's effectiveness, given the substantial empirical improvements (6.17% HR@10, 8.23% NDCG@10)
- **Medium confidence** in the causal mechanisms, as the theoretical foundation is sound but lacks direct supporting evidence
- **Low confidence** in the generalizability to datasets beyond the seven tested, particularly for cross-system scenarios

## Next Checks

1. Test the independence assumption between domain-specific confounders by measuring cross-domain correlations in the half-sibling regression residuals
2. Validate the cycle consistency loss effectiveness by quantifying preference preservation rates during domain transformation
3. Evaluate confounder selection function performance by systematically varying confounder weights and measuring recommendation accuracy changes