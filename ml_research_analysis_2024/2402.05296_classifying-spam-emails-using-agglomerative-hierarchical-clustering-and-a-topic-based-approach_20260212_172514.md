---
ver: rpa2
title: Classifying spam emails using agglomerative hierarchical clustering and a topic-based
  approach
arxiv_id: '2402.05296'
source_url: https://arxiv.org/abs/2402.05296
tags:
- spam
- emails
- email
- text
- https
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes a novel approach to spam email classification
  by applying a cybersecurity topic-based perspective using natural language processing
  and machine learning techniques. The authors create two novel datasets, SPEMC-15K-E
  and SPEMC-15K-S, containing approximately 15,000 English and Spanish spam emails
  respectively, labeled into 11 categories through agglomerative hierarchical clustering.
---

# Classifying spam emails using agglomerative hierarchical clustering and a topic-based approach

## Quick Facts
- arXiv ID: 2402.05296
- Source URL: https://arxiv.org/abs/2402.05296
- Reference count: 40
- This paper proposes a novel approach to spam email classification by applying a cybersecurity topic-based perspective using natural language processing and machine learning techniques.

## Executive Summary
This paper introduces a novel approach to spam email classification that applies a cybersecurity topic-based perspective using natural language processing and machine learning techniques. The authors create two novel datasets, SPEMC-15K-E and SPEMC-15K-S, containing approximately 15,000 English and Spanish spam emails respectively, labeled into 11 categories through agglomerative hierarchical clustering. The study evaluates 16 different pipelines combining four text representation techniques with four classifiers, demonstrating that TF-IDF with Logistic Regression achieves the highest performance for both language datasets.

## Method Summary
The methodology involves extracting textual content from emails (subject, body, images) using OCR for HTML-to-image conversion and image text extraction, filtering by language and joining all visible text. Text preprocessing includes lowercasing, stopword removal, tokenization, and removal of single characters/numbers. Four text representation methods (TF-IDF, BOW, Word2Vec, BERT) are combined with four classifiers (SVM, Naive Bayes, Random Forest, Logistic Regression) using 10-fold cross-validation on the SPEMC datasets.

## Key Results
- TF-IDF with Logistic Regression achieves highest performance: F1 score of 0.953 and accuracy of 94.6% for English emails
- TF-IDF with Naive Bayes yields F1 score of 0.945 and 98.5% accuracy for Spanish emails
- TF-IDF with Logistic Regression provides fastest classification, processing English and Spanish spam emails in 2ms and 2.2ms on average

## Why This Works (Mechanism)

### Mechanism 1
- Hierarchical clustering discovers topic-based spam categories without prior labeling by grouping spam emails by textual similarity, then manual inspection assigns semantic labels based on expert domain knowledge. This works under the assumption that spam emails with similar textual features share underlying topic structure and can be meaningfully clustered. Break condition: If spam emails are too diverse or spammer techniques obscure semantic structure, clusters may not map cleanly to interpretable categories.

### Mechanism 2
- Combining OCR-based text extraction with traditional NLP preprocessing improves classification accuracy on image-based and hidden-text spam by converting images to greyscale, extracting visible text, and recovering hidden HTML text via OCR to avoid filter evasion techniques. This works under the assumption that spammers embed malicious text in images or hide it in HTML to bypass text filters. Break condition: If OCR quality is poor or spammers use advanced obfuscation beyond simple HTML hiding, text extraction may fail.

### Mechanism 3
- TF-IDF with Logistic Regression provides optimal balance of accuracy and speed for spam multi-classification by converting emails to weighted word vectors emphasizing discriminative terms and finding linear decision boundaries between classes. This works under the assumption that term frequency patterns are sufficient to distinguish spam categories. Break condition: If spam categories require capturing complex semantic relationships, linear models may underperform compared to deep learning approaches.

## Foundational Learning

- Concept: Agglomerative hierarchical clustering and linkage metrics
  - Why needed here: To automatically discover spam topic clusters without pre-labeled data
  - Quick check question: What is the difference between Ward's linkage and single linkage in hierarchical clustering?

- Concept: TF-IDF and Bag of Words text representation
  - Why needed here: To convert raw email text into numerical features suitable for machine learning classifiers
  - Quick check question: How does TF-IDF differ from simple Bag of Words in handling common vs rare words?

- Concept: OCR techniques for text extraction from images and HTML
  - Why needed here: To recover text embedded in images or hidden in HTML that traditional parsers would miss
  - Quick check question: What preprocessing steps improve OCR accuracy on spam email images?

## Architecture Onboarding

- Component map: Raw email → Language detection → HTML/plain text extraction → OCR processing → Text preprocessing → Feature encoding (TF-IDF/BOW/word2vec/BERT) → Classification (SVM/NB/RF/LR) → Category prediction
- Critical path: Feature encoding → Classification, as this determines model accuracy and runtime
- Design tradeoffs: TF-IDF + LR offers best accuracy/runtime tradeoff; word2vec/BERT provide semantic richness but higher computational cost
- Failure signatures: Poor cluster separation indicates spam diversity; low classification accuracy suggests feature encoding issues; high runtime points to inefficient models
- First 3 experiments:
  1. Test OCR text extraction quality on a sample of image-based spam emails
  2. Compare TF-IDF vs BOW performance on the SPEMC dataset
  3. Benchmark classification accuracy and runtime for all 16 pipeline combinations

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How does the proposed hierarchical clustering approach scale to datasets significantly larger than 15K emails, given the noted limitations of high computational time and space complexity?
- Basis in paper: The authors state they used 15K emails due to limitations of hierarchical clustering for large datasets, such as high computational time and space complexity, and human resources to analyze cluster outputs.
- Why unresolved: The paper does not explore alternative clustering approaches or dimensionality reduction techniques that could enable scaling to larger datasets while maintaining performance.
- What evidence would resolve it: Experimental results comparing the proposed approach with scalable alternatives (e.g., approximate clustering, distributed implementations) on datasets of varying sizes, along with computational resource requirements and performance metrics.

### Open Question 2
- Question: How effective are the proposed text preprocessing and OCR techniques for handling increasingly sophisticated spammer tricks, such as adversarial attacks on OCR or advanced hidden text techniques?
- Basis in paper: The authors propose OCR-based techniques to extract visible text from HTML and images, addressing hidden text and image-based spam, but do not evaluate robustness against advanced obfuscation methods.
- Why unresolved: The paper does not test the proposed methods against known adversarial techniques or evolving spammer strategies, leaving uncertainty about long-term effectiveness.
- What evidence would resolve it: Systematic evaluation of the preprocessing pipeline against a benchmark of adversarial spam samples, including OCR-resistant text, steganographic images, and other emerging obfuscation techniques, with performance degradation analysis.

### Open Question 3
- Question: How do the proposed multi-classification models perform on spam datasets with different topic distributions or from different time periods, considering the evolving nature of spam content?
- Basis in paper: The authors acknowledge that spam has a changing nature due to time and techniques used by spammers, but their evaluation is limited to a single dataset from a specific time period.
- Why unresolved: The paper does not assess model generalization across different spam topic distributions or temporal shifts in spam content, which is critical for real-world deployment.
- What evidence would resolve it: Cross-dataset evaluation using spam corpora from different time periods or sources, with performance comparison and analysis of topic distribution shifts, to quantify model robustness and adaptability.

## Limitations
- The study's clustering approach relies heavily on manual inspection for label assignment, which introduces potential subjectivity and limits reproducibility
- While TF-IDF + Logistic Regression shows superior performance, the computational complexity and scalability of the OCR preprocessing pipeline for real-time deployment remains unclear
- The dataset composition represents only 11 spam categories, potentially missing emerging or rare spam types that could affect real-world generalization

## Confidence
- High confidence in the technical methodology for text preprocessing and feature extraction, as these steps follow established NLP practices
- Medium confidence in the clustering-based categorization approach, given the reliance on manual labeling and limited validation of cluster interpretability
- Medium confidence in the comparative performance results, though the absence of baseline comparisons with state-of-the-art spam detection systems limits context

## Next Checks
1. Replicate the hierarchical clustering with different linkage metrics and evaluate stability of the 11-category assignments across multiple runs
2. Test the OCR preprocessing pipeline on a broader sample of image-based spam to assess robustness against various obfuscation techniques
3. Benchmark the TF-IDF + Logistic Regression pipeline against contemporary deep learning approaches using the same SPEMC datasets to establish relative performance gains