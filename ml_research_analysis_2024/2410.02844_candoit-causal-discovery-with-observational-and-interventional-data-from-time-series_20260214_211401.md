---
ver: rpa2
title: 'CAnDOIT: Causal Discovery with Observational and Interventional Data from
  Time-Series'
arxiv_id: '2410.02844'
source_url: https://arxiv.org/abs/2410.02844
tags:
- candoit
- causal
- e-16
- lpcmci
- data
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: CAnDOIT extends LPCMCI to perform causal discovery on time-series
  using both observational and interventional data via context variables. The method
  models interventions as exogenous dummy variables that override parent influences
  while preserving the original causal structure.
---

# CAnDOIT: Causal Discovery with Observational and Interventional Data from Time-Series

## Quick Facts
- arXiv ID: 2410.02844
- Source URL: https://arxiv.org/abs/2410.02844
- Reference count: 40
- Key outcome: CAnDOIT consistently achieves lower False Positive Rates, Uncertainty, and PAG Size compared to LPCMCI, with F1-Score improvements of 0.15-0.35 across synthetic and robotic scenarios.

## Executive Summary
CAnDOIT extends LPCMCI to perform causal discovery on time-series using both observational and interventional data via context variables. The method models interventions as exogenous dummy variables that override parent influences while preserving the original causal structure. Experiments on synthetic models show CAnDOIT consistently achieves lower False Positive Rates, Uncertainty, and PAG Size compared to LPCMCI, indicating better causal graph identifiability. The approach is publicly available and outperforms the state-of-the-art in accuracy and model identifiability.

## Method Summary
CAnDOIT extends LPCMCI by introducing context variables to model interventions. These context variables act as exogenous dummy variables that override parent influences while preserving the original causal structure. The method tests conditional independencies only on the pooled dataset of observational and interventional data, ensuring faithfulness to both data types simultaneously. By intervening on variables with ambiguous links, CAnDOIT can resolve these ambiguities and reduce PAG size and uncertainty.

## Key Results
- CAnDOIT consistently achieves lower False Positive Rates, Uncertainty, and PAG Size compared to LPCMCI
- F1-Score improvements range from 0.15-0.35 across linear and nonlinear systems with hidden confounders
- On a robotic manipulation scenario, CAnDOIT correctly identifies latent confounders that LPCMCI misses

## Why This Works (Mechanism)

### Mechanism 1
CAnDOIT improves causal graph identifiability by modeling interventions as exogenous context variables that override parent influences while preserving the original causal structure. Context variables (C_Xk) are added as parents of intervention targets (X_k) with instantaneous links. When C_Xk is non-zero (intervention mode), it replaces the influence of X_k's original parents. This allows simultaneous representation of observational and interventional data within a single unified causal graph without structural modification.

### Mechanism 2
CAnDOIT maintains faithfulness to the joint distribution of observational and interventional data by testing conditional independencies only on the pooled dataset. Rather than testing independence separately in observational and interventional subsets, CAnDOIT tests on the combined dataset. This ensures the inferred PAG remains faithful to both data types simultaneously, preventing spurious independence conclusions that would arise from subset testing.

### Mechanism 3
CAnDOIT reduces PAG size and uncertainty by leveraging interventional data to eliminate ambiguous links that arise from hidden confounders. By intervening on variables with ambiguous links (marked as and in PAGs), CAnDOIT can determine the correct orientation of these links. Each resolved ambiguity halves the number of equivalent MAGs, directly reducing PAG size according to PAG Size = 2^Uncertainty.

## Foundational Learning

- **Concept: Partial Ancestral Graphs (PAGs) and their interpretation**
  - Why needed here: CAnDOIT outputs time-series PAGs, which require understanding of edge types (→, ←, ↔, , ) and what they represent in terms of ancestral relationships and latent confounders.
  - Quick check question: What does a link X Y in a PAG represent in terms of possible MAGs?

- **Concept: Faithfulness assumption in causal discovery**
  - Why needed here: CAnDOIT requires faithfulness to hold for the joint observational and interventional distribution, which is critical for valid conditional independence testing.
  - Quick check question: Why would testing conditional independence separately on observational and interventional subsets violate faithfulness?

- **Concept: Context variables in causal inference**
  - Why needed here: CAnDOIT's core innovation uses context variables to model interventions; understanding how they function is essential for implementing and debugging the algorithm.
  - Quick check question: How does the context variable C_Xk override the influence of X_k's parents while preserving the original causal structure?

## Architecture Onboarding

- **Component map:** Data Input → Context Block → LPCMCI Engine → Post-processing → Output PAG
- **Critical path:** Data Input → Context Block → LPCMCI Engine → Post-processing → Output PAG
- **Design tradeoffs:** CAnDOIT trades computational speed for improved accuracy and identifiability by introducing context variables and using interventional data.
- **Failure signatures:** Increased execution time, failure to resolve ambiguous links, violation of faithfulness assumption when pooling data.
- **First 3 experiments:**
  1. Run CAnDOIT on synthetic linear system with no hidden confounders and one intervention, compare PAG Size to LPCMCI.
  2. Run CAnDOIT on synthetic nonlinear system with hidden confounders and multiple interventions, verify reduction in Uncertainty.
  3. Run CAnDOIT on Causal World robotic scenario with hidden confounder, verify correct identification of bidirected link.

## Open Questions the Paper Calls Out

- **Open Question 1:** How does the ratio between observational and interventional time-series data length affect CAnDOIT's performance?
  - Basis in paper: The authors mention that evaluating the optimal amount of observational and interventional data is a future research direction.
  - Why unresolved: The paper only briefly mentions this as a future work item without conducting experiments to determine the optimal ratio.
  - What evidence would resolve it: Experiments varying the ratio of observational to interventional data and measuring performance metrics like F1-score and PAG size.

- **Open Question 2:** How does CAnDOIT scale with increasing time-series data length beyond what was tested?
  - Basis in paper: The authors state that scalability is an aspect to be further investigated, having only partially explored it through variable count.
  - Why unresolved: The paper only evaluated scalability in terms of number of variables, not time-series length.
  - What evidence would resolve it: Experiments testing CAnDOIT with increasingly long time-series data and measuring computational time and accuracy.

- **Open Question 3:** Can CAnDOIT be extended to handle soft interventions or unknown intervention targets?
  - Basis in paper: The authors acknowledge that the current version only handles hard interventions on known targets and suggest this as a future extension.
  - Why unresolved: The paper only implements hard interventions with known targets and does not explore other intervention types.
  - What evidence would resolve it: Modifications to the algorithm to handle soft interventions or unknown targets, followed by validation experiments.

## Limitations

- CAnDOIT assumes intervention targets are known and applies interventions sequentially (no simultaneous interventions in the same time interval)
- The method requires sufficient observational data to establish initial causal structure, which may be challenging in highly interventional settings
- The context variable approach adds computational overhead and complexity compared to pure observational methods

## Confidence

- **High confidence:** Improved FPR, Uncertainty, and PAG Size metrics on synthetic data
- **Medium confidence:** F1-Score improvements (0.15-0.35 range) due to variability in real-world applicability
- **Medium confidence:** Robotic manipulation results, as they represent a single application case

## Next Checks

1. Test CAnDOIT on synthetic data with simultaneous interventions to verify failure modes when diagonal design assumption is violated
2. Evaluate performance degradation when intervention targets are partially unknown or misspecified
3. Compare computational overhead and runtime scaling with increasing number of interventions and time lags