---
ver: rpa2
title: 'MemFusionMap: Working Memory Fusion for Online Vectorized HD Map Construction'
arxiv_id: '2409.18737'
source_url: https://arxiv.org/abs/2409.18737
tags:
- memory
- temporal
- fusion
- memfusionmap
- overlap
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes MemFusionMap, a novel temporal fusion model
  for online vectorized HD map construction that addresses the limited memory capacity
  and occlusion challenges of existing single-frame methods. The core method idea
  involves a working memory fusion module that maintains a fixed subset of historical
  BEV features and a temporal overlap heatmap that explicitly encodes temporal overlap
  information and vehicle trajectory.
---

# MemFusionMap: Working Memory Fusion for Online Vectorized HD Map Construction

## Quick Facts
- arXiv ID: 2409.18737
- Source URL: https://arxiv.org/abs/2409.18737
- Reference count: 40
- Maximum improvement of 5.4% in mAP over state-of-the-art methods while maintaining a versatile design for scalability

## Executive Summary
MemFusionMap addresses the limited memory capacity and occlusion challenges of existing single-frame methods for online vectorized HD map construction. The core innovation is a working memory fusion module that maintains a fixed subset of historical BEV features, combined with a temporal overlap heatmap that explicitly encodes temporal overlap information and vehicle trajectory. This dual-component approach significantly improves the model's temporal reasoning capability compared to single-frame methods. Extensive evaluation on nuScenes and Argoverse2 benchmarks demonstrates state-of-the-art performance with a maximum improvement of 5.4% in mAP.

## Method Summary
MemFusionMap introduces a working memory fusion module that maintains a buffer of 4 past BEV features, warps them to current ego-vehicle position, and fuses them with current BEV features through convolutional layers with dilation. The model also incorporates a temporal overlap heatmap that tracks how many times each BEV grid cell has been observed, providing explicit temporal reasoning cues. These components are integrated through a memory fusion block using dilated convolution to enhance the receptive field for better temporal and spatial feature interaction. The two-stage training approach combines single-frame training with temporal training using a streaming strategy and AdamW optimizer with learning rate 5e-4.

## Key Results
- Maximum improvement of 5.4% in mAP over state-of-the-art methods
- Significant performance gains in handling occluded regions through temporal reasoning
- Versatile design maintains scalability while improving temporal reasoning capability

## Why This Works (Mechanism)

### Mechanism 1
- Working memory fusion with a fixed subset of historical BEV features improves temporal reasoning capacity compared to single-frame methods.
- Core assumption: Historical frames contain complementary information about map elements that can help resolve occlusions and improve geometric accuracy.
- Evidence anchors: "Specifically, we contribute a working memory fusion module that improves the model's memory capacity to reason across a history of frames."
- Break condition: If historical frames don't contain complementary information (e.g., all frames are occluded similarly), the working memory fusion provides no benefit.

### Mechanism 2
- Temporal overlap heatmap provides explicit temporal reasoning cues and implicitly encodes vehicle trajectory information.
- Core assumption: The model can effectively use explicit temporal overlap information to weight current vs. historical features appropriately.
- Evidence anchors: "We also design a novel temporal overlap heatmap to explicitly inform the model about the temporal overlap information and vehicle trajectory in the Bird's Eye View space."
- Break condition: If the model cannot effectively interpret the temporal overlap information, the heatmap provides no benefit and may even confuse the model.

### Mechanism 3
- Dilated convolution in the memory fusion block improves receptive field and enables more effective temporal and spatial feature interaction.
- Core assumption: Map elements like lane markings have elongated shapes that benefit from larger receptive fields for better temporal reasoning.
- Evidence anchors: "Therefore, we apply dilated (atrous) convolution [6] in Conv Mem to further improve the working memory fusion module."
- Break condition: If the dilation parameters are not well-tuned, the model may lose local detail or become computationally inefficient.

## Foundational Learning

- **Bird's Eye View (BEV) representation**: Why needed - The task requires constructing HD maps from multi-view camera images by projecting them into BEV space for unified spatial reasoning. Quick check - What is the main advantage of using BEV representation for HD map construction compared to raw camera images?

- **Temporal fusion and recurrence**: Why needed - The model needs to reason across multiple frames to handle occlusions and improve map element accuracy that single-frame methods cannot achieve. Quick check - How does the working memory buffer differ from the GRU-based temporal fusion used in StreamMapNet?

- **Vectorized map representation**: Why needed - The output is a set of polylines representing road elements (lanes, pedestrian crossings, boundaries) rather than rasterized segmentation maps. Quick check - Why are vectorized representations preferred over rasterized maps for downstream planning tasks?

## Architecture Onboarding

- **Component map**: Image Encoder (ResNet-50) -> BEV Encoder (BEVFormer) -> Working Memory Buffer -> Temporal Overlap Heatmap -> Working Memory Fusion Module -> Decoder Head (DETR-based)

- **Critical path**: Image Encoder → BEV Encoder → Working Memory Fusion → Decoder Head

- **Design tradeoffs**:
  - Working memory capacity (4 frames) vs. computational cost: More frames could provide better temporal context but increase memory usage and runtime
  - Dilated convolution vs. standard convolution: Larger receptive field but potentially more parameters
  - Temporal overlap heatmap vs. implicit temporal reasoning: Explicit cues may help but add complexity

- **Failure signatures**:
  - Poor performance on occluded regions: Working memory fusion or temporal overlap heatmap not effectively handling occlusion
  - Geometric inaccuracies in map elements: Dilated convolution parameters not well-tuned for elongated shapes
  - Runtime issues: Working memory buffer size or fusion module too computationally expensive

- **First 3 experiments**:
  1. Verify working memory buffer correctly warps and maintains past BEV features by visualizing warped features at different timestamps
  2. Test temporal overlap heatmap generation by simulating different vehicle speeds and trajectories to confirm correct observation counting
  3. Validate fusion module output by comparing unified BEV features with and without temporal components on simple sequences with known ground truth

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What is the optimal working memory capacity (TWM) for different types of map elements (pedestrian crossings, lane dividers, road boundaries)?
- Basis in paper: The paper conducts ablation studies showing TWM=4 performs best, but notes performance may vary with element types
- Why unresolved: The paper only reports overall mAP and doesn't break down performance by map element type for different TWM values
- What evidence would resolve it: Systematic evaluation of different TWM values for each map element type to identify element-specific optimal capacities

### Open Question 2
- Question: How does MemFusionMap's performance degrade under extreme occlusion scenarios where historical frames provide no useful information?
- Basis in paper: The paper discusses occlusion challenges and demonstrates robustness, but doesn't test scenarios where occlusion spans entire working memory window
- Why unresolved: The paper shows MemFusionMap handles some occlusion cases better than baselines but doesn't explore worst-case occlusion scenarios
- What evidence would resolve it: Experiments with synthetic occlusion patterns that completely block target regions across all working memory frames

### Open Question 3
- Question: What is the relationship between vehicle speed/trajectory patterns and the effectiveness of the temporal overlap heatmap?
- Basis in paper: The paper shows temporal overlap heatmap encodes vehicle speed and trajectory through examples, but doesn't quantify this relationship
- Why unresolved: The paper demonstrates qualitative examples of speed/trajectory encoding but doesn't measure how these patterns affect prediction accuracy
- What evidence would resolve it: Correlation analysis between speed/trajectory complexity metrics and prediction accuracy improvements when using temporal overlap heatmap

## Limitations
- Fixed-size working memory buffer (4 frames) may be insufficient for capturing longer-range temporal dependencies
- Temporal overlap heatmap may struggle with scenarios involving stationary objects or persistent occlusions
- Dilated convolution design lacks empirical validation against alternative receptive field designs

## Confidence
- **High Confidence**: The core mechanism of maintaining historical BEV features and warping them to current ego-position is well-established and directly supported by ablation studies
- **Medium Confidence**: The effectiveness of the temporal overlap heatmap in guiding model attention is supported by qualitative examples but lacks comprehensive quantitative ablation analysis
- **Low Confidence**: The specific dilation parameters (2,2) and their claimed benefits for elongated map elements are presented without comparative analysis

## Next Checks
1. **Ablation on Working Memory Size**: Systematically evaluate the model's performance across different working memory buffer sizes (2, 4, 8, 12 frames) to determine the optimal temporal window for various driving scenarios.

2. **Temporal Overlap Heatmap Robustness**: Test the model's performance on sequences with varying object velocities and occlusion patterns to validate whether the heatmap consistently improves predictions or introduces bias in scenarios where temporal overlap doesn't correlate with prediction reliability.

3. **Dilated Convolution Sensitivity**: Conduct experiments replacing the dilated convolution with standard convolutions and different dilation rates to empirically verify the claimed benefits for elongated map elements and determine if the (2,2) configuration is optimal.