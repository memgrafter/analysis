---
ver: rpa2
title: 'ToNNO: Tomographic Reconstruction of a Neural Network''s Output for Weakly
  Supervised Segmentation of 3D Medical Images'
arxiv_id: '2404.13103'
source_url: https://arxiv.org/abs/2404.13103
tags:
- layercam
- layer
- tomographic
- segmentation
- averaged
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The paper addresses weakly supervised semantic segmentation of
  3D medical images, where only image-level labels indicating the presence or absence
  of a region of interest (e.g., tumors or lesions) are available. The proposed method,
  ToNNO, leverages tomographic reconstruction of a neural network's output to perform
  dense prediction tasks on 3D volumes using any 2D image encoder.
---

# ToNNO: Tomographic Reconstruction of a Neural Network's Output for Weakly Supervised Segmentation of 3D Medical Images

## Quick Facts
- arXiv ID: 2404.13103
- Source URL: https://arxiv.org/abs/2404.13103
- Reference count: 40
- Primary result: Achieves 0.14 F1-score improvement over LayerCAM for 3D weakly supervised segmentation

## Executive Summary
ToNNO presents a novel approach for weakly supervised semantic segmentation of 3D medical images using only image-level labels. The method leverages tomographic reconstruction of neural network outputs by extracting multiple angular projections from 3D volumes, processing them through 2D encoders, and reconstructing dense predictions via inverse Radon transform. Evaluated across four large-scale medical imaging datasets (Multiple Sclerosis, AutoPET, MosMed, Duke), ToNNO demonstrates significant improvements over traditional 2D CAM methods. The paper further extends this approach by combining tomographic reconstruction with CAM techniques, introducing Averaged CAM and Tomographic CAM, which achieve even better performance, particularly in recall metrics.

## Method Summary
ToNNO addresses the challenge of 3D weakly supervised segmentation by treating the 3D volume as a collection of 2D projections at different angles. The method extracts stacks of slices from various angular orientations, feeds them through a standard 2D image encoder, and collects the encoder's output for each projection. These outputs are then combined using inverse Radon transform to reconstruct a 3D heatmap representing the predicted segmentation. This approach enables the use of any existing 2D encoder architecture for 3D segmentation tasks. The paper extends this basic framework by integrating Class Activation Mapping (CAM) techniques, proposing Averaged CAM (which averages CAM heatmaps from multiple angles) and Tomographic CAM (which applies inverse Radon transform to CAM heatmaps before averaging).

## Key Results
- Achieves 0.14 F1-score improvement over LayerCAM on average across tested datasets
- Significant recall improvements on AutoPET and MosMed datasets
- Outperforms traditional 2D CAM methods on four large-scale medical image datasets
- Tomographic CAM demonstrates the best overall performance among the proposed variants

## Why This Works (Mechanism)
The method exploits the principle that 2D projections of a 3D object contain complementary information about its internal structure. By processing multiple angular projections through a 2D encoder and reconstructing the combined information, ToNNO effectively captures 3D spatial relationships without requiring 3D convolutions. The inverse Radon transform serves as a principled way to combine information from different viewing angles, analogous to how CT scanners reconstruct 3D images from X-ray projections. This approach leverages the power of existing 2D encoder architectures while addressing their inherent limitation in capturing volumetric information.

## Foundational Learning

**Weakly Supervised Learning**: Training models with only coarse labels rather than dense annotations. Needed because annotating 3D medical volumes is extremely time-consuming and expensive. Quick check: Verify that only image-level labels (presence/absence) are used during training.

**Class Activation Mapping (CAM)**: Technique for generating visual explanations of CNN predictions by highlighting important regions. Needed as a baseline and extension method for weakly supervised segmentation. Quick check: Confirm CAM implementation follows standard gradient-based or attention-based approaches.

**Radon Transform and Inverse Radon Transform**: Mathematical operations for projecting and reconstructing multidimensional signals. Needed to combine information from multiple angular projections into a coherent 3D prediction. Quick check: Validate that inverse Radon transform is correctly implemented and produces meaningful reconstructions.

**Semantic Segmentation**: Task of assigning class labels to each pixel/voxel in an image. Needed as the target application for converting image-level predictions to dense segmentations. Quick check: Ensure evaluation metrics (F1-score, IoU, etc.) are appropriate for segmentation tasks.

## Architecture Onboarding

Component map: 3D Volume -> Angular Projection Extraction -> 2D Encoder -> Output Collection -> Inverse Radon Transform -> 3D Heatmap

Critical path: The reconstruction pipeline (projection → encoding → inverse transform) is critical as it directly produces the final segmentation output. Any error in this path propagates to the final result.

Design tradeoffs: The method trades computational efficiency for leveraging existing 2D architectures. While requiring multiple forward passes for different projections, it avoids the need for 3D convolutional networks and their associated computational costs.

Failure signatures: Poor reconstruction quality manifests as blurry or incomplete segmentations, particularly at object boundaries. Performance degradation occurs when the angular sampling is insufficient to capture 3D structure.

First experiments:
1. Validate inverse Radon transform reconstruction on synthetic 3D volumes with known structure
2. Compare ToNNO performance with and without CAM extensions on a single dataset
3. Test different numbers of angular projections to find optimal balance between accuracy and computation

## Open Questions the Paper Calls Out
None identified in the provided materials.

## Limitations

- Generalizability to medical imaging modalities beyond the tested conditions (MS, COVID-19 pneumonia, brain tumors) remains uncertain
- Computational overhead of tomographic reconstruction compared to simpler 2D approaches is not thoroughly analyzed
- Performance dependency on different 2D encoder architectures is not systematically explored

## Confidence

- Core tomographic reconstruction methodology: High
- Performance improvements over baseline 2D CAM methods: High
- Specific numerical results on tested datasets: High
- Generalizability to other medical imaging tasks: Medium
- Computational efficiency claims: Low

## Next Checks

1. Benchmark the method on additional medical imaging datasets with different modalities (e.g., CT, ultrasound) to assess generalizability.
2. Conduct ablation studies to isolate the contribution of tomographic reconstruction versus CAM-based components in the extended methods.
3. Perform detailed computational analysis comparing inference times and memory usage between ToNNO and standard 2D CAM approaches across different hardware configurations.