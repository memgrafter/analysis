---
ver: rpa2
title: Universal approximation property of ODENet and ResNet with a single activation
  function
arxiv_id: '2410.16709'
source_url: https://arxiv.org/abs/2410.16709
tags:
- function
- such
- neural
- where
- theorem
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper studies the universal approximation properties of ODENet
  and ResNet. The ODENet is a mathematical model of ResNet-type deep learning systems,
  mapping an initial value to the final value of an ODE system.
---

# Universal approximation property of ODENet and ResNet with a single activation function

## Quick Facts
- arXiv ID: 2410.16709
- Source URL: https://arxiv.org/abs/2410.16709
- Authors: Masato Kimura; Kazunori Matsui; Yosuke Mizuno
- Reference count: 30
- One-line primary result: ODENet and ResNet with restricted vector fields (single activation function + affine mapping) can uniformly approximate those with general vector fields under Lipschitz conditions.

## Executive Summary
This paper establishes the universal approximation property (UAP) for ODENet and ResNet when using a single composition of activation function and affine mapping as the vector field. The authors prove that if the activation function has UAP and satisfies Lipschitz continuity, then ODENet and ResNet with restricted vector fields can uniformly approximate those with general vector fields. The key insight is that by composing activation functions and affine transformations, one can approximate any Lipschitz continuous vector field, and the continuity of the flow map ensures that this approximation translates to the final output.

## Method Summary
The proof strategy involves decomposing the approximation error into three components: approximating general vector fields by piecewise constant approximations in time, approximating piecewise constant functions by functions of the restricted form, and approximating discontinuous functions by smooth functions. The authors leverage the continuity of the flow map with respect to the vector field (established via Gronwall's inequality) to bound the overall approximation error. For ResNet, they show that time-discretization via the explicit Euler method preserves the universal approximation property from continuous ODENet to discrete ResNet.

## Key Results
- ODENet with restricted vector fields (single activation function + affine mapping) can uniformly approximate ODENet with general vector fields
- ResNet inherits the universal approximation property from ODENet through explicit Euler discretization
- The approximation holds in both sup-norm and Lp-norm when the activation function has UAP and satisfies Lipschitz conditions

## Why This Works (Mechanism)

### Mechanism 1
- Claim: ODENet and ResNet with restricted vector fields can uniformly approximate ODENet with general vector fields
- Mechanism: The restricted vector field can approximate any Lipschitz continuous vector field by composing activation functions and affine transformations, then using smoothness of the flow map to bound approximation error
- Core assumption: The activation function has universal approximation property (UAP) and satisfies Lipschitz continuity
- Evidence anchors:
  - [abstract] "if the activation function has universal approximation property and satisfies a Lipschitz condition, then the ODENet with respect to any function satisfying the Lipschitz condition can be approximated by the ODENet with respect to a function of the restricted form."
  - [section 3] "Theorem 3.1 (UAP for ODENet). It holds that S(F)/C0(D;RN) = S(H)/C0(D;RN)"
  - [corpus] Weak evidence - no direct corpus papers on restricted vector field approximation, but related papers on UAP exist
- Break condition: If the activation function does not have UAP or is not Lipschitz continuous, the approximation may fail

### Mechanism 2
- Claim: The flow map associated with the ODE system is continuous with respect to the vector field in the sup-norm
- Mechanism: By Gronwall's inequality, small perturbations in the vector field lead to small changes in the solution flow, enabling uniform approximation of ODENet flows
- Core assumption: The vector field satisfies Lipschitz condition and is bounded
- Evidence anchors:
  - [section 4] "Lemma 4.3. Let f, g : RN × [0, T] → RN satisfy (2.3) and (2.4). ... Then, we have ∥Sf(t) − Sg(t)∥C0(D) ≤ ∥f − g∥L∞(0,T;C0(E))TeLip(f)T"
  - [corpus] Moderate evidence - related papers on ODE flow continuity exist in mathematical literature
- Break condition: If the vector field is not Lipschitz or not bounded, the flow map may not be continuous

### Mechanism 3
- Claim: Time-discretization (Euler method) preserves the universal approximation property from continuous ODENet to discrete ResNet
- Mechanism: Since ODENet has UAP, its discrete counterpart ResNet also has UAP due to the convergence of explicit Euler scheme
- Core assumption: The explicit Euler discretization converges to the continuous ODE solution
- Evidence anchors:
  - [section 1] "From the general discussion on the explicit Euler method, if ODENet has UAP, then ResNet also has UAP"
  - [section 5] "Theorem 3.6. For all f ∈ F and ǫ > 0, there exists sres ∈ Sres such that ∥Sf(T) − sres∥C0(D;RN) < ǫ"
  - [corpus] Moderate evidence - papers on Euler method convergence exist but not specifically for UAP preservation
- Break condition: If the step size is too large or the vector field is too irregular, the discretization error may prevent UAP preservation

## Foundational Learning

- Concept: Universal Approximation Property (UAP)
  - Why needed here: UAP is the core property being studied and extended from general vector fields to restricted ones
  - Quick check question: What is the minimal condition on an activation function to have UAP on all bounded closed subsets?

- Concept: Lipschitz continuity and boundedness
  - Why needed here: These conditions ensure existence/uniqueness of ODE solutions and continuity of flow maps
  - Quick check question: Why is Lipschitz continuity of the vector field necessary for the Picard-Lindelöf theorem?

- Concept: Flow map and its continuity
  - Why needed here: The flow map is the key object being approximated, and its continuity with respect to vector fields enables the main results
  - Quick check question: How does Gronwall's inequality help establish continuity of flow maps?

## Architecture Onboarding

- Component map: Activation function → Vector field construction → ODE solution → Flow map → Approximation error bound
- Critical path: Activation function → Vector field construction → ODE solution → Flow map → Approximation error bound
- Design tradeoffs:
  - Activation function choice: Must have UAP and be Lipschitz
  - Vector field complexity: Restricted form vs. general form
  - Approximation accuracy: Trade-off between smoothness and expressiveness
- Failure signatures:
  - Non-convergence of ODE solutions
  - Large approximation errors despite smooth activation
  - Violation of Lipschitz/boundedness conditions
- First 3 experiments:
  1. Verify UAP of a candidate activation function on a bounded domain
  2. Test flow map continuity for small vector field perturbations
  3. Validate ResNet-ODENet equivalence for simple linear vector fields

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Can ODENet and ResNet with a single activation function approximate any function in higher dimensions (N ≥ 2) under the sup-norm?
- Basis in paper: [explicit] The paper proves the universal approximation property for ODENet and ResNet with a single activation function, but it is not clear whether this holds for higher dimensions
- Why unresolved: The paper only proves the result for one-dimensional cases and does not provide a proof or counterexample for higher dimensions
- What evidence would resolve it: A rigorous mathematical proof or a counterexample demonstrating that the universal approximation property does not hold for higher dimensions would resolve this question

### Open Question 2
- Question: What are the implications of the universal approximation property for the practical implementation of ODENet and ResNet?
- Basis in paper: [inferred] The paper proves the universal approximation property, but it does not discuss the practical implications of this result for the implementation of ODENet and ResNet
- Why unresolved: The paper focuses on the theoretical aspects of the universal approximation property and does not explore its practical implications
- What evidence would resolve it: Empirical studies comparing the performance of ODENet and ResNet with a single activation function to other architectures in practical applications would provide insights into the implications of the universal approximation property

### Open Question 3
- Question: How does the choice of activation function affect the universal approximation property of ODENet and ResNet?
- Basis in paper: [explicit] The paper assumes that the activation function has universal approximation property and satisfies a Lipschitz condition, but it does not explore the impact of different activation functions on the universal approximation property
- Why unresolved: The paper focuses on a specific class of activation functions and does not investigate the effects of different activation functions on the universal approximation property
- What evidence would resolve it: Comparative studies of ODENet and ResNet with different activation functions and their universal approximation properties would provide insights into the impact of the choice of activation function

## Limitations

- The theoretical results rely heavily on Lipschitz continuity and boundedness assumptions that may not hold in all practical neural network applications
- Empirical validation through numerical experiments is limited, leaving open questions about practical performance
- The complexity of the approximating networks needed to achieve desired accuracy is not explicitly quantified

## Confidence

- High Confidence: The theoretical framework for UAP in ODENet with general vector fields is well-established and correctly applied
- Medium Confidence: The extension to restricted vector fields follows logically from the general case, but the specific construction and error bounds require careful verification
- Medium Confidence: The ResNet-ODENet equivalence through time discretization is theoretically sound but depends on practical implementation details

## Next Checks

1. **Numerical Verification:** Implement numerical experiments comparing approximation errors for different activation functions (ReLU, sigmoid, tanh) and varying network depths to empirically validate the theoretical bounds

2. **Counterexample Testing:** Systematically test cases where Lipschitz conditions are violated to understand the breakdown of the approximation property and identify practical failure modes

3. **Complexity Analysis:** Quantify the relationship between approximation accuracy and network complexity (depth/width) for both ODENet and ResNet to understand practical limitations