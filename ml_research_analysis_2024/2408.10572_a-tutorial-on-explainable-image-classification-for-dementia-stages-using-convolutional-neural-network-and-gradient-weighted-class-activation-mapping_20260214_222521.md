---
ver: rpa2
title: A Tutorial on Explainable Image Classification for Dementia Stages Using Convolutional
  Neural Network and Gradient-weighted Class Activation Mapping
arxiv_id: '2408.10572'
source_url: https://arxiv.org/abs/2408.10572
tags:
- image
- layer
- dementia
- images
- deep
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This tutorial paper demonstrates a convolutional neural network
  (CNN) combined with Gradient-weighted Class Activation Mapping (Grad-CAM) to classify
  four stages of dementia using MRI brain images. The CNN model, consisting of nine
  layers, achieves over 99% accuracy on a test dataset of 642 images.
---

# A Tutorial on Explainable Image Classification for Dementia Stages Using Convolutional Neural Network and Gradient-weighted Class Activation Mapping

## Quick Facts
- arXiv ID: 2408.10572
- Source URL: https://arxiv.org/abs/2408.10572
- Reference count: 28
- Over 99% classification accuracy achieved for four dementia stages

## Executive Summary
This tutorial demonstrates a CNN-Grad-CAM approach for classifying four stages of dementia using MRI brain images. The nine-layer CNN architecture achieves over 99% accuracy on a test dataset of 642 images, while Grad-CAM visualizations explain predictions by highlighting relevant brain regions. The method handles an imbalanced dataset with 6,400 images across four dementia stages, showing promise for medical image analysis and explainable AI applications.

## Method Summary
The method combines a CNN for classification with Grad-CAM for explainability. The CNN architecture consists of three convolutional layers (128, 256, 256 filters), two max-pooling layers, one flatten layer, and two dense layers (256, 4 neurons). The model is trained on 128x128 grayscale MRI images from an Alzheimer's dataset, with 80% train, 10% validation, and 10% test split. Grad-CAM generates heatmaps by computing gradients of the predicted class with respect to the final convolutional layer's feature maps, creating visualizations that highlight important regions in the images.

## Key Results
- CNN model achieves 99.69% test accuracy on 642 images
- All precision, recall, and F1-scores are very close to 100% across all classes
- Only two misclassifications occur (mild dementia predicted as very mild)
- Grad-CAM successfully visualizes important brain regions for each prediction

## Why This Works (Mechanism)

### Mechanism 1
Grad-CAM visualization explains CNN predictions by highlighting brain regions most relevant to dementia stage classification. The method computes gradients of the predicted class with respect to the final convolutional layer's feature maps, multiplies these by feature map activations, and averages across channels to produce a heatmap superimposed on the original image.

### Mechanism 2
The CNN architecture achieves >99% accuracy due to effective hierarchical feature extraction from MRI images. Three convolutional layers with increasing filter counts progressively learn more abstract representations, while max-pooling preserves salient features for classification.

### Mechanism 3
Imbalanced class distribution does not degrade performance due to the CNN's robust feature learning capabilities. Despite severe imbalance (50% non-dementia, 1% moderate dementia), the model learns discriminative features that generalize across classes.

## Foundational Learning

- **Concept:** Convolutional Neural Networks (CNNs) for image classification
  - Why needed here: The core task is classifying dementia stages from MRI images, which requires learning spatial hierarchies of features.
  - Quick check question: What is the purpose of using multiple convolutional layers with increasing filter counts in the CNN architecture?

- **Concept:** Gradient-weighted Class Activation Mapping (Grad-CAM)
  - Why needed here: To provide visual explanations for the CNN's predictions, making the model interpretable for medical practitioners.
  - Quick check question: How does Grad-CAM use gradients to create a heatmap that highlights important regions in the input image?

- **Concept:** Handling imbalanced datasets in machine learning
  - Why needed here: The dataset has a severe class imbalance (1% moderate dementia), which can bias models toward majority classes if not properly addressed.
  - Quick check question: What are common techniques to handle imbalanced datasets, and why might they not be necessary in this case?

## Architecture Onboarding

- **Component map:** Input Layer (128x128) -> Conv2D(128 filters) -> MaxPooling2D -> Conv2D(256 filters) -> MaxPooling2D -> Conv2D(256 filters, named "lastConv") -> Flatten -> Dense(256) -> Dense(4, named "output_layer")

- **Critical path:**
  1. Load and preprocess MRI images (128x128 grayscale, normalized to [0,1])
  2. Build CNN model with specified architecture
  3. Train model using training set with validation monitoring
  4. Evaluate model on test set for accuracy metrics
  5. Generate Grad-CAM visualizations for sample predictions
  6. Analyze visualizations for medical interpretability

- **Design tradeoffs:**
  - Simplicity vs. complexity: The nine-layer architecture is simpler than state-of-the-art models but achieves high accuracy, trading potential performance gains for easier interpretation and faster training.
  - Depth vs. spatial resolution: Deeper networks might capture more abstract features but would lose spatial detail needed for localizing brain regions relevant to dementia.
  - Imbalanced data handling: No explicit resampling techniques were used, relying on the CNN's ability to learn from limited minority class examples.

- **Failure signatures:**
  - Overfitting: Perfect training accuracy (100%) with slightly lower validation accuracy (98.28%) suggests potential overfitting, which might manifest as poor generalization to new datasets.
  - Misclassification patterns: The two misclassified instances were both mild dementia cases predicted as very mild, indicating possible confusion between adjacent stages.
  - Grad-CAM artifacts: If Grad-CAM highlights irrelevant brain regions or produces noisy heatmaps, it may indicate the model is relying on spurious correlations rather than meaningful features.

- **First 3 experiments:**
  1. **Sanity check data loading:** Verify that ImageDataGenerator correctly loads and preprocesses images, and that class distributions in training, validation, and test sets match expectations.
  2. **Model architecture validation:** Print model summary to confirm layer configurations, parameter counts, and output shapes match the described architecture.
  3. **Training convergence test:** Train for a few epochs and monitor accuracy and loss curves to ensure the model is learning and not stuck in poor local minima.

## Open Questions the Paper Calls Out

### Open Question 1
How do medical practitioners validate the clinical significance of Grad-CAM heatmaps in identifying dementia stages? The authors state that "the heatmap results require further justification from the medical partitioners, which is suggested for future study."

### Open Question 2
Would different CNN architectures or hyperparameters improve performance beyond the current 99.69% accuracy? The authors suggest "future works may include the exploration and comparisons of different CNN structures with different explainable visualisation methods."

### Open Question 3
How does the model perform on data from different MRI scanners or preprocessing pipelines? The model was trained on a specific pre-processed Kaggle dataset without cross-platform validation.

### Open Question 4
Can the model distinguish between different types of dementia (Alzheimer's vs vascular vs Lewy body) beyond progressive stages? The dataset only includes progressive stages, not different dementia pathologies.

## Limitations

- Lack of transparency regarding model hyperparameters and training configuration
- No cross-validation or testing on independent datasets for generalizability assessment
- High accuracy achieved without explicit handling of severe class imbalance
- Limited clinical applicability due to lack of patient demographic and acquisition protocol details

## Confidence

- **High Confidence:** The fundamental methodology combining CNN with Grad-CAM for medical image classification is sound and well-established.
- **Medium Confidence:** The reported accuracy metrics and classification performance, while impressive, lack sufficient detail on validation procedures and hyperparameter tuning.
- **Low Confidence:** The claim of handling severe class imbalance without explicit balancing techniques and the model's ability to generalize to clinical settings without further validation.

## Next Checks

1. **Hyperparameter Sensitivity Analysis:** Systematically vary learning rate, batch size, and optimizer settings to determine their impact on model performance and identify optimal configurations.

2. **Cross-Validation and External Testing:** Implement k-fold cross-validation and test the model on an independent dataset to assess generalizability and rule out overfitting.

3. **Clinical Relevance Assessment:** Collaborate with medical experts to evaluate the clinical utility of Grad-CAM visualizations and validate whether highlighted regions align with known biomarkers for dementia progression.