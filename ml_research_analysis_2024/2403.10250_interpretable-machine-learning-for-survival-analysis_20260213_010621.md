---
ver: rpa2
title: Interpretable Machine Learning for Survival Analysis
arxiv_id: '2403.10250'
source_url: https://arxiv.org/abs/2403.10250
tags:
- survival
- feature
- time
- features
- data
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper provides a comprehensive review and formal adaptation
  of interpretable machine learning (IML) methods for survival analysis. It addresses
  the challenge of interpreting black-box survival models by adapting commonly used
  IML techniques like ICE, PDP, ALE, H-statistics, and feature importance measures
  to handle time-to-event data with censoring.
---

# Interpretable Machine Learning for Survival Analysis

## Quick Facts
- arXiv ID: 2403.10250
- Source URL: https://arxiv.org/abs/2403.10250
- Authors: Sophie Hanna Langbein; Mateusz Krzyziński; Mikołaj Spytek; Hubert Baniecki; Przemysław Biecek; Marvin N. Wright
- Reference count: 40
- Primary result: Comprehensive review and formal adaptation of IML methods for survival analysis, demonstrating their utility on breast cancer recurrence data

## Executive Summary
This paper provides a comprehensive review and formal adaptation of interpretable machine learning (IML) methods for survival analysis. It addresses the challenge of interpreting black-box survival models by adapting commonly used IML techniques like ICE, PDP, ALE, H-statistics, and feature importance measures to handle time-to-event data with censoring. The authors introduce new survival-specific variants of these methods and apply them to real-world breast cancer recurrence data, demonstrating their utility in uncovering model behavior and feature effects. Results show that methods like SurvSHAP(t) provide time-dependent feature attributions, while PFI and ALE plots reveal important predictors and interactions. The work bridges the gap between IML theory and survival analysis, offering practical guidance for researchers. Limitations include computational complexity and challenges in visualizing time-dependent explanations. Overall, the paper advances the interpretability of survival models, enabling better understanding and trust in machine learning predictions for critical applications like healthcare.

## Method Summary
The paper adapts existing IML techniques to survival analysis by extending them to handle time-dependent predictions and censored data. Key adaptations include: defining ICE curves to show how model predictions vary over time for a given instance when a feature changes; extending PDP to visualize average effects over time; adapting ALE to provide unbiased estimates of feature effects while controlling for correlations; extending H-statistics to measure interactions between features in survival models; and developing SurvSHAP(t) to provide time-dependent Shapley value explanations. The authors implement these methods in the survex R package and apply them to the GBSG2 breast cancer recurrence dataset, demonstrating how these adapted methods can reveal feature importance, interactions, and model behavior over time.

## Key Results
- SurvSHAP(t) provides time-dependent feature attributions that preserve SHAP's game-theoretic properties while accommodating the functional nature of survival predictions
- ALE plots effectively reveal feature effects and interactions in the presence of correlated features, avoiding the extrapolation bias of PDP
- Feature importance measures (PFI, PermImportance) identify key predictors like tumor size and hormonal therapy status for breast cancer recurrence
- The adapted IML methods successfully uncover model behavior and feature effects in black-box survival models, enhancing interpretability

## Why This Works (Mechanism)

### Mechanism 1
- **Claim**: The paper formalizes and adapts model-agnostic IML methods to handle survival analysis with censored data, enabling meaningful interpretation of black-box survival models.
- **Mechanism**: It extends methods like ICE, PDP, ALE, H-statistics, and feature importance measures by incorporating time as a dimension and adapting them to handle right-censored survival outcomes. For example, ICE curves are redefined to show how model predictions vary over time for a given instance when a feature changes, and partial dependence plots are extended to visualize average effects over time.
- **Core assumption**: Survival model outputs (e.g., survival probabilities or cumulative hazard functions) can be treated as functions over time and thus be subject to the same IML techniques used for static predictions.
- **Evidence anchors**:
  - [abstract] "formally detail how commonly used IML methods... can be adapted to survival outcomes"
  - [section 2.1.1] "we present a formal adaption of the partial dependence concept to survival analysis"
- **Break condition**: If the survival model output cannot be expressed as a time-dependent function or if censoring is handled in a way incompatible with marginal/conditional averaging.

### Mechanism 2
- **Claim**: SurvSHAP(t) provides time-dependent Shapley value explanations for survival models, preserving the game-theoretic properties of SHAP while accounting for the functional nature of survival predictions.
- **Mechanism**: SurvSHAP(t) computes Shapley values at each timepoint, measuring the marginal contribution of each feature to the difference between the predicted survival function for an instance and the average predicted survival function. This is done using the Shapley sampling values algorithm and KernelSHAP adapted for functional outputs.
- **Core assumption**: The Shapley value framework can be extended to functional outputs by treating each timepoint independently and aggregating the results over time.
- **Evidence anchors**:
  - [abstract] "methods like SurvSHAP(t) provide time-dependent feature attributions"
  - [section 2.1.4] "SurvSHAP(t) extends the foundational SHAP properties rooted in game theory, including local accuracy, missingness, and consistency, to accommodate the time-dependent nature of the explanation"
- **Break condition**: If the model predictions are not additive or if the survival function is not differentiable with respect to feature coalitions.

### Mechanism 3
- **Claim**: Accumulated Local Effects (ALE) plots provide unbiased estimates of feature effects in the presence of correlated features, avoiding the extrapolation issues of Partial Dependence Plots.
- **Mechanism**: ALE computes the derivative of the prediction function with respect to a feature, averages it over the conditional distribution of other features, and then integrates the result. This isolates the main effect of a feature while controlling for correlations.
- **Core assumption**: The feature of interest can be ordered (numerical or ordinal) and the prediction function is differentiable with respect to that feature.
- **Evidence anchors**:
  - [section 2.2.2] "ALE extends M-plots to obtain an unbiased estimate for the main effects of a feature of interest"
  - [section 2.2.2] "ALE has the advantage of allowing for a hierarchical estimation of components, avoiding the computational complexities associated with an estimation of the joint distribution"
- **Break condition**: If features are highly non-linearly correlated or if the prediction function is not smooth enough for derivative estimation.

## Foundational Learning

- **Concept**: Survival analysis basics (survival function, hazard function, cumulative hazard function, censoring)
  - Why needed here: The entire paper builds on the idea that survival models produce time-dependent outputs that need to be interpreted. Understanding these functions is essential to grasp how IML methods are adapted.
  - Quick check question: What is the relationship between the hazard function and the survival function?

- **Concept**: Censoring in survival analysis
  - Why needed here: Most IML methods assume complete data; adapting them to censored data requires understanding how censoring affects estimation and interpretation.
  - Quick check question: How does right-censoring affect the Kaplan-Meier estimator?

- **Concept**: Shapley values and game theory
  - Why needed here: SurvSHAP(t) is based on Shapley values; understanding the fairness and consistency properties of Shapley values is key to appreciating why SurvSHAP(t) is a meaningful extension.
  - Quick check question: What does it mean for a feature attribution method to satisfy the "local accuracy" property?

## Architecture Onboarding

- **Component map**: Survival model fitting -> IML method adaptation (ICE, PDP, ALE, H-stats, PFI, SHAP) -> Time discretization -> Visualization and interpretation -> Software implementation (survex R package)
- **Critical path**: Fit survival model -> adapt IML method for time-dependent output -> compute explanations at each timepoint -> aggregate or visualize results -> interpret
- **Design tradeoffs**: Time-dependent methods are more informative but computationally heavier; marginal plots are simpler but can be biased with correlated features; SHAP-based methods are theoretically sound but may be noisy
- **Failure signatures**: Extrapolation bias (PDP), noisy attributions (SHAP), inability to capture interactions (ALE), computational intractability (high-order interactions)
- **First 3 experiments**:
  1. Apply ICE and PDP to a simple CoxPH model on the GBSG2 dataset and compare the results
  2. Compute ALE plots for correlated features and compare to PDP to see the bias reduction
  3. Generate SurvSHAP(t) explanations for a random survival forest and visualize the time-dependent feature attributions

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can time-dependent feature effects in survival models be visualized in a cognitively intelligible way for end-users, particularly in medical domains?
- Basis in paper: [explicit] The paper discusses the challenge of complex visualizations for time-dependent explanations, noting that balancing comprehensive presentation with transparency and cognitive intelligibility is a central challenge.
- Why unresolved: The paper highlights this as a future research direction but does not provide a concrete solution. The complexity of time-dependent explanations makes it difficult to present them in an interpretable manner without oversimplifying or losing important nuances.
- What evidence would resolve it: Development and evaluation of novel visualization techniques specifically designed for time-dependent survival explanations, with user studies demonstrating their effectiveness in conveying complex information to medical practitioners.

### Open Question 2
- Question: What are the most effective methods for selecting timepoints for discretization in time-dependent interpretability methods, and how do these selections impact the quality of explanations?
- Basis in paper: [explicit] The paper identifies the lack of reporting on timepoint selection criteria and notes that the number and values of timepoints can significantly impact explanation results, especially for methods that aggregate over time intervals.
- Why unresolved: There is no established guideline or best practice for selecting timepoints, and the impact of different selection strategies on explanation quality is not well understood. The paper suggests this is a critical area for future research.
- What evidence would resolve it: Comparative studies evaluating the impact of different timepoint selection strategies on the stability and interpretability of survival explanations, along with the development of robust guidelines for timepoint selection.

### Open Question 3
- Question: How can interpretability methods for survival analysis be extended to handle competing risks and time-varying features, which are supported by many machine learning survival models but not adequately addressed by current methods?
- Basis in paper: [explicit] The paper notes that most discussed explanation methods are tailored to right-censoring and time-constant features, limiting their applicability to more complex scenarios like competing risks or time-varying features.
- Why unresolved: Extending interpretability methods to these scenarios requires addressing additional complexities, such as the need to account for multiple types of events or changes in feature values over time, which are not currently well-handled by existing approaches.
- What evidence would resolve it: Development and validation of interpretability methods specifically designed for competing risks and time-varying features, with empirical studies demonstrating their effectiveness in real-world survival analysis applications.

## Limitations
- The computational complexity of time-dependent explanations, particularly SurvSHAP(t), may limit their practical applicability in large-scale or real-time settings
- Most methods are tailored to right-censoring and time-constant features, limiting their applicability to more complex scenarios like competing risks or time-varying features
- The lack of established guidelines for selecting timepoints in time-dependent methods can impact the quality and comparability of explanations

## Confidence

**High Confidence**: The core adaptation of PDP, ICE, and ALE methods to survival analysis is well-grounded in existing literature and the mathematical formulations are clearly presented. The use of these methods to identify feature effects and interactions over time is supported by the empirical results on the GBSG2 dataset.

**Medium Confidence**: The extension of SHAP values to SurvSHAP(t) is theoretically sound but may face practical challenges in implementation and interpretation. The time-dependent nature of the explanations may introduce additional complexity and potential instability, particularly when dealing with small sample sizes or high-dimensional feature spaces.

**Low Confidence**: The adaptation of H-statistics to survival analysis is mentioned but not thoroughly explored or validated in the paper. The potential for capturing higher-order interactions is promising but requires further investigation to assess its practical utility and limitations.

## Next Checks

1. **Stress Test with Synthetic Data**: Generate synthetic survival datasets with known feature effects and interactions, including various censoring mechanisms. Apply the adapted IML methods to verify their ability to recover the ground truth feature attributions and interactions.

2. **Computational Efficiency Analysis**: Evaluate the computational complexity and scalability of the time-dependent IML methods, particularly SurvSHAP(t), on datasets of varying sizes and feature dimensions. Assess the trade-off between interpretability and computational cost.

3. **Robustness to Censoring Mechanisms**: Investigate the performance of the adapted IML methods under different censoring scenarios (e.g., independent, informative, heavy censoring). Quantify the impact of censoring on the accuracy and reliability of the feature attributions and explanations.