---
ver: rpa2
title: Unlocking Legal Knowledge with Multi-Layered Embedding-Based Retrieval
arxiv_id: '2411.07739'
source_url: https://arxiv.org/abs/2411.07739
tags: []
core_contribution: This paper introduces a multi-layered embedding-based retrieval
  method for legal texts, creating embeddings at multiple levels of granularity (documents,
  articles, clauses, etc.) to capture the hierarchical structure of legal knowledge.
  The method improves upon traditional flat chunking approaches by providing more
  semantically relevant chunks for Retrieval Augmented Generation systems.
---

# Unlocking Legal Knowledge with Multi-Layered Embedding-Based Retrieval

## Quick Facts
- **arXiv ID:** 2411.07739
- **Source URL:** https://arxiv.org/abs/2411.07739
- **Reference count:** 40
- **Primary result:** Multi-layered embeddings achieved 37.86% essential chunks vs 16.39% for flat chunking in Brazilian Constitution retrieval

## Executive Summary
This paper introduces a multi-layered embedding-based retrieval method that creates embeddings at multiple levels of granularity (documents, articles, clauses, etc.) to capture the hierarchical structure of legal knowledge. The approach improves upon traditional flat chunking by providing more semantically relevant chunks for Retrieval Augmented Generation systems. When tested on the Brazilian Constitution, the method showed significantly better retrieval quality, particularly for complex articles with multiple provisions. The hierarchical approach preserves semantic relationships between legal provisions while reducing redundant and unnecessary chunks in retrieval results.

## Method Summary
The method segments legal documents into a hierarchical structure: document level, component level (books, titles, chapters), basic unit hierarchy (articles), basic unit (article content), basic unit components (paragraphs, clauses), and enumeration level. Embeddings are generated for each chunk at every level using text-embedding-3-large with 256 dimensions. These embeddings are stored in a vector database and retrieved using cosine similarity with filtering based on token limits (2500) and similarity thresholds (25% deviation). The multi-layered approach allows retrieval to match queries at appropriate levels of granularity while preserving structural relationships between legal provisions.

## Key Results
- Multi-layered approach achieved 37.86% essential chunks vs 16.39% for flat chunking
- Reduced unnecessary chunks from 75.41% (flat) to significantly lower levels
- Demonstrated particular advantages for semantically dense articles like Article 5 of the Brazilian Constitution

## Why This Works (Mechanism)

### Mechanism 1
Hierarchical chunking produces embeddings that better capture semantic relevance than flat chunking. By creating embeddings at multiple levels of granularity, the system preserves structural relationships between legal provisions, allowing retrieval to match queries at appropriate levels. This works because legal texts have inherent hierarchical structure that carries semantic meaning beyond individual article content. The approach breaks down when legal texts lack meaningful hierarchical structure or when queries always require fine-grained detail.

### Mechanism 2
Multi-layer approach reduces redundant and unnecessary chunks in retrieval. By embedding both specific provisions and their broader contexts, the system can select semantically consistent chunks without overlap. This mechanism assumes that overlapping text ranges between different granularity levels create redundancy that hurts retrieval quality. The method breaks down if cosine similarity filtering fails to effectively prioritize relevant chunks.

### Mechanism 3
Semantic chunking at multiple levels enables better handling of semantically dense articles. Articles with many provisions are represented by multiple embeddings, allowing retrieval to distinguish between related but distinct concepts. This works because dense articles contain multiple distinct semantic themes that require separate embeddings for accurate retrieval. The approach fails when query embeddings cannot distinguish between concepts within dense articles.

## Foundational Learning

- **Cosine similarity and vector embeddings**: Why needed - The system relies on comparing query embeddings with chunk embeddings to retrieve relevant content. Quick check - How does cosine similarity measure semantic similarity between two text embeddings?

- **Hierarchical document structures**: Why needed - Legal texts follow specific structural patterns (articles, paragraphs, clauses) that the system exploits. Quick check - What are the key structural levels in Brazilian legal documents and how do they relate to each other?

- **Retrieval Augmented Generation (RAG) pipeline**: Why needed - The system uses RAG to combine retrieved legal text chunks with generation for answering queries. Quick check - What are the three main phases of a RAG system and how does embedding-based retrieval fit into this architecture?

## Architecture Onboarding

- **Component map**: Text processing pipeline (hierarchical chunking) -> Embedding generation (multi-layer) -> Vector database (stores all embeddings) -> Retrieval engine (cosine similarity + filtering) -> RAG generator (combines context with query)

- **Critical path**: 1. Input legal text → hierarchical chunking 2. Generate embeddings for each chunk level 3. Store embeddings in vector database 4. Query embedding → similarity search 5. Filter and rank chunks based on similarity and overlap 6. Generate response using top chunks

- **Design tradeoffs**: More layers = better granularity but higher storage/compute costs; Larger embeddings = better semantic capture but slower retrieval; Strict filtering = more focused results but risk missing relevant context

- **Failure signatures**: Too many unnecessary chunks returned (poor similarity filtering); Missing critical context (insufficient higher-level embeddings); Semantic overload in dense articles (inadequate hierarchical representation)

- **First 3 experiments**: 1. Compare retrieval accuracy using single article-level embeddings vs multi-layer approach on simple queries 2. Test filtering effectiveness by measuring reduction in unnecessary chunks while maintaining essential ones 3. Evaluate performance on semantically dense articles by comparing retrieval quality between flat and hierarchical methods

## Open Questions the Paper Calls Out

### Open Question 1
Does the multi-layered embedding approach maintain its advantages when applied to common law legal systems with less hierarchical document structures? The paper only tested the method on Brazilian legal texts which have a highly structured hierarchy. The authors acknowledge this is an open question but provide no evidence about cross-system applicability. Comparative testing on common law legal documents would resolve this question.

### Open Question 2
What is the optimal number of embedding dimensions for legal text retrieval, and does increasing dimensions beyond 256 provide measurable performance gains? The paper used 256 dimensions as a proof-of-concept but did not explore the performance trade-offs of using higher dimensions within the model's 3072-dimension capacity. Systematic testing across different embedding dimensions would resolve this question.

### Open Question 3
How can inter-article relationships (cross-references and dependencies) be effectively embedded to improve legal information retrieval? The paper proposes this as a future research direction but does not implement or test methods for capturing relationships between different articles or provisions. Implementation and testing of various approaches for embedding inter-article relationships would resolve this question.

## Limitations
- Limited generalizability - tested only on Brazilian Constitution with highly structured hierarchy
- Computational overhead - generating multiple embeddings per document increases storage and processing requirements
- Dependence on hierarchical segmentation quality - requires domain expertise for correct implementation

## Confidence
- High confidence in the mechanism of hierarchical chunking preserving semantic relationships
- Medium confidence in the generalizability across legal systems
- Medium confidence in the practical scalability for large legal corpora
- High confidence in the specific performance metrics reported for the Brazilian Constitution

## Next Checks
1. Test the multi-layered approach on legal documents from different jurisdictions (US, EU, common law systems) to evaluate cross-system generalizability
2. Conduct ablation studies to quantify the contribution of each hierarchical level to overall retrieval performance
3. Measure the computational overhead and storage requirements compared to flat chunking approaches on corpora of varying sizes