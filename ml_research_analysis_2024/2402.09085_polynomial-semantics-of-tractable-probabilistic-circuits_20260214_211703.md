---
ver: rpa2
title: Polynomial Semantics of Tractable Probabilistic Circuits
arxiv_id: '2402.09085'
source_url: https://arxiv.org/abs/2402.09085
tags:
- polynomial
- circuit
- circuits
- polynomials
- computing
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper establishes that various polynomial representations
  of binary probability distributions (network, likelihood, generating, and Fourier
  polynomials) are all equivalent in terms of expressive efficiency - any circuit
  computing one can be transformed into a circuit computing any other with only polynomial
  increase in size. The key insight is that while these polynomials have different
  semantic meanings, they can all be transformed into each other through systematic
  procedures.
---

# Polynomial Semantics of Tractable Probabilistic Circuits

## Quick Facts
- arXiv ID: 2402.09085
- Source URL: https://arxiv.org/abs/2402.09085
- Authors: Oliver Broadrick; Honghua Zhang; Guy Van den Broeck
- Reference count: 18
- Primary result: Different polynomial representations of binary probability distributions are equivalent under polynomial transformations

## Executive Summary
This paper establishes that various polynomial representations of binary probability distributions (network, likelihood, generating, and Fourier polynomials) are all equivalent in terms of expressive efficiency. The key insight is that while these polynomials have different semantic meanings, they can all be transformed into each other through systematic procedures. The authors provide explicit transformation algorithms showing that given a circuit of size s computing any of these polynomials, a circuit computing any other polynomial can be obtained with size O(n²s) for binary variables. They also show that these transformations preserve tractability for marginal inference and explore the extension to categorical variables, proving that marginal inference becomes #P-hard in that case.

## Method Summary
The paper systematically studies the relationships between different polynomial representations of probability distributions using arithmetic circuits. It provides explicit transformation algorithms between network, likelihood, generating, and Fourier polynomials, proving that any circuit for one polynomial type can be transformed into a circuit for any other type with only polynomial increase in size (O(n²s)). The method involves removing division nodes, variable substitution, and domain transformations between {0,1} and {-1,1}. The authors also explore categorical extensions and prove hardness results for marginal inference in that setting.

## Key Results
- Any circuit computing one polynomial representation can be transformed into a circuit computing any other polynomial representation with only O(n²s) size increase
- All four polynomial representations (network, likelihood, generating, Fourier) are tractable for marginal inference on the same class of binary distributions
- Extending probabilistic generating circuits to categorical random variables makes marginal inference #P-hard
- The paper provides explicit algorithms for polynomial transformations and proves their correctness

## Why This Works (Mechanism)

### Mechanism 1
- Claim: Polynomial representations of binary probability distributions (network, likelihood, generating, and Fourier) are equivalent in expressive efficiency.
- Mechanism: Each circuit computing one polynomial type can be systematically transformed into a circuit computing any other polynomial type with only polynomial size increase (O(n²s) where s is the original circuit size).
- Core assumption: All polynomials are multilinear and compute the same probability distribution on binary variables {0,1}^n.
- Evidence anchors:
  - [abstract] "any circuit for one of them can be transformed into a circuit for any of the others with only a polynomial increase in size"
  - [section] "we show that given a circuit computing any of these polynomials, we can transform it to a circuit for any of the others in polynomial time"
  - [corpus] Weak - corpus neighbors discuss tractable marginalization but don't directly confirm polynomial equivalence
- Break condition: If polynomials are not multilinear or compute different distributions, the equivalence breaks down.

### Mechanism 2
- Claim: Marginal inference remains tractable across all polynomial representations.
- Mechanism: The polynomial transformations preserve the tractability property - any circuit that enables efficient marginal inference for one polynomial type will enable efficient marginal inference for all polynomial types.
- Core assumption: The structural properties enabling tractable inference (like decomposability) are preserved through the polynomial transformations.
- Evidence anchors:
  - [abstract] "They are therefore all tractable for marginal inference on the same class of distributions"
  - [section] "we study the circuit representations for multilinear polynomials of different semantics, and find that they all are tractable for marginal probabilities regardless of the circuit structure"
  - [corpus] Moderate - corpus includes work on tractable probabilistic circuits but doesn't explicitly verify marginal inference preservation
- Break condition: If the transformation introduces non-multilinear components or destroys decomposability, marginal inference may become intractable.

### Mechanism 3
- Claim: Categorical extension of generating polynomials loses tractability (#P-hard inference).
- Mechanism: When extending from binary (multilinear) to categorical variables, the generating polynomials become non-multilinear, which fundamentally breaks the tractability of inference.
- Core assumption: The polynomial complexity of categorical generating polynomials makes inference computationally hard.
- Evidence anchors:
  - [abstract] "we explore the natural extension of one such polynomial semantics, called probabilistic generating circuits, to categorical random variables, and establish that marginal inference becomes #P-hard"
  - [section] "we propose to generalize them to categorical PGCs such that the non-multilinear generating polynomials they represent have well-known categorical semantics. Unfortunately, we show that inference in a categorical PGC with n random variables and k > 3 categories is #P-hard"
  - [corpus] Moderate - corpus includes hardness results for probabilistic models but doesn't directly confirm categorical PGC hardness
- Break condition: If a polynomial-time algorithm for categorical generating polynomial inference is discovered, this mechanism would break.

## Foundational Learning

- Concept: Multilinear polynomials
  - Why needed here: All polynomial representations studied are multilinear, and multilinearity is crucial for tractable inference
  - Quick check question: What property do all four polynomial types (network, likelihood, generating, Fourier) share that enables tractable inference?

- Concept: Arithmetic circuits
  - Why needed here: Circuits provide the compact representation for polynomials and enable the polynomial transformations
  - Quick check question: How do sum nodes, product nodes, and leaf nodes in arithmetic circuits combine to represent a polynomial?

- Concept: Polynomial equivalence and transformation
  - Why needed here: The core result shows that different polynomial representations are equivalent and can be transformed into each other
  - Quick check question: What is the maximum size increase when transforming between different polynomial representations?

## Architecture Onboarding

- Component map: Polynomial representation module -> Circuit transformation engine -> Inference module -> Categorical extension handler
- Critical path: Circuit → Polynomial type identification → Transformation selection → Circuit transformation → Inference computation
- Design tradeoffs:
  - Generality vs. efficiency: Supporting all polynomial types adds flexibility but may reduce optimization opportunities
  - Memory vs. speed: Storing intermediate circuits during transformation uses more memory but speeds up the process
  - Categorical support vs. tractability: Including categorical extensions would add expressiveness but at the cost of tractability
- Failure signatures:
  - Exponential blowup during transformation (indicates polynomial equivalence doesn't hold)
  - Marginal inference taking exponential time (indicates tractability was lost)
  - Division by zero errors (indicates polynomial identity breakdown)
- First 3 experiments:
  1. Implement transformation from network polynomial circuit to generating polynomial circuit and verify polynomial equivalence
  2. Test marginal inference speed on transformed circuits vs. original circuits
  3. Attempt categorical extension and verify that inference becomes #P-hard (should fail to compute efficiently)

## Open Questions the Paper Calls Out

### Open Question 1
- Question: Is there a more direct and natural transformation between likelihood polynomials p(x) and Fourier transforms ˆp(x) without going through the path p → p−1,1 → g → p−1,1 → ˆp?
- Basis in paper: [explicit] The paper notes that while there is a path between p and ˆp through other transformations, "there is a symmetric set of transformations that compute ˆp from p in a more natural way" and mentions that "it is more common to define the binary Fourier transform ˆp of p in terms of its Fourier expansion."
- Why unresolved: The paper describes an indirect path but doesn't provide a direct transformation algorithm. The symmetric transformations mentioned are not fully developed.
- What evidence would resolve it: A direct polynomial-time transformation algorithm between p and ˆp that doesn't require going through intermediate polynomial representations.

### Open Question 2
- Question: Can the hardness results for categorical PGCs be circumvented by restricting to special classes of categorical distributions?
- Basis in paper: [explicit] The paper shows that inference in categorical PGCs with k > 3 categories is #P-hard, but notes "This motivates the need to research tractable categorical distributions, e.g. possibly in the direction suggested by Cao et al. [2023]."
- Why unresolved: The hardness proof relies on the general case, but doesn't explore whether restricted subclasses of categorical distributions might still be tractable.
- What evidence would resolve it: Identification of specific structural properties of categorical distributions that allow for tractable inference in PGCs, or a proof that no such properties exist.

### Open Question 3
- Question: How do these polynomial transformations behave under approximate inference or learning scenarios?
- Basis in paper: [inferred] The paper focuses on exact polynomial transformations and tractability, but doesn't address how these transformations would work when approximations are introduced (e.g., in learning or inference with limited resources).
- Why unresolved: All transformations are proven for exact computation, but real-world applications often require approximations.
- What evidence would resolve it: Analysis of how approximation errors propagate through these transformations, and whether the polynomial-size guarantees still hold under approximate computation.

### Open Question 4
- Question: Are there other polynomial representations beyond network, likelihood, generating, and Fourier polynomials that could be equivalently expressive?
- Basis in paper: [explicit] The paper mentions "various polynomial semantics have been considered in the literature" and lists "network polynomials, likelihood polynomials, generating functions, Fourier transforms, and characteristic polynomials" as examples, suggesting there may be others.
- Why unresolved: The paper proves equivalence among four specific representations but doesn't exhaustively characterize all possible polynomial representations of distributions.
- What evidence would resolve it: A complete characterization of polynomial representations that are equivalent to network polynomials under polynomial-size transformations, or a proof of limitations on such equivalence.

## Limitations

- The paper focuses exclusively on binary random variables, leaving the behavior for non-binary cases partially explored
- While the #P-hardness of categorical extensions is claimed, the proof details are not provided in the abstract
- The O(n²s) transformation complexity assumes specific circuit properties that may not hold in all practical implementations

## Confidence

- Polynomial equivalence claim: High confidence (supported by established arithmetic circuit theory)
- Tractability preservation: Medium-High confidence (reasonable but requires implementation verification)
- Categorical extension hardness: Medium confidence (theoretically sound but needs proof verification)

## Next Checks

1. Implement and test the polynomial transformation algorithms on diverse circuit structures to verify the O(n²s) complexity bound holds in practice
2. Verify that marginal inference remains tractable across all polynomial representations by timing inference on transformed circuits
3. Construct a concrete example of a categorical generating polynomial circuit and attempt inference to empirically confirm #P-hardness