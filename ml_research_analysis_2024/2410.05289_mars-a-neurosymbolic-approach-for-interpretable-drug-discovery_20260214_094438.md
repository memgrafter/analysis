---
ver: rpa2
title: 'MARS: A neurosymbolic approach for interpretable drug discovery'
arxiv_id: '2410.05289'
source_url: https://arxiv.org/abs/2410.05289
tags:
- mars
- which
- drug
- rule
- node
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: The study addresses interpretability challenges in drug discovery
  by proposing mechanism-of-action (MoA) deconvolution using a neurosymbolic approach
  called MARS. MARS dynamically learns rule weights to guide path-finding through
  knowledge graphs, aiming to predict drug effects while providing interpretable explanations.
---

# MARS: A neurosymbolic approach for interpretable drug discovery

## Quick Facts
- arXiv ID: 2410.05289
- Source URL: https://arxiv.org/abs/2410.05289
- Reference count: 24
- Primary result: MARS achieves Hits@10 of 0.788 and MRR of 0.535 on MoA-net-10k while maintaining interpretable rule-based predictions

## Executive Summary
This study addresses interpretability challenges in drug discovery by proposing mechanism-of-action (MoA) deconvolution using a neurosymbolic approach called MARS. The system dynamically learns rule weights to guide path-finding through knowledge graphs, aiming to predict drug effects while providing interpretable explanations. By introducing a two-hop joint probability update method (P2H), MARS achieves state-of-the-art performance while maintaining rule-based predictions and identifying reasoning shortcuts driven by node degree bias rather than domain-based rules.

## Method Summary
MARS uses a deep reinforcement learning agent to traverse knowledge graphs and predict drug-biological process relationships. The agent takes L=4 length paths through the MoA-net KG, guided by dynamically learned rule weights that reflect the relative usefulness of each metapath-based rule. The reward function combines base reward (for finding true node pairs) with supplementary reward (for following metapath-based rules), with a hyperparameter λ controlling their relative importance. Rule weights are updated during training using either naive frequency-based updates or the P2H algorithm, which computes probabilities based on two-hop fragments to detect and mitigate degree bias. The system is trained using the Adam optimizer with REINFORCE and early stopping based on validation MRR.

## Key Results
- MARS P2H achieves state-of-the-art performance with Hits@10 of 0.788 and MRR of 0.535 on MoA-net-10k
- Correctly identifies known MoAs for 33 drug-BP pairs through interpretable path explanations
- Demonstrates degree bias mitigation by showing performance drops on permuted KG while maintaining performance on original KG
- Pruned metrics (rule-based predictions) show strong correlation with standard metrics, indicating rule-following behavior

## Why This Works (Mechanism)

### Mechanism 1: Dynamic Rule Weight Learning
MARS improves interpretability by dynamically learning rule weights that reflect the relative usefulness of each metapath-based rule in the prediction task. The system initializes all rule weights uniformly (0.5) and updates them during training using either naive frequency-based updates or the P2H algorithm. These updates guide the agent toward more informative paths while bypassing assumptions about pre-assigned rule weights. The core assumption is that learned rule weights accurately reflect the importance of each metapath-based rule to the prediction task, and updating these weights during training improves both performance and interpretability.

### Mechanism 2: P2H Degree Bias Detection
The P2H algorithm identifies and mitigates reasoning shortcuts driven by degree bias rather than domain-based rules. P2H computes the probability of each metapath-based rule based on the joint probability of its two-hop fragments, allowing the system to identify when predictions are driven by node degree bias rather than the intended rules. This insight enables mitigation strategies like KG trimming. The core assumption is that degree bias in KG predictions can be detected by analyzing the relationship between rule weights and the prevalence of certain relations, and this bias can be mitigated through appropriate preprocessing.

### Mechanism 3: Balanced Reward Optimization
MARS achieves state-of-the-art performance while maintaining interpretability through balanced reward optimization. The reward function combines base reward (for finding true node pairs) with supplementary reward (for following metapath-based rules), with a hyperparameter λ controlling their relative importance. This balance encourages both accurate predictions and rule-following behavior. The core assumption is that the dual-reward structure effectively balances the need for accurate predictions with the desire for interpretable, rule-based reasoning, and the λ hyperparameter can be tuned to achieve this balance.

## Foundational Learning

- **Knowledge Graph Structure**
  - Why needed here: Understanding nodes, edges, relations, and metapaths is essential for implementing MARS and interpreting its predictions
  - Quick check question: What is the difference between a metapath and a path in a knowledge graph?

- **Reinforcement Learning Basics**
  - Why needed here: MARS uses deep RL to train an agent that traverses the KG to find connections between drugs and biological processes
  - Quick check question: How does the reward function in MARS differ from standard RL reward functions?

- **Interpretability in Machine Learning**
  - Why needed here: The study focuses on achieving interpretability in drug discovery, requiring understanding of what makes a model interpretable and how to evaluate interpretability
  - Quick check question: What is the difference between associative patterns and mechanistic patterns in the context of drug mechanism-of-action?

- **Degree Bias in Graph Neural Networks**
  - Why needed here: The study identifies degree bias as a key reasoning shortcut, requiring understanding of how node degree affects predictions
  - Quick check question: How does node degree distribution affect link prediction performance in knowledge graphs?

## Architecture Onboarding

- **Component map:** Input KG (MoA-net) -> Agent with LSTM memory -> Reward function -> Rule weight update mechanism -> Output predicted drug-BP connections

- **Critical path:** 1. Agent starts at drug node 2. Takes L=4 transitions through KG following learned policy 3. Terminal node evaluated against true BP pairs 4. Path compared against metapath-based rules 5. Reward calculated and used to update agent policy and rule weights 6. Process repeats until convergence

- **Design tradeoffs:** Rule-based vs. black-box approaches (sacrifices some performance for interpretability), KG trimming (reduces complexity but may lose information), reward balance (λ tuning required), trajectory length (longer paths capture more complex MoAs but increase computational cost)

- **Failure signatures:** Poor pruned metrics indicate agent not following rules despite their availability, consistently low weights on certain relation types suggest degree bias, performance drops on permuted KG indicate reliance on node degree rather than semantics, high variance across training runs suggests instability in weight updates

- **First 3 experiments:** 1. Run MARS on MoA-net without any rule weights (λ=0) to establish baseline performance 2. Implement naive weight updates and compare pruned vs. standard metrics 3. Apply P2H updates and verify improvement in both performance and interpretability metrics

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What specific modifications to the two-hop joint probability (P2H) algorithm could improve its performance on denser knowledge graphs without compromising interpretability?
- Basis in paper: The paper discusses that MARS P2H works well on MoA-net-10k (a trimmed version) but acknowledges that scaling to denser KGs requires further exploration
- Why unresolved: The authors suggest potential directions like merging high-degree nodes or using domain knowledge about promiscuous proteins, but do not implement or evaluate these approaches
- What evidence would resolve it: Experimental results comparing MARS P2H with various modifications on different knowledge graph densities, demonstrating improved performance while maintaining interpretability

### Open Question 2
- Question: How can we objectively determine whether reasoning shortcuts exist in models that do not provide interpretable explanations like MARS?
- Basis in paper: The paper highlights the challenge of measuring calibration in biomedical domains and notes that reasoning shortcuts can't be objectively identified for models without interpretable explanations
- Why unresolved: The authors compare pruned metrics (rule-based predictions) to standard metrics to assess MARS, but acknowledge this doesn't reveal whether all other predictions follow unintended semantics
- What evidence would resolve it: Development and validation of quantitative metrics or methods that can detect reasoning shortcuts in black-box models by analyzing their behavior patterns and comparing them against known domain knowledge

### Open Question 3
- Question: What is the optimal balance between using mechanistic rules and associative patterns for drug discovery tasks across different knowledge graph domains?
- Basis in paper: The paper finds that MARS and other models initially rely on associative patterns for accuracy but that these patterns don't represent mechanistic MoAs, leading to degree bias issues
- Why unresolved: The authors demonstrate that removing associative patterns reduces performance, but also show that mechanistic rules alone (like DWPC) underperform. The optimal trade-off remains unclear
- What evidence would resolve it: Systematic experiments across multiple drug discovery tasks and knowledge graph domains that quantify the trade-off between mechanistic accuracy and predictive performance when varying the proportion of rule-based versus associative pattern guidance

## Limitations
- Findings based on a single knowledge graph (MoA-net) and drug discovery domain, limiting generalizability
- P2H algorithm requires extensive hyperparameter tuning that may limit practical deployment
- Performance improvement comes from a trimmed KG version (MoA-net-10k), raising questions about scalability to full KGs

## Confidence
- High confidence: MARS outperforms baseline models on standard metrics and correctly identifies known MoAs for 33 drug-BP pairs
- Medium confidence: The degree bias detection and mitigation approach generalizes beyond the drug discovery domain
- Medium confidence: The interpretability of MARS predictions aligns with domain expert expectations

## Next Checks
1. Test MARS P2H on additional knowledge graphs from different domains (e.g., academic citation networks, biological interaction networks) to assess generalizability of degree bias findings
2. Conduct ablation studies to quantify the contribution of each component (rule weights, P2H, KG trimming) to overall performance
3. Implement a human evaluation study where domain experts assess the plausibility of MARS-generated MoA explanations compared to ground truth mechanisms