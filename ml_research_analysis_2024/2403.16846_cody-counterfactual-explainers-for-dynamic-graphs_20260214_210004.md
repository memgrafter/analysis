---
ver: rpa2
title: 'CoDy: Counterfactual Explainers for Dynamic Graphs'
arxiv_id: '2403.16846'
source_url: https://arxiv.org/abs/2403.16846
tags:
- counterfactual
- cody
- greedy
- search
- predictions
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper addresses the challenge of explaining Temporal Graph
  Neural Networks (TGNNs) for dynamic graphs, where existing methods focus on factual
  explanations rather than counterfactual ones. To tackle this, the authors introduce
  CoDy, a model-agnostic method that leverages Monte Carlo Tree Search with heuristic
  selection strategies to efficiently explore the search space of counterfactual subgraphs.
---

# CoDy: Counterfactual Explainers for Dynamic Graphs

## Quick Facts
- arXiv ID: 2403.16846
- Source URL: https://arxiv.org/abs/2403.16846
- Reference count: 40
- Primary result: Introduces CoDy, a model-agnostic method using Monte Carlo Tree Search to find counterfactual explanations for Temporal Graph Neural Networks on dynamic graphs

## Executive Summary
This paper addresses the challenge of explaining Temporal Graph Neural Networks (TGNNs) for dynamic graphs, where existing methods focus on factual explanations rather than counterfactual ones. The authors introduce CoDy, a model-agnostic method that leverages Monte Carlo Tree Search with heuristic selection strategies to efficiently explore the search space of counterfactual subgraphs. CoDy identifies counterfactual examples by modifying past events in the input graph, aiming to alter the model's predictions. The proposed method is evaluated against state-of-the-art baselines on three real-world datasets, demonstrating superior performance with up to 59% higher success rate in finding significant counterfactual inputs.

## Method Summary
CoDy employs Monte Carlo Tree Search (MCTS) to systematically explore the space of possible graph modifications that could change a model's prediction. The method uses heuristic selection strategies, including spatio-temporal and local-gradient approaches, to guide the search toward promising counterfactual subgraphs. By focusing on modifying past events in the dynamic graph, CoDy generates actionable explanations that reveal which changes would have altered the model's decision. The approach is designed to be model-agnostic, making it applicable to various TGNN architectures without requiring access to internal model parameters.

## Key Results
- CoDy achieves up to 59% higher success rate in finding significant counterfactual inputs compared to state-of-the-art baselines
- Heuristic strategies, particularly spatio-temporal and local-gradient approaches, consistently deliver high-quality explanations
- CoDy successfully balances necessity and sufficiency in counterfactual explanations across three real-world datasets

## Why This Works (Mechanism)
CoDy works by leveraging Monte Carlo Tree Search to efficiently navigate the combinatorial space of possible graph modifications. The heuristic selection strategies guide the search toward modifications that are most likely to produce meaningful counterfactuals based on temporal and structural patterns in the data. By focusing on modifying past events rather than the entire graph structure, the method generates explanations that are both computationally tractable and practically relevant. The model-agnostic design allows CoDy to identify counterfactuals without requiring access to internal model parameters, making it broadly applicable across different TGNN architectures.

## Foundational Learning
- **Monte Carlo Tree Search**: A search algorithm that balances exploration and exploitation to find optimal solutions in large decision spaces; needed for efficiently navigating the combinatorial space of graph modifications
- **Temporal Graph Neural Networks**: Neural networks designed to process dynamic graph data with temporal dependencies; needed as the target models for explanation
- **Counterfactual explanations**: Explanations that describe what changes to input data would have resulted in different model predictions; needed to provide actionable insights into model behavior
- **Heuristic selection strategies**: Methods for guiding search algorithms toward promising regions of the solution space; needed to improve search efficiency and explanation quality
- **Dynamic graph representation**: Techniques for encoding temporal graph data in a form suitable for machine learning; needed as the input format for both TGNNs and CoDy

## Architecture Onboarding

**Component Map**
Graph Preprocessing -> MCTS Core -> Heuristic Selector -> Counterfactual Generator -> Evaluation Module

**Critical Path**
The critical path involves MCTS exploring graph modifications guided by heuristic selectors, with the counterfactual generator producing explanations and the evaluation module assessing their quality against baseline methods.

**Design Tradeoffs**
- Model-agnostic approach vs. potential performance gains from model-specific optimizations
- Computational efficiency of MCTS vs. thoroughness of search space exploration
- Actionability of explanations vs. complexity of modifications required

**Failure Signatures**
- Poor performance on graphs with sparse temporal dynamics
- Inability to find counterfactuals when the original prediction is highly confident
- Computational timeouts on very large dynamic graphs

**3 First Experiments**
1. Test CoDy on a simple synthetic dynamic graph with known ground truth counterfactuals
2. Compare MCTS with different heuristic strategies on a medium-sized real-world dataset
3. Evaluate scalability by running CoDy on graphs with increasing numbers of nodes and temporal steps

## Open Questions the Paper Calls Out
None

## Limitations
- Computational complexity of MCTS may not scale efficiently to very large dynamic graphs with millions of nodes and edges
- Heuristic selection strategies may introduce bias toward certain types of counterfactual examples and potentially miss other valid explanations
- Evaluation relies on synthetic perturbations rather than human judgment of explanation quality, limiting assessment of practical interpretability

## Confidence
- Effectiveness of CoDy in finding counterfactual examples: **High** (supported by quantitative results showing 59% improvement)
- Superiority of heuristic strategies: **Medium** (consistent performance across datasets but limited strategy comparison)
- Actionability of explanations: **Low** (not empirically validated with domain experts or downstream tasks)

## Next Checks
1. Conduct user studies with domain experts to evaluate the interpretability and actionability of CoDy-generated explanations in real-world scenarios
2. Test scalability on larger dynamic graphs with varying temporal resolutions and edge densities to assess computational efficiency
3. Compare explanation quality against ground truth causal interventions in controlled synthetic environments where true counterfactuals are known