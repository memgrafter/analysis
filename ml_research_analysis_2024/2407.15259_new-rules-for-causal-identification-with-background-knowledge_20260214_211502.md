---
ver: rpa2
title: New Rules for Causal Identification with Background Knowledge
arxiv_id: '2407.15259'
source_url: https://arxiv.org/abs/2407.15259
tags:
- path
- causal
- possible
- directed
- adjustment
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper proposes two novel orientation rules, R12 and R13, for
  incorporating background knowledge (BK) into partial mixed graphs in the presence
  of latent confounders. Unlike existing rules that transform edges based on a few
  edges or paths, R12 considers a subgraph involving an unbridged path and possible
  directed paths from a vertex to every vertex in the unbridged path.
---

# New Rules for Causal Identification with Background Knowledge

## Quick Facts
- arXiv ID: 2407.15259
- Source URL: https://arxiv.org/abs/2407.15259
- Reference count: 40
- Authors propose novel orientation rules R12 and R13 for incorporating background knowledge into partial mixed graphs with latent confounders

## Executive Summary
This paper introduces two novel orientation rules, R12 and R13, designed to incorporate background knowledge into partial mixed graphs (PMGs) in the presence of latent confounders. Unlike existing rules that operate on single edges or small paths, R12 considers subgraphs involving unbridged paths and possible directed paths, while R13 generalizes existing rules by extending to uncovered possible directed paths. The authors prove these rules are sound for incorporating background knowledge and demonstrate their applicability in the set determination task, where the goal is to determine possible causal effects given a partial ancestral graph (PAG) identified from observational data.

## Method Summary
The authors propose two novel orientation rules (R12 and R13) for incorporating background knowledge into partial mixed graphs. R12 transforms an edge based on unbridged paths and possible directed paths to every vertex in the path, while R13 extends edges to uncovered possible directed paths. These rules are implemented within the PAGcauses algorithm framework, eliminating the need to enumerate exponential block sets when determining adjustment sets. The approach leverages the structure of partial ancestral graphs and background knowledge to efficiently identify causal effects in the presence of latent confounders.

## Key Results
- R12 and R13 are proven sound for incorporating background knowledge into partial mixed graphs
- The rules eliminate the need for exponential enumeration of block sets in the set determination task
- R12 generalizes existing rules by considering subgraphs involving unbridged paths and directed paths to all vertices in the path
- R13 extends existing rules by transforming edges based on uncovered possible directed paths

## Why This Works (Mechanism)

### Mechanism 1
- Claim: R12 and R13 generalize existing orientation rules by considering subgraphs and uncovered possible directed paths instead of single edges or small paths.
- Mechanism: R12 transforms an edge A◦−∗B to A←∗B if there is an unbridged path relative to SA and possible directed paths from A to every vertex in the unbridged path. R13 transforms the edge if there is an uncovered possible directed path from A to an ancestor of SA.
- Core assumption: The unbridged path property ensures that in any MAG consistent with the PMG, vertices in the path must be ancestors of SA, enabling correct orientation.
- Evidence anchors:
  - [abstract] "R12 considers a subgraph involving an unbridged path and possible directed paths from a vertex to every vertex in the unbridged path."
  - [section 3] "R12 is more complicated, since R12 considers not only the unbridged path, but also the large number of paths from A in R12 to every vertex in the unbridged path, which form a sub-graph."
  - [corpus] Weak - no direct supporting evidence from corpus neighbors.
- Break condition: If the unbridged path property doesn't hold (e.g., due to incorrect background knowledge), R12 may produce incorrect orientations.

### Mechanism 2
- Claim: By incorporating R12 into PAGcauses, the algorithm can avoid enumerating exponential block sets when determining adjustment sets.
- Mechanism: R12 allows direct identification of vertices that must be ancestors of SA, enabling construction of block sets without enumeration. The algorithm updates S by incorporating Anc(B, M) ∩ T when R12 triggers.
- Core assumption: When R12 triggers, the transformed edges represent valid background knowledge that can be used to expand the block set S.
- Evidence anchors:
  - [abstract] "we show that these rules are applicable in some typical causality tasks, such as determining the set of possible causal effects with observational data."
  - [section 4.2] "As discussed in Sec. 4.1, given a potential adjustment set W, an exponential complexity of enumerating all the block sets is involved... In the following, we show that enumerating block sets can be avoided by introducing R12."
  - [corpus] Weak - no direct supporting evidence from corpus neighbors.
- Break condition: If R12 triggers incorrectly (due to invalid background knowledge), the constructed block set S may be incorrect, leading to wrong adjustment set determination.

### Mechanism 3
- Claim: The rules are sound for incorporating background knowledge in the presence of latent confounders.
- Mechanism: Theorem 1 proves that R12 and R13 maintain consistency with all MAGs in the MEC represented by the PAG, ensuring sound orientation of edges based on background knowledge.
- Core assumption: The background knowledge is correct and there exist MAGs consistent with both the PMG and the background knowledge.
- Evidence anchors:
  - [abstract] "The authors prove that R12 and R13 are sound for incorporating BK."
  - [section 3] "Theorem 1. R12 and R13 are sound to incorporate BK."
  - [corpus] Weak - no direct supporting evidence from corpus neighbors.
- Break condition: If the background knowledge is incorrect or inconsistent with the PAG, the rules may produce orientations that are not valid in any MAG consistent with the original PAG.

## Foundational Learning

- Concept: Markov equivalence class (MEC) and PAG representation
  - Why needed here: Understanding that observational data only identifies a MEC of causal graphs, not a unique DAG, is fundamental to why background knowledge is needed.
  - Quick check question: If we observe X and Y are d-separated given Z in all DAGs in a MEC, what does this tell us about the PAG representation of this MEC?

- Concept: Maximal ancestral graph (MAG) and latent confounders
  - Why needed here: MAGs are used to represent causal relations among observable variables when latent confounders are present, which is the setting where R12 and R13 operate.
  - Quick check question: In a MAG, what is the difference between a directed edge A→B and a bi-directed edge A↔B?

- Concept: Adjustment sets and covariate adjustment
  - Why needed here: The application to set determination task requires understanding how adjustment sets are used to estimate causal effects from observational data.
  - Quick check question: Given a DAG with X→Y←Z, what adjustment set would you use to estimate the causal effect of X on Y?

## Architecture Onboarding

- Component map: PAG P -> Transform circles at X -> Obtain maximal local MAGs -> Find potential adjustment sets -> Algorithm 2 verification -> Set of possible causal effects
- Critical path: For a given PAG and target causal effect, transform circles at X → obtain maximal local MAGs → find potential adjustment sets → use Algorithm 2 to verify adjustment sets without enumeration → return set of possible causal effects
- Design tradeoffs: The rules R12 and R13 are more complex than existing rules but provide stronger orientation capabilities. This complexity is traded for avoiding exponential enumeration in the set determination task.
- Failure signatures: If background knowledge is incorrect, the rules may produce orientations inconsistent with the true causal structure. If the PAG is misidentified from data, the entire process will be based on incorrect assumptions.
- First 3 experiments:
  1. Test R12 and R13 on a simple PAG with known background knowledge to verify they produce correct orientations.
  2. Compare the runtime of PAGrules (with R12) versus original PAGcauses on a benchmark dataset to measure the improvement from avoiding block set enumeration.
  3. Test the sensitivity of the rules to incorrect background knowledge by introducing small errors and observing how the orientation results degrade.

## Open Questions the Paper Calls Out

### Open Question 1
- Question: What are the necessary and sufficient conditions for a sound and complete set of rules to incorporate background knowledge into partial mixed graphs in the presence of latent confounders?
- Basis in paper: [explicit] The authors propose two novel rules (R12 and R13) and state that they are sound for incorporating background knowledge, but note that the thorough result for causal identification with any kinds of background knowledge in the presence of latent confounders remains elusive.
- Why unresolved: The paper does not provide a complete set of rules or prove completeness for incorporating all possible types of background knowledge.
- What evidence would resolve it: A set of rules that are both sound and complete for incorporating any type of background knowledge into partial mixed graphs with latent confounders, along with a proof of completeness.

### Open Question 2
- Question: Can the proposed rules R12 and R13 be generalized or extended to other causal inference tasks beyond set determination and incorporating background knowledge?
- Basis in paper: [inferred] The authors demonstrate the applicability of R12 and R13 in set determination and mention that even without background knowledge, the rules are applicable in some typical causality tasks. However, they do not explore other potential applications.
- Why unresolved: The paper focuses on specific applications and does not investigate the broader applicability of the rules.
- What evidence would resolve it: Successful application of R12 and R13 to other causal inference tasks, such as causal effect estimation, causal structure learning, or counterfactual inference, with theoretical justification and empirical validation.

### Open Question 3
- Question: How do the proposed rules R12 and R13 perform in terms of computational efficiency and scalability compared to existing methods when applied to large-scale causal inference problems?
- Basis in paper: [explicit] The authors claim that their rule-based approach enhances the state-of-the-art method by circumventing a process of enumerating block sets, which reduces an exponential complexity. However, they do not provide a comprehensive empirical comparison with existing methods.
- Why unresolved: The paper presents theoretical complexity analysis but lacks extensive empirical evaluation on large-scale problems.
- What evidence would resolve it: Empirical studies comparing the performance of R12 and R13-based methods with existing approaches on large-scale causal inference problems, measuring runtime, memory usage, and accuracy.

## Limitations

- The rules' complexity makes them computationally intensive compared to simpler orientation rules
- Soundness critically depends on the correctness of background knowledge, with no clear mechanism for handling incorrect BK
- Completeness is not established - some valid orientations from background knowledge might be missed

## Confidence

**High Confidence:** The basic mechanism of R12 and R13 (transforming edges based on unbridged paths and uncovered possible directed paths) is well-defined and theoretically grounded. The proof of soundness (Theorem 1) provides strong theoretical support for the rules' validity when background knowledge is correct.

**Medium Confidence:** The claim that incorporating R12 eliminates the need for exponential block set enumeration is supported by the theoretical argument but would benefit from empirical validation. The complexity reduction is logical given the rule's properties, but practical performance depends on implementation details not fully specified in the paper.

**Low Confidence:** The paper lacks empirical validation - no experiments are presented to demonstrate the rules' performance on real or synthetic data. The claims about applicability to typical causality tasks remain theoretical without evidence of practical utility.

## Next Checks

1. **Soundness verification on synthetic examples:** Create a series of synthetic PAGs with known background knowledge and verify that R12 and R13 produce orientations consistent with the ground truth causal structure.

2. **Empirical complexity comparison:** Implement PAGcauses with and without R12, then measure the runtime difference on benchmark causal discovery datasets with varying numbers of variables and edges.

3. **Sensitivity analysis to incorrect BK:** Systematically introduce controlled errors into background knowledge and measure how the orientation results degrade, establishing bounds on the rules' robustness to BK errors.