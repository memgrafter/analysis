---
ver: rpa2
title: 'Industrial-Grade Time-Dependent Counterfactual Root Cause Analysis through
  the Unanticipated Point of Incipient Failure: a Proof of Concept'
arxiv_id: '2407.11056'
source_url: https://arxiv.org/abs/2407.11056
tags:
- causal
- root
- failure
- data
- cause
- transformers
- self-attention
- retrieval-augmented-generation
- instruction-tuning
- parameter-efficient-finetuning
- mixture-of-experts
- chain-of-thought
core_contribution: This paper presents a proof-of-concept for industrial-grade counterfactual
  root cause analysis in multivariate time series environments, focusing on detecting
  the Point of Incipient Failure where anomalies first appear. The method combines
  causal discovery using PC algorithms with time lags and Dynamic Causal Bayesian
  Networks to model system behavior.
---

# Industrial-Grade Time-Dependent Counterfactual Root Cause Analysis through the Unanticipated Point of Incipient Failure: a Proof of Concept

## Quick Facts
- arXiv ID: 2407.11056
- Source URL: https://arxiv.org/abs/2407.11056
- Reference count: 12
- Key outcome: Proof-of-concept for detecting root causes at Point of Incipient Failure in multivariate time series using causal discovery and counterfactual analysis on synthetic 2-out-of-3 redundancy system

## Executive Summary
This paper presents a proof-of-concept for industrial-grade counterfactual root cause analysis in multivariate time series environments, focusing on detecting the Point of Incipient Failure where anomalies first appear. The method combines causal discovery using PC algorithms with time lags and Dynamic Causal Bayesian Networks to model system behavior. Experimental results on a synthetic 2-out-of-3 redundancy system show the approach can identify root causes through likelihood-ranked causal paths, with the most probable path achieving 0.0505 likelihood. Counterfactual analysis demonstrates that a single variable intervention can explain the observed anomaly. The work addresses the research gap in learning system condition transitions rather than just anomaly detection, though current maturity is at Technology Readiness Level 3. The paper outlines avenues for improvement including handling real-world data challenges, heteroskedasticity, and scaling considerations.

## Method Summary
The approach combines causal discovery with Dynamic Causal Bayesian Networks (DCBN) to identify root causes at the Point of Incipient Failure in multivariate time series. First, the PC algorithm with Fisher-Z independence test is applied to time-lagged data to discover causal structure. This structure is then used to build a Dynamic CBN that models temporal dependencies. The Point of Incipient Failure is detected by identifying the first inflection point where failure probability increases significantly. Counterfactual analysis through algorithmic recourse evaluates potential interventions that could have prevented the observed anomaly by simulating different values at the Point of Incipient Failure.

## Key Results
- The approach successfully identifies the Point of Incipient Failure as the moment when anomalous behavior first appears in the system
- Causal structure learning correctly identifies the root cause path with the highest likelihood (0.0505) through the learned DCBN
- Counterfactual analysis demonstrates that a single variable intervention at the Point of Incipient Failure can explain the observed anomaly
- The method effectively models system condition transitions rather than just detecting anomalies

## Why This Works (Mechanism)

### Mechanism 1
- Claim: The method identifies root causes by detecting the Point of Incipient Failure (T) where anomaly probability first increases significantly.
- Mechanism: The approach tracks the probability of failure over time and identifies T as the first inflection point where the second derivative exceeds a threshold Θ. This captures when the system first begins abnormal behavior before full failure.
- Core assumption: The root cause exists at or near T, and anomaly probability increases monotonically after T.
- Evidence anchors:
  - [section] "The learned DCBN shall be used to estimate the probability of the Failure variable XF in time PF (t)... To detect if an anomaly is present, the Point of Incipient Failure T should be determined. This is the moment in time when the system starts developing an abnormal behavior that will eventually lead to the crash."
  - [abstract] "It drives the attention toward the Point of Incipient Failure, which is the moment in time when the anomalous behavior is first observed, and where the root cause is assumed to be found before the issue propagates."
  - [corpus] Weak evidence - corpus neighbors focus on root cause diagnosis but don't specifically discuss incipient failure detection.

### Mechanism 2
- Claim: The Dynamic Causal Bayesian Network (DCBN) structure enables time-dependent causal discovery and probabilistic inference.
- Mechanism: DCBN extends Bayesian networks by explicitly modeling time slices with interslice edges connecting variables across time and intraslice edges within the same time. This captures temporal dependencies and causal precedence.
- Core assumption: The causal structure can be learned from observational time series data using PC or PC-MCI algorithms with time lags.
- Evidence anchors:
  - [section] "The Dynamic CBN (DCBN) yield a factorized representation of a stochastic process. They extend the standard causal Bayesian network formalism by providing explicit discrete temporal dimensions."
  - [section] "The proposed approach initially infers the causal relations from observational time series event data... An initial baseline is obtained with the PC algorithm (using the Fisher-Z independence test) on data augmented with time lags."
  - [corpus] Moderate evidence - several corpus papers discuss causal discovery in time series, supporting this approach.

### Mechanism 3
- Claim: Counterfactual analysis through algorithmic recourse can identify interventions that would have prevented the observed anomaly.
- Mechanism: The approach evaluates P(Yt=T+|do(Xt=T+1), Xt=T+, Yt=T+) to estimate how the alarm would have behaved if the root cause variable had different values at the Point of Incipient Failure.
- Core assumption: Interventions on the identified root cause can change the outcome, and the causal model is correctly specified.
- Evidence anchors:
  - [section] "Algorithmic Recourse explores these counterfactual worlds... such environments are simulated via inference through (atomic) interventionsα in time on a specific abnormal instance in order to revert the anomaly."
  - [section] "Given that an anomaly was factually recorded in the data... Equation (8) estimates the probability that the risk would have been low at the Point of Incipient Failure Xt=T+F=L, had the root cause Xt=T+ had the value α."
  - [corpus] Weak evidence - corpus focuses on root cause diagnosis but doesn't extensively cover counterfactual interventions for anomaly prevention.

## Foundational Learning

- Concept: Structural Causal Models (SCM)
  - Why needed here: Provides the theoretical foundation for modeling causal relationships and enables counterfactual reasoning
  - Quick check question: How does an SCM differ from a standard probabilistic model in terms of the queries it can answer?

- Concept: Time Series Causal Discovery
  - Why needed here: Essential for learning causal structures from observational time series data with potential temporal confounding
  - Quick check question: What is the main challenge when applying standard causal discovery algorithms to time series data?

- Concept: Counterfactual Reasoning and Do-Calculus
  - Why needed here: Enables algorithmic recourse by simulating interventions on the causal model to find potential solutions
  - Quick check question: What are the three steps of Pearl's counterfactual reasoning framework?

## Architecture Onboarding

- Component map: Data Preprocessing -> Causal Structure Learning -> DCBN Construction -> Point of Incipient Failure Detection -> Root Cause Path Identification -> Counterfactual Analysis
- Critical path: Data preprocessing → Causal structure learning → DCBN construction → Point of Incipient Failure detection → Root cause path identification → Counterfactual analysis
- Design tradeoffs: PC algorithm (simpler, manual lag) vs PC-MCI (more powerful, automatic lag handling); static vs dynamic Bayesian networks; direct vs indirect effects analysis
- Failure signatures: Empty causal graphs, cyclic dependencies, poor anomaly prediction, non-monotonic failure probability, counterfactual interventions with no effect
- First 3 experiments:
  1. Verify the synthetic system data generation and basic anomaly injection works correctly
  2. Test PC algorithm with time lags on the synthetic data and validate learned structure against ground truth
  3. Implement DCBN and verify it can accurately predict the alarm signal given the learned structure

## Open Questions the Paper Calls Out

### Open Question 1
- Question: How can the proposed causal discovery method be improved to handle more complex industrial environments with larger numbers of variables and longer time series records?
- Basis in paper: [explicit] "Finally, assessing the capacity to scale of the described solution is necessary. This goal should consider the impact of the number of variables, the length of the records, the nature of data, etc."
- Why unresolved: The paper only demonstrates the approach on a synthetic 2-out-of-3 redundancy system with 4 variables. Real-world industrial systems have significantly more variables and longer time series, which may pose challenges for the current causal discovery algorithms.
- What evidence would resolve it: Testing the approach on larger, more complex synthetic or real-world industrial datasets with varying numbers of variables and record lengths to assess its scalability and performance.

### Open Question 2
- Question: How can the method be adapted to handle real-world industrial data that may have imbalanced failure instances and heteroskedasticity issues?
- Basis in paper: [explicit] "However, operational data often suffer from imbalance issues, especially showing a shortage of failure instances... What is potentially weak in the current state of the art in causal RCA is the specific assessment of heteroskedasticity."
- Why unresolved: The current approach assumes a balanced dataset and stationary causal relationships, which may not hold for real-world industrial data. Imbalanced data and non-stationary relationships due to anomalies can affect the performance of the causal discovery and inference algorithms.
- What evidence would resolve it: Evaluating the approach on real-world industrial datasets with imbalanced failure instances and heteroskedasticity issues, and proposing modifications to the causal discovery and inference algorithms to handle these challenges.

### Open Question 3
- Question: How can the method be extended to identify multiple root causes and their interactions in complex failure scenarios?
- Basis in paper: [explicit] "Finally, it would also be interesting to relax the assumption that failures can only occur through the path of the root cause, and explore the impact of direct and indirect effects."
- Why unresolved: The current approach focuses on identifying a single root cause and its causal path. However, complex industrial failures may involve multiple root causes and their interactions, which are not captured by the current method.
- What evidence would resolve it: Developing extensions to the causal discovery and inference algorithms to identify multiple root causes and their interactions, and validating the approach on complex failure scenarios with multiple root causes.

## Limitations
- The synthetic 2-out-of-3 redundancy system lacks the complexity of real industrial systems with heterogeneous variables and non-linear relationships
- The PC algorithm may struggle with high-dimensional data or insufficient temporal resolution to capture causal relationships
- The method assumes a single Point of Incipient Failure and monotonic increase in failure probability, which may not hold for systems with multiple cascading failures
- The approach requires reasonably large amounts of labeled failure data for structure learning, which may not be available in many industrial settings

## Confidence
**High Confidence**: The theoretical foundation combining causal discovery with Dynamic Causal Bayesian Networks is well-established. The mechanism for detecting the Point of Incipient Failure through probability tracking is mathematically sound and clearly articulated.

**Medium Confidence**: The experimental results on the synthetic system demonstrate the approach works as intended, but the simplified nature of the system limits generalizability. The likelihood calculations for causal paths appear correct but haven't been validated against alternative methods.

**Low Confidence**: The counterfactual analysis framework, while theoretically valid, hasn't been extensively validated on complex systems. The assumptions about root causes being identifiable at the Point of Incipient Failure may not hold in practice, particularly for systems with delayed effects or multiple concurrent issues.

## Next Checks
1. **Generalization Test**: Apply the approach to a more complex synthetic system with multiple failure modes, feedback loops, and non-linear relationships to assess robustness beyond the simple 2-out-of-3 redundancy case.

2. **Real Data Validation**: Test the method on real industrial time series data from a system with known failure modes, comparing identified root causes against domain expert diagnoses to validate practical effectiveness.

3. **Robustness Analysis**: Evaluate performance under data quality challenges including missing values, noise, and limited failure events, and test alternative structure learning algorithms beyond PC to assess sensitivity to algorithmic choices.